!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(T,e){"use strict";function g(e){return null!=e&&e===e.window}var t=[],n=Object.getPrototypeOf,s=t.slice,y=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,r={},o=r.toString,v=r.hasOwnProperty,a=v.toString,l=a.call(Object),m={},x=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},C=T.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function h(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?r[o.call(e)]||"object":typeof e}var f="3.6.0",E=function(e,t){return new E.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=h(e);return!x(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}E.fn=E.prototype={jquery:f,constructor:E,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){e=E.merge(this.constructor(),e);return e.prevObject=this,e},each:function(e){return E.each(this,e)},map:function(n){return this.pushStack(E.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(E.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},E.extend=E.fn.extend=function(){var e,t,n,r,i,o=arguments[0]||{},a=1,s=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[a]||{},a++),"object"==typeof o||x(o)||(o={}),a===s&&(o=this,a--);a<s;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&o!==n&&(u&&n&&(E.isPlainObject(n)||(r=Array.isArray(n)))?(i=o[t],i=r&&!Array.isArray(i)?[]:r||E.isPlainObject(i)?i:{},r=!1,o[t]=E.extend(u,i,n)):void 0!==n&&(o[t]=n));return o},E.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){return!(!e||"[object Object]"!==o.call(e))&&(!(e=n(e))||"function"==typeof(e=v.call(e,"constructor")&&e.constructor)&&a.call(e)===l)},isEmptyObject:function(e){for(var t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){t=t||[];return null!=e&&(p(Object(e))?E.merge(t,"string"==typeof e?[e]:e):u.call(t,e)),t},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!=a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return y(a)},guid:1,support:m}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=t[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){r["[object "+t+"]"]=t.toLowerCase()});var d=function(n){function f(e,t){return e="0x"+e.slice(1)-65536,t||(e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320))}function r(){T()}var e,d,b,o,i,h,p,g,w,u,l,T,C,a,E,y,s,c,v,S="sizzle"+ +new Date,m=n.document,k=0,x=0,A=ue(),N=ue(),j=ue(),D=ue(),q=function(e,t){return e===t&&(l=!0),0},L={}.hasOwnProperty,t=[],H=t.pop,O=t.push,P=t.push,R=t.slice,M=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",W="[\\x20\\t\\r\\n\\f]",F="(?:\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\["+W+"*("+F+")(?:"+W+"*([*^$|!~]?=)"+W+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+W+"*\\]",$=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",_=new RegExp(W+"+","g"),z=new RegExp("^"+W+"+|((?:^|[^\\\\])(?:\\\\.)*)"+W+"+$","g"),U=new RegExp("^"+W+"*,"+W+"*"),X=new RegExp("^"+W+"*([>+~]|"+W+")"+W+"*"),V=new RegExp(W+"|>"),G=new RegExp($),Y=new RegExp("^"+F+"$"),Q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+W+"*(even|odd|(([+-]|)(\\d*)n|)"+W+"*(?:([+-]|)"+W+"*(\\d+)|))"+W+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+W+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+W+"*((?:-\\d)?\\d*)"+W+"*\\)|)(?=[^-]|$)","i")},J=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,ee=/^[^{]+\{\s*\[native \w/,te=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ne=/[+~]/,re=new RegExp("\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\([^\\r\\n\\f])","g"),ie=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oe=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ae=me(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{P.apply(t=R.call(m.childNodes),m.childNodes),t[m.childNodes.length].nodeType}catch(e){P={apply:t.length?function(e,t){O.apply(e,R.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=te.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&v(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return P.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return P.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!D[t+" "]&&(!y||!y.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(V.test(t)||X.test(t))){for((f=ne.test(t)&&ge(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(ie,oe):e.setAttribute("id",s=S)),o=(l=h(t)).length;o--;)l[o]=(s?"#"+s:":scope")+" "+ve(l[o]);c=l.join(",")}try{return P.apply(n,f.querySelectorAll(c)),n}catch(e){D(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace(z,"$1"),e,n,r)}function ue(){var n=[];function r(e,t){return n.push(e+" ")>b.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){for(var n=e.split("|"),r=n.length;r--;)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function he(a){return le(function(o){return o=+o,le(function(e,t){for(var n,r=a([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,e=e&&(e.ownerDocument||e).documentElement;return!J.test(t||e&&e.nodeName||"HTML")},T=se.setDocument=function(e){var t,e=e?e.ownerDocument||e:m;return e!=C&&9===e.nodeType&&e.documentElement&&(a=(C=e).documentElement,E=!i(C),m!=C&&(t=C.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",r,!1):t.attachEvent&&t.attachEvent("onunload",r)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=ee.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(re,f);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E){e=t.getElementById(e);return e?[e]:[]}}):(b.filter.ID=function(e){var t=e.replace(re,f);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},b.find.CLASS=d.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],y=[],(d.qsa=ee.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+W+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+W+"*(?:value|"+I+")"),e.querySelectorAll("[id~="+S+"-]").length||y.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||y.push("\\["+W+"*name"+W+"*="+W+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||y.push(".#.+[+~]"),e.querySelectorAll("\\\f"),y.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+W+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(d.matchesSelector=ee.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",$)}),y=y.length&&new RegExp(y.join("|")),s=s.length&&new RegExp(s.join("|")),t=ee.test(a.compareDocumentPosition),v=t||ee.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==m&&v(m,e)?-1:t==C||t.ownerDocument==m&&v(m,t)?1:u?M(u,e)-M(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?M(u,e)-M(u,t):0;if(i===o)return pe(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?pe(a[r],s[r]):a[r]==m?-1:s[r]==m?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!D[t+" "]&&(!s||!s.test(t))&&(!y||!y.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){D(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),v(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],n=n&&L.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==n?n:d.attributes||!E?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},se.escape=function(e){return(e+"").replace(ie,oe)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(q),l){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(re,f),e[3]=(e[3]||e[4]||e[5]||"").replace(re,f),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&G.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(re,f).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=A[e+" "];return t||(t=new RegExp("(^|"+W+")"+e+"("+W+"|$)"))&&A(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=se.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(_," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(h,e,t,g,y){var v="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===y?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=v!=m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(v){for(;l;){for(a=e;a=a[l];)if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){for(d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];a=++s&&a&&a[l]||(d=s=0)||u.pop();)if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)for(;(a=++s&&a&&a[l]||(d=s=0)||u.pop())&&((x?a.nodeName.toLowerCase()!==f:1!==a.nodeType)||!++d||(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a!==e)););return(d-=y)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){for(var n,r=a(e,o),i=r.length;i--;)e[n=M(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=p(e.replace(z,"$1"));return s[S]?le(function(e,t,n,r){for(var i,o=s(e,null,r,[]),a=e.length;a--;)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(re,f),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return Y.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(re,f).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:de(!1),disabled:de(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:he(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=function(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}(e);function ye(){}function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function me(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=x++;return e.first?function(e,t,n){for(;e=e[s];)if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[k,f];if(n){for(;e=e[s];)if((1===e.nodeType||c)&&a(e,t,n))return!0}else for(;e=e[s];)if(1===e.nodeType||c)if(r=(i=e[S]||(e[S]={}))[e.uniqueID]||(i[e.uniqueID]={}),u&&u===e.nodeName.toLowerCase())e=e[s]||e;else{if((i=r[l])&&i[0]===k&&i[1]===f)return o[2]=i[2];if((r[l]=o)[2]=a(e,t,n))return!0}return!1}}function xe(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function be(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function we(d,h,g,y,v,e){return y&&!y[S]&&(y=we(y)),v&&!v[S]&&(v=we(v,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:be(c,s,d,n,r),p=g?v||(e?d:l||y)?[]:t:f;if(g&&g(f,p,n,r),y)for(i=be(p,u),y(i,[],n,r),o=i.length;o--;)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a));if(e){if(v||d){if(v){for(i=[],o=p.length;o--;)(a=p[o])&&i.push(f[o]=a);v(null,p=[],i,r)}for(o=p.length;o--;)(a=p[o])&&-1<(i=v?M(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=be(p===t?p.splice(l,p.length):p),v?v(null,t,p,r):P.apply(t,p)})}function Te(y,v){function e(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){for(a=0,t||o.ownerDocument==C||(T(o),n=!E);s=y[a++];)if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){for(a=0;s=v[a++];)s(c,f,t,n);if(e){if(0<u)for(;l--;)c[l]||f[l]||(f[l]=H.call(r));f=be(f)}P.apply(r,f),i&&!e&&0<f.length&&1<u+v.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c}var m=0<v.length,x=0<y.length;return m?le(e):e}return ye.prototype=b.filters=b.pseudos,b.setFilters=new ye,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=N[e+" "];if(l)return t?0:l.slice(0);for(a=e,s=[],u=b.preFilter;a;){for(o in n&&!(r=U.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length)),b.filter)!(r=Q[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):N(e,s).slice(0)},p=se.compile=function(e,t){var n,r=[],i=[],o=j[e+" "];if(!o){for(n=(t=t||h(e)).length;n--;)((o=function e(t){for(var r,n,i,o=t.length,a=b.relative[t[0].type],s=a||b.relative[" "],u=a?1:0,l=me(function(e){return e===r},s,!0),c=me(function(e){return-1<M(r,e)},s,!0),f=[function(e,t,n){return n=!a&&(n||t!==w)||((r=t).nodeType?l:c)(e,t,n),r=null,n}];u<o;u++)if(n=b.relative[t[u].type])f=[me(xe(f),n)];else{if((n=b.filter[t[u].type].apply(null,t[u].matches))[S]){for(i=++u;i<o&&!b.relative[t[i].type];i++);return we(1<u&&xe(f),1<u&&ve(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(z,"$1"),n,u<i&&e(t.slice(u,i)),i<o&&e(t=t.slice(i)),i<o&&ve(t))}f.push(n)}return xe(f)}(t[n]))[S]?r:i).push(o);(o=j(e,Te(i,r))).selector=e}return o},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(re,f),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=Q.needsContext.test(e)?0:o.length;i--&&(a=o[i],!b.relative[s=a.type]);)if((u=b.find[s])&&(r=u(a.matches[0].replace(re,f),ne.test(o[0].type)&&ge(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&ve(o)))return P.apply(n,r),n;break}}return(l||p(e,c))(r,t,!E,n,!t||ne.test(e)&&ge(t.parentNode)||t),n},d.sortStable=S.split("").sort(q).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(I,function(e,t,n){if(!n)return!0===e[t]?t.toLowerCase():(t=e.getAttributeNode(t))&&t.specified?t.value:null}),se}(T);E.find=d,E.expr=d.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=d.uniqueSort,E.text=d.getText,E.isXMLDoc=d.isXML,E.contains=d.contains,E.escapeSelector=d.escape;function w(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&E(e).is(n))break;r.push(e)}return r}function S(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}var k=E.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return x(n)?E.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?E.grep(e,function(e){return e===n!==r}):"string"!=typeof n?E.grep(e,function(e){return-1<i.call(n,e)!==r}):E.filter(n,e,r)}E.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?E.find.matchesSelector(r,e)?[r]:[]:E.find.matches(e,E.grep(t,function(e){return 1===e.nodeType}))},E.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(E(e).filter(function(){for(t=0;t<r;t++)if(E.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)E.find(e,i[t],n);return 1<r?E.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?E(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(e,t,n){if(!e)return this;if(n=n||D,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):x(e)?void 0!==n.ready?n.ready(e):e(E):E.makeArray(e,this);if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return(!t||t.jquery?t||n:this.constructor(t)).find(e);if(r[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),N.test(r[1])&&E.isPlainObject(t))for(var r in t)x(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(e=C.getElementById(r[2]))&&(this[0]=e,this.length=1),this}).prototype=E.fn,D=E(C);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}E.fn.extend({has:function(e){var t=E(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(E.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&E(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&E.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?E.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(E(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return w(e,"parentNode")},parentsUntil:function(e,t,n){return w(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return w(e,"nextSibling")},prevAll:function(e){return w(e,"previousSibling")},nextUntil:function(e,t,n){return w(e,"nextSibling",n)},prevUntil:function(e,t,n){return w(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return null!=e.contentDocument&&n(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),E.merge([],e.childNodes))}},function(r,i){E.fn[r]=function(e,t){var n=E.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=E.filter(t,n)),1<this.length&&(H[r]||E.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&x(i=e.promise)?i.call(e).done(t).fail(n):e&&x(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}E.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},E.each(e.match(P)||[],function(e,t){n[t]=!0}),n):E.extend({},r);function i(){for(s=s||r.once,a=o=!0;l.length;c=-1)for(t=l.shift();++c<u.length;)!1===u[c].apply(t[0],t[1])&&r.stopOnFalse&&(c=u.length,t=!1);r.memory||(t=!1),o=!1,s&&(u=t?[]:"")}var o,t,a,s,u=[],l=[],c=-1,f={add:function(){return u&&(t&&!o&&(c=u.length-1,l.push(t)),function n(e){E.each(e,function(e,t){x(t)?r.unique&&f.has(t)||u.push(t):t&&t.length&&"string"!==h(t)&&n(t)})}(arguments),t&&!o&&i()),this},remove:function(){return E.each(arguments,function(e,t){for(var n;-1<(n=E.inArray(t,u,n));)u.splice(n,1),n<=c&&c--}),this},has:function(e){return e?-1<E.inArray(e,u):0<u.length},empty:function(){return u=u&&[],this},disable:function(){return s=l=[],u=t="",this},disabled:function(){return!u},lock:function(){return s=l=[],t||o||(u=t=""),this},locked:function(){return!!s},fireWith:function(e,t){return s||(t=[e,(t=t||[]).slice?t.slice():t],l.push(t),o||i()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!a}};return f},E.extend({Deferred:function(e){var o=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var i=arguments;return E.Deferred(function(r){E.each(o,function(e,t){var n=x(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&x(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){function e(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,x(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}}var n=this,r=arguments,t=s?e:function(){try{e()}catch(e){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(E.Deferred.getStackHook&&(t.stackTrace=E.Deferred.getStackHook()),T.setTimeout(t))}}return E.Deferred(function(e){o[0][3].add(l(0,e,x(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,x(t)?t:R)),o[2][3].add(l(0,e,x(n)?n:M))}).promise()},promise:function(e){return null!=e?E.extend(e,a):a}},s={};return E.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){function t(t){return function(e){i[t]=this,o[t]=1<arguments.length?s.call(arguments):e,--n||a.resolveWith(i,o)}}var n=arguments.length,r=n,i=Array(r),o=s.call(arguments),a=E.Deferred();if(n<=1&&(I(e,a.done(t(r)).resolve,a.reject,!n),"pending"===a.state()||x(o[r]&&o[r].then)))return a.then();for(;r--;)I(o[r],t(r),a.reject);return a.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){T.console&&T.console.warn&&e&&W.test(e.name)&&T.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},E.readyException=function(e){T.setTimeout(function(){throw e})};var F=E.Deferred();function B(){C.removeEventListener("DOMContentLoaded",B),T.removeEventListener("load",B),E.ready()}E.fn.ready=function(e){return F.then(e).catch(function(e){E.readyException(e)}),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0)!==e&&0<--E.readyWait||F.resolveWith(C,[E])}}),E.ready.then=F.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?T.setTimeout(E.ready):(C.addEventListener("DOMContentLoaded",B),T.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===h(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,x(r)||(a=!0),l&&(t=a?(t.call(e,r),null):(l=t,function(e,t,n){return l.call(E(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}function V(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function G(){this.expando=E.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;for(;n--;)delete r[t[n]]}void 0!==t&&!E.isEmptyObject(r)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){e=e[this.expando];return void 0!==e&&!E.isEmptyObject(e)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}E.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),E.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;return o&&void 0===e?void 0!==(t=Q.get(o,n))||void 0!==(t=Z(o,n))?t:void 0:void this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),E.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,E.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=E.queue(e,t),r=n.length,i=n.shift(),o=E._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){E.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:E.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),E.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?E.queue(this[0],t):void 0===n?this:this.each(function(){var e=E.queue(this,t,n);E._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&E.dequeue(this,t)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--i||o.resolveWith(a,[a])}var r,i=1,o=E.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(r=Y.get(a[s],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=C.documentElement,ie=function(e){return E.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return E.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===E.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return E.css(e,t,"")},u=s(),l=n&&n[3]||(E.cssNumber[t]?"":"px"),c=e.nodeType&&(E.cssNumber[t]||"px"!==l&&+u)&&te.exec(E.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)E.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,E.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s=[],u=0,l=e.length;u<l;u++)(r=e[u]).style&&(n=r.style.display,t?("none"===n&&(s[u]=Y.get(r,"display")||null,s[u]||(r.style.display="")),""===r.style.display&&ae(r)&&(s[u]=(a=o=void 0,o=(i=r).ownerDocument,a=i.nodeName,(i=ue[a])||(o=o.body.appendChild(o.createElement(a)),i=E.css(o,"display"),o.parentNode.removeChild(o),"none"===i&&(i="block"),ue[a]=i)))):"none"!==n&&(s[u]="none",Y.set(r,"display",n)));for(u=0;u<l;u++)null!=s[u]&&(e[u].style.display=s[u]);return e}E.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?E(this).show():E(this).hide()})}});var ce=/^(?:checkbox|radio)$/i,fe=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pe=/^$|^module$|\/(?:java|ecma)script/i;f=C.createDocumentFragment().appendChild(C.createElement("div")),(d=C.createElement("input")).setAttribute("type","radio"),d.setAttribute("checked","checked"),d.setAttribute("name","t"),f.appendChild(d),m.checkClone=f.cloneNode(!0).cloneNode(!0).lastChild.checked,f.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!f.cloneNode(!0).lastChild.defaultValue,f.innerHTML="<option></option>",m.option=!!f.lastChild;var de={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function he(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&A(e,t)?E.merge([e],n):n}function ge(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}de.tbody=de.tfoot=de.colgroup=de.caption=de.thead,de.th=de.td,m.option||(de.optgroup=de.option=[1,"<select multiple='multiple'>","</select>"]);var ye=/<|&#?\w+;/;function ve(e,t,n,r,i){for(var o,a,s,u,l,c=t.createDocumentFragment(),f=[],p=0,d=e.length;p<d;p++)if((o=e[p])||0===o)if("object"===h(o))E.merge(f,o.nodeType?[o]:o);else if(ye.test(o)){for(a=a||c.appendChild(t.createElement("div")),s=(fe.exec(o)||["",""])[1].toLowerCase(),s=de[s]||de._default,a.innerHTML=s[1]+E.htmlPrefilter(o)+s[2],l=s[0];l--;)a=a.lastChild;E.merge(f,a.childNodes),(a=c.firstChild).textContent=""}else f.push(t.createTextNode(o));for(c.textContent="",p=0;o=f[p++];)if(r&&-1<E.inArray(o,r))i&&i.push(o);else if(u=ie(o),a=he(c.appendChild(o),"script"),u&&ge(a),n)for(l=0;o=a[l++];)pe.test(o.type||"")&&n.push(o);return c}var me=/^([^.]*)(?:\.(.+)|)/;function xe(){return!0}function be(){return!1}function we(e,t){return e===function(){try{return C.activeElement}catch(e){}}()==("focus"===t)}function Te(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Te(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=be;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return E().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=E.guid++)),e.each(function(){E.event.add(this,t,i,r,n)})}function Ce(e,i,o){o?(Y.set(e,i,!1),E.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(E.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:E.event.trigger(E.extend(r[0],E.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&E.event.add(e,i,xe)}E.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h=Y.get(t);if(V(t))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&E.find.matchesSelector(re,i),n.guid||(n.guid=E.guid++),(s=h.events)||(s=h.events=Object.create(null)),(a=h.handle)||(a=h.handle=function(e){return void 0!==E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(P)||[""]).length;u--;)f=d=(l=me.exec(e[u])||[])[1],p=(l[2]||"").split(".").sort(),f&&(c=E.event.special[f]||{},f=(i?c.delegateType:c.bindType)||f,c=E.event.special[f]||{},l=E.extend({type:f,origType:d,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:p.join(".")},o),(d=s[f])||((d=s[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,r,p,a)||t.addEventListener&&t.addEventListener(f,a)),c.add&&(c.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,l):d.push(l),E.event.global[f]=!0)},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=Y.hasData(e)&&Y.get(e);if(y&&(u=y.events)){for(l=(t=(t||"").match(P)||[""]).length;l--;)if(d=g=(s=me.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){for(f=E.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||E.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)E.event.remove(e,d+t[l],n,r,!0);E.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a=new Array(arguments.length),s=E.event.fix(e),u=(Y.get(this,"events")||Object.create(null))[s.type]||[],e=E.event.special[s.type]||{};for(a[0]=s,t=1;t<arguments.length;t++)a[t]=arguments[t];if(s.delegateTarget=this,!e.preDispatch||!1!==e.preDispatch.call(this,s)){for(o=E.event.handlers.call(this,s,u),t=0;(r=o[t++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!1!==i.namespace&&!s.rnamespace.test(i.namespace)||(s.handleObj=i,s.data=i.data,void 0!==(i=((E.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,a))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return e.postDispatch&&e.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<E(i,this).index(l):E.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:x(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){e=this||e;return ce.test(e.type)&&e.click&&A(e,"input")&&Ce(e,"click",xe),!1},trigger:function(e){e=this||e;return ce.test(e.type)&&e.click&&A(e,"input")&&Ce(e,"click"),!0},_default:function(e){e=e.target;return ce.test(e.type)&&e.click&&A(e,"input")&&Y.get(e,"click")||A(e,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?xe:be,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:be,isPropagationStopped:be,isImmediatePropagationStopped:be,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=xe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=xe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=xe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},function(e,t){E.event.special[e]={setup:function(){return Ce(this,e,we),!1},trigger:function(){return Ce(this,e),!0},_default:function(){return!0},delegateType:t}}),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){E.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||E.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),E.fn.extend({on:function(e,t,n,r){return Te(this,e,t,n,r)},one:function(e,t,n,r){return Te(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,E(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=be),this.each(function(){E.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i]);return this}});var Ee=/<script|<style|<link/i,Se=/checked\s*(?:[^=]|=\s*.checked.)/i,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ae(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&E(e).children("tbody")[0]||e}function Ne(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function je(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function De(e,t){var n,r,i,o;if(1===t.nodeType){if(Y.hasData(e)&&(o=Y.get(e).events))for(i in Y.remove(t,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)E.event.add(t,i,o[i][n]);Q.hasData(e)&&(e=Q.access(e),e=E.extend({},e),Q.set(t,e))}}function qe(n,r,i,o){r=y(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=x(d);if(h||1<f&&"string"==typeof d&&!m.checkClone&&Se.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),qe(t,r,i,o)});if(f&&(t=(e=ve(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=E.map(he(e,"script"),Ne)).length;c<f;c++)u=e,c!==p&&(u=E.clone(u,!0,!0),s&&E.merge(a,he(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,E.map(a,je),c=0;c<s;c++)u=a[c],pe.test(u.type||"")&&!Y.access(u,"globalEval")&&E.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?E._evalUrl&&!u.noModule&&E._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(ke,""),u,l))}return n}function Le(e,t,n){for(var r,i=t?E.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||E.cleanData(he(r)),r.parentNode&&(n&&ie(r)&&ge(he(r,"script")),r.parentNode.removeChild(r));return e}E.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(a=he(c),r=0,i=(o=he(e)).length;r<i;r++)s=o[r],u=a[r],l=void 0,"input"===(l=u.nodeName.toLowerCase())&&ce.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||he(e),a=a||he(c),r=0,i=o.length;r<i;r++)De(o[r],a[r]);else De(e,c);return 0<(a=he(c,"script")).length&&ge(a,!f&&he(e,"script")),c},cleanData:function(e){for(var t,n,r,i=E.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?E.event.remove(n,r):E.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),E.fn.extend({detach:function(e){return Le(this,e,!0)},remove:function(e){return Le(this,e)},text:function(e){return $(this,function(e){return void 0===e?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return qe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ae(this,e).appendChild(e)})},prepend:function(){return qe(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=Ae(this,e)).insertBefore(e,t.firstChild)})},before:function(){return qe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return qe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(he(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ee.test(e)&&!de[(fe.exec(e)||["",""])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(E.cleanData(he(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return qe(this,arguments,function(e){var t=this.parentNode;E.inArray(this,n)<0&&(E.cleanData(he(this)),t&&t.replaceChild(e,this))},n)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){E.fn[e]=function(e){for(var t,n=[],r=E(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),E(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});function He(e,t,n){var r,i={};for(r in t)i[r]=e.style[r],e.style[r]=t[r];for(r in n=n.call(e),t)e.style[r]=i[r];return n}var Oe,Pe,Re,Me,Ie,We,Fe,Be,$e=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),_e=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=T),t.getComputedStyle(e)},ze=new RegExp(ne.join("|"),"i");function Ue(){var e;Be&&(Fe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Be.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(Fe).appendChild(Be),e=T.getComputedStyle(Be),Oe="1%"!==e.top,We=12===Xe(e.marginLeft),Be.style.right="60%",Me=36===Xe(e.right),Pe=36===Xe(e.width),Be.style.position="absolute",Re=12===Xe(Be.offsetWidth/3),re.removeChild(Fe),Be=null)}function Xe(e){return Math.round(parseFloat(e))}function Ve(e,t,n){var r,i,o=e.style;return(n=n||_e(e))&&(""!==(i=n.getPropertyValue(t)||n[t])||ie(e)||(i=E.style(e,t)),!m.pixelBoxStyles()&&$e.test(i)&&ze.test(t)&&(r=o.width,e=o.minWidth,t=o.maxWidth,o.minWidth=o.maxWidth=o.width=i,i=n.width,o.width=r,o.minWidth=e,o.maxWidth=t)),void 0!==i?i+"":i}function Ge(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}Fe=C.createElement("div"),(Be=C.createElement("div")).style&&(Be.style.backgroundClip="content-box",Be.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===Be.style.backgroundClip,E.extend(m,{boxSizingReliable:function(){return Ue(),Pe},pixelBoxStyles:function(){return Ue(),Me},pixelPosition:function(){return Ue(),Oe},reliableMarginLeft:function(){return Ue(),We},scrollboxSize:function(){return Ue(),Re},reliableTrDimensions:function(){var e,t,n;return null==Ie&&(e=C.createElement("table"),t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),n=T.getComputedStyle(t),Ie=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),Ie}}));var Ye=["Webkit","Moz","ms"],Qe=C.createElement("div").style,Je={};function Ke(e){var t=E.cssProps[e]||Je[e];return t||(e in Qe?e:Je[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ye.length;n--;)if((e=Ye[n]+t)in Qe)return e}(e)||e)}var Ze=/^(none|table(?!-c[ea]).+)/,et=/^--/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=E.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=E.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=E.css(e,"border"+ne[a]+"Width",!0,i))):(u+=E.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=E.css(e,"border"+ne[a]+"Width",!0,i):s+=E.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function ot(e,t,n){var r=_e(e),i=(!m.boxSizingReliable()||n)&&"border-box"===E.css(e,"boxSizing",!1,r),o=i,a=Ve(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if($e.test(a)){if(!n)return a;a="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===E.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===E.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){e=Ve(e,"opacity");return""===e?"1":e}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=et.test(t),l=e.style;if(u||(t=Ke(s)),a=E.cssHooks[t]||E.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(E.cssNumber[s]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o=X(t);return et.test(t)||(t=Ke(o)),(o=E.cssHooks[t]||E.cssHooks[o])&&"get"in o&&(i=o.get(e,!0,n)),void 0===i&&(i=Ve(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(t=parseFloat(i),!0===n||isFinite(t)?t||0:i):i}}),E.each(["height","width"],function(e,s){E.cssHooks[s]={get:function(e,t,n){if(t)return!Ze.test(E.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,s,n):He(e,tt,function(){return ot(e,s,n)})},set:function(e,t,n){var r,i=_e(e),o=!m.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===E.css(e,"boxSizing",!1,i),n=n?it(e,s,n,a,i):0;return a&&o&&(n-=Math.ceil(e["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(i[s])-it(e,s,"border",!1,i)-.5)),n&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[s]=t,t=E.css(e,s)),rt(0,t,n)}}}),E.cssHooks.marginLeft=Ge(m.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ve(e,"marginLeft"))||e.getBoundingClientRect().left-He(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),E.each({margin:"",padding:"",border:"Width"},function(i,o){E.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(E.cssHooks[i+o].set=rt)}),E.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=_e(e),i=t.length;a<i;a++)o[t[a]]=E.css(e,t[a],!1,r);return o}return void 0!==n?E.style(e,t,n):E.css(e,t)},e,t,1<arguments.length)}}),(E.Tween=at).prototype={constructor:at,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(E.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return(e&&e.get?e:at.propHooks._default).get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:at.propHooks._default).set(this),this}},at.prototype.init.prototype=at.prototype,at.propHooks={_default:{get:function(e){return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(e=E.css(e.elem,e.prop,""))&&"auto"!==e?e:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||!E.cssHooks[e.prop]&&null==e.elem.style[Ke(e.prop)]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}},at.propHooks.scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},E.fx=at.prototype.init,E.fx.step={};var st,ut,lt=/^(?:toggle|show|hide)$/,ct=/queueHooks$/;function ft(){ut&&(!1===C.hidden&&T.requestAnimationFrame?T.requestAnimationFrame(ft):T.setTimeout(ft,E.fx.interval),E.fx.tick())}function pt(){return T.setTimeout(function(){st=void 0}),st=Date.now()}function dt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ht(e,t,n){for(var r,i=(gt.tweeners[t]||[]).concat(gt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function gt(i,e,t){var n,o,r=0,a=gt.prefilters.length,s=E.Deferred().always(function(){delete u.elem}),u=function(){if(o)return!1;for(var e=st||pt(),e=Math.max(0,l.startTime+l.duration-e),t=1-(e/l.duration||0),n=0,r=l.tweens.length;n<r;n++)l.tweens[n].run(t);return s.notifyWith(i,[l,t,e]),t<1&&r?e:(r||s.notifyWith(i,[l,1,0]),s.resolveWith(i,[l]),!1)},l=s.promise({elem:i,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||pt(),duration:t.duration,tweens:[],createTween:function(e,t){e=E.Tween(i,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(e),e},stop:function(e){var t=0,n=e?l.tweens.length:0;if(o)return this;for(o=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(i,[l,1,0]),s.resolveWith(i,[l,e])):s.rejectWith(i,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=E.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<a;r++)if(n=gt.prefilters[r].call(l,i,c,l.opts))return x(n.stop)&&(E._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return E.map(c,ht,l),x(l.opts.start)&&l.opts.start.call(i,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),E.fx.timer(E.extend(u,{elem:i,anim:l,queue:l.opts.queue})),l}E.Animation=E.extend(gt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){for(var n,r=0,i=(e=x(e)?(t=e,["*"]):e.match(P)).length;r<i;r++)n=e[r],gt.tweeners[n]=gt.tweeners[n]||[],gt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c="width"in t||"height"in t,f=this,p={},d=e.style,h=e.nodeType&&ae(e),g=Y.get(e,"fxshow");for(r in n.queue||(null==(a=E._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,E.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],lt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;h=!0}p[r]=g&&g[r]||E.style(e,r)}if((u=!E.isEmptyObject(t))||!E.isEmptyObject(p))for(r in c&&1===e.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],null==(l=g&&g.display)&&(l=Y.get(e,"display")),"none"===(c=E.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=E.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===E.css(e,"float")&&(u||(f.done(function(){d.display=l}),null==l&&(c=d.display,l="none"===c?"":c)),d.display="inline-block")),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),u=!1,p)u||(g?"hidden"in g&&(h=g.hidden):g=Y.access(e,"fxshow",{display:l}),o&&(g.hidden=!h),h&&le([e],!0),f.done(function(){for(r in h||le([e]),Y.remove(e,"fxshow"),p)E.style(e,r,p[r])})),u=ht(h?g[r]:0,r,f),r in g||(g[r]=u.start,h&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?gt.prefilters.unshift(e):gt.prefilters.push(e)}}),E.speed=function(e,t,n){var r=e&&"object"==typeof e?E.extend({},e):{complete:n||!n&&t||x(e)&&e,duration:e,easing:n&&t||t&&!x(t)&&t};return E.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in E.fx.speeds?r.duration=E.fx.speeds[r.duration]:r.duration=E.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){x(r.old)&&r.old.call(this),r.queue&&E.dequeue(this,r.queue)},r},E.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=E.isEmptyObject(t),o=E.speed(e,n,r),r=function(){var e=gt(this,E.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return r.finish=r,i||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(i,e,o){function a(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=E.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&ct.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||E.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=E.timers,o=n?n.length:0;for(t.finish=!0,E.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),E.each(["toggle","show","hide"],function(e,r){var i=E.fn[r];E.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(dt(r,!0),e,t,n)}}),E.each({slideDown:dt("show"),slideUp:dt("hide"),slideToggle:dt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){E.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),E.timers=[],E.fx.tick=function(){var e,t=0,n=E.timers;for(st=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||E.fx.stop(),st=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){ut||(ut=!0,ft())},E.fx.stop=function(){ut=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(r,e){return r=E.fx&&E.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=T.setTimeout(e,r);t.stop=function(){T.clearTimeout(n)}})},f=C.createElement("input"),ee=C.createElement("select").appendChild(C.createElement("option")),f.type="checkbox",m.checkOn=""!==f.value,m.optSelected=ee.selected,(f=C.createElement("input")).value="t",f.type="radio",m.radioValue="t"===f.value;var yt,vt=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return $(this,E.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})}}),E.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?E.prop(e,t,n):(1===o&&E.isXMLDoc(e)||(i=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?yt:void 0)),void 0!==n?null===n?void E.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):!(i&&"get"in i&&null!==(r=i.get(e,t)))&&null==(r=E.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),yt={set:function(e,t,n){return!1===t?E.removeAttr(e,n):e.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),function(e,t){var a=vt[t]||E.find.attr;vt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=vt[o],vt[o]=r,r=null!=a(e,t,n)?o:null,vt[o]=i),r}});var mt=/^(?:input|select|textarea|button)$/i,xt=/^(?:a|area)$/i;function bt(e){return(e.match(P)||[]).join(" ")}function wt(e){return e.getAttribute&&e.getAttribute("class")||""}function Tt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}E.fn.extend({prop:function(e,t){return $(this,E.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[E.propFix[e]||e]})}}),E.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(e)||(t=E.propFix[t]||t,i=E.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,"tabindex");return t?parseInt(t,10):mt.test(e.nodeName)||xt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(E.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(e){e=e.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(t){var e,n,r,i,o,a,s=0;if(x(t))return this.each(function(e){E(this).addClass(t.call(this,e,wt(this)))});if((e=Tt(t)).length)for(;n=this[s++];)if(a=wt(n),r=1===n.nodeType&&" "+bt(a)+" "){for(o=0;i=e[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");a!==(a=bt(r))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,r,i,o,a,s=0;if(x(t))return this.each(function(e){E(this).removeClass(t.call(this,e,wt(this)))});if(!arguments.length)return this.attr("class","");if((e=Tt(t)).length)for(;n=this[s++];)if(a=wt(n),r=1===n.nodeType&&" "+bt(a)+" "){for(o=0;i=e[o++];)for(;-1<r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");a!==(a=bt(r))&&n.setAttribute("class",a)}return this},toggleClass:function(i,t){var o=typeof i,a="string"==o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):x(i)?this.each(function(e){E(this).toggleClass(i.call(this,e,wt(this),t),t)}):this.each(function(){var e,t,n,r;if(a)for(t=0,n=E(this),r=Tt(i);e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==i&&"boolean"!=o||((e=wt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==i&&Y.get(this,"__className__")||""))})},hasClass:function(e){for(var t,n=0,r=" "+e+" ";t=this[n++];)if(1===t.nodeType&&-1<(" "+bt(wt(t))+" ").indexOf(r))return!0;return!1}});var Ct=/\r/g;E.fn.extend({val:function(t){var n,e,r,i=this[0];return arguments.length?(r=x(t),this.each(function(e){1===this.nodeType&&(null==(e=r?t.call(this,e,E(this).val()):t)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=E.map(e,function(e){return null==e?"":e+""})),(n=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value")||(this.value=e))})):i?(n=E.valHooks[i.type]||E.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(i,"value"))?e:"string"==typeof(e=i.value)?e.replace(Ct,""):null==e?"":e:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,"value");return null!=t?t:bt(E.text(e))}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,i="select-one"===e.type,o=i?null:[],a=i?r+1:n.length,s=r<0?a:i?r:0;s<a;s++)if(((t=n[s]).selected||s===r)&&!t.disabled&&(!t.parentNode.disabled||!A(t.parentNode,"optgroup"))){if(t=E(t).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,o=E.makeArray(t),a=i.length;a--;)((r=i[a]).selected=-1<E.inArray(E.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<E.inArray(E(e).val(),t)}},m.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),m.focusin="onfocusin"in T;function Et(e){e.stopPropagation()}var St=/^(?:focusinfocus|focusoutblur)$/;E.extend(E.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f=[n||C],p=v.call(e,"type")?e.type:e,d=v.call(e,"namespace")?e.namespace.split("."):[],h=c=o=n=n||C;if(3!==n.nodeType&&8!==n.nodeType&&!St.test(p+E.event.triggered)&&(-1<p.indexOf(".")&&(p=(d=p.split(".")).shift(),d.sort()),s=p.indexOf(":")<0&&"on"+p,(e=e[E.expando]?e:new E.Event(p,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=d.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),l=E.event.special[p]||{},r||!l.trigger||!1!==l.trigger.apply(n,t))){if(!r&&!l.noBubble&&!g(n)){for(a=l.delegateType||p,St.test(a+p)||(h=h.parentNode);h;h=h.parentNode)f.push(h),o=h;o===(n.ownerDocument||C)&&f.push(o.defaultView||o.parentWindow||T)}for(i=0;(h=f[i++])&&!e.isPropagationStopped();)c=h,e.type=1<i?a:l.bindType||p,(u=(Y.get(h,"events")||Object.create(null))[e.type]&&Y.get(h,"handle"))&&u.apply(h,t),(u=s&&h[s])&&u.apply&&V(h)&&(e.result=u.apply(h,t),!1===e.result&&e.preventDefault());return e.type=p,r||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(f.pop(),t)||!V(n)||s&&x(n[p])&&!g(n)&&((o=n[s])&&(n[s]=null),E.event.triggered=p,e.isPropagationStopped()&&c.addEventListener(p,Et),n[p](),e.isPropagationStopped()&&c.removeEventListener(p,Et),E.event.triggered=void 0,o&&(n[s]=o)),e.result}},simulate:function(e,t,n){e=E.extend(new E.Event,n,{type:e,isSimulated:!0});E.event.trigger(e,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),m.focusin||E.each({focus:"focusin",blur:"focusout"},function(n,r){function i(e){E.event.simulate(r,e.target,E.event.fix(e))}E.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var kt=T.location,At={guid:Date.now()},Nt=/\?/;E.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new T.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||E.error("Invalid XML: "+(n?E.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var jt=/\[\]$/,Dt=/\r?\n/g,qt=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;E.param=function(e,t){function n(e,t){t=x(t)?t():t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)}var r,i=[];if(null==e)return"";if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){n(this.name,this.value)});else for(r in e)!function n(r,e,i,o){if(Array.isArray(e))E.each(e,function(e,t){i||jt.test(r)?o(r,t):n(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,o)});else if(i||"object"!==h(e))o(r,e);else for(var t in e)n(r+"["+t+"]",e[t],i,o)}(r,e[r],t,n);return i.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&Lt.test(this.nodeName)&&!qt.test(e)&&(this.checked||!ce.test(e))}).map(function(e,t){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var Ht=/%20/g,Ot=/#.*$/,Pt=/([?&])_=[^&]*/,Rt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Mt=/^(?:GET|HEAD)$/,It=/^\/\//,Wt={},Ft={},Bt="*/".concat("*"),$t=C.createElement("a");function _t(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(x(t))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function zt(t,r,i,o){var a={},s=t===Ft;function u(e){var n;return a[e]=!0,E.each(t[e]||[],function(e,t){t=t(r,i,o);return"string"!=typeof t||s||a[t]?s?!(n=t):void 0:(r.dataTypes.unshift(t),u(t),!1)}),n}return u(r.dataTypes[0])||!a["*"]&&u("*")}function Ut(e,t){var n,r,i=E.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r=r||{})[n]=t[n]);return r&&E.extend(!0,e,r),e}$t.href=kt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(kt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ut(Ut(e,E.ajaxSettings),t):Ut(E.ajaxSettings,e)},ajaxPrefilter:_t(Wt),ajaxTransport:_t(Ft),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var u,l,c,n,f,r,p,d,i,h=E.ajaxSetup({},t),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?E(g):E.event,v=E.Deferred(),m=E.Callbacks("once memory"),x=h.statusCode||{},o={},a={},s="canceled",b={readyState:0,getResponseHeader:function(e){var t;if(p){if(!n)for(n={};t=Rt.exec(c);)n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return p?c:null},setRequestHeader:function(e,t){return null==p&&(e=a[e.toLowerCase()]=a[e.toLowerCase()]||e,o[e]=t),this},overrideMimeType:function(e){return null==p&&(h.mimeType=e),this},statusCode:function(e){if(e)if(p)b.always(e[b.status]);else for(var t in e)x[t]=[x[t],e[t]];return this},abort:function(e){e=e||s;return u&&u.abort(e),w(0,e),this}};if(v.promise(b),h.url=((e||h.url||kt.href)+"").replace(It,kt.protocol+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(P)||[""],null==h.crossDomain){r=C.createElement("a");try{r.href=h.url,r.href=r.href,h.crossDomain=$t.protocol+"//"+$t.host!=r.protocol+"//"+r.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=E.param(h.data,h.traditional)),zt(Wt,h,t,b),p)return b;for(i in(d=E.event&&h.global)&&0==E.active++&&E.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),l=h.url.replace(Ot,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(Ht,"+")):(e=h.url.slice(l.length),h.data&&(h.processData||"string"==typeof h.data)&&(l+=(Nt.test(l)?"&":"?")+h.data,delete h.data),!1===h.cache&&(l=l.replace(Pt,"$1"),e=(Nt.test(l)?"&":"?")+"_="+At.guid+++e),h.url=l+e),h.ifModified&&(E.lastModified[l]&&b.setRequestHeader("If-Modified-Since",E.lastModified[l]),E.etag[l]&&b.setRequestHeader("If-None-Match",E.etag[l])),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&b.setRequestHeader("Content-Type",h.contentType),b.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Bt+"; q=0.01":""):h.accepts["*"]),h.headers)b.setRequestHeader(i,h.headers[i]);if(h.beforeSend&&(!1===h.beforeSend.call(g,b,h)||p))return b.abort();if(s="abort",m.add(h.complete),b.done(h.success),b.fail(h.error),u=zt(Ft,h,t,b)){if(b.readyState=1,d&&y.trigger("ajaxSend",[b,h]),p)return b;h.async&&0<h.timeout&&(f=T.setTimeout(function(){b.abort("timeout")},h.timeout));try{p=!1,u.send(o,w)}catch(e){if(p)throw e;w(-1,e)}}else w(-1,"No Transport");function w(e,t,n,r){var i,o,a,s=t;p||(p=!0,f&&T.clearTimeout(f),u=void 0,c=r||"",b.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(a=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a=a||i}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(h,b,n)),!r&&-1<E.inArray("script",h.dataTypes)&&E.inArray("json",h.dataTypes)<0&&(h.converters["text script"]=function(){}),a=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if(s=i.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(h,a,b,r),r?(h.ifModified&&((n=b.getResponseHeader("Last-Modified"))&&(E.lastModified[l]=n),(n=b.getResponseHeader("etag"))&&(E.etag[l]=n)),204===e||"HEAD"===h.type?s="nocontent":304===e?s="notmodified":(s=a.state,i=a.data,r=!(o=a.error))):(o=s,!e&&s||(s="error",e<0&&(e=0))),b.status=e,b.statusText=(t||s)+"",r?v.resolveWith(g,[i,s,b]):v.rejectWith(g,[b,s,o]),b.statusCode(x),x=void 0,d&&y.trigger(r?"ajaxSuccess":"ajaxError",[b,h,r?i:o]),m.fireWith(g,[b,s]),d&&(y.trigger("ajaxComplete",[b,h]),--E.active||E.event.trigger("ajaxStop")))}return b},getJSON:function(e,t,n){return E.get(e,t,n,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],function(e,i){E[i]=function(e,t,n,r){return x(t)&&(r=r||n,n=t,t=void 0),E.ajax(E.extend({url:e,type:i,dataType:r,data:t,success:n},E.isPlainObject(e)&&e))}}),E.ajaxPrefilter(function(e){for(var t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),E._evalUrl=function(e,t,n){return E.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){E.globalEval(e,t,n)}})},E.fn.extend({wrapAll:function(e){return this[0]&&(x(e)&&(e=e.call(this[0])),e=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return x(n)?this.each(function(e){E(this).wrapInner(n.call(this,e))}):this.each(function(){var e=E(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=x(t);return this.each(function(e){E(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new T.XMLHttpRequest}catch(e){}};var Xt={0:200,1223:204},Vt=E.ajaxSettings.xhr();m.cors=!!Vt&&"withCredentials"in Vt,m.ajax=Vt=!!Vt,E.ajaxTransport(function(i){var o,a;if(m.cors||Vt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Xt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&T.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),E.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),E.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=E("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Gt=[],Yt=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Gt.pop()||E.expando+"_"+At.guid++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Yt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=x(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Yt,"$1"+r):!1!==e.jsonp&&(e.url+=(Nt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||E.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=T[r],T[r]=function(){o=arguments},n.always(function(){void 0===i?E(T).removeProp(r):T[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Gt.push(r)),o&&x(i)&&i(o[0]),o=i=void 0}),"script"}),m.createHTMLDocument=((f=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===f.childNodes.length),E.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),r=!n&&[],(n=N.exec(e))?[t.createElement(n[1])]:(n=ve([e],t,r),r&&r.length&&E(r).remove(),E.merge([],n.childNodes)));var r},E.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=bt(e.slice(s)),e=e.slice(0,s)),x(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&E.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?E("<div>").append(E.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},E.expr.pseudos.animated=function(t){return E.grep(E.timers,function(e){return t===e.elem}).length},E.offset={setOffset:function(e,t,n){var r,i,o,a,s=E.css(e,"position"),u=E(e),l={};"static"===s&&(e.style.position="relative"),o=u.offset(),r=E.css(e,"top"),a=E.css(e,"left"),a=("absolute"===s||"fixed"===s)&&-1<(r+a).indexOf("auto")?(i=(s=u.position()).top,s.left):(i=parseFloat(r)||0,parseFloat(a)||0),x(t)&&(t=t.call(e,n,E.extend({},o))),null!=t.top&&(l.top=t.top-o.top+i),null!=t.left&&(l.left=t.left-o.left+a),"using"in t?t.using.call(e,l):u.css(l)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){E.offset.setOffset(this,t,e)});var e,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),n=n.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===E.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===E.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=E(e).offset()).top+=E.css(e,"borderTopWidth",!0),i.left+=E.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-E.css(r,"marginTop",!0),left:t.left-i.left-E.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===E.css(e,"position");)e=e.offsetParent;return e||re})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;E.fn[t]=function(e){return $(this,function(e,t,n){var r;return g(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n?r?r[i]:e[t]:void(r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n)},t,e,arguments.length)}}),E.each(["top","left"],function(e,n){E.cssHooks[n]=Ge(m.pixelPosition,function(e,t){if(t)return t=Ve(e,n),$e.test(t)?E(e).position()[n]+"px":t})}),E.each({Height:"height",Width:"width"},function(a,s){E.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){E.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return g(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?E.css(e,t,i):E.style(e,t,n,i)},s,n?e:void 0,n)}})}),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){E.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Qt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;E.proxy=function(e,t){var n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),x(e))return n=s.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(s.call(arguments)))}).guid=e.guid=e.guid||E.guid++,r},E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=A,E.isFunction=x,E.isWindow=g,E.camelCase=X,E.type=h,E.now=Date.now,E.isNumeric=function(e){var t=E.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},E.trim=function(e){return null==e?"":(e+"").replace(Qt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return E});var Jt=T.jQuery,Kt=T.$;return E.noConflict=function(e){return T.$===E&&(T.$=Kt),e&&T.jQuery===E&&(T.jQuery=Jt),E},void 0===e&&(T.jQuery=T.$=E),E});
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.async=n.async||{})}(this,function(n){"use strict";function d(n,t){t|=0;for(var e=Math.max(n.length-t,0),r=Array(e),i=0;i<e;i++)r[i]=n[t+i];return r}function t(t){var e=d(arguments,1);return function(){var n=d(arguments);return t.apply(null,e.concat(n))}}var a=function(e){return function(){var n=d(arguments),t=n.pop();e.call(this,n,t)}};function i(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}var e="function"==typeof setImmediate&&setImmediate,r="object"==typeof process&&"function"==typeof process.nextTick;function o(n){setTimeout(n,0)}function u(e){return function(n){var t=d(arguments,1);e(function(){n.apply(null,t)})}}var p=u(e?setImmediate:r?process.nextTick:o);function c(r){return a(function(n,t){var e;try{e=r.apply(this,n)}catch(n){return t(n)}i(e)&&"function"==typeof e.then?e.then(function(n){f(t,null,n)},function(n){f(t,n.message?n:new Error(n))}):t(null,e)})}function f(n,t,e){try{n(t,e)}catch(n){p(l,n)}}function l(n){throw n}var s="function"==typeof Symbol;function h(n){return s&&"AsyncFunction"===n[Symbol.toStringTag]}function m(n){return h(n)?c(n):n}function y(i){return function(t){var n=d(arguments,1),e=a(function(e,n){var r=this;return i(t,function(n,t){m(n).apply(r,e.concat(t))},n)});return n.length?e.apply(this,n):e}}var v="object"==typeof global&&global&&global.Object===Object&&global,g="object"==typeof self&&self&&self.Object===Object&&self,b=v||g||Function("return this")(),j=b.Symbol,S=Object.prototype,k=S.hasOwnProperty,L=S.toString,O=j?j.toStringTag:void 0;var w=Object.prototype.toString;var x="[object Null]",E="[object Undefined]",A=j?j.toStringTag:void 0;function T(n){return null==n?void 0===n?E:x:A&&A in Object(n)?function(n){var t=k.call(n,O),e=n[O];try{var r=!(n[O]=void 0)}catch(n){}var i=L.call(n);return r&&(t?n[O]=e:delete n[O]),i}(n):(n=n,w.call(n))}var _="[object AsyncFunction]",B="[object Function]",F="[object GeneratorFunction]",I="[object Proxy]";var M=9007199254740991;function U(n){return"number"==typeof n&&-1<n&&n%1==0&&n<=M}function q(n){return null!=n&&U(n.length)&&!function(n){if(i(n)){n=T(n);return n==B||n==F||n==_||n==I}}(n)}var z={};function P(){}function V(t){return function(){var n;null!==t&&(n=t,t=null,n.apply(this,arguments))}}var D="function"==typeof Symbol&&Symbol.iterator,R=function(n){return D&&n[D]&&n[D]()};function C(n){return null!=n&&"object"==typeof n}function $(n){return C(n)&&"[object Arguments]"==T(n)}var W=Object.prototype,N=W.hasOwnProperty,Q=W.propertyIsEnumerable,G=$(function(){return arguments}())?$:function(n){return C(n)&&N.call(n,"callee")&&!Q.call(n,"callee")},H=Array.isArray;var J="object"==typeof n&&n&&!n.nodeType&&n,K=J&&"object"==typeof module&&module&&!module.nodeType&&module,X=K&&K.exports===J?b.Buffer:void 0,Y=(X?X.isBuffer:void 0)||function(){return!1},Z=9007199254740991,nn=/^(?:0|[1-9]\d*)$/;var tn={};tn["[object Float32Array]"]=tn["[object Float64Array]"]=tn["[object Int8Array]"]=tn["[object Int16Array]"]=tn["[object Int32Array]"]=tn["[object Uint8Array]"]=tn["[object Uint8ClampedArray]"]=tn["[object Uint16Array]"]=tn["[object Uint32Array]"]=!0,tn["[object Arguments]"]=tn["[object Array]"]=tn["[object ArrayBuffer]"]=tn["[object Boolean]"]=tn["[object DataView]"]=tn["[object Date]"]=tn["[object Error]"]=tn["[object Function]"]=tn["[object Map]"]=tn["[object Number]"]=tn["[object Object]"]=tn["[object RegExp]"]=tn["[object Set]"]=tn["[object String]"]=tn["[object WeakMap]"]=!1;var en,rn="object"==typeof n&&n&&!n.nodeType&&n,on=rn&&"object"==typeof module&&module&&!module.nodeType&&module,un=on&&on.exports===rn&&v.process,cn=function(){try{var n=on&&on.require&&on.require("util").types;return n?n:un&&un.binding&&un.binding("util")}catch(n){}}(),an=cn&&cn.isTypedArray,fn=an?(en=an,function(n){return en(n)}):function(n){return C(n)&&U(n.length)&&!!tn[T(n)]},ln=Object.prototype.hasOwnProperty;function sn(n,t){var e,r,i,o,u=H(n),c=!u&&G(n),a=!u&&!c&&Y(n),f=!u&&!c&&!a&&fn(n),l=u||c||a||f,s=l?function(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}(n.length,String):[],p=s.length;for(e in n)!t&&!ln.call(n,e)||l&&("length"==e||a&&("offset"==e||"parent"==e)||f&&("buffer"==e||"byteLength"==e||"byteOffset"==e)||(o=void 0,o=typeof(r=e),(i=null==(i=p)?Z:i)&&("number"==o||"symbol"!=o&&nn.test(r))&&-1<r&&r%1==0&&r<i))||s.push(e);return s}var pn=Object.prototype;var hn,yn,vn=(hn=Object.keys,yn=Object,function(n){return hn(yn(n))}),dn=Object.prototype.hasOwnProperty;function mn(n){if(e=(t=n)&&t.constructor,t!==("function"==typeof e&&e.prototype||pn))return vn(n);var t,e,r,i=[];for(r in Object(n))dn.call(n,r)&&"constructor"!=r&&i.push(r);return i}function gn(n){return(q(n)?sn:mn)(n)}function bn(n){if(q(n))return e=-1,r=(t=n).length,function(){return++e<r?{value:t[e],key:e}:null};var t,e,r,i,o,u,c,a,f,l=R(n);return l?(a=l,f=-1,function(){var n=a.next();return n.done?null:(f++,{value:n.value,key:f})}):(o=gn(i=n),u=-1,c=o.length,function n(){var t=o[++u];return"__proto__"===t?n():u<c?{value:i[t],key:t}:null})}function jn(t){return function(){if(null===t)throw new Error("Callback was already called.");var n=t;t=null,n.apply(this,arguments)}}function Sn(f){return function(n,t,e){if(e=V(e||P),f<=0||!n)return e(null);var r=bn(n),i=!1,o=0,u=!1;function c(n,t){if(--o,n)i=!0,e(n);else{if(t===z||i&&o<=0)return i=!0,e(null);u||a()}}function a(){for(u=!0;o<f&&!i;){var n=r();if(null===n)return i=!0,void(o<=0&&e(null));o+=1,t(n.value,n.key,jn(c))}u=!1}a()}}function kn(n,t,e,r){Sn(t)(n,m(e),r)}function Ln(r,i){return function(n,t,e){return r(n,i,t,e)}}function On(n,t,e){e=V(e||P);var r=0,i=0,o=n.length;function u(n,t){n?e(n):++i!==o&&t!==z||e(null)}for(0===o&&e(null);r<o;r++)t(n[r],r,jn(u))}function wn(n,t,e){(q(n)?On:xn)(n,m(t),e)}var xn=Ln(kn,1/0);function En(r){return function(n,t,e){return r(wn,n,m(t),e)}}function An(n,t,e,r){r=r||P,t=t||[];var i=[],o=0,u=m(e);n(t,function(n,t,e){var r=o++;u(n,function(n,t){i[r]=t,e(n)})},function(n){r(n,i)})}var Tn=En(An),_n=y(Tn);function Bn(i){return function(n,t,e,r){return i(Sn(t),n,m(e),r)}}var Fn=Bn(An),In=Ln(Fn,1),Mn=y(In);function Un(n,t){for(var e=-1,r=null==n?0:n.length;++e<r&&!1!==t(n[e],e,n););return n}var qn,zn=function(n,t,e){for(var r=-1,i=Object(n),o=e(n),u=o.length;u--;){var c=o[qn?u:++r];if(!1===t(i[c],c,i))break}return n};function Pn(n,t){return n&&zn(n,t,gn)}function Vn(n){return n!=n}function Dn(n,t,e){return t==t?function(n,t,e){for(var r=e-1,i=n.length;++r<i;)if(n[r]===t)return r;return-1}(n,t,e):function(n,t,e,r){for(var i=n.length,o=e+(r?1:-1);r?o--:++o<i;)if(t(n[o],o,n))return o;return-1}(n,Vn,e)}function Rn(u,n,c){"function"==typeof n&&(c=n,n=null),c=V(c||P);var e=gn(u).length;if(!e)return c(null);n=n||e;var a={},f=0,l=!1,s=Object.create(null),t=[],p=[],h={};function y(i,o){t.push(function(){var r,n,t,e;r=i,n=o,l||(t=jn(function(n,t){var e;f--,2<arguments.length&&(t=d(arguments,1)),n?(e={},Pn(a,function(n,t){e[t]=n}),e[r]=t,l=!0,s=Object.create(null),c(n,e)):(a[r]=t,Un(s[r]||[],function(n){n()}),v())}),f++,e=m(n[n.length-1]),1<n.length?e(a,t):e(t))})}function v(){if(0===t.length&&0===f)return c(null,a);for(;t.length&&f<n;)t.shift()()}Pn(u,function(e,r){if(!H(e))return y(r,[e]),void p.push(r);var i=e.slice(0,e.length-1),o=i.length;if(0===o)return y(r,e),void p.push(r);h[r]=o,Un(i,function(n){if(!u[n])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+n+"` in "+i.join(", "));var t;t=function(){0===--o&&y(r,e)},(s[n=n]||(s[n]=[])).push(t)})}),function(){for(var n,t=0;p.length;)n=p.pop(),t++,Un(function(e){var r=[];return Pn(u,function(n,t){H(n)&&0<=Dn(n,e,0)&&r.push(t)}),r}(n),function(n){0==--h[n]&&p.push(n)});if(t!==e)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),v()}function Cn(n,t){for(var e=-1,r=null==n?0:n.length,i=Array(r);++e<r;)i[e]=t(n[e],e,n);return i}var $n="[object Symbol]";var Wn=1/0,Nn=j?j.prototype:void 0,Qn=Nn?Nn.toString:void 0;function Gn(n){if("string"==typeof n)return n;if(H(n))return Cn(n,Gn)+"";if("symbol"==typeof(t=n)||C(t)&&T(t)==$n)return Qn?Qn.call(n):"";var t=n+"";return"0"==t&&1/n==-Wn?"-0":t}function Hn(n,t,e){var r=n.length;return e=void 0===e?r:e,!t&&r<=e?n:function(n,t,e){var r=-1,i=n.length;t<0&&(t=i<-t?0:i+t),(e=i<e?i:e)<0&&(e+=i),i=e<t?0:e-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=n[r+t];return o}(n,t,e)}var Jn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Kn="\\ud800-\\udfff",Xn="["+Kn+"]",Yn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Zn="\\ud83c[\\udffb-\\udfff]",nt="[^"+Kn+"]",tt="(?:\\ud83c[\\udde6-\\uddff]){2}",et="[\\ud800-\\udbff][\\udc00-\\udfff]",rt="(?:"+Yn+"|"+Zn+")"+"?",it="[\\ufe0e\\ufe0f]?",ot=it+rt+("(?:\\u200d(?:"+[nt,tt,et].join("|")+")"+it+rt+")*"),ut="(?:"+[nt+Yn+"?",Yn,tt,et,Xn].join("|")+")",ct=RegExp(Zn+"(?="+Zn+")|"+ut+ot,"g");function at(n){return t=n,Jn.test(t)?n.match(ct)||[]:n.split("");var t}var ft=/^\s+|\s+$/g;function lt(n,t,e){var r;if((n=null==(r=n)?"":Gn(r))&&(e||void 0===t))return n.replace(ft,"");if(!n||!(t=Gn(t)))return n;n=at(n),t=at(t);return Hn(n,function(n,t){for(var e=-1,r=n.length;++e<r&&-1<Dn(t,n[e],0););return e}(n,t),function(n,t){for(var e=n.length;e--&&-1<Dn(t,n[e],0););return e}(n,t)+1).join("")}var st=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,pt=/,/,ht=/(=.+)?(\s*)$/,yt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function vt(n,t){var u={};Pn(n,function(r,n){var i,t=h(r),e=!t&&1===r.length||t&&0===r.length;if(H(r))i=r.slice(0,-1),r=r[r.length-1],u[n]=i.concat(0<i.length?o:r);else if(e)u[n]=r;else{if(i=e=(e=(e=(e=(e=r).toString().replace(yt,"")).match(st)[2].replace(" ",""))?e.split(pt):[]).map(function(n){return lt(n.replace(ht,""))}),0===r.length&&!t&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");t||i.pop(),u[n]=i.concat(o)}function o(t,n){var e=Cn(i,function(n){return t[n]});e.push(n),m(r).apply(null,e)}}),Rn(u,t)}function dt(){this.head=this.tail=null,this.length=0}function mt(n,t){n.length=1,n.head=n.tail=t}function gt(n,t,e){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var u=m(n),c=0,a=[],f=!1;function r(n,t,e){if(null!=e&&"function"!=typeof e)throw new Error("task callback must be a function");if(s.started=!0,H(n)||(n=[n]),0===n.length&&s.idle())return p(function(){s.drain()});for(var r=0,i=n.length;r<i;r++){var o={data:n[r],callback:e||P};t?s._tasks.unshift(o):s._tasks.push(o)}f||(f=!0,p(function(){f=!1,s.process()}))}var l=!1,s={_tasks:new dt,concurrency:t,payload:e,saturated:P,unsaturated:P,buffer:t/4,empty:P,drain:P,error:P,started:!1,paused:!1,push:function(n,t){r(n,!1,t)},kill:function(){s.drain=P,s._tasks.empty()},unshift:function(n,t){r(n,!0,t)},remove:function(n){s._tasks.remove(n)},process:function(){if(!l){for(l=!0;!s.paused&&c<s.concurrency&&s._tasks.length;){var n=[],t=[],e=s._tasks.length;s.payload&&(e=Math.min(e,s.payload));for(var r=0;r<e;r++){var i=s._tasks.shift();n.push(i),a.push(i),t.push(i.data)}c+=1,0===s._tasks.length&&s.empty(),c===s.concurrency&&s.saturated();var o=jn(function(o){return function(n){--c;for(var t=0,e=o.length;t<e;t++){var r=o[t],i=Dn(a,r,0);0===i?a.shift():0<i&&a.splice(i,1),r.callback.apply(r,arguments),null!=n&&s.error(n,r.data)}c<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}(n));u(t,o)}l=!1}},length:function(){return s._tasks.length},running:function(){return c},workersList:function(){return a},idle:function(){return s._tasks.length+c===0},pause:function(){s.paused=!0},resume:function(){!1!==s.paused&&(s.paused=!1,p(s.process))}};return s}function bt(n,t){return gt(n,1,t)}dt.prototype.removeLink=function(n){return n.prev?n.prev.next=n.next:this.head=n.next,n.next?n.next.prev=n.prev:this.tail=n.prev,n.prev=n.next=null,--this.length,n},dt.prototype.empty=function(){for(;this.head;)this.shift();return this},dt.prototype.insertAfter=function(n,t){t.prev=n,t.next=n.next,n.next?n.next.prev=t:this.tail=t,n.next=t,this.length+=1},dt.prototype.insertBefore=function(n,t){t.prev=n.prev,(t.next=n).prev?n.prev.next=t:this.head=t,n.prev=t,this.length+=1},dt.prototype.unshift=function(n){this.head?this.insertBefore(this.head,n):mt(this,n)},dt.prototype.push=function(n){this.tail?this.insertAfter(this.tail,n):mt(this,n)},dt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},dt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},dt.prototype.toArray=function(){for(var n=Array(this.length),t=this.head,e=0;e<this.length;e++)n[e]=t.data,t=t.next;return n},dt.prototype.remove=function(n){for(var t=this.head;t;){var e=t.next;n(t)&&this.removeLink(t),t=e}return this};var jt=Ln(kn,1);function St(n,r,t,e){e=V(e||P);var i=m(t);jt(n,function(n,t,e){i(r,n,function(n,t){r=t,e(n)})},function(n){e(n,r)})}function kt(){var t=Cn(arguments,m);return function(){var n=d(arguments),r=this,e=n[n.length-1];"function"==typeof e?n.pop():e=P,St(t,n,function(n,t,e){t.apply(r,n.concat(function(n){var t=d(arguments,1);e(n,t)}))},function(n,t){e.apply(r,[n].concat(t))})}}function Lt(){return kt.apply(null,d(arguments).reverse())}function Ot(n,t,e,i){i=i||P;var r=m(e);Fn(n,t,function(n,t){r(n,function(n){return n?t(n):t(null,d(arguments,1))})},function(n,t){for(var e=[],r=0;r<t.length;r++)t[r]&&(e=xt.apply(e,t[r]));return i(n,e)})}function wt(){var n=d(arguments),t=[null].concat(n);return function(){return arguments[arguments.length-1].apply(this,t)}}var xt=Array.prototype.concat,Et=Ln(Ot,1/0),At=Ln(Ot,1);function Tt(n){return n}function _t(c,a){return function(n,t,i,e){e=e||P;var o,u=!1;n(t,function(e,n,r){i(e,function(n,t){n?r(n):c(t)&&!o?(o=a(u=!0,e),r(null,z)):r()})},function(n){n?e(n):e(null,u?o:a(!1))})}}function Bt(n,t){return t}var Ft=En(_t(Tt,Bt)),It=Bn(_t(Tt,Bt)),Mt=Ln(It,1);function Ut(e){return function(n){var t=d(arguments,1);t.push(function(n){var t=d(arguments,1);"object"==typeof console&&(n?console.error&&console.error(n):console[e]&&Un(t,function(n){console[e](n)}))}),m(n).apply(null,t)}}g=Ut("dir");function qt(n,t,e){e=jn(e||P);var r=m(n),i=m(t);function o(n){if(n)return e(n);n=d(arguments,1);n.push(u),i.apply(this,n)}function u(n,t){return n?e(n):t?void r(o):e(null)}u(null,!0)}function zt(n,t,e){e=jn(e||P);var r=m(n),i=function(n){if(n)return e(n);n=d(arguments,1);if(t.apply(this,n))return r(i);e.apply(null,[null].concat(n))};r(i)}function Pt(n,t,e){zt(n,function(){return!t.apply(this,arguments)},e)}function Vt(n,t,e){e=jn(e||P);var r=m(t),i=m(n);function o(n){if(n)return e(n);i(u)}function u(n,t){return n?e(n):t?void r(o):e(null)}i(u)}function Dt(r){return function(n,t,e){return r(n,e)}}function Rt(n,t,e){wn(n,Dt(m(t)),e)}function Ct(n,t,e,r){Sn(t)(n,Dt(m(e)),r)}var $t=Ln(Ct,1);function Wt(r){return h(r)?r:a(function(n,t){var e=!0;n.push(function(){var n=arguments;e?p(function(){t.apply(null,n)}):t.apply(null,n)}),r.apply(this,n),e=!1})}function Nt(n){return!n}S=En(_t(Nt,Nt)),W=Bn(_t(Nt,Nt)),K=Ln(W,1);function Qt(t){return function(n){return null==n?void 0:n[t]}}function Gt(n,r,t,i){var o=new Array(r.length);n(r,function(n,e,r){t(n,function(n,t){o[e]=!!t,r(n)})},function(n){if(n)return i(n);for(var t=[],e=0;e<r.length;e++)o[e]&&t.push(r[e]);i(null,t)})}function Ht(n,t,o,e){var u=[];n(t,function(e,r,i){o(e,function(n,t){n?i(n):(t&&u.push({index:r,value:e}),i())})},function(n){n?e(n):e(null,Cn(u.sort(function(n,t){return n.index-t.index}),Qt("value")))})}function Jt(n,t,e,r){(q(t)?Gt:Ht)(n,t,m(e),r||P)}J=En(Jt),b=Bn(Jt),X=Ln(b,1);function Kt(n,t){var e=jn(t||P),r=m(Wt(n));!function n(t){if(t)return e(t);r(n)}()}rn=function(n,t,e,c){c=c||P;var i=m(e);Fn(n,t,function(e,r){i(e,function(n,t){return n?r(n):r(null,{key:t,val:e})})},function(n,t){for(var e,r,i={},o=Object.prototype.hasOwnProperty,u=0;u<t.length;u++)t[u]&&(e=t[u].key,r=t[u].val,o.call(i,e)?i[e].push(r):i[e]=[r]);return c(n,i)})},v=Ln(rn,1/0),cn=Ln(rn,1),an=Ut("log");function Xt(n,t,e,r){r=V(r||P);var i={},o=m(e);kn(n,t,function(n,e,r){o(n,e,function(n,t){return n?r(n):(i[e]=t,void r())})},function(n){r(n,i)})}j=Ln(Xt,1/0),Nn=Ln(Xt,1);function Yt(n,e){var o=Object.create(null),u=Object.create(null);e=e||Tt;var r=m(n),t=a(function(n,t){var i=e.apply(null,n);i in o?p(function(){t.apply(null,o[i])}):i in u?u[i].push(t):(u[i]=[t],r.apply(null,n.concat(function(){var n=d(arguments);o[i]=n;var t=u[i];delete u[i];for(var e=0,r=t.length;e<r;e++)t[e].apply(null,n)})))});return t.memo=o,t.unmemoized=n,t}Kn=u(r?process.nextTick:e?setImmediate:o);function Zt(n,t,e){e=e||P;var i=q(t)?[]:{};n(t,function(n,e,r){m(n)(function(n,t){2<arguments.length&&(t=d(arguments,1)),i[e]=t,r(n)})},function(n){e(n,i)})}function ne(n,t){Zt(wn,n,t)}function te(n,t,e){Zt(Sn(t),n,e)}function ee(n,t){var e=m(n);return gt(function(n,t){e(n[0],t)},t,1)}it=function(n,t){var c=ee(n,t);return c.push=function(n,t,e){if(null==e&&(e=P),"function"!=typeof e)throw new Error("task callback must be a function");if(c.started=!0,H(n)||(n=[n]),0===n.length)return p(function(){c.drain()});t=t||0;for(var r=c._tasks.head;r&&t>=r.priority;)r=r.next;for(var i=0,o=n.length;i<o;i++){var u={data:n[i],priority:t,callback:e};r?c._tasks.insertBefore(r,u):c._tasks.push(u)}p(c.process)},delete c.unshift,c};function re(n,t){if(t=V(t||P),!H(n))return t(new TypeError("First argument to race must be an array of functions"));if(!n.length)return t();for(var e=0,r=n.length;e<r;e++)m(n[e])(t)}function ie(n,t,e,r){St(d(n).reverse(),t,e,r)}function oe(n){var t=m(n);return a(function(n,e){return n.push(function(n,t){n?e(null,{error:n}):(t=arguments.length<=2?t:d(arguments,1),e(null,{value:t}))}),t.apply(this,n)})}function ue(n){var e;return H(n)?e=Cn(n,oe):(e={},Pn(n,function(n,t){e[t]=oe.call(this,n)})),e}function ce(n,t,r,e){Jt(n,t,function(n,e){r(n,function(n,t){e(n,!t)})},e)}rt=En(ce),nt=Bn(ce),Yn=Ln(nt,1);function ae(n){return function(){return n}}function fe(n,t,e){var r={times:5,intervalFunc:ae(0)};if(arguments.length<3&&"function"==typeof n?(e=t||P,t=n):(function(n,t){if("object"==typeof t)n.times=+t.times||5,n.intervalFunc="function"==typeof t.interval?t.interval:ae(+t.interval||0),n.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");n.times=+t||5}}(r,n),e=e||P),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var i=m(t),o=1;!function t(){i(function(n){n&&o++<r.times&&("function"!=typeof r.errorFilter||r.errorFilter(n))?setTimeout(t,r.intervalFunc(o)):e.apply(null,arguments)})}()}tt=function(r,n){n||(n=r,r=null);var i=m(n);return a(function(t,n){function e(n){i.apply(null,t.concat(n))}r?fe(r,e,n):fe(e,n)})};function le(n,t){Zt(jt,n,t)}et=En(_t(Boolean,Tt)),Xn=Bn(_t(Boolean,Tt)),Zn=Ln(Xn,1);function se(n,t,e){var i=m(t);function r(n,t){n=n.criteria,t=t.criteria;return n<t?-1:t<n?1:0}Tn(n,function(e,r){i(e,function(n,t){return n?r(n):void r(null,{value:e,criteria:t})})},function(n,t){return n?e(n):void e(null,Cn(t.sort(r),Qt("value")))})}function pe(i,o,u){var c=m(i);return a(function(n,t){var e,r=!1;n.push(function(){r||(t.apply(null,arguments),clearTimeout(e))}),e=setTimeout(function(){var n=i.name||"anonymous";(n=new Error('Callback function "'+n+'" timed out.')).code="ETIMEDOUT",u&&(n.info=u),r=!0,t(n)},o),c.apply(null,n)})}var he=Math.ceil,ye=Math.max;function ve(n,t,e,r){e=m(e);Fn(function(n,t,e,r){for(var i=-1,o=ye(he((t-n)/(e||1)),0),u=Array(o);o--;)u[r?o:++i]=n,n+=e;return u}(0,n,1),t,e,r)}ut=Ln(ve,1/0),ot=Ln(ve,1);function de(n,r,t,e){arguments.length<=3&&(e=t,t=r,r=H(n)?[]:{}),e=V(e||P);var i=m(t);wn(n,function(n,t,e){i(r,n,t,e)},function(n){e(n,r)})}function me(n,t){var r,i=null;t=t||P,$t(n,function(n,e){m(n)(function(n,t){r=2<arguments.length?d(arguments,1):t,e(!(i=n))})},function(){t(i,r)})}function ge(n){return function(){return(n.unmemoized||n).apply(null,arguments)}}function be(t,n,e){e=jn(e||P);var r=m(n);if(!t())return e(null);var i=function(n){if(n)return e(n);if(t())return r(i);n=d(arguments,1);e.apply(null,[null].concat(n))};r(i)}function je(n,t,e){be(function(){return!n.apply(this,arguments)},t,e)}r=function(e,t){if(t=V(t||P),!H(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function i(n){var t=m(e[r++]);n.push(jn(o)),t.apply(null,n)}function o(n){if(n||r===e.length)return t.apply(null,arguments);i(d(arguments,1))}i([])},e={apply:t,applyEach:_n,applyEachSeries:Mn,asyncify:c,auto:Rn,autoInject:vt,cargo:bt,compose:Lt,concat:Et,concatLimit:Ot,concatSeries:At,constant:wt,detect:Ft,detectLimit:It,detectSeries:Mt,dir:g,doDuring:qt,doUntil:Pt,doWhilst:zt,during:Vt,each:Rt,eachLimit:Ct,eachOf:wn,eachOfLimit:kn,eachOfSeries:jt,eachSeries:$t,ensureAsync:Wt,every:S,everyLimit:W,everySeries:K,filter:J,filterLimit:b,filterSeries:X,forever:Kt,groupBy:v,groupByLimit:rn,groupBySeries:cn,log:an,map:Tn,mapLimit:Fn,mapSeries:In,mapValues:j,mapValuesLimit:Xt,mapValuesSeries:Nn,memoize:Yt,nextTick:Kn,parallel:ne,parallelLimit:te,priorityQueue:it,queue:ee,race:re,reduce:St,reduceRight:ie,reflect:oe,reflectAll:ue,reject:rt,rejectLimit:nt,rejectSeries:Yn,retry:fe,retryable:tt,seq:kt,series:le,setImmediate:p,some:et,someLimit:Xn,someSeries:Zn,sortBy:se,timeout:pe,times:ut,timesLimit:ve,timesSeries:ot,transform:de,tryEach:me,unmemoize:ge,until:je,waterfall:r,whilst:be,all:S,allLimit:W,allSeries:K,any:et,anyLimit:Xn,anySeries:Zn,find:Ft,findLimit:It,findSeries:Mt,forEach:Rt,forEachSeries:$t,forEachLimit:Ct,forEachOf:wn,forEachOfSeries:jt,forEachOfLimit:kn,inject:St,foldl:St,foldr:ie,select:J,selectLimit:b,selectSeries:X,wrapSync:c};n.default=e,n.apply=t,n.applyEach=_n,n.applyEachSeries=Mn,n.asyncify=c,n.auto=Rn,n.autoInject=vt,n.cargo=bt,n.compose=Lt,n.concat=Et,n.concatLimit=Ot,n.concatSeries=At,n.constant=wt,n.detect=Ft,n.detectLimit=It,n.detectSeries=Mt,n.dir=g,n.doDuring=qt,n.doUntil=Pt,n.doWhilst=zt,n.during=Vt,n.each=Rt,n.eachLimit=Ct,n.eachOf=wn,n.eachOfLimit=kn,n.eachOfSeries=jt,n.eachSeries=$t,n.ensureAsync=Wt,n.every=S,n.everyLimit=W,n.everySeries=K,n.filter=J,n.filterLimit=b,n.filterSeries=X,n.forever=Kt,n.groupBy=v,n.groupByLimit=rn,n.groupBySeries=cn,n.log=an,n.map=Tn,n.mapLimit=Fn,n.mapSeries=In,n.mapValues=j,n.mapValuesLimit=Xt,n.mapValuesSeries=Nn,n.memoize=Yt,n.nextTick=Kn,n.parallel=ne,n.parallelLimit=te,n.priorityQueue=it,n.queue=ee,n.race=re,n.reduce=St,n.reduceRight=ie,n.reflect=oe,n.reflectAll=ue,n.reject=rt,n.rejectLimit=nt,n.rejectSeries=Yn,n.retry=fe,n.retryable=tt,n.seq=kt,n.series=le,n.setImmediate=p,n.some=et,n.someLimit=Xn,n.someSeries=Zn,n.sortBy=se,n.timeout=pe,n.times=ut,n.timesLimit=ve,n.timesSeries=ot,n.transform=de,n.tryEach=me,n.unmemoize=ge,n.until=je,n.waterfall=r,n.whilst=be,n.all=S,n.allLimit=W,n.allSeries=K,n.any=et,n.anyLimit=Xn,n.anySeries=Zn,n.find=Ft,n.findLimit=It,n.findSeries=Mt,n.forEach=Rt,n.forEachSeries=$t,n.forEachLimit=Ct,n.forEachOf=wn,n.forEachOfSeries=jt,n.forEachOfLimit=kn,n.inject=St,n.foldl=St,n.foldr=ie,n.select=J,n.selectLimit=b,n.selectSeries=X,n.wrapSync=c,Object.defineProperty(n,"__esModule",{value:!0})});
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.L={})}(this,function(t){"use strict";function h(t){for(var i,e,n=1,o=arguments.length;n<o;n++)for(i in e=arguments[n])t[i]=e[i];return t}var s=Object.create||function(t){return i.prototype=t,new i};function i(){}function _(t,i){var e=Array.prototype.slice;if(t.bind)return t.bind.apply(t,e.call(arguments,1));var n=e.call(arguments,2);return function(){return t.apply(i,n.length?n.concat(e.call(arguments)):arguments)}}var e=0;function m(t){return t._leaflet_id=t._leaflet_id||++e,t._leaflet_id}function n(t,i,e){var n,o,s=function(){n=!1,o&&(r.apply(e,o),o=!1)},r=function(){n?o=arguments:(t.apply(e,arguments),setTimeout(s,i),n=!0)};return r}function o(t,i,e){var n=i[1],o=i[0],i=n-o;return t===n&&e?t:((t-o)%i+i)%i+o}function a(){return!1}function r(t,i){i=Math.pow(10,void 0===i?6:i);return Math.round(t*i)/i}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function l(t){return u(t).split(/\s+/)}function c(t,i){for(var e in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?s(t.options):{}),i)t.options[e]=i[e];return t.options}function d(t,i,e){var n,o=[];for(n in t)o.push(encodeURIComponent(e?n.toUpperCase():n)+"="+encodeURIComponent(t[n]));return(i&&-1!==i.indexOf("?")?"&":"?")+o.join("&")}var p=/\{ *([\w_-]+) *\}/g;function f(t,e){return t.replace(p,function(t,i){i=e[i];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function v(t,i){for(var e=0;e<t.length;e++)if(t[e]===i)return e;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function x(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function P(t){var i=+new Date,e=Math.max(0,16-(i-w));return w=i+e,window.setTimeout(t,e)}var b=window.requestAnimationFrame||x("RequestAnimationFrame")||P,T=window.cancelAnimationFrame||x("CancelAnimationFrame")||x("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function M(t,i,e){if(!e||b!==P)return b.call(window,_(t,i));t.call(i)}function z(t){t&&T.call(window,t)}var C={extend:h,create:s,bind:_,lastId:e,stamp:m,throttle:n,wrapNum:o,falseFn:a,formatNum:r,trim:u,splitWords:l,setOptions:c,getParamString:d,template:f,isArray:g,indexOf:v,emptyImageUrl:y,requestFn:b,cancelFn:T,requestAnimFrame:M,cancelAnimFrame:z};function S(){}S.extend=function(t){function i(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var e,n=i.__super__=this.prototype,o=s(n);for(e in(o.constructor=i).prototype=o,this)Object.prototype.hasOwnProperty.call(this,e)&&"prototype"!==e&&"__super__"!==e&&(i[e]=this[e]);return t.statics&&(h(i,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var i=0;i<t.length;i++)t[i]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),h.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=h(s(o.options),t.options)),h(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,i=o._initHooks.length;t<i;t++)o._initHooks[t].call(this)}},i},S.include=function(t){return h(this.prototype,t),this},S.mergeOptions=function(t){return h(this.prototype.options,t),this},S.addInitHook=function(t){var i=Array.prototype.slice.call(arguments,1),e="function"==typeof t?t:function(){this[t].apply(this,i)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(e),this};var Z={on:function(t,i,e){if("object"==typeof t)for(var n in t)this._on(n,t[n],i);else for(var o=0,s=(t=l(t)).length;o<s;o++)this._on(t[o],i,e);return this},off:function(t,i,e){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],i);else for(var o=0,s=(t=l(t)).length;o<s;o++)this._off(t[o],i,e);else delete this._events;return this},_on:function(t,i,e){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),e===this&&(e=void 0);for(var t={fn:i,ctx:e},o=n,s=0,r=o.length;s<r;s++)if(o[s].fn===i&&o[s].ctx===e)return;o.push(t)},_off:function(t,i,e){var n,o,s;if(this._events&&(n=this._events[t]))if(i){if(e===this&&(e=void 0),n)for(o=0,s=n.length;o<s;o++){var r=n[o];if(r.ctx===e&&r.fn===i)return r.fn=a,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(o,1)}}else{for(o=0,s=n.length;o<s;o++)n[o].fn=a;delete this._events[t]}},fire:function(t,i,e){if(!this.listens(t,e))return this;var n=h({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var s=0,r=o.length;s<r;s++){var a=o[s];a.fn.call(a.ctx||this,n)}this._firingCount--}}return e&&this._propagateEvent(n),this},listens:function(t,i){var e=this._events&&this._events[t];if(e&&e.length)return!0;if(i)for(var n in this._eventParents)if(this._eventParents[n].listens(t,i))return!0;return!1},once:function(t,i,e){if("object"==typeof t){for(var n in t)this.once(n,t[n],i);return this}var o=_(function(){this.off(t,i,e).off(t,o,e)},this);return this.on(t,i,e).on(t,o,e)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[m(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[m(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,h({layer:t.target,propagatedFrom:t.target},t),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var E=S.extend(Z);function k(t,i,e){this.x=e?Math.round(t):t,this.y=e?Math.round(i):i}var B=Math.trunc||function(t){return 0<t?Math.floor(t):Math.ceil(t)};function A(t,i,e){return t instanceof k?t:g(t)?new k(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new k(t.x,t.y):new k(t,i,e)}function I(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function O(t,i){return!t||t instanceof I?t:new I(t,i)}function R(t,i){if(t)for(var e=i?[t,i]:t,n=0,o=e.length;n<o;n++)this.extend(e[n])}function N(t,i){return t instanceof R?t:new R(t,i)}function D(t,i,e){if(isNaN(t)||isNaN(i))throw new Error("Invalid LatLng object: ("+t+", "+i+")");this.lat=+t,this.lng=+i,void 0!==e&&(this.alt=+e)}function j(t,i,e){return t instanceof D?t:g(t)&&"object"!=typeof t[0]?3===t.length?new D(t[0],t[1],t[2]):2===t.length?new D(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new D(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===i?null:new D(t,i,e)}k.prototype={clone:function(){return new k(this.x,this.y)},add:function(t){return this.clone()._add(A(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(A(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new k(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new k(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=B(this.x),this.y=B(this.y),this},distanceTo:function(t){var i=(t=A(t)).x-this.x,t=t.y-this.y;return Math.sqrt(i*i+t*t)},equals:function(t){return(t=A(t)).x===this.x&&t.y===this.y},contains:function(t){return t=A(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+r(this.x)+", "+r(this.y)+")"}},I.prototype={extend:function(t){return t=A(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new k((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new k(this.min.x,this.max.y)},getTopRight:function(){return new k(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var i,e;return(t=("number"==typeof t[0]||t instanceof k?A:O)(t))instanceof I?(i=t.min,e=t.max):i=e=t,i.x>=this.min.x&&e.x<=this.max.x&&i.y>=this.min.y&&e.y<=this.max.y},intersects:function(t){t=O(t);var i=this.min,e=this.max,n=t.min,o=t.max,t=o.x>=i.x&&n.x<=e.x,e=o.y>=i.y&&n.y<=e.y;return t&&e},overlaps:function(t){t=O(t);var i=this.min,e=this.max,n=t.min,o=t.max,t=o.x>i.x&&n.x<e.x,e=o.y>i.y&&n.y<e.y;return t&&e},isValid:function(){return!(!this.min||!this.max)}},R.prototype={extend:function(t){var i,e,n=this._southWest,o=this._northEast;if(t instanceof D)e=i=t;else{if(!(t instanceof R))return t?this.extend(j(t)||N(t)):this;if(i=t._southWest,e=t._northEast,!i||!e)return this}return n||o?(n.lat=Math.min(i.lat,n.lat),n.lng=Math.min(i.lng,n.lng),o.lat=Math.max(e.lat,o.lat),o.lng=Math.max(e.lng,o.lng)):(this._southWest=new D(i.lat,i.lng),this._northEast=new D(e.lat,e.lng)),this},pad:function(t){var i=this._southWest,e=this._northEast,n=Math.abs(i.lat-e.lat)*t,t=Math.abs(i.lng-e.lng)*t;return new R(new D(i.lat-n,i.lng-t),new D(e.lat+n,e.lng+t))},getCenter:function(){return new D((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new D(this.getNorth(),this.getWest())},getSouthEast:function(){return new D(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t=("number"==typeof t[0]||t instanceof D||"lat"in t?j:N)(t);var i,e,n=this._southWest,o=this._northEast;return t instanceof R?(i=t.getSouthWest(),e=t.getNorthEast()):i=e=t,i.lat>=n.lat&&e.lat<=o.lat&&i.lng>=n.lng&&e.lng<=o.lng},intersects:function(t){t=N(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),t=o.lat>=i.lat&&n.lat<=e.lat,e=o.lng>=i.lng&&n.lng<=e.lng;return t&&e},overlaps:function(t){t=N(t);var i=this._southWest,e=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),t=o.lat>i.lat&&n.lat<e.lat,e=o.lng>i.lng&&n.lng<e.lng;return t&&e},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,i){return!!t&&(t=N(t),this._southWest.equals(t.getSouthWest(),i)&&this._northEast.equals(t.getNorthEast(),i))},isValid:function(){return!(!this._southWest||!this._northEast)}};var W={latLngToPoint:function(t,i){t=this.projection.project(t),i=this.scale(i);return this.transformation._transform(t,i)},pointToLatLng:function(t,i){i=this.scale(i),i=this.transformation.untransform(t,i);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var i=this.projection.bounds,t=this.scale(t);return new I(this.transformation.transform(i.min,t),this.transformation.transform(i.max,t))},infinite:!(D.prototype={equals:function(t,i){return!!t&&(t=j(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===i?1e-9:i))},toString:function(t){return"LatLng("+r(this.lat,t)+", "+r(this.lng,t)+")"},distanceTo:function(t){return H.distance(this,j(t))},wrap:function(){return H.wrapLatLng(this)},toBounds:function(t){var i=180*t/40075017,t=i/Math.cos(Math.PI/180*this.lat);return N([this.lat-i,this.lng-t],[this.lat+i,this.lng+t])},clone:function(){return new D(this.lat,this.lng,this.alt)}}),wrapLatLng:function(t){var i=this.wrapLng?o(t.lng,this.wrapLng,!0):t.lng;return new D(this.wrapLat?o(t.lat,this.wrapLat,!0):t.lat,i,t.alt)},wrapLatLngBounds:function(t){var i=t.getCenter(),e=this.wrapLatLng(i),n=i.lat-e.lat,i=i.lng-e.lng;if(0==n&&0==i)return t;e=t.getSouthWest(),t=t.getNorthEast();return new R(new D(e.lat-n,e.lng-i),new D(t.lat-n,t.lng-i))}},H=h({},W,{wrapLng:[-180,180],R:6371e3,distance:function(t,i){var e=Math.PI/180,n=t.lat*e,o=i.lat*e,s=Math.sin((i.lat-t.lat)*e/2),e=Math.sin((i.lng-t.lng)*e/2),e=s*s+Math.cos(n)*Math.cos(o)*e*e,e=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e));return this.R*e}}),F=6378137,U={R:F,MAX_LATITUDE:85.0511287798,project:function(t){var i=Math.PI/180,e=this.MAX_LATITUDE,e=Math.max(Math.min(e,t.lat),-e),e=Math.sin(e*i);return new k(this.R*t.lng*i,this.R*Math.log((1+e)/(1-e))/2)},unproject:function(t){var i=180/Math.PI;return new D((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*i,t.x*i/this.R)},bounds:new I([-(gt=F*Math.PI),-gt],[gt,gt])};function V(t,i,e,n){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=i,this._c=e,this._d=n}function q(t,i,e,n){return new V(t,i,e,n)}V.prototype={transform:function(t,i){return this._transform(t.clone(),i)},_transform:function(t,i){return i=i||1,t.x=i*(this._a*t.x+this._b),t.y=i*(this._c*t.y+this._d),t},untransform:function(t,i){return i=i||1,new k((t.x/i-this._b)/this._a,(t.y/i-this._d)/this._c)}};var G=h({},H,{code:"EPSG:3857",projection:U,transformation:q(vt=.5/(Math.PI*U.R),.5,-vt,.5)}),K=h({},G,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function X(t,i){for(var e,n,o,s,r="",a=0,h=t.length;a<h;a++){for(e=0,n=(o=t[a]).length;e<n;e++)r+=(e?"L":"M")+(s=o[e]).x+" "+s.y;r+=i?Tt?"z":"x":""}return r||"M0 0"}var J=document.documentElement.style,$="ActiveXObject"in window,Q=$&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),it=zt("webkit"),et=zt("android"),nt=zt("android 2")||zt("android 3"),ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),st=et&&zt("Google")&&ot<537&&!("AudioNode"in window),rt=!!window.opera,at=!tt&&zt("chrome"),ht=zt("gecko")&&!it&&!rt&&!$,ut=!at&&zt("safari"),lt=zt("phantom"),ct="OTransition"in J,_t=0===navigator.platform.indexOf("Win"),dt=$&&"transition"in J,pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!nt,mt="MozPerspective"in J,ft=!window.L_DISABLE_3D&&(dt||pt||mt)&&!ct&&!lt,F="undefined"!=typeof orientation||zt("mobile"),gt=F&&it,vt=F&&pt,ot=!window.PointerEvent&&window.MSPointerEvent,yt=!(!window.PointerEvent&&!ot),xt=!window.L_NO_TOUCH&&(yt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),wt=F&&rt,J=F&&ht,Pt=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),Lt=function(){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",a,i),window.removeEventListener("testPassiveEventSupport",a,i)}catch(t){}return t}(),bt=!!document.createElement("canvas").getContext,Tt=!(!document.createElementNS||!Y("svg").createSVGRect),Mt=!Tt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';t=t.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(t){return!1}}();function zt(t){return 0<=navigator.userAgent.toLowerCase().indexOf(t)}var rt={ie:$,ielt9:Q,edge:tt,webkit:it,android:et,android23:nt,androidStock:st,opera:rt,chrome:at,gecko:ht,safari:ut,phantom:lt,opera12:ct,win:_t,ie3d:dt,webkit3d:pt,gecko3d:mt,any3d:ft,mobile:F,mobileWebkit:gt,mobileWebkit3d:vt,msPointer:ot,pointer:yt,touch:xt,mobileOpera:wt,mobileGecko:J,retina:Pt,passiveEvents:Lt,canvas:bt,svg:Tt,vml:Mt},Ct=ot?"MSPointerDown":"pointerdown",St=ot?"MSPointerMove":"pointermove",Zt=ot?"MSPointerUp":"pointerup",Et=ot?"MSPointerCancel":"pointercancel",kt={},Bt=!1;function At(t,i,e,n){function o(t){Nt(t,s)}var s,r,a,h,u,l;function c(t){t.pointerType===(t.MSPOINTER_TYPE_MOUSE||"mouse")&&0===t.buttons||Nt(t,r)}return"touchstart"===i?(a=t,h=e,u=n,l=_(function(t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Zi(t),Nt(t,h)}),a["_leaflet_touchstart"+u]=l,a.addEventListener(Ct,l,!1),Bt||(document.addEventListener(Ct,It,!0),document.addEventListener(St,Ot,!0),document.addEventListener(Zt,Rt,!0),document.addEventListener(Et,Rt,!0),Bt=!0)):"touchmove"===i?(r=e,(l=t)["_leaflet_touchmove"+n]=c,l.addEventListener(St,c,!1)):"touchend"===i&&(s=e,(t=t)["_leaflet_touchend"+n]=o,t.addEventListener(Zt,o,!1),t.addEventListener(Et,o,!1)),this}function It(t){kt[t.pointerId]=t}function Ot(t){kt[t.pointerId]&&(kt[t.pointerId]=t)}function Rt(t){delete kt[t.pointerId]}function Nt(t,i){for(var e in t.touches=[],kt)t.touches.push(kt[e]);t.changedTouches=[t],i(t)}var Dt=ot?"MSPointerDown":yt?"pointerdown":"touchstart",jt=ot?"MSPointerUp":yt?"pointerup":"touchend",Wt="_leaflet_";var Ht,Ft,Ut,Vt,qt,Gt,Kt=li(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Yt=li(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Xt="webkitTransition"===Yt||"OTransition"===Yt?Yt+"End":"transitionend";function Jt(t){return"string"==typeof t?document.getElementById(t):t}function $t(t,i){var e=t.style[i]||t.currentStyle&&t.currentStyle[i];return e&&"auto"!==e||!document.defaultView||(e=(t=document.defaultView.getComputedStyle(t,null))?t[i]:null),"auto"===e?null:e}function Qt(t,i,e){t=document.createElement(t);return t.className=i||"",e&&e.appendChild(t),t}function ti(t){var i=t.parentNode;i&&i.removeChild(t)}function ii(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ei(t){var i=t.parentNode;i&&i.lastChild!==t&&i.appendChild(t)}function ni(t){var i=t.parentNode;i&&i.firstChild!==t&&i.insertBefore(t,i.firstChild)}function oi(t,i){if(void 0!==t.classList)return t.classList.contains(i);t=hi(t);return 0<t.length&&new RegExp("(^|\\s)"+i+"(\\s|$)").test(t)}function si(t,i){var e;if(void 0!==t.classList)for(var n=l(i),o=0,s=n.length;o<s;o++)t.classList.add(n[o]);else oi(t,i)||ai(t,((e=hi(t))?e+" ":"")+i)}function ri(t,i){void 0!==t.classList?t.classList.remove(i):ai(t,u((" "+hi(t)+" ").replace(" "+i+" "," ")))}function ai(t,i){void 0===t.className.baseVal?t.className=i:t.className.baseVal=i}function hi(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function ui(t,i){"opacity"in t.style?t.style.opacity=i:"filter"in t.style&&function(t,i){var e=!1,n="DXImageTransform.Microsoft.Alpha";try{e=t.filters.item(n)}catch(t){if(1===i)return}i=Math.round(100*i),e?(e.Enabled=100!==i,e.Opacity=i):t.style.filter+=" progid:"+n+"(opacity="+i+")"}(t,i)}function li(t){for(var i=document.documentElement.style,e=0;e<t.length;e++)if(t[e]in i)return t[e];return!1}function ci(t,i,e){i=i||new k(0,0);t.style[Kt]=(dt?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(e?" scale("+e+")":"")}function _i(t,i){t._leaflet_pos=i,ft?ci(t,i):(t.style.left=i.x+"px",t.style.top=i.y+"px")}function di(t){return t._leaflet_pos||new k(0,0)}function pi(){xi(window,"dragstart",Zi)}function mi(){Pi(window,"dragstart",Zi)}function fi(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(gi(),Gt=(qt=t).style.outline,t.style.outline="none",xi(window,"keydown",gi))}function gi(){qt&&(qt.style.outline=Gt,Gt=qt=void 0,Pi(window,"keydown",gi))}function vi(t){for(;t=t.parentNode,!(t.offsetWidth&&t.offsetHeight||t===document.body););return t}function yi(t){var i=t.getBoundingClientRect();return{x:i.width/t.offsetWidth||1,y:i.height/t.offsetHeight||1,boundingClientRect:i}}Vt="onselectstart"in document?(Ut=function(){xi(window,"selectstart",Zi)},function(){Pi(window,"selectstart",Zi)}):(Ft=li(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),Ut=function(){var t;Ft&&(t=document.documentElement.style,Ht=t[Ft],t[Ft]="none")},function(){Ft&&(document.documentElement.style[Ft]=Ht,Ht=void 0)});lt={TRANSFORM:Kt,TRANSITION:Yt,TRANSITION_END:Xt,get:Jt,getStyle:$t,create:Qt,remove:ti,empty:ii,toFront:ei,toBack:ni,hasClass:oi,addClass:si,removeClass:ri,setClass:ai,getClass:hi,setOpacity:ui,testProp:li,setTransform:ci,setPosition:_i,getPosition:di,disableTextSelection:Ut,enableTextSelection:Vt,disableImageDrag:pi,enableImageDrag:mi,preventOutline:fi,restoreOutline:gi,getSizedParentNode:vi,getScale:yi};function xi(t,i,e,n){if("object"==typeof i)for(var o in i)Ti(t,o,i[o],e);else for(var s=0,r=(i=l(i)).length;s<r;s++)Ti(t,i[s],e,n);return this}var wi="_leaflet_events";function Pi(t,i,e,n){if("object"==typeof i)for(var o in i)Mi(t,o,i[o],e);else if(i)for(var s=0,r=(i=l(i)).length;s<r;s++)Mi(t,i[s],e,n);else{for(var a in t[wi])Mi(t,a,t[wi][a]);delete t[wi]}return this}function Li(){return yt&&(!tt&&!ut)}var bi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ti(i,t,e,n){var o=t+m(e)+(n?"_"+m(n):"");if(i[wi]&&i[wi][o])return this;var s,r,a,h,u,l,c=function(t){return e.call(n||i,t||window.event)},_=c;function d(t){if(yt){if(!t.isPrimary)return;if("mouse"===t.pointerType)return}else if(1<t.touches.length)return;var i=Date.now(),e=i-(h||i);u=t.touches?t.touches[0]:t,l=0<e&&e<=250,h=i}function p(t){if(l&&!u.cancelBubble){if(yt){if("mouse"===t.pointerType)return;var i,e,n={};for(e in u)i=u[e],n[e]=i&&i.bind?i.bind(u):i;u=n}u.type="dblclick",u.button=0,r(u),h=null}}yt&&0===t.indexOf("touch")?At(i,t,c,o):xt&&"dblclick"===t&&!Li()?(r=c,l=!1,(s=i)[Wt+Dt+(a=o)]=d,s[Wt+jt+a]=p,s[Wt+"dblclick"+a]=r,s.addEventListener(Dt,d,!!Lt&&{passive:!1}),s.addEventListener(jt,p,!!Lt&&{passive:!1}),s.addEventListener("dblclick",r,!1)):"addEventListener"in i?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?i.addEventListener(bi[t]||t,c,!!Lt&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(c=function(t){t=t||window.event,Ni(i,t)&&_(t)},i.addEventListener(bi[t],c,!1)):i.addEventListener(t,_,!1):"attachEvent"in i&&i.attachEvent("on"+t,c),i[wi]=i[wi]||{},i[wi][o]=c}function Mi(t,i,e,n){var o,s,r,a=i+m(e)+(n?"_"+m(n):""),e=t[wi]&&t[wi][a];if(!e)return this;yt&&0===i.indexOf("touch")?(r=(o=t)["_leaflet_"+(s=i)+(r=a)],"touchstart"===s?o.removeEventListener(Ct,r,!1):"touchmove"===s?o.removeEventListener(St,r,!1):"touchend"===s&&(o.removeEventListener(Zt,r,!1),o.removeEventListener(Et,r,!1))):xt&&"dblclick"===i&&!Li()?(o=(n=t)[Wt+Dt+(s=a)],r=n[Wt+jt+s],s=n[Wt+"dblclick"+s],n.removeEventListener(Dt,o,!!Lt&&{passive:!1}),n.removeEventListener(jt,r,!!Lt&&{passive:!1}),n.removeEventListener("dblclick",s,!1)):"removeEventListener"in t?t.removeEventListener(bi[i]||i,e,!1):"detachEvent"in t&&t.detachEvent("on"+i,e),t[wi][a]=null}function zi(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Ri(t),this}function Ci(t){return Ti(t,"wheel",zi),this}function Si(t){return xi(t,"mousedown touchstart dblclick",zi),Ti(t,"click",Oi),this}function Zi(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Ei(t){return Zi(t),zi(t),this}function ki(t,i){if(!i)return new k(t.clientX,t.clientY);var e=yi(i),n=e.boundingClientRect;return new k((t.clientX-n.left)/e.x-i.clientLeft,(t.clientY-n.top)/e.y-i.clientTop)}var Bi=_t&&at?2*window.devicePixelRatio:ht?window.devicePixelRatio:1;function Ai(t){return tt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Bi:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var Ii={};function Oi(t){Ii[t.type]=!0}function Ri(t){var i=Ii[t.type];return Ii[t.type]=!1,i}function Ni(t,i){var e=i.relatedTarget;if(!e)return!0;try{for(;e&&e!==t;)e=e.parentNode}catch(t){return!1}return e!==t}var ct={on:xi,off:Pi,stopPropagation:zi,disableScrollPropagation:Ci,disableClickPropagation:Si,preventDefault:Zi,stop:Ei,getMousePosition:ki,getWheelDelta:Ai,fakeStop:Oi,skipped:Ri,isExternalTarget:Ni,addListener:xi,removeListener:Pi},Di=E.extend({run:function(t,i,e,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=e||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=di(t),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(t){var i=+new Date-this._startTime,e=1e3*this._duration;i<e?this._runFrame(this._easeOut(i/e),t):(this._runFrame(1),this._complete())},_runFrame:function(t,i){t=this._startPos.add(this._offset.multiplyBy(t));i&&t._round(),_i(this._el,t),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),ji=E.extend({options:{crs:G,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,i){i=c(this,i),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=_(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),void 0!==i.zoom&&(this._zoom=this._limitZoom(i.zoom)),i.center&&void 0!==i.zoom&&this.setView(j(i.center),i.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Yt&&ft&&!wt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),xi(this._proxy,Xt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,e){if((i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(j(t),i,this.options.maxBounds),e=e||{},this._stop(),this._loaded&&!e.reset&&!0!==e)&&(void 0!==e.animate&&(e.zoom=h({animate:e.animate},e.zoom),e.pan=h({animate:e.animate,duration:e.duration},e.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,e.zoom):this._tryAnimatedPan(t,e.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,i),this},setZoom:function(t,i){return this._loaded?this.setView(this.getCenter(),t,{zoom:i}):(this._zoom=t,this)},zoomIn:function(t,i){return t=t||(ft?this.options.zoomDelta:1),this.setZoom(this._zoom+t,i)},zoomOut:function(t,i){return t=t||(ft?this.options.zoomDelta:1),this.setZoom(this._zoom-t,i)},setZoomAround:function(t,i,e){var n=this.getZoomScale(i),o=this.getSize().divideBy(2),n=(t instanceof k?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),n=this.containerPointToLatLng(o.add(n));return this.setView(n,i,{zoom:e})},_getBoundsCenterZoom:function(t,i){i=i||{},t=t.getBounds?t.getBounds():N(t);var e=A(i.paddingTopLeft||i.padding||[0,0]),n=A(i.paddingBottomRight||i.padding||[0,0]),o=this.getBoundsZoom(t,!1,e.add(n));if((o="number"==typeof i.maxZoom?Math.min(i.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};n=n.subtract(e).divideBy(2),e=this.project(t.getSouthWest(),o),t=this.project(t.getNorthEast(),o);return{center:this.unproject(e.add(t).divideBy(2).add(n),o),zoom:o}},fitBounds:function(t,i){if(!(t=N(t)).isValid())throw new Error("Bounds are not valid.");t=this._getBoundsCenterZoom(t,i);return this.setView(t.center,t.zoom,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,i){return this.setView(t,this._zoom,{pan:i})},panBy:function(t,i){return i=i||{},(t=A(t).round()).x||t.y?(!0===i.animate||this.getSize().contains(t)?(this._panAnim||(this._panAnim=new Di,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire("movestart"),!1!==i.animate?(si(this._mapPane,"leaflet-pan-anim"),e=this._getMapPanePos().subtract(t).round(),this._panAnim.run(this._mapPane,e,i.duration||.25,i.easeLinearity)):(this._rawPanBy(t),this.fire("move").fire("moveend"))):this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this):this.fire("moveend");var e},flyTo:function(n,o,t){if(!1===(t=t||{}).animate||!ft)return this.setView(n,o,t);this._stop();var s=this.project(this.getCenter()),r=this.project(n),i=this.getSize(),a=this._zoom;n=j(n),o=void 0===o?a:o;var h=Math.max(i.x,i.y),e=h*this.getZoomScale(a,o),u=r.distanceTo(s)||1,l=1.42,c=l*l;function _(t){t=(e*e-h*h+(t?-1:1)*c*c*u*u)/(2*(t?e:h)*c*u),t=Math.sqrt(t*t+1)-t;return t<1e-9?-18:Math.log(t)}function d(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}var m=_(0);function f(t){return h*(p(m)*(d(t=m+l*t)/p(t))-d(m))/c}var g=Date.now(),v=(_(1)-m)/l,y=t.duration?1e3*t.duration:1e3*v*.8;return this._moveStart(!0,t.noMoveStart),function t(){var i=(Date.now()-g)/y,e=(e=i,(1-Math.pow(1-e,1.5))*v);i<=1?(this._flyToFrame=M(t,this),this._move(this.unproject(s.add(r.subtract(s).multiplyBy(f(e)/u)),a),this.getScaleZoom(h/(h*(p(m)/p(m+l*e))),a),{flyTo:!0})):this._move(n,o)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,i){t=this._getBoundsCenterZoom(t,i);return this.flyTo(t.center,t.zoom,i)},setMaxBounds:function(t){return(t=N(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var i=this.options.minZoom;return this.options.minZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var i=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&i!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,i){this._enforcingBounds=!0;var e=this.getCenter(),t=this._limitCenter(e,this._zoom,N(t));return e.equals(t)||this.panTo(t,i),this._enforcingBounds=!1,this},panInside:function(t,i){var e=A((i=i||{}).paddingTopLeft||i.padding||[0,0]),n=A(i.paddingBottomRight||i.padding||[0,0]),o=this.getCenter(),s=this.project(o),r=this.project(t),a=this.getPixelBounds(),h=a.getSize().divideBy(2),o=O([a.min.add(e),a.max.subtract(n)]);return o.contains(r)||(this._enforcingBounds=!0,t=s.subtract(r),a=A(r.x+t.x,r.y+t.y),(r.x<o.min.x||r.x>o.max.x)&&(a.x=s.x-t.x,0<t.x?a.x+=h.x-e.x:a.x-=h.x-n.x),(r.y<o.min.y||r.y>o.max.y)&&(a.y=s.y-t.y,0<t.y?a.y+=h.y-e.y:a.y-=h.y-n.y),this.panTo(this.unproject(a),i),this._enforcingBounds=!1),this},invalidateSize:function(t){if(!this._loaded)return this;t=h({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var e=this.getSize(),n=i.divideBy(2).round(),o=e.divideBy(2).round(),o=n.subtract(o);return o.x||o.y?(t.animate&&t.pan?this.panBy(o):(t.pan&&this._rawPanBy(o),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:e})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=h({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=_(this._handleGeolocationResponse,this),e=_(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,e,t):navigator.geolocation.getCurrentPosition(i,e,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var i=t.code,t=t.message||(1===i?"permission denied":2===i?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:i,message:"Geolocation error: "+t+"."})},_handleGeolocationResponse:function(t){var i,e=new D(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),o=this._locateOptions;o.setView&&(i=this.getBoundsZoom(n),this.setView(e,o.maxZoom?Math.min(i,o.maxZoom):i));var s,r={latlng:e,bounds:n,timestamp:t.timestamp};for(s in t.coords)"number"==typeof t.coords[s]&&(r[s]=t.coords[s]);this.fire("locationfound",r)},addHandler:function(t,i){if(!i)return this;i=this[t]=new i(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}for(var t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ti(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ti(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,i){i=Qt("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),i||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new R(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,i,e){t=N(t),e=A(e||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),s=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),t=this.getSize().subtract(e),e=O(this.project(a,n),this.project(r,n)).getSize(),a=ft?this.options.zoomSnap:1,r=t.x/e.x,e=t.y/e.y,e=i?Math.max(r,e):Math.min(r,e),n=this.getScaleZoom(e,n);return a&&(n=Math.round(n/(a/100))*(a/100),n=i?Math.ceil(n/a)*a:Math.floor(n/a)*a),Math.max(o,Math.min(s,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new k(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,i){i=this._getTopLeftPoint(t,i);return new I(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,i){var e=this.options.crs;return i=void 0===i?this._zoom:i,e.scale(t)/e.scale(i)},getScaleZoom:function(t,i){var e=this.options.crs;i=void 0===i?this._zoom:i;i=e.zoom(t*e.scale(i));return isNaN(i)?1/0:i},project:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.latLngToPoint(j(t),i)},unproject:function(t,i){return i=void 0===i?this._zoom:i,this.options.crs.pointToLatLng(A(t),i)},layerPointToLatLng:function(t){t=A(t).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(t){return this.project(j(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(j(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(N(t))},distance:function(t,i){return this.options.crs.distance(j(t),j(i))},containerPointToLayerPoint:function(t){return A(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return A(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){t=this.containerPointToLayerPoint(A(t));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(j(t)))},mouseEventToContainerPoint:function(t){return ki(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){t=this._container=Jt(t);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");xi(t,"scroll",this._onScroll,this),this._containerId=m(t)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&ft,si(t,"leaflet-container"+(xt?" leaflet-touch":"")+(Pt?" leaflet-retina":"")+(Q?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var i=$t(t,"position");"absolute"!==i&&"relative"!==i&&"fixed"!==i&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_i(this._mapPane,new k(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(si(t.markerPane,"leaflet-zoom-hide"),si(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,i){_i(this._mapPane,new k(0,0));var e=!this._loaded;this._loaded=!0,i=this._limitZoom(i),this.fire("viewprereset");var n=this._zoom!==i;this._moveStart(n,!1)._move(t,i)._moveEnd(n),this.fire("viewreset"),e&&this.fire("load")},_moveStart:function(t,i){return t&&this.fire("zoomstart"),i||this.fire("movestart"),this},_move:function(t,i,e){void 0===i&&(i=this._zoom);var n=this._zoom!==i;return this._zoom=i,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||e&&e.pinch)&&this.fire("zoom",e),this.fire("move",e)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){_i(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={};var i=t?Pi:xi;i((this._targets[m(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&i(window,"resize",this._onResize,this),ft&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=M(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,i){for(var e,n=[],o="mouseout"===i||"mouseover"===i,s=t.target||t.srcElement,r=!1;s;){if((e=this._targets[m(s)])&&("click"===i||"preclick"===i)&&!t._simulated&&this._draggableMoved(e)){r=!0;break}if(e&&e.listens(i,!0)){if(o&&!Ni(s,t))break;if(n.push(e),o)break}if(s===this._container)break;s=s.parentNode}return n.length||r||o||!Ni(s,t)||(n=[this]),n},_handleDOMEvent:function(t){var i;this._loaded&&!Ri(t)&&("mousedown"!==(i=t.type)&&"keypress"!==i&&"keyup"!==i&&"keydown"!==i||fi(t.target||t.srcElement),this._fireDOMEvent(t,i))},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,e){if("click"===t.type&&((o=h({},t)).type="preclick",this._fireDOMEvent(o,o.type,e)),!t._stopped&&(e=(e||[]).concat(this._findEventTargets(t,i))).length){var n=e[0];"contextmenu"===i&&n.listens(i,!0)&&Zi(t);var o,s={originalEvent:t};"keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type&&(o=n.getLatLng&&(!n._radius||n._radius<=10),s.containerPoint=o?this.latLngToContainerPoint(n.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=o?n.getLatLng():this.layerPointToLatLng(s.layerPoint));for(var r=0;r<e.length;r++)if(e[r].fire(i,s,!0),s.originalEvent._stopped||!1===e[r].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,i=this._handlers.length;t<i;t++)this._handlers[t].disable()},whenReady:function(t,i){return this._loaded?t.call(i||this,{target:this}):this.on("load",t,i),this},_getMapPanePos:function(){return di(this._mapPane)||new k(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,i){return(t&&void 0!==i?this._getNewPixelOrigin(t,i):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,i){var e=this.getSize()._divideBy(2);return this.project(t,i)._subtract(e)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,i,e){e=this._getNewPixelOrigin(e,i);return this.project(t,i)._subtract(e)},_latLngBoundsToNewLayerBounds:function(t,i,e){e=this._getNewPixelOrigin(e,i);return O([this.project(t.getSouthWest(),i)._subtract(e),this.project(t.getNorthWest(),i)._subtract(e),this.project(t.getSouthEast(),i)._subtract(e),this.project(t.getNorthEast(),i)._subtract(e)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,i,e){if(!e)return t;var n=this.project(t,i),o=this.getSize().divideBy(2),o=new I(n.subtract(o),n.add(o)),e=this._getBoundsOffset(o,e,i);return e.round().equals([0,0])?t:this.unproject(n.add(e),i)},_limitOffset:function(t,i){if(!i)return t;var e=this.getPixelBounds(),e=new I(e.min.add(t),e.max.add(t));return t.add(this._getBoundsOffset(e,i))},_getBoundsOffset:function(t,i,e){i=O(this.project(i.getNorthEast(),e),this.project(i.getSouthWest(),e)),e=i.min.subtract(t.min),t=i.max.subtract(t.max);return new k(this._rebound(e.x,-t.x),this._rebound(e.y,-t.y))},_rebound:function(t,i){return 0<t+i?Math.round(t-i)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(i))},_limitZoom:function(t){var i=this.getMinZoom(),e=this.getMaxZoom(),n=ft?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(i,Math.min(e,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ri(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,i){t=this._getCenterOffset(t)._trunc();return!(!0!==(i&&i.animate)&&!this.getSize().contains(t))&&(this.panBy(t,i),!0)},_createAnimProxy:function(){var t=this._proxy=Qt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var i=Kt,e=this._proxy.style[i];ci(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),e===this._proxy.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ti(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),i=this.getZoom();ci(this._proxy,this.project(t,i),this.getZoomScale(i,1))},_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,i,e){if(this._animatingZoom)return!0;if(e=e||{},!this._zoomAnimated||!1===e.animate||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(i),n=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==e.animate&&!this.getSize().contains(n))&&(M(function(){this._moveStart(!0,!1)._animateZoom(t,i,!0)},this),!0)},_animateZoom:function(t,i,e,n){this._mapPane&&(e&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=i,si(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:i,noUpdate:n}),setTimeout(_(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ri(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),M(function(){this._moveEnd(!0)},this))}});var Wi=S.extend({options:{position:"topright"},initialize:function(t){c(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var i=this._map;return i&&i.removeControl(this),this.options.position=t,i&&i.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var i=this._container=this.onAdd(t),e=this.getPosition(),t=t._controlCorners[e];return si(i,"leaflet-control"),-1!==e.indexOf("bottom")?t.insertBefore(i,t.firstChild):t.appendChild(i),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(ti(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(t){this._map&&t&&0<t.screenX&&0<t.screenY&&this._map.getContainer().focus()}}),pt=function(t){return new Wi(t)};ji.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var n=this._controlCorners={},o="leaflet-",s=this._controlContainer=Qt("div",o+"control-container",this._container);function t(t,i){var e=o+t+" "+o+i;n[t+i]=Qt("div",e,s)}t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ti(this._controlCorners[t]);ti(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Hi=Wi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,i,e,n){return e<n?-1:n<e?1:0}},initialize:function(t,i,e){for(var n in c(this,e),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in i)this._addLayer(i[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),(this._map=t).on("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Wi.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,i){return this._addLayer(t,i),this._map?this._update():this},addOverlay:function(t,i){return this._addLayer(t,i,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);t=this._getLayer(m(t));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){si(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(si(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ri(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ri(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",i=this._container=Qt("div",t),e=this.options.collapsed;i.setAttribute("aria-haspopup",!0),Si(i),Ci(i);var n=this._section=Qt("section",t+"-list");e&&(this._map.on("click",this.collapse,this),et||xi(i,{mouseenter:this.expand,mouseleave:this.collapse},this));var o=this._layersLink=Qt("a",t+"-toggle",i);o.href="#",o.title="Layers",xt?(xi(o,"click",Ei),xi(o,"click",this.expand,this)):xi(o,"focus",this.expand,this),e||this.expand(),this._baseLayersList=Qt("div",t+"-base",n),this._separator=Qt("div",t+"-separator",n),this._overlaysList=Qt("div",t+"-overlays",n),i.appendChild(n)},_getLayer:function(t){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&m(this._layers[i].layer)===t)return this._layers[i]},_addLayer:function(t,i,e){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:i,overlay:e}),this.options.sortLayers&&this._layers.sort(_(function(t,i){return this.options.sortFunction(t.layer,i.layer,t.name,i.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ii(this._baseLayersList),ii(this._overlaysList),this._layerControlInputs=[];for(var t,i,e,n=0,o=0;o<this._layers.length;o++)e=this._layers[o],this._addItem(e),i=i||e.overlay,t=t||!e.overlay,n+=e.overlay?0:1;return this.options.hideSingleBase&&(t=t&&1<n,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=i&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var i=this._getLayer(m(t.target)),t=i.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;t&&this._map.fire(t,i)},_createRadioElement:function(t,i){t='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=t,i.firstChild},_addItem:function(t){var i,e=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((i=document.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=n):i=this._createRadioElement("leaflet-base-layers_"+m(this),n),this._layerControlInputs.push(i),i.layerId=m(t.layer),xi(i,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;n=document.createElement("div");return e.appendChild(n),n.appendChild(i),n.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){var t,i,e=this._layerControlInputs,n=[],o=[];this._handlingClick=!0;for(var s=e.length-1;0<=s;s--)t=e[s],i=this._getLayer(t.layerId).layer,t.checked?n.push(i):t.checked||o.push(i);for(s=0;s<o.length;s++)this._map.hasLayer(o[s])&&this._map.removeLayer(o[s]);for(s=0;s<n.length;s++)this._map.hasLayer(n[s])||this._map.addLayer(n[s]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,i,e=this._layerControlInputs,n=this._map.getZoom(),o=e.length-1;0<=o;o--)t=e[o],i=this._getLayer(t.layerId).layer,t.disabled=void 0!==i.options.minZoom&&n<i.options.minZoom||void 0!==i.options.maxZoom&&n>i.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Fi=Wi.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var i="leaflet-control-zoom",e=Qt("div",i+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,i+"-in",e,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,i+"-out",e,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),e},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,i,e,n,o){n=Qt("a",e,n);return n.innerHTML=t,n.href="#",n.title=i,n.setAttribute("role","button"),n.setAttribute("aria-label",i),Si(n),xi(n,"click",Ei),xi(n,"click",o,this),xi(n,"click",this._refocusOnMap,this),n},_updateDisabled:function(){var t=this._map,i="leaflet-disabled";ri(this._zoomInButton,i),ri(this._zoomOutButton,i),!this._disabled&&t._zoom!==t.getMinZoom()||si(this._zoomOutButton,i),!this._disabled&&t._zoom!==t.getMaxZoom()||si(this._zoomInButton,i)}});ji.mergeOptions({zoomControl:!0}),ji.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Fi,this.addControl(this.zoomControl))});var Ui=Wi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var i="leaflet-control-scale",e=Qt("div",i),n=this.options;return this._addScales(n,i+"-line",e),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,i,e){t.metric&&(this._mScale=Qt("div",i,e)),t.imperial&&(this._iScale=Qt("div",i,e))},_update:function(){var t=this._map,i=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,i]),t.containerPointToLatLng([this.options.maxWidth,i]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var i=this._getRoundNum(t),e=i<1e3?i+" m":i/1e3+" km";this._updateScale(this._mScale,e,i/t)},_updateImperial:function(t){var i,e=3.2808399*t;5280<e?(i=e/5280,t=this._getRoundNum(i),this._updateScale(this._iScale,t+" mi",t/i)):(i=this._getRoundNum(e),this._updateScale(this._iScale,i+" ft",i/e))},_updateScale:function(t,i,e){t.style.width=Math.round(this.options.maxWidth*e)+"px",t.innerHTML=i},_getRoundNum:function(t){var i=Math.pow(10,(Math.floor(t)+"").length-1),t=t/i;return i*(t=10<=t?10:5<=t?5:3<=t?3:2<=t?2:1)}}),Vi=Wi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){c(this,t),this._attributions={}},onAdd:function(t){for(var i in(t.attributionControl=this)._container=Qt("div","leaflet-control-attribution"),Si(this._container),t._layers)t._layers[i].getAttribution&&this.addAttribution(t._layers[i].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t&&(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update()),this},removeAttribution:function(t){return t&&this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t,i=[];for(t in this._attributions)this._attributions[t]&&i.push(t);var e=[];this.options.prefix&&e.push(this.options.prefix),i.length&&e.push(i.join(", ")),this._container.innerHTML=e.join(" | ")}}});ji.mergeOptions({attributionControl:!0}),ji.addInitHook(function(){this.options.attributionControl&&(new Vi).addTo(this)});Wi.Layers=Hi,Wi.Zoom=Fi,Wi.Scale=Ui,Wi.Attribution=Vi,pt.layers=function(t,i,e){return new Hi(t,i,e)},pt.zoom=function(t){return new Fi(t)},pt.scale=function(t){return new Ui(t)},pt.attribution=function(t){return new Vi(t)};mt=S.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}});mt.addTo=function(t,i){return t.addHandler(i,this),this};var qi,gt={Events:Z},Gi=xt?"touchstart mousedown":"mousedown",Ki={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Yi={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Xi=E.extend({options:{clickTolerance:3},initialize:function(t,i,e,n){c(this,n),this._element=t,this._dragStartTarget=i||t,this._preventOutline=e},enable:function(){this._enabled||(xi(this._dragStartTarget,Gi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Xi._dragging===this&&this.finishDrag(),Pi(this._dragStartTarget,Gi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){var i,e;!t._simulated&&this._enabled&&(this._moved=!1,oi(this._element,"leaflet-zoom-anim")||Xi._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||((Xi._dragging=this)._preventOutline&&fi(this._element),pi(),Ut(),this._moving||(this.fire("down"),i=t.touches?t.touches[0]:t,e=vi(this._element),this._startPoint=new k(i.clientX,i.clientY),this._parentScale=yi(e),xi(document,Yi[t.type],this._onMove,this),xi(document,Ki[t.type],this._onUp,this))))},_onMove:function(t){var i;!t._simulated&&this._enabled&&(t.touches&&1<t.touches.length?this._moved=!0:((i=new k((i=t.touches&&1===t.touches.length?t.touches[0]:t).clientX,i.clientY)._subtract(this._startPoint)).x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,Zi(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=di(this._element).subtract(i),si(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),si(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,z(this._animRequest),this._lastEvent=t,this._animRequest=M(this._updatePosition,this,!0))))},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),_i(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in ri(document.body,"leaflet-dragging"),this._lastTarget&&(ri(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Yi)Pi(document,Yi[t],this._onMove,this),Pi(document,Ki[t],this._onUp,this);mi(),Vt(),this._moved&&this._moving&&(z(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Xi._dragging=!1}});function Ji(t,i){if(!i||!t.length)return t.slice();i*=i;return t=function(t,i){var e=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(e);n[0]=n[e-1]=1,function t(i,e,n,o,s){var r,a,h,u=0;for(a=o+1;a<=s-1;a++)h=ee(i[a],i[o],i[s],!0),u<h&&(r=a,u=h);n<u&&(e[r]=1,t(i,e,n,o,r),t(i,e,n,r,s))}(t,n,i,0,e-1);var o,s=[];for(o=0;o<e;o++)n[o]&&s.push(t[o]);return s}(t=function(t,i){for(var e=[t[0]],n=1,o=0,s=t.length;n<s;n++)(function(t,i){var e=i.x-t.x,t=i.y-t.y;return e*e+t*t})(t[n],t[o])>i&&(e.push(t[n]),o=n);o<s-1&&e.push(t[s-1]);return e}(t,i),i)}function $i(t,i,e){return Math.sqrt(ee(t,i,e,!0))}function Qi(t,i,e,n,o){var s,r,a,h=n?qi:ie(t,e),u=ie(i,e);for(qi=u;;){if(!(h|u))return[t,i];if(h&u)return!1;a=ie(r=te(t,i,s=h||u,e,o),e),s===h?(t=r,h=a):(i=r,u=a)}}function te(t,i,e,n,o){var s,r,a=i.x-t.x,h=i.y-t.y,i=n.min,n=n.max;return 8&e?(s=t.x+a*(n.y-t.y)/h,r=n.y):4&e?(s=t.x+a*(i.y-t.y)/h,r=i.y):2&e?(s=n.x,r=t.y+h*(n.x-t.x)/a):1&e&&(s=i.x,r=t.y+h*(i.x-t.x)/a),new k(s,r,o)}function ie(t,i){var e=0;return t.x<i.min.x?e|=1:t.x>i.max.x&&(e|=2),t.y<i.min.y?e|=4:t.y>i.max.y&&(e|=8),e}function ee(t,i,e,n){var o=i.x,s=i.y,r=e.x-o,a=e.y-s,i=r*r+a*a;return 0<i&&(1<(i=((t.x-o)*r+(t.y-s)*a)/i)?(o=e.x,s=e.y):0<i&&(o+=r*i,s+=a*i)),r=t.x-o,a=t.y-s,n?r*r+a*a:new k(o,s)}function ne(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function oe(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ne(t)}vt={simplify:Ji,pointToSegmentDistance:$i,closestPointOnSegment:function(t,i,e){return ee(t,i,e)},clipSegment:Qi,_getEdgeIntersection:te,_getBitCode:ie,_sqClosestPointOnSegment:ee,isFlat:ne,_flat:oe};function se(t,i,e){for(var n,o,s,r,a,h,u,l=[1,4,2,8],c=0,_=t.length;c<_;c++)t[c]._code=ie(t[c],i);for(s=0;s<4;s++){for(h=l[s],n=[],c=0,o=(_=t.length)-1;c<_;o=c++)r=t[c],a=t[o],r._code&h?a._code&h||((u=te(a,r,h,i,e))._code=ie(u,i),n.push(u)):(a._code&h&&((u=te(a,r,h,i,e))._code=ie(u,i),n.push(u)),n.push(r));t=n}return t}var J={clipPolygon:se},ot={project:function(t){return new k(t.lng,t.lat)},unproject:function(t){return new D(t.y,t.x)},bounds:new I([-180,-90],[180,90])},_t={R:6378137,R_MINOR:6356752.314245179,bounds:new I([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var i=Math.PI/180,e=this.R,n=t.lat*i,o=this.R_MINOR/e,s=Math.sqrt(1-o*o),o=s*Math.sin(n),s=Math.tan(Math.PI/4-n/2)/Math.pow((1-o)/(1+o),s/2),n=-e*Math.log(Math.max(s,1e-10));return new k(t.lng*i*e,n)},unproject:function(t){for(var i,e=180/Math.PI,n=this.R,o=this.R_MINOR/n,s=Math.sqrt(1-o*o),r=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(r),h=0,u=.1;h<15&&1e-7<Math.abs(u);h++)i=s*Math.sin(a),i=Math.pow((1-i)/(1+i),s/2),a+=u=Math.PI/2-2*Math.atan(r*i)-a;return new D(a*e,t.x*e/n)}},at={LonLat:ot,Mercator:_t,SphericalMercator:U},Z=h({},H,{code:"EPSG:3395",projection:_t,transformation:q(ht=.5/(Math.PI*_t.R),.5,-ht,.5)}),re=h({},H,{code:"EPSG:4326",projection:ot,transformation:q(1/180,1,-1/180,.5)}),U=h({},W,{projection:ot,transformation:q(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,i){var e=i.lng-t.lng,t=i.lat-t.lat;return Math.sqrt(e*e+t*t)},infinite:!0});W.Earth=H,W.EPSG3395=Z,W.EPSG3857=G,W.EPSG900913=K,W.EPSG4326=re,W.Simple=U;var ae=E.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[m(t)]=this},removeInteractiveTarget:function(t){return delete this._map._targets[m(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var i,e=t.target;e.hasLayer(this)&&(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents&&(i=this.getEvents(),e.on(i,this),this.once("remove",function(){e.off(i,this)},this)),this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this}))}});ji.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var i=m(t);return this._layers[i]||((this._layers[i]=t)._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var i=m(t);return this._layers[i]&&(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[i],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null),this},hasLayer:function(t){return!!t&&m(t)in this._layers},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},_addLayers:function(t){for(var i=0,e=(t=t?g(t)?t:[t]:[]).length;i<e;i++)this.addLayer(t[i])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[m(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){t=m(t);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var t,i=1/0,e=-1/0,n=this._getZoomSpan();for(t in this._zoomBoundLayers)var o=this._zoomBoundLayers[t].options,i=void 0===o.minZoom?i:Math.min(i,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom);this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=i===1/0?void 0:i,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var he=ae.extend({initialize:function(t,i){var e,n;if(c(this,i),this._layers={},t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var i=this.getLayerId(t);return this._layers[i]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){t=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(t){return!!t&&("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var i,e,n=Array.prototype.slice.call(arguments,1);for(i in this._layers)(e=this._layers[i])[t]&&e[t].apply(e,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,i){for(var e in this._layers)t.call(i,this._layers[e]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:m}),ue=he.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),he.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),he.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t,i=new R;for(t in this._layers){var e=this._layers[t];i.extend(e.getBounds?e.getBounds():e.getLatLng())}return i}}),le=S.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){c(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,i){var e=this._getIconUrl(t);if(!e){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}i=this._createImg(e,i&&"IMG"===i.tagName?i:null);return this._setIconStyles(i,t),i},_setIconStyles:function(t,i){var e=this.options,n=e[i+"Size"];"number"==typeof n&&(n=[n,n]);var o=A(n),n=A("shadow"===i&&e.shadowAnchor||e.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+i+" "+(e.className||""),n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,i){return(i=i||document.createElement("img")).src=t,i},_getIconUrl:function(t){return Pt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var ce=le.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return ce.imagePath||(ce.imagePath=this._detectIconPath()),(this.options.imagePath||ce.imagePath)+le.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=Qt("div","leaflet-default-icon-path",document.body),i=$t(t,"background-image")||$t(t,"backgroundImage");return document.body.removeChild(t),i=null===i||0!==i.indexOf("url")?"":i.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),_e=mt.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Xi(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),si(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ri(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var i=this._marker,e=i._map,n=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,s=di(i._icon),r=e.getPixelBounds(),a=e.getPixelOrigin(),o=O(r.min._subtract(a).add(o),r.max._subtract(a).subtract(o));o.contains(s)||(n=A((Math.max(o.max.x,s.x)-o.max.x)/(r.max.x-o.max.x)-(Math.min(o.min.x,s.x)-o.min.x)/(r.min.x-o.min.x),(Math.max(o.max.y,s.y)-o.max.y)/(r.max.y-o.max.y)-(Math.min(o.min.y,s.y)-o.min.y)/(r.min.y-o.min.y)).multiplyBy(n),e.panBy(n,{animate:!1}),this._draggable._newPos._add(n),this._draggable._startPos._add(n),_i(i._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=M(this._adjustPan.bind(this,t)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,t)))},_onDrag:function(t){var i=this._marker,e=i._shadow,n=di(i._icon),o=i._map.layerPointToLatLng(n);e&&_i(e,n),i._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,i.fire("move",t).fire("drag",t)},_onDragEnd:function(t){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),de=ae.extend({options:{icon:new ce,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,i){c(this,i),this._latlng=j(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var i=this._latlng;return this._latlng=j(t),this.update(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){var t;return this._icon&&this._map&&(t=this._map.latLngToLayerPoint(this._latlng).round(),this._setPos(t)),this},_initIcon:function(){var t=this.options,i="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),e=t.icon.createIcon(this._icon),n=!1;e!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(e.title=t.title),"IMG"===e.tagName&&(e.alt=t.alt||"")),si(e,i),t.keyboard&&(e.tabIndex="0"),this._icon=e,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),e=!1;o!==this._shadow&&(this._removeShadow(),e=!0),o&&(si(o,i),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&e&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ti(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ti(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&_i(this._icon,t),this._shadow&&_i(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(t)},_initInteraction:function(){var t;this.options.interactive&&(si(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_e&&(t=this.options.draggable,this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _e(this),t&&this.dragging.enable()))},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ui(this._icon,t),this._shadow&&ui(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var pe=ae.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return c(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),me=pe.extend({options:{fill:!0,radius:10},initialize:function(t,i){c(this,i),this._latlng=j(t),this._radius=this.options.radius},setLatLng:function(t){var i=this._latlng;return this._latlng=j(t),this.redraw(),this.fire("move",{oldLatLng:i,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var i=t&&t.radius||this._radius;return pe.prototype.setStyle.call(this,t),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,i=this._radiusY||t,e=this._clickTolerance(),e=[t+e,i+e];this._pxBounds=new I(this._point.subtract(e),this._point.add(e))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var fe=me.extend({initialize:function(t,i,e){if("number"==typeof i&&(i=h({},e,{radius:i})),c(this,i),this._latlng=j(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new R(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:pe.prototype.setStyle,_project:function(){var t,i,e,n,o,s=this._latlng.lng,r=this._latlng.lat,a=this._map,h=a.options.crs;h.distance===H.distance?(o=Math.PI/180,t=this._mRadius/H.R/o,i=a.project([r+t,s]),n=a.project([r-t,s]),e=i.add(n).divideBy(2),n=a.unproject(e).lat,o=Math.acos((Math.cos(t*o)-Math.sin(r*o)*Math.sin(n*o))/(Math.cos(r*o)*Math.cos(n*o)))/o,!isNaN(o)&&0!==o||(o=t/Math.cos(Math.PI/180*r)),this._point=e.subtract(a.getPixelOrigin()),this._radius=isNaN(o)?0:e.x-a.project([n,s-o]).x,this._radiusY=e.y-i.y):(h=h.unproject(h.project(this._latlng).subtract([this._mRadius,0])),this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(h).x),this._updateBounds()}});var ge=pe.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,i){c(this,i),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var i,e,n=1/0,o=null,s=ee,r=0,a=this._parts.length;r<a;r++)for(var h=this._parts[r],u=1,l=h.length;u<l;u++){var c=s(t,i=h[u-1],e=h[u],!0);c<n&&(n=c,o=s(t,i,e))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r=this._rings[0],a=r.length;if(!a)return null;for(i=t=0;t<a-1;t++)i+=r[t].distanceTo(r[t+1])/2;if(0===i)return this._map.layerPointToLatLng(r[0]);for(e=t=0;t<a-1;t++)if(n=r[t],o=r[t+1],i<(e+=s=n.distanceTo(o)))return s=(e-i)/s,this._map.layerPointToLatLng([o.x-s*(o.x-n.x),o.y-s*(o.y-n.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,i){return i=i||this._defaultShape(),t=j(t),i.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new R,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return ne(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var i=[],e=ne(t),n=0,o=t.length;n<o;n++)e?(i[n]=j(t[n]),this._bounds.extend(i[n])):i[n]=this._convertLatLngs(t[n]);return i},_project:function(){var t=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),t=new k(t,t);this._pxBounds=new I([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)])},_projectLatlngs:function(t,i,e){var n,o,s=t[0]instanceof D,r=t.length;if(s){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),e.extend(o[n]);i.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,e,n,o,s=this._parts,r=0,a=0,h=this._rings.length;r<h;r++)for(i=0,e=(o=this._rings[r]).length;i<e-1;i++)(n=Qi(o[i],o[i+1],t,i,!0))&&(s[a]=s[a]||[],s[a].push(n[0]),n[1]===o[i+1]&&i!==e-2||(s[a].push(n[1]),a++))},_simplifyPoints:function(){for(var t=this._parts,i=this.options.smoothFactor,e=0,n=t.length;e<n;e++)t[e]=Ji(t[e],i)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,i){var e,n,o,s,r,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(e=0,s=this._parts.length;e<s;e++)for(n=0,o=(r=(a=this._parts[e]).length)-1;n<r;o=n++)if((i||0!==n)&&$i(t,a[o],a[n])<=h)return!0;return!1}});ge._flat=oe;var ve=ge.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,i,e,n,o,s,r,a,h,u=this._rings[0],l=u.length;if(!l)return null;for(t=s=r=a=0,i=l-1;t<l;i=t++)e=u[t],n=u[i],o=e.y*n.x-n.y*e.x,r+=(e.x+n.x)*o,a+=(e.y+n.y)*o,s+=3*o;return h=0===s?u[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var i=ge.prototype._convertLatLngs.call(this,t),t=i.length;return 2<=t&&i[0]instanceof D&&i[0].equals(i[t-1])&&i.pop(),i},_setLatLngs:function(t){ge.prototype._setLatLngs.call(this,t),ne(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return(ne(this._latlngs[0])?this._latlngs:this._latlngs[0])[0]},_clipPoints:function(){var t=this._renderer._bounds,i=this.options.weight,i=new k(i,i),t=new I(t.min.subtract(i),t.max.add(i));if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var e,n=0,o=this._rings.length;n<o;n++)(e=se(this._rings[n],t,!0)).length&&this._parts.push(e)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var i,e,n,o,s,r,a,h,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(s=0,r=(h=(i=this._parts[o]).length)-1;s<h;r=s++)e=i[s],n=i[r],e.y>t.y!=n.y>t.y&&t.x<(n.x-e.x)*(t.y-e.y)/(n.y-e.y)+e.x&&(u=!u);return u||ge.prototype._containsPoint.call(this,t,!0)}});var ye=ue.extend({initialize:function(t,i){c(this,i),this._layers={},t&&this.addData(t)},addData:function(t){var i,e,n,o=g(t)?t:t.features;if(o){for(i=0,e=o.length;i<e;i++)((n=o[i]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var s=this.options;if(s.filter&&!s.filter(t))return this;var r=xe(t,s);return r?(r.feature=ze(t),r.defaultOptions=r.options,this.resetStyle(r),s.onEachFeature&&s.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=h({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(t){this._setLayerStyle(t,i)},this)},_setLayerStyle:function(t,i){t.setStyle&&("function"==typeof i&&(i=i(t.feature)),t.setStyle(i))}});function xe(t,i){var e,n,o,s,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],u=i&&i.pointToLayer,l=i&&i.coordsToLatLng||Pe;if(!a&&!r)return null;switch(r.type){case"Point":return we(u,t,e=l(a),i);case"MultiPoint":for(o=0,s=a.length;o<s;o++)e=l(a[o]),h.push(we(u,t,e,i));return new ue(h);case"LineString":case"MultiLineString":return n=Le(a,"LineString"===r.type?0:1,l),new ge(n,i);case"Polygon":case"MultiPolygon":return n=Le(a,"Polygon"===r.type?1:2,l),new ve(n,i);case"GeometryCollection":for(o=0,s=r.geometries.length;o<s;o++){var c=xe({geometry:r.geometries[o],type:"Feature",properties:t.properties},i);c&&h.push(c)}return new ue(h);default:throw new Error("Invalid GeoJSON object.")}}function we(t,i,e,n){return t?t(i,e):new de(e,n&&n.markersInheritOptions&&n)}function Pe(t){return new D(t[1],t[0],t[2])}function Le(t,i,e){for(var n,o=[],s=0,r=t.length;s<r;s++)n=i?Le(t[s],i-1,e):(e||Pe)(t[s]),o.push(n);return o}function be(t,i){return i="number"==typeof i?i:6,void 0!==t.alt?[r(t.lng,i),r(t.lat,i),r(t.alt,i)]:[r(t.lng,i),r(t.lat,i)]}function Te(t,i,e,n){for(var o=[],s=0,r=t.length;s<r;s++)o.push(i?Te(t[s],i-1,e,n):be(t[s],n));return!i&&e&&o.push(o[0]),o}function Me(t,i){return t.feature?h({},t.feature,{geometry:i}):ze(i)}function ze(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}_t={toGeoJSON:function(t){return Me(this,{type:"Point",coordinates:be(this.getLatLng(),t)})}};function Ce(t,i){return new ye(t,i)}de.include(_t),fe.include(_t),me.include(_t),ge.include({toGeoJSON:function(t){var i=!ne(this._latlngs);return Me(this,{type:(i?"Multi":"")+"LineString",coordinates:Te(this._latlngs,i?1:0,!1,t)})}}),ve.include({toGeoJSON:function(t){var i=!ne(this._latlngs),e=i&&!ne(this._latlngs[0]),t=Te(this._latlngs,e?2:i?1:0,!0,t);return i||(t=[t]),Me(this,{type:(e?"Multi":"")+"Polygon",coordinates:t})}}),he.include({toMultiPoint:function(i){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON(i).geometry.coordinates)}),Me(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(i){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(i);var e="GeometryCollection"===t,n=[];return this.eachLayer(function(t){t.toGeoJSON&&(t=t.toGeoJSON(i),e?n.push(t.geometry):"FeatureCollection"===(t=ze(t)).type?n.push.apply(n,t.features):n.push(t))}),e?Me(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var ht=Ce,Se=ae.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,i,e){this._url=t,this._bounds=N(i),c(this,e)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(si(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ti(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ei(this._image),this},bringToBack:function(){return this._map&&ni(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=N(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,i=this._image=t?this._url:Qt("img");si(i,"leaflet-image-layer"),this._zoomAnimated&&si(i,"leaflet-zoom-animated"),this.options.className&&si(i,this.options.className),i.onselectstart=a,i.onmousemove=a,i.onload=_(this.fire,this,"load"),i.onerror=_(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=i.src:(i.src=this._url,i.alt=this.options.alt)},_animateZoom:function(t){var i=this._map.getZoomScale(t.zoom),t=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ci(this._image,t,i)},_reset:function(){var t=this._image,i=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),e=i.getSize();_i(t,i.min),t.style.width=e.x+"px",t.style.height=e.y+"px"},_updateOpacity:function(){ui(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Ze=Se.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var t="VIDEO"===this._url.tagName,i=this._image=t?this._url:Qt("video");if(si(i,"leaflet-image-layer"),this._zoomAnimated&&si(i,"leaflet-zoom-animated"),this.options.className&&si(i,this.options.className),i.onselectstart=a,i.onmousemove=a,i.onloadeddata=_(this.fire,this,"load"),t){for(var e=i.getElementsByTagName("source"),n=[],o=0;o<e.length;o++)n.push(e[o].src);this._url=0<e.length?n:[i.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(i.style,"objectFit")&&(i.style.objectFit="fill"),i.autoplay=!!this.options.autoplay,i.loop=!!this.options.loop,i.muted=!!this.options.muted;for(var s=0;s<this._url.length;s++){var r=Qt("source");r.src=this._url[s],i.appendChild(r)}}}});var Ee=Se.extend({_initImage:function(){var t=this._image=this._url;si(t,"leaflet-image-layer"),this._zoomAnimated&&si(t,"leaflet-zoom-animated"),this.options.className&&si(t,this.options.className),t.onselectstart=a,t.onmousemove=a}});var ke=ae.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,i){c(this,t),this._source=i},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ui(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ui(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(ui(this._container,0),this._removeTimeout=setTimeout(_(ti,void 0,this._container),200)):ti(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=j(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ei(this._container),this},bringToBack:function(){return this._map&&ni(this._container),this},_prepareOpen:function(t,i,e){if(i instanceof ae||(e=i,i=t),i instanceof ue)for(var n in t._layers){i=t._layers[n];break}if(!e)if(i.getCenter)e=i.getCenter();else{if(!i.getLatLng)throw new Error("Unable to get source layer LatLng.");e=i.getLatLng()}return this._source=i,this.update(),e},_updateContent:function(){if(this._content){var t=this._contentNode,i="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof i)t.innerHTML=i;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}this.fire("contentupdate")}},_updatePosition:function(){var t,i,e;this._map&&(t=this._map.latLngToLayerPoint(this._latlng),e=A(this.options.offset),i=this._getAnchor(),this._zoomAnimated?_i(this._container,t.add(i)):e=e.add(t).add(i),i=this._containerBottom=-e.y,e=this._containerLeft=-Math.round(this._containerWidth/2)+e.x,this._container.style.bottom=i+"px",this._container.style.left=e+"px")},_getAnchor:function(){return[0,0]}}),Be=ke.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){ke.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pe||this._source.on("preclick",zi))},onRemove:function(t){ke.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pe||this._source.off("preclick",zi))},getEvents:function(){var t=ke.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",i=this._container=Qt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),e=this._wrapper=Qt("div",t+"-content-wrapper",i);this._contentNode=Qt("div",t+"-content",e),Si(i),Ci(this._contentNode),xi(i,"contextmenu",zi),this._tipContainer=Qt("div",t+"-tip-container",i),this._tip=Qt("div",t+"-tip",this._tipContainer),this.options.closeButton&&((i=this._closeButton=Qt("a",t+"-close-button",i)).href="#close",i.innerHTML="&#215;",xi(i,"click",this._onCloseButtonClick,this))},_updateLayout:function(){var t=this._contentNode,i=t.style;i.width="",i.whiteSpace="nowrap";var e=t.offsetWidth,e=Math.min(e,this.options.maxWidth);e=Math.max(e,this.options.minWidth),i.width=e+1+"px",i.whiteSpace="",i.height="";var n=t.offsetHeight,o=this.options.maxHeight,e="leaflet-popup-scrolled";o&&o<n?(i.height=o+"px",si(t,e)):ri(t,e),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var i=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),t=this._getAnchor();_i(this._container,i.add(t))},_adjustPan:function(){var t,i,e,n,o,s,r,a,h;this.options.autoPan&&(this._map._panAnim&&this._map._panAnim.stop(),t=this._map,r=parseInt($t(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+r,e=this._containerWidth,(a=new k(this._containerLeft,-i-this._containerBottom))._add(di(this._container)),n=t.layerPointToContainerPoint(a),h=A(this.options.autoPanPadding),o=A(this.options.autoPanPaddingTopLeft||h),s=A(this.options.autoPanPaddingBottomRight||h),r=t.getSize(),h=a=0,n.x+e+s.x>r.x&&(a=n.x+e-r.x+s.x),n.x-a-o.x<0&&(a=n.x-o.x),n.y+i+s.y>r.y&&(h=n.y+i-r.y+s.y),n.y-h-o.y<0&&(h=n.y-o.y),(a||h)&&t.fire("autopanstart").panBy([a,h]))},_onCloseButtonClick:function(t){this._close(),Ei(t)},_getAnchor:function(){return A(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});ji.mergeOptions({closePopupOnClick:!0}),ji.include({openPopup:function(t,i,e){return t instanceof Be||(t=new Be(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),ae.include({bindPopup:function(t,i){return t instanceof Be?(c(t,i),(this._popup=t)._source=this):(this._popup&&!i||(this._popup=new Be(i,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,i){return this._popup&&this._map&&(i=this._popup._prepareOpen(this,t,i),this._map.openPopup(this._popup,i)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var i=t.layer||t.target;this._popup&&this._map&&(Ei(t),i instanceof pe?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===i?this.closePopup():this.openPopup(i,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Ae=ke.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){ke.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){ke.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=ke.prototype.getEvents.call(this);return xt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Qt("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var i,e=this._map,n=this._container,o=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),r=this.options.direction,a=n.offsetWidth,h=n.offsetHeight,u=A(this.options.offset),e=this._getAnchor(),h="top"===r?(i=a/2,h):"bottom"===r?(i=a/2,0):(i="center"===r?a/2:"right"===r?0:"left"===r?a:s.x<o.x?(r="right",0):(r="left",a+2*(u.x+e.x)),h/2);t=t.subtract(A(i,h,!0)).add(u).add(e),ri(n,"leaflet-tooltip-right"),ri(n,"leaflet-tooltip-left"),ri(n,"leaflet-tooltip-top"),ri(n,"leaflet-tooltip-bottom"),si(n,"leaflet-tooltip-"+r),_i(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ui(this._container,t)},_animateZoom:function(t){t=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(t)},_getAnchor:function(){return A(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});ji.include({openTooltip:function(t,i,e){return t instanceof Ae||(t=new Ae(e).setContent(t)),i&&t.setLatLng(i),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),ae.include({bindTooltip:function(t,i){return t instanceof Ae?(c(t,i),(this._tooltip=t)._source=this):(this._tooltip&&!i||(this._tooltip=new Ae(i,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){var i,e;!t&&this._tooltipHandlersAdded||(i=t?"off":"on",e={remove:this.closeTooltip,move:this._moveTooltip},this._tooltip.options.permanent?e.add=this._openTooltip:(e.mouseover=this._openTooltip,e.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(e.mousemove=this._moveTooltip),xt&&(e.click=this._openTooltip)),this[i](e),this._tooltipHandlersAdded=!t)},openTooltip:function(t,i){return this._tooltip&&this._map&&(i=this._tooltip._prepareOpen(this,t,i),this._map.openTooltip(this._tooltip,i),this._tooltip.options.interactive&&this._tooltip._container&&(si(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(ri(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var i=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(i,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(t=this._map.mouseEventToContainerPoint(t.originalEvent),t=this._map.containerPointToLayerPoint(t),i=this._map.layerPointToLatLng(t)),this._tooltip.setLatLng(i)}});var Ie=le.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:document.createElement("div"),t=this.options;return t.html instanceof Element?(ii(i),i.appendChild(t.html)):i.innerHTML=!1!==t.html?t.html:"",t.bgPos&&(t=A(t.bgPos),i.style.backgroundPosition=-t.x+"px "+-t.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}});le.Default=ce;var Oe=ae.extend({options:{tileSize:256,opacity:1,updateWhenIdle:F,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){c(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ti(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ei(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ni(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=n(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof k?t:new k(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var i,e=this.getPane().children,n=-t(-1/0,1/0),o=0,s=e.length;o<s;o++)i=e[o].style.zIndex,e[o]!==this._container&&i&&(n=t(n,+i));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Q){ui(this._container,this.options.opacity);var t,i=+new Date,e=!1,n=!1;for(t in this._tiles){var o,s=this._tiles[t];s.current&&s.loaded&&(o=Math.min(1,(i-s.loaded)/200),ui(s.el,o),o<1?e=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0))}n&&!this._noPrune&&this._pruneTiles(),e&&(z(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:a,_initContainer:function(){this._container||(this._container=Qt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,i=this.options.maxZoom;if(void 0!==t){for(var e in this._levels)e=Number(e),this._levels[e].el.children.length||e===t?(this._levels[e].el.style.zIndex=i-Math.abs(t-e),this._onUpdateLevel(e)):(ti(this._levels[e].el),this._removeTilesAtZoom(e),this._onRemoveLevel(e),delete this._levels[e]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=Qt("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=i,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),a(n.el.offsetWidth),this._onCreateLevel(n)),this._level=n}},_onUpdateLevel:a,_onRemoveLevel:a,_onCreateLevel:a,_pruneTiles:function(){if(this._map){var t,i,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)(e=this._tiles[t]).current&&!e.active&&(i=e.coords,this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2));for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var i in this._tiles)this._tiles[i].coords.z===t&&this._removeTile(i)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ti(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,i,e,n){var o=Math.floor(t/2),t=Math.floor(i/2),i=e-1,e=new k(+o,+t);e.z=+i;e=this._tileCoordsToKey(e),e=this._tiles[e];return e&&e.active?e.retain=!0:(e&&e.loaded&&(e.retain=!0),n<i&&this._retainParent(o,t,i,n))},_retainChildren:function(t,i,e,n){for(var o=2*t;o<2*t+2;o++)for(var s=2*i;s<2*i+2;s++){var r=new k(o,s);r.z=e+1;r=this._tileCoordsToKey(r),r=this._tiles[r];r&&r.active?r.retain=!0:(r&&r.loaded&&(r.retain=!0),e+1<n&&this._retainChildren(o,s,e+1,n))}},_resetView:function(t){t=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var i=this.options;return void 0!==i.minNativeZoom&&t<i.minNativeZoom?i.minNativeZoom:void 0!==i.maxNativeZoom&&i.maxNativeZoom<t?i.maxNativeZoom:t},_setView:function(t,i,e,n){var o=Math.round(i),o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o),s=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!s||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(t),e||this._pruneTiles(),this._noPrune=!!e),this._setZoomTransforms(t,i)},_setZoomTransforms:function(t,i){for(var e in this._levels)this._setZoomTransform(this._levels[e],t,i)},_setZoomTransform:function(t,i,e){var n=this._map.getZoomScale(e,t.zoom),e=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(i,e)).round();ft?ci(t.el,e,n):_i(t.el,e)},_resetGrid:function(){var t=this._map,i=t.options.crs,e=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,i.wrapLng[0]],n).x/e.x),Math.ceil(t.project([0,i.wrapLng[1]],n).x/e.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([i.wrapLat[0],0],n).y/e.x),Math.ceil(t.project([i.wrapLat[1],0],n).y/e.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var i=this._map,e=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),e=i.getZoomScale(e,this._tileZoom),t=i.project(t,this._tileZoom).floor(),e=i.getSize().divideBy(2*e);return new I(t.subtract(e),t.add(e))},_update:function(t){var i=this._map;if(i){var e=this._clampZoom(i.getZoom());if(void 0===t&&(t=i.getCenter()),void 0!==this._tileZoom){var n,i=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(i),s=o.getCenter(),r=[],i=this.options.keepBuffer,a=new I(o.getBottomLeft().subtract([i,-i]),o.getTopRight().add([i,-i]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(n in this._tiles){var h=this._tiles[n].coords;h.z===this._tileZoom&&a.contains(new k(h.x,h.y))||(this._tiles[n].current=!1)}if(1<Math.abs(e-this._tileZoom))this._setView(t,e);else{for(var u=o.min.y;u<=o.max.y;u++)for(var l=o.min.x;l<=o.max.x;l++){var c,_=new k(l,u);_.z=this._tileZoom,this._isValidTile(_)&&((c=this._tiles[this._tileCoordsToKey(_)])?c.current=!0:r.push(_))}if(r.sort(function(t,i){return t.distanceTo(s)-i.distanceTo(s)}),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));for(var d=document.createDocumentFragment(),l=0;l<r.length;l++)this._addTile(r[l],d);this._level.el.appendChild(d)}}}}},_isValidTile:function(t){var i=this._map.options.crs;if(!i.infinite){var e=this._globalTileRange;if(!i.wrapLng&&(t.x<e.min.x||t.x>e.max.x)||!i.wrapLat&&(t.y<e.min.y||t.y>e.max.y))return!1}if(!this.options.bounds)return!0;t=this._tileCoordsToBounds(t);return N(this.options.bounds).overlaps(t)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var i=this._map,e=this.getTileSize(),n=t.scaleBy(e),e=n.add(e);return[i.unproject(n,t.z),i.unproject(e,t.z)]},_tileCoordsToBounds:function(t){t=this._tileCoordsToNwSe(t),t=new R(t[0],t[1]);return this.options.noWrap||(t=this._map.wrapLatLngBounds(t)),t},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var i=t.split(":"),t=new k(+i[0],+i[1]);return t.z=+i[2],t},_removeTile:function(t){var i=this._tiles[t];i&&(ti(i.el),delete this._tiles[t],this.fire("tileunload",{tile:i.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){si(t,"leaflet-tile");var i=this.getTileSize();t.style.width=i.x+"px",t.style.height=i.y+"px",t.onselectstart=a,t.onmousemove=a,Q&&this.options.opacity<1&&ui(t,this.options.opacity),et&&!nt&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,i){var e=this._getTilePos(t),n=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),_(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&M(_(this._tileReady,this,t,null,o)),_i(o,e),this._tiles[n]={el:o,coords:t,current:!0},i.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,i,e){i&&this.fire("tileerror",{error:i,tile:e,coords:t});var n=this._tileCoordsToKey(t);(e=this._tiles[n])&&(e.loaded=+new Date,this._map._fadeAnimated?(ui(e.el,0),z(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(e.active=!0,this._pruneTiles()),i||(si(e.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:e.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Q||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(_(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var i=new k(this._wrapX?o(t.x,this._wrapX):t.x,this._wrapY?o(t.y,this._wrapY):t.y);return i.z=t.z,i},_pxBoundsToTileRange:function(t){var i=this.getTileSize();return new I(t.min.unscaleBy(i).floor(),t.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var Re=Oe.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,i){this._url=t,(i=c(this,i)).detectRetina&&Pt&&0<i.maxZoom&&(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom++):(i.zoomOffset++,i.maxZoom--),i.minZoom=Math.max(0,i.minZoom)),"string"==typeof i.subdomains&&(i.subdomains=i.subdomains.split("")),et||this.on("tileunload",this._onTileRemove)},setUrl:function(t,i){return this._url===t&&void 0===i&&(i=!0),this._url=t,i||this.redraw(),this},createTile:function(t,i){var e=document.createElement("img");return xi(e,"load",_(this._tileOnLoad,this,i,e)),xi(e,"error",_(this._tileOnError,this,i,e)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),e.alt="",e.setAttribute("role","presentation"),e.src=this.getTileUrl(t),e},getTileUrl:function(t){var i={r:Pt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};return this._map&&!this._map.options.crs.infinite&&(t=this._globalTileRange.max.y-t.y,this.options.tms&&(i.y=t),i["-y"]=t),f(this._url,h(i,this.options))},_tileOnLoad:function(t,i){Q?setTimeout(_(t,this,null,i),0):t(null,i)},_tileOnError:function(t,i,e){var n=this.options.errorTileUrl;n&&i.getAttribute("src")!==n&&(i.src=n),t(e,i)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,i=this.options.maxZoom;return this.options.zoomReverse&&(t=i-t),t+this.options.zoomOffset},_getSubdomain:function(t){t=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var t,i;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((i=this._tiles[t].el).onload=a,i.onerror=a,i.complete||(i.src=y,ti(i),delete this._tiles[t]))},_removeTile:function(t){var i=this._tiles[t];if(i)return st||i.el.setAttribute("src",y),Oe.prototype._removeTile.call(this,t)},_tileReady:function(t,i,e){if(this._map&&(!e||e.getAttribute("src")!==y))return Oe.prototype._tileReady.call(this,t,i,e)}});function Ne(t,i){return new Re(t,i)}var De=Re.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var e,n=h({},this.defaultWmsParams);for(e in i)e in this.options||(n[e]=i[e]);var o=(i=c(this,i)).detectRetina&&Pt?2:1,t=this.getTileSize();n.width=t.x*o,n.height=t.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[i]=this._crs.code,Re.prototype.onAdd.call(this,t)},getTileUrl:function(t){var i=this._tileCoordsToNwSe(t),e=this._crs,e=O(e.project(i[0]),e.project(i[1])),i=e.min,e=e.max,e=(1.3<=this._wmsVersion&&this._crs===re?[i.y,i.x,e.y,e.x]:[i.x,i.y,e.x,e.y]).join(","),t=Re.prototype.getTileUrl.call(this,t);return t+d(this.wmsParams,t,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+e},setParams:function(t,i){return h(this.wmsParams,t),i||this.redraw(),this}});Re.WMS=De,Ne.wms=function(t,i){return new De(t,i)};var je=ae.extend({options:{padding:.1,tolerance:0},initialize:function(t){c(this,t),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&si(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,i){var e=this._map.getZoomScale(i,this._zoom),n=di(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,i),s=this._map.project(t,i).subtract(s),s=o.multiplyBy(-e).add(n).add(o).subtract(s);ft?ci(this._container,s,e):_i(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,i=this._map.getSize(),e=this._map.containerPointToLayerPoint(i.multiplyBy(-t)).round();this._bounds=new I(e,e.add(i.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),We=je.extend({getEvents:function(){var t=je.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){je.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");xi(t,"mousemove",this._onMouseMove,this),xi(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),xi(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,ti(this._container),Pi(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){var t,i,e,n;this._map._animatingZoom&&this._bounds||(je.prototype._update.call(this),t=this._bounds,i=this._container,e=t.getSize(),n=Pt?2:1,_i(i,t.min),i.width=n*e.x,i.height=n*e.y,i.style.width=e.x+"px",i.style.height=e.y+"px",Pt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update"))},_reset:function(){je.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t);t=(this._layers[m(t)]=t)._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var i=t._order,e=i.next,i=i.prev;e?e.prev=i:this._drawLast=i,i?i.next=e:this._drawFirst=e,delete t._order,delete this._layers[m(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){for(var i,e=t.options.dashArray.split(/[, ]+/),n=[],o=0;o<e.length;o++){if(i=Number(e[o]),isNaN(i))return;n.push(i)}t.options._dashArray=n}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(t){var i;t._pxBounds&&(i=(t.options.weight||0)+1,this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(t._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(t._pxBounds.max.add([i,i])))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t,i=this._redrawBounds;i?(t=i.getSize(),this._ctx.clearRect(i.min.x,i.min.y,t.x,t.y)):(this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore())},_draw:function(){var t,i,e=this._redrawBounds;this._ctx.save(),e&&(i=e.getSize(),this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()),this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,i){if(this._drawing){var e,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(h.beginPath(),e=0;e<a;e++){for(n=0,o=r[e].length;n<o;n++)s=r[e][n],h[n?"lineTo":"moveTo"](s.x,s.y);i&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){var i,e,n,o;this._drawing&&!t._empty()&&(i=t._point,e=this._ctx,n=Math.max(Math.round(t._radius),1),1!=(o=(Math.max(Math.round(t._radiusY),1)||n)/n)&&(e.save(),e.scale(1,o)),e.beginPath(),e.arc(i.x,i.y/o,n,0,2*Math.PI,!1),1!=o&&e.restore(),this._fillStroke(e,t))},_fillStroke:function(t,i){var e=i.options;e.fill&&(t.globalAlpha=e.fillOpacity,t.fillStyle=e.fillColor||e.color,t.fill(e.fillRule||"evenodd")),e.stroke&&0!==e.weight&&(t.setLineDash&&t.setLineDash(i.options&&i.options._dashArray||[]),t.globalAlpha=e.opacity,t.lineWidth=e.weight,t.strokeStyle=e.color,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.stroke())},_onClick:function(t){for(var i,e,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(n)&&(("click"===t.type||"preclick"!==t.type)&&this._map._draggableMoved(i)||(e=i));e&&(Oi(t),this._fireEvent([e],t))},_onMouseMove:function(t){var i;!this._map||this._map.dragging.moving()||this._map._animatingZoom||(i=this._map.mouseEventToLayerPoint(t),this._handleMouseHover(t,i))},_handleMouseOut:function(t){var i=this._hoveredLayer;i&&(ri(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,i){if(!this._mouseHoverThrottled){for(var e,n,o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&(n=e);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(si(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(_(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,i,e){this._map._fireDOMEvent(i,e||i.type,t)},_bringToFront:function(t){var i,e,n=t._order;n&&(i=n.next,e=n.prev,i&&((i.prev=e)?e.next=i:i&&(this._drawFirst=i),n.prev=this._drawLast,(this._drawLast.next=n).next=null,this._drawLast=n,this._requestRedraw(t)))},_bringToBack:function(t){var i,e,n=t._order;n&&(i=n.next,(e=n.prev)&&((e.next=i)?i.prev=e:e&&(this._drawLast=e),n.prev=null,n.next=this._drawFirst,this._drawFirst.prev=n,this._drawFirst=n,this._requestRedraw(t)))}});function He(t){return bt?new We(t):null}var Fe=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),ot={_initContainer:function(){this._container=Qt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(je.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var i=t._container=Fe("shape");si(i,"leaflet-vml-shape "+(this.options.className||"")),i.coordsize="1 1",t._path=Fe("path"),i.appendChild(t._path),this._updateStyle(t),this._layers[m(t)]=t},_addPath:function(t){var i=t._container;this._container.appendChild(i),t.options.interactive&&t.addInteractiveTarget(i)},_removePath:function(t){var i=t._container;ti(i),t.removeInteractiveTarget(i),delete this._layers[m(t)]},_updateStyle:function(t){var i=t._stroke,e=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(i=i||(t._stroke=Fe("stroke")),o.appendChild(i),i.weight=n.weight+"px",i.color=n.color,i.opacity=n.opacity,n.dashArray?i.dashStyle=g(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):i.dashStyle="",i.endcap=n.lineCap.replace("butt","flat"),i.joinstyle=n.lineJoin):i&&(o.removeChild(i),t._stroke=null),n.fill?(e=e||(t._fill=Fe("fill")),o.appendChild(e),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(o.removeChild(e),t._fill=null)},_updateCircle:function(t){var i=t._point.round(),e=Math.round(t._radius),n=Math.round(t._radiusY||e);this._setPath(t,t._empty()?"M0 0":"AL "+i.x+","+i.y+" "+e+","+n+" 0,23592600")},_setPath:function(t,i){t._path.v=i},_bringToFront:function(t){ei(t._container)},_bringToBack:function(t){ni(t._container)}},Ue=Mt?Fe:Y,Ve=je.extend({getEvents:function(){var t=je.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=Ue("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ue("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ti(this._container),Pi(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){var t,i,e;this._map._animatingZoom&&this._bounds||(je.prototype._update.call(this),i=(t=this._bounds).getSize(),e=this._container,this._svgSize&&this._svgSize.equals(i)||(this._svgSize=i,e.setAttribute("width",i.x),e.setAttribute("height",i.y)),_i(e,t.min),e.setAttribute("viewBox",[t.min.x,t.min.y,i.x,i.y].join(" ")),this.fire("update"))},_initPath:function(t){var i=t._path=Ue("path");t.options.className&&si(i,t.options.className),t.options.interactive&&si(i,"leaflet-interactive"),this._updateStyle(t),this._layers[m(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ti(t._path),t.removeInteractiveTarget(t._path),delete this._layers[m(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var i=t._path,t=t.options;i&&(t.stroke?(i.setAttribute("stroke",t.color),i.setAttribute("stroke-opacity",t.opacity),i.setAttribute("stroke-width",t.weight),i.setAttribute("stroke-linecap",t.lineCap),i.setAttribute("stroke-linejoin",t.lineJoin),t.dashArray?i.setAttribute("stroke-dasharray",t.dashArray):i.removeAttribute("stroke-dasharray"),t.dashOffset?i.setAttribute("stroke-dashoffset",t.dashOffset):i.removeAttribute("stroke-dashoffset")):i.setAttribute("stroke","none"),t.fill?(i.setAttribute("fill",t.fillColor||t.color),i.setAttribute("fill-opacity",t.fillOpacity),i.setAttribute("fill-rule",t.fillRule||"evenodd")):i.setAttribute("fill","none"))},_updatePoly:function(t,i){this._setPath(t,X(t._parts,i))},_updateCircle:function(t){var i=t._point,e=Math.max(Math.round(t._radius),1),n="a"+e+","+(Math.max(Math.round(t._radiusY),1)||e)+" 0 1,0 ",e=t._empty()?"M0 0":"M"+(i.x-e)+","+i.y+n+2*e+",0 "+n+2*-e+",0 ";this._setPath(t,e)},_setPath:function(t,i){t._path.setAttribute("d",i)},_bringToFront:function(t){ei(t._path)},_bringToBack:function(t){ni(t._path)}});function qe(t){return Tt||Mt?new Ve(t):null}Mt&&Ve.include(ot),ji.include({getRenderer:function(t){t=(t=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer)||(this._renderer=this._createRenderer());return this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var i=this._paneRenderers[t];return void 0===i&&(i=this._createRenderer({pane:t}),this._paneRenderers[t]=i),i},_createRenderer:function(t){return this.options.preferCanvas&&He(t)||qe(t)}});var Ge=ve.extend({initialize:function(t,i){ve.prototype.initialize.call(this,this._boundsToLatLngs(t),i)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=N(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});Ve.create=Ue,Ve.pointsToPath=X,ye.geometryToLayer=xe,ye.coordsToLatLng=Pe,ye.coordsToLatLngs=Le,ye.latLngToCoords=be,ye.latLngsToCoords=Te,ye.getFeature=Me,ye.asFeature=ze,ji.mergeOptions({boxZoom:!0});Z=mt.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){xi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Pi(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ti(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Ut(),pi(),this._startPoint=this._map.mouseEventToContainerPoint(t),xi(document,{contextmenu:Ei,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Qt("div","leaflet-zoom-box",this._container),si(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var i=new I(this._point,this._startPoint),t=i.getSize();_i(this._box,i.min),this._box.style.width=t.x+"px",this._box.style.height=t.y+"px"},_finish:function(){this._moved&&(ti(this._box),ri(this._container,"leaflet-crosshair")),Vt(),mi(),Pi(document,{contextmenu:Ei,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){1!==t.which&&1!==t.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(_(this._resetState,this),0),t=new R(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})))},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});ji.addInitHook("addHandler","boxZoom",Z),ji.mergeOptions({doubleClickZoom:!0});G=mt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var i=this._map,e=i.getZoom(),n=i.options.zoomDelta,n=t.originalEvent.shiftKey?e-n:e+n;"center"===i.options.doubleClickZoom?i.setZoom(n):i.setZoomAround(t.containerPoint,n)}});ji.addInitHook("addHandler","doubleClickZoom",G),ji.mergeOptions({dragging:!0,inertia:!nt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});K=mt.extend({addHooks:function(){var t;this._draggable||(t=this._map,this._draggable=new Xi(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))),si(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ri(this._map._container,"leaflet-grab"),ri(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t,i=this._map;i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity?(t=N(this._map.options.maxBounds),this._offsetLimit=O(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))):this._offsetLimit=null,i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){var i,e;this._map.options.inertia&&(i=this._lastTime=+new Date,e=this._lastPos=this._draggable._absPos||this._draggable._newPos,this._positions.push(e),this._times.push(i),this._prunePositions(i)),this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;1<this._positions.length&&50<t-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),i=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=i.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,i){return t-(t-i)*this._viscosity},_onPreDragLimit:function(){var t,i;this._viscosity&&this._offsetLimit&&(t=this._draggable._newPos.subtract(this._draggable._startPos),i=this._offsetLimit,t.x<i.min.x&&(t.x=this._viscousLimit(t.x,i.min.x)),t.y<i.min.y&&(t.y=this._viscousLimit(t.y,i.min.y)),t.x>i.max.x&&(t.x=this._viscousLimit(t.x,i.max.x)),t.y>i.max.y&&(t.y=this._viscousLimit(t.y,i.max.y)),this._draggable._newPos=this._draggable._startPos.add(t))},_onPreDragWrap:function(){var t=this._worldWidth,i=Math.round(t/2),e=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-i+e)%t+i-e,i=(n+i+e)%t-i-e,i=Math.abs(o+e)<Math.abs(i+e)?o:i;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=i},_onDragEnd:function(t){var i,e,n,o,s=this._map,r=s.options,a=!r.inertia||this._times.length<2;s.fire("dragend",t),a?s.fire("moveend"):(this._prunePositions(+new Date),e=this._lastPos.subtract(this._positions[0]),t=(this._lastTime-this._times[0])/1e3,i=r.easeLinearity,e=(a=e.multiplyBy(i/t)).distanceTo([0,0]),t=Math.min(r.inertiaMaxSpeed,e),e=a.multiplyBy(t/e),n=t/(r.inertiaDeceleration*i),(o=e.multiplyBy(-n/2).round()).x||o.y?(o=s._limitOffset(o,s.options.maxBounds),M(function(){s.panBy(o,{duration:n,easeLinearity:i,noMoveStart:!0,animate:!0})})):s.fire("moveend"))}});ji.addInitHook("addHandler","dragging",K),ji.mergeOptions({keyboard:!0,keyboardPanDelta:80});U=mt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),xi(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Pi(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){var t,i,e;this._focused||(t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,e=t.scrollLeft||e.scrollLeft,this._map._container.focus(),window.scrollTo(e,i))},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){for(var i=this._panKeys={},e=this.keyCodes,n=0,o=e.left.length;n<o;n++)i[e.left[n]]=[-1*t,0];for(n=0,o=e.right.length;n<o;n++)i[e.right[n]]=[t,0];for(n=0,o=e.down.length;n<o;n++)i[e.down[n]]=[0,t];for(n=0,o=e.up.length;n<o;n++)i[e.up[n]]=[0,-1*t]},_setZoomDelta:function(t){for(var i=this._zoomKeys={},e=this.keyCodes,n=0,o=e.zoomIn.length;n<o;n++)i[e.zoomIn[n]]=t;for(n=0,o=e.zoomOut.length;n<o;n++)i[e.zoomOut[n]]=-t},_addHooks:function(){xi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Pi(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var i,e=t.keyCode,n=this._map;if(e in this._panKeys)n._panAnim&&n._panAnim._inProgress||(i=this._panKeys[e],t.shiftKey&&(i=A(i).multiplyBy(3)),n.panBy(i),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds));else if(e in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else{if(27!==e||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Ei(t)}}});ji.addInitHook("addHandler","keyboard",U),ji.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});_t=mt.extend({addHooks:function(){xi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Pi(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var i=Ai(t),e=this._map.options.wheelDebounceTime;this._delta+=i,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);e=Math.max(e-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(_(this._performZoom,this),e),Ei(t)},_performZoom:function(){var t=this._map,i=t.getZoom(),e=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),n=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,n=e?Math.ceil(n/e)*e:n,n=t._limitZoom(i+(0<this._delta?n:-n))-i;this._delta=0,this._startTime=null,n&&("center"===t.options.scrollWheelZoom?t.setZoom(i+n):t.setZoomAround(this._lastMousePos,i+n))}});ji.addInitHook("addHandler","scrollWheelZoom",_t),ji.mergeOptions({tap:!0,tapTolerance:15});F=mt.extend({addHooks:function(){xi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Pi(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(Zi(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],t=i.target;this._startPos=this._newPos=new k(i.clientX,i.clientY),t.tagName&&"a"===t.tagName.toLowerCase()&&si(t,"leaflet-active"),this._holdTimeout=setTimeout(_(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),xi(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){var i;clearTimeout(this._holdTimeout),Pi(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches&&((t=(i=t.changedTouches[0]).target)&&t.tagName&&"a"===t.tagName.toLowerCase()&&ri(t,"leaflet-active"),this._simulateEvent("mouseup",i),this._isTapValid()&&this._simulateEvent("click",i))},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){t=t.touches[0];this._newPos=new k(t.clientX,t.clientY),this._simulateEvent("mousemove",t)},_simulateEvent:function(t,i){var e=document.createEvent("MouseEvents");e._simulated=!0,i.target._simulatedClick=!0,e.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(e)}});!xt||yt&&!ut||ji.addInitHook("addHandler","tap",F),ji.mergeOptions({touchZoom:xt&&!nt,bounceAtZoomLimits:!0});ot=mt.extend({addHooks:function(){si(this._map._container,"leaflet-touch-zoom"),xi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ri(this._map._container,"leaflet-touch-zoom"),Pi(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i,e,n=this._map;!t.touches||2!==t.touches.length||n._animatingZoom||this._zooming||(i=n.mouseEventToContainerPoint(t.touches[0]),e=n.mouseEventToContainerPoint(t.touches[1]),this._centerPoint=n.getSize()._divideBy(2),this._startLatLng=n.containerPointToLatLng(this._centerPoint),"center"!==n.options.touchZoom&&(this._pinchStartLatLng=n.containerPointToLatLng(i.add(e)._divideBy(2))),this._startDist=i.distanceTo(e),this._startZoom=n.getZoom(),this._moved=!1,this._zooming=!0,n._stop(),xi(document,"touchmove",this._onTouchMove,this),xi(document,"touchend",this._onTouchEnd,this),Zi(t))},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var i=this._map,e=i.mouseEventToContainerPoint(t.touches[0]),n=i.mouseEventToContainerPoint(t.touches[1]),o=e.distanceTo(n)/this._startDist;if(this._zoom=i.getScaleZoom(o,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&o<1||this._zoom>i.getMaxZoom()&&1<o)&&(this._zoom=i._limitZoom(this._zoom)),"center"===i.options.touchZoom){if(this._center=this._startLatLng,1==o)return}else{n=e._add(n)._divideBy(2)._subtract(this._centerPoint);if(1==o&&0===n.x&&0===n.y)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(n),this._zoom)}this._moved||(i._moveStart(!0,!1),this._moved=!0),z(this._animRequest);i=_(i._move,i,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=M(i,this,!0),Zi(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,z(this._animRequest),Pi(document,"touchmove",this._onTouchMove,this),Pi(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});ji.addInitHook("addHandler","touchZoom",ot),ji.BoxZoom=Z,ji.DoubleClickZoom=G,ji.Drag=K,ji.Keyboard=U,ji.ScrollWheelZoom=_t,ji.Tap=F,ji.TouchZoom=ot,t.version="1.7.1",t.Control=Wi,t.control=pt,t.Browser=rt,t.Evented=E,t.Mixin=gt,t.Util=C,t.Class=S,t.Handler=mt,t.extend=h,t.bind=_,t.stamp=m,t.setOptions=c,t.DomEvent=ct,t.DomUtil=lt,t.PosAnimation=Di,t.Draggable=Xi,t.LineUtil=vt,t.PolyUtil=J,t.Point=k,t.point=A,t.Bounds=I,t.bounds=O,t.Transformation=V,t.transformation=q,t.Projection=at,t.LatLng=D,t.latLng=j,t.LatLngBounds=R,t.latLngBounds=N,t.CRS=W,t.GeoJSON=ye,t.geoJSON=Ce,t.geoJson=ht,t.Layer=ae,t.LayerGroup=he,t.layerGroup=function(t,i){return new he(t,i)},t.FeatureGroup=ue,t.featureGroup=function(t,i){return new ue(t,i)},t.ImageOverlay=Se,t.imageOverlay=function(t,i,e){return new Se(t,i,e)},t.VideoOverlay=Ze,t.videoOverlay=function(t,i,e){return new Ze(t,i,e)},t.SVGOverlay=Ee,t.svgOverlay=function(t,i,e){return new Ee(t,i,e)},t.DivOverlay=ke,t.Popup=Be,t.popup=function(t,i){return new Be(t,i)},t.Tooltip=Ae,t.tooltip=function(t,i){return new Ae(t,i)},t.Icon=le,t.icon=function(t){return new le(t)},t.DivIcon=Ie,t.divIcon=function(t){return new Ie(t)},t.Marker=de,t.marker=function(t,i){return new de(t,i)},t.TileLayer=Re,t.tileLayer=Ne,t.GridLayer=Oe,t.gridLayer=function(t){return new Oe(t)},t.SVG=Ve,t.svg=qe,t.Renderer=je,t.Canvas=We,t.canvas=He,t.Path=pe,t.CircleMarker=me,t.circleMarker=function(t,i){return new me(t,i)},t.Circle=fe,t.circle=function(t,i,e){return new fe(t,i,e)},t.Polyline=ge,t.polyline=function(t,i){return new ge(t,i)},t.Polygon=ve,t.polygon=function(t,i){return new ve(t,i)},t.Rectangle=Ge,t.rectangle=function(t,i){return new Ge(t,i)},t.Map=ji,t.map=function(t,i){return new ji(t,i)};var Ke=window.L;t.noConflict=function(){return window.L=Ke,this},window.L=t});
!function(){var t={restoreView:function(){if(!function(e){try{var t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(t){return console.warn("Your browser blocks access to "+e),!1}}("localStorage"))return!1;var r=window.localStorage;this.__initRestore||(this.on("moveend",function(t){var e;this._loaded&&(e={lat:this.getCenter().lat,lng:this.getCenter().lng,zoom:this.getZoom()},r.mapView=JSON.stringify(e))},this),this.__initRestore=!0);var t=r.mapView;try{return t=JSON.parse(t||""),this.setView(L.latLng(t.lat,t.lng),t.zoom,!0),!0}catch(t){return!1}}};L.Map.include(t)}();
"use strict";var polyline={};function py2_round(e){return Math.floor(Math.abs(e)+.5)*(0<=e?1:-1)}function encode(e,o,n){var r=(e=py2_round(e*n))-(o=py2_round(o*n));r<<=1,e-o<0&&(r=~r);for(var t="";32<=r;)t+=String.fromCharCode(63+(32|31&r)),r>>=5;return t+=String.fromCharCode(r+63)}function flipped(e){for(var o=[],n=0;n<e.length;n++)o.push(e[n].slice().reverse());return o}polyline.decode=function(e,o){for(var n,r=0,t=0,i=0,l=[],u=0,p=0,d=null,c=Math.pow(10,o||5);r<e.length;){for(d=null,u=0,p=0;p|=(31&(d=e.charCodeAt(r++)-63))<<u,u+=5,32<=d;);for(n=1&p?~(p>>1):p>>1,u=p=0;p|=(31&(d=e.charCodeAt(r++)-63))<<u,u+=5,32<=d;);t+=n,i+=1&p?~(p>>1):p>>1,l.push([t/c,i/c])}return l},polyline.encode=function(e,o){if(!e.length)return"";for(var n=Math.pow(10,o||5),r=encode(e[0][0],0,n)+encode(e[0][1],0,n),t=1;t<e.length;t++){var i=e[t],l=e[t-1];r+=encode(i[0],l[0],n),r+=encode(i[1],l[1],n)}return r},polyline.fromGeoJSON=function(e,o){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return polyline.encode(flipped(e.coordinates),o)},polyline.toGeoJSON=function(e,o){return{type:"LineString",coordinates:flipped(polyline.decode(e,o))}},"object"==typeof module&&module.exports&&(module.exports=polyline);
var toGeoJSON=function(){"use strict";var t,r=/\s*/g,i=/^\s*|\s*$/g,o=/\s+/;function h(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function L(e,t){return e.getElementsByTagName(t)}function F(e,t){return e.getAttribute(t)}function s(e,t){return parseFloat(F(e,t))}function M(e,t){t=L(e,t);return t.length?t[0]:null}function g(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function w(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e,t){for(var r,n={},i=0;i<t.length;i++)(r=M(e,t[i]))&&(n[t[i]]=w(r));return n}function m(e,t){for(var r in t)e[r]=t[r]}function P(e){return g(e.replace(r,"").split(","))}function R(e){for(var t=e.replace(i,"").split(o),r=[],n=0;n<t.length;n++)r.push(P(t[n]));return r}function y(e){var t=[s(e,"lon"),s(e,"lat")],r=M(e,"ele"),n=M(e,"gpxtpx:hr")||M(e,"hr"),e=M(e,"time");return r&&(r=parseFloat(w(r)),isNaN(r)||t.push(r)),{coordinates:t,time:e?w(e):null,heartRate:n?parseFloat(w(n)):null}}function d(){return{type:"FeatureCollection",features:[]}}function v(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return"undefined"!=typeof XMLSerializer?t=new XMLSerializer:"object"!=typeof exports||"object"!=typeof process||process.browser||(t=new(require("xmldom").XMLSerializer)),{kml:function(e){for(var t=d(),k={},S={},T={},x=["Polygon","LineString","Point","Track","gx:Track"],r=L(e,"Placemark"),n=L(e,"Style"),i=L(e,"StyleMap"),o=0;o<n.length;o++){var s=h(v(n[o])).toString(16);k["#"+F(n[o],"id")]=s,S[s]=n[o]}for(var a=0;a<i.length;a++){k["#"+F(i[a],"id")]=h(v(i[a])).toString(16);for(var l=L(i[a],"Pair"),u={},p=0;p<l.length;p++)u[w(M(l[p],"key"))]=w(M(l[p],"styleUrl"));T["#"+F(i[a],"id")]=u}for(var c=0;c<r.length;c++)t.features=t.features.concat(function(e){var t,r=function e(t){var r,n,i,o,s=[],a=[];if(M(t,"MultiGeometry"))return e(M(t,"MultiGeometry"));if(M(t,"MultiTrack"))return e(M(t,"MultiTrack"));if(M(t,"gx:MultiTrack"))return e(M(t,"gx:MultiTrack"));for(n=0;n<x.length;n++)if(r=L(t,x[n]))for(i=0;i<r.length;i++)if(p=r[i],"Point"===x[n])s.push({type:"Point",coordinates:P(w(M(p,"coordinates")))});else if("LineString"===x[n])s.push({type:"LineString",coordinates:R(w(M(p,"coordinates")))});else if("Polygon"===x[n]){var l=L(p,"LinearRing"),u=[];for(o=0;o<l.length;o++)u.push(R(w(M(l[o],"coordinates"))));s.push({type:"Polygon",coordinates:u})}else{var p;"Track"!==x[n]&&"gx:Track"!==x[n]||(p=b(p),s.push({type:"LineString",coordinates:p.coords}),p.times.length&&a.push(p.times))}return{geoms:s,coordTimes:a}}(e),n={},i=w(M(e,"name")),o=w(M(e,"address")),s=w(M(e,"styleUrl")),a=w(M(e,"description")),l=M(e,"TimeSpan"),u=M(e,"TimeStamp"),p=M(e,"ExtendedData"),c=M(e,"LineStyle"),h=M(e,"PolyStyle"),g=M(e,"visibility");if(!r.geoms.length)return[];i&&(n.name=i);o&&(n.address=o);s&&("#"!==s[0]&&(s="#"+s),n.styleUrl=s,k[s]&&(n.styleHash=k[s]),T[s]&&(n.styleMapHash=T[s],n.styleHash=k[T[s].normal]),(s=S[n.styleHash])&&(c=c||M(s,"LineStyle"),h=h||M(s,"PolyStyle")));a&&(n.description=a);l&&(a=w(M(l,"begin")),l=w(M(l,"end")),n.timespan={begin:a,end:l});u&&(n.timestamp=w(M(u,"when")));c&&(m=N(w(M(c,"color"))),y=m[0],f=m[1],m=parseFloat(w(M(c,"width"))),y&&(n.stroke=y),isNaN(f)||(n["stroke-opacity"]=f),isNaN(m)||(n["stroke-width"]=m));{var f,m,y;h&&(y=N(w(M(h,"color"))),f=y[0],m=y[1],y=w(M(h,"fill")),h=w(M(h,"outline")),f&&(n.fill=f),isNaN(m)||(n["fill-opacity"]=m),y&&(n["fill-opacity"]="1"===y?n["fill-opacity"]||1:0),h&&(n["stroke-opacity"]="1"===h?n["stroke-opacity"]||1:0))}if(p){var d=L(p,"Data"),v=L(p,"SimpleData");for(t=0;t<d.length;t++)n[d[t].getAttribute("name")]=w(M(d[t],"value"));for(t=0;t<v.length;t++)n[v[t].getAttribute("name")]=w(v[t])}g&&(n.visibility=w(g));r.coordTimes.length&&(n.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);r={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:n};F(e,"id")&&(r.id=F(e,"id"));return[r]}(r[c]));function N(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function b(e){var t=L(e,"coord"),r=[],n=[];0===t.length&&(t=L(e,"gx:coord"));for(var i=0;i<t.length;i++)r.push(g(w(t[i]).split(" ")));for(var o=L(e,"when"),s=0;s<o.length;s++)n.push(w(o[s]));return{coords:r,times:n}}return t},gpx:function(e){for(var t,r,n,i=L(e,"trk"),o=L(e,"rte"),s=L(e,"wpt"),a=d(),l=0;l<i.length;l++)(t=function(e){for(var t,r=L(e,"trkseg"),n=[],i=[],o=[],s=0;s<r.length;s++)(t=u(r[s],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&i.push(t.times),t.heartRates&&t.heartRates.length&&o.push(t.heartRates));if(0===n.length)return;var a=c(e);m(a,p(M(e,"extensions"))),i.length&&(a.coordTimes=1===n.length?i[0]:i);o.length&&(a.heartRates=1===n.length?o[0]:o);return{type:"Feature",properties:a,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}(i[l]))&&a.features.push(t);for(l=0;l<o.length;l++)(t=function(e){var t=u(e,"rtept");if(!t.line)return;var r=c(e);return m(r,p(M(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}(o[l]))&&a.features.push(t);for(l=0;l<s.length;l++)a.features.push((r=s[l],n=void 0,m(n=c(r),f(r,["sym"])),{type:"Feature",properties:n,geometry:{type:"Point",coordinates:y(r).coordinates}}));function u(e,t){var r=L(e,t),n=[],i=[],o=[],s=r.length;if(s<2)return{};for(var a=0;a<s;a++){var l=y(r[a]);n.push(l.coordinates),l.time&&i.push(l.time),l.heartRate&&o.push(l.heartRate)}return{line:n,times:i,heartRates:o}}function p(e){var t,r,n={};return!e||(r=M(e,"line"))&&(t=w(M(r,"color")),e=parseFloat(w(M(r,"opacity"))),r=parseFloat(w(M(r,"width"))),t&&(n.stroke=t),isNaN(e)||(n["stroke-opacity"]=e),isNaN(r)||(n["stroke-width"]=96*r/25.4)),n}function c(e){var t=f(e,["name","cmt","desc","type","time","keywords"]),r=L(e,"link");r.length&&(t.links=[]);for(var n,i=0;i<r.length;i++)m(n={href:F(r[i],"href")},f(r[i],["text","type"])),t.links.push(n);return t}return a}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports?exports.VectorMarkers=t(require("leaflet")):e.VectorMarkers=t(e.L)}(this,function(o){return i={},r.m=n=[function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icon=t.VectorMarkers=void 0;var r=i(o(1)),n=i(o(2)),o=i(o(3));function i(e){return e&&e.__esModule?e:{default:e}}t.VectorMarkers=n.default,t.Icon=o.default,r.default.VectorMarkers=n.default},function(e,t){e.exports=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=o(3),i=(r=n)&&r.__esModule?r:{default:r};t.default={version:"1.0.0",Icon:i.default,icon:function(e){return new i.default(e)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,s=o(1),a=(i=s)&&i.__esModule?i:{default:i};var l={shadowUrl:"dist/images/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],className:"vector-marker",prefix:"fa",spinClass:"fa-spin",extraIconClasses:"",extraDivClasses:"",icon:"home",markerColor:"#338ACC",iconColor:"white",viewBox:"0 0 32 52"},r=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,a.default.Icon),r(c,[{key:"createIcon",value:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),o=this.options,e=o.map_pin||"M16,1 C7.7146,1 1,7.65636364 1,15.8648485 C1,24.0760606 16,51 16,51 C16,51 31,24.0760606 31,15.8648485 C31,7.65636364 24.2815,1 16,1 L16,1 Z";return t.innerHTML='<svg width="'+o.iconSize[0]+'px" height="'+o.iconSize[1]+'px" viewBox="'+o.viewBox+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="'+e+'" fill="'+o.markerColor+'"></path></svg>',o.icon&&t.appendChild(this._createInner()),o.className+=0<o.className.length?" "+o.extraDivClasses:o.extraDivClasses,this._setIconStyles(t,"icon"),this._setIconStyles(t,"icon-"+o.markerColor),t}},{key:"_createInner",value:function(){var e=document.createElement("i"),t=this.options;return e.classList.add(t.prefix),t.extraClasses&&e.classList.add(t.extraClasses),t.prefix?e.classList.add(t.prefix+"-"+t.icon):e.classList.add(t.icon),t.spin&&"string"==typeof t.spinClass&&e.classList.add(t.spinClass),t.iconColor&&("white"===t.iconColor||"black"===t.iconColor?e.classList.add("icon-"+t.iconColor):e.style.color=t.iconColor),t.iconSize&&(e.style.width=t.iconSize[0]+"px"),e}},{key:"_setIconStyles",value:function(e,t){var o=this.options,r=a.default.point(o["shadow"===t?"shadowSize":"iconSize"]),n=void 0;!(n="shadow"===t?a.default.point(o.shadowAnchor||o.iconAnchor):a.default.point(o.iconAnchor))&&r&&(n=r.divideBy(2,!0)),e.className="vector-marker-"+t+" "+o.className,n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")}}]),c);function c(e){!function(e){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return a.default.Util.setOptions(t,l),a.default.Util.setOptions(t,e),t}t.default=r}],r.c=i,r.p="",r(0);function r(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,r),t.loaded=!0,t.exports}var n,i});
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function e(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(n);return e=r?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!=typeof e&&"function"!=typeof e?a(t):e}}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(n):t.value}})(e,t,n||e)}var t,n,f,s=function(){function e(){r(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(e,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r].callback===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var o=t[n];try{o.callback.call(this,e)}catch(e){Promise.resolve().then(function(){throw e})}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),e}(),b=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,s);var t=e(n);function n(){var e;return r(this,n),(e=t.call(this)).listeners||s.call(a(e)),Object.defineProperty(a(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return i(n,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),u(l(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(),p=function(){function e(){r(this,e),Object.defineProperty(this,"signal",{value:new b,writable:!0,configurable:!0})}return i(e,[{key:"abort",value:function(){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();function y(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),1):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(p.prototype[Symbol.toStringTag]="AbortController",b.prototype[Symbol.toStringTag]="AbortSignal"),y(t="undefined"!=typeof self?self:global)&&(t.fetch?(n=(f=function(e){"function"==typeof e&&(e={fetch:e});var t=e.fetch,r=void 0===(n=e.Request)?t.Request:n,n=e.AbortController,e=e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL;if(!y({fetch:t,Request:r,AbortController:n,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:e=void 0!==e&&e}))return{fetch:t,Request:i};var i=r;(i&&!i.prototype.hasOwnProperty("signal")||e)&&((i=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);t=new r(e,t);return n&&Object.defineProperty(t,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),t}).prototype=r.prototype);var l=t;return{fetch:function(e,t){var n,r=i&&i.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(r){try{n=new DOMException("Aborted","AbortError")}catch(e){(n=new Error("Aborted")).name="AbortError"}if(r.aborted)return Promise.reject(n);var o=new Promise(function(e,t){r.addEventListener("abort",function(){return t(n)},{once:!0})});return t&&t.signal&&delete t.signal,Promise.race([o,l(e,t)])}return l(e,t)},Request:i}}(t)).fetch,f=f.Request,t.fetch=n,t.Request=f,Object.defineProperty(t,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:p}),Object.defineProperty(t,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:b})):console.warn("fetch() is not available, cannot install abortcontroller-polyfill"))});
!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.bootbox=e(t.jQuery)}(this,function e(u,p){"use strict";var r,n,i,l;Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,n=!{toString:null}.propertyIsEnumerable("toString"),l=(i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("function"!=typeof t&&("object"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");var e,o,a=[];for(e in t)r.call(t,e)&&a.push(e);if(n)for(o=0;o<l;o++)r.call(t,i[o])&&a.push(i[o]);return a}));var d={};d.VERSION="5.5.2";var s={ar:{OK:"ÙÙØ§ÙÙ",CANCEL:"Ø§ÙØºØ§Ø¡",CONFIRM:"ØªØ£ÙÙØ¯"},bg_BG:{OK:"ÐÐº",CANCEL:"ÐÑÐºÐ°Ð·",CONFIRM:"ÐÐ¾ÑÐ²ÑÑÐ¶Ð´Ð°Ð²Ð°Ð¼"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"ZruÅ¡it",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"ÎÎ½ÏÎ¬Î¾ÎµÎ¹",CANCEL:"ÎÎºÏÏÏÏÎ·",CONFIRM:"ÎÏÎ¹Î²ÎµÎ²Î±Î¯ÏÏÎ·"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},eu:{OK:"OK",CANCEL:"Ezeztatu",CONFIRM:"Onartu"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"ÙØ¨ÙÙ",CANCEL:"ÙØºÙ",CONFIRM:"ØªØ§ÛÛØ¯"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"Confirmer"},he:{OK:"×××©××¨",CANCEL:"×××××",CONFIRM:"×××©××¨"},hu:{OK:"OK",CANCEL:"MÃ©gsem",CONFIRM:"MegerÅsÃ­t"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"ã­ã£ã³ã»ã«",CONFIRM:"ç¢ºèª"},ka:{OK:"OK",CANCEL:"ááá£á¥áááá",CONFIRM:"ááááá¡á¢á£á ááá"},ko:{OK:"OK",CANCEL:"ì·¨ì",CONFIRM:"íì¸"},lt:{OK:"Gerai",CANCEL:"AtÅ¡aukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"ApstiprinÄt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"PotwierdÅº"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"ÐÑÐ¼ÐµÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¼ÐµÐ½Ð¸ÑÑ"},sk:{OK:"OK",CANCEL:"ZruÅ¡iÅ¥",CONFIRM:"PotvrdiÅ¥"},sl:{OK:"OK",CANCEL:"PrekliÄi",CONFIRM:"Potrdi"},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},sw:{OK:"Sawa",CANCEL:"Ghairi",CONFIRM:"Thibitisha"},ta:{OK:"à®à®°à®¿",CANCEL:"à®°à®¤à¯à®¤à¯ à®à¯à®¯à¯",CONFIRM:"à®à®±à¯à®¤à®¿ à®à¯à®¯à¯"},th:{OK:"à¸à¸à¸¥à¸",CANCEL:"à¸¢à¸à¹à¸¥à¸´à¸",CONFIRM:"à¸¢à¸·à¸à¸¢à¸±à¸"},tr:{OK:"Tamam",CANCEL:"Ä°ptal",CONFIRM:"Onayla"},uk:{OK:"OK",CANCEL:"ÐÑÐ´Ð¼ÑÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¹Ð½ÑÑÐ¸"},vi:{OK:"OK",CANCEL:"Há»§y bá»",CONFIRM:"XÃ¡c nháº­n"},zh_CN:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¡®è®¤"},zh_TW:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¢ºèª"}},b={dialog:'<div class="bootbox modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="bootbox-body"></div></div></div></div></div>',header:'<div class="modal-header"><h5 class="modal-title"></h5></div>',footer:'<div class="modal-footer"></div>',closeButton:'<button type="button" class="bootbox-close-button close" aria-hidden="true">&times;</button>',form:'<form class="bootbox-form"></form>',button:'<button type="button" class="btn"></button>',option:"<option></option>",promptMessage:'<div class="bootbox-prompt-message"></div>',inputs:{text:'<input class="bootbox-input bootbox-input-text form-control" autocomplete="off" type="text" />',textarea:'<textarea class="bootbox-input bootbox-input-textarea form-control"></textarea>',email:'<input class="bootbox-input bootbox-input-email form-control" autocomplete="off" type="email" />',select:'<select class="bootbox-input bootbox-input-select form-control"></select>',checkbox:'<div class="form-check checkbox"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-checkbox" type="checkbox" /></label></div>',radio:'<div class="form-check radio"><label class="form-check-label"><input class="form-check-input bootbox-input bootbox-input-radio" type="radio" name="bootbox-radio" /></label></div>',date:'<input class="bootbox-input bootbox-input-date form-control" autocomplete="off" type="date" />',time:'<input class="bootbox-input bootbox-input-time form-control" autocomplete="off" type="time" />',number:'<input class="bootbox-input bootbox-input-number form-control" autocomplete="off" type="number" />',password:'<input class="bootbox-input bootbox-input-password form-control" autocomplete="off" type="password" />',range:'<input class="bootbox-input bootbox-input-range form-control-range" autocomplete="off" type="range" />'}},f={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body",value:"",inputType:"text",swapButtonOrder:!1,centerVertical:!1,multiple:!1,scrollable:!1,reusable:!1};function c(t,e,o){return u.extend(!0,{},t,function(t,e){var o=t.length,a={};if(o<1||2<o)throw new Error("Invalid argument length");return 2===o||"string"==typeof t[0]?(a[e[0]]=t[0],a[e[1]]=t[1]):a=t[0],a}(e,o))}function m(t,e,o,a){a&&a[0]&&(i=a[0].locale||f.locale,(a[0].swapButtonOrder||f.swapButtonOrder)&&(e=e.reverse()));var r,n,i={className:"bootbox-"+t,buttons:function(t,e){for(var o={},a=0,r=t.length;a<r;a++){var n=t[a],i=n.toLowerCase(),n=n.toUpperCase();o[i]={label:function(t,e){e=s[e];return(e||s.en)[t]}(n,e)}}return o}(e,i)};return o=c(i,a,o),n={},C(r=e,function(t,e){n[e]=!0}),C(o.buttons,function(t){if(n[t]===p)throw new Error('button key "'+t+'" is not allowed (options are '+r.join(" ")+")")}),o}function h(t){return Object.keys(t).length}function C(t,o){var a=0;u.each(t,function(t,e){o(t,e,a++)})}function O(t){t.data.dialog.find(".bootbox-accept").first().trigger("focus")}function w(t){t.target===t.data.dialog[0]&&t.data.dialog.remove()}function v(t){t.target===t.data.dialog[0]&&(t.data.dialog.off("escape.close.bb"),t.data.dialog.off("click"))}function g(t,e,o){t.stopPropagation(),t.preventDefault(),u.isFunction(o)&&!1===o.call(e,t)||e.modal("hide")}function N(t){return/([01][0-9]|2[0-3]):[0-5][0-9]?:[0-5][0-9]/.test(t)}function y(t){return/(\d{4})-(\d{2})-(\d{2})/.test(t)}return d.locales=function(t){return t?s[t]:s},d.addLocale=function(t,o){return u.each(["OK","CANCEL","CONFIRM"],function(t,e){if(!o[e])throw new Error('Please supply a translation for "'+e+'"')}),s[t]={OK:o.OK,CANCEL:o.CANCEL,CONFIRM:o.CONFIRM},d},d.removeLocale=function(t){if("en"===t)throw new Error('"en" is used as the default and fallback locale and cannot be removed.');return delete s[t],d},d.setLocale=function(t){return d.setDefaults("locale",t)},d.setDefaults=function(){var t={};return 2===arguments.length?t[arguments[0]]=arguments[1]:t=arguments[0],u.extend(f,t),d},d.hideAll=function(){return u(".bootbox").modal("hide"),d},d.init=function(t){return e(t||u)},d.dialog=function(t){if(u.fn.modal===p)throw new Error('"$.fn.modal" is not defined; please double check you have included the Bootstrap JavaScript library. See https://getbootstrap.com/docs/4.4/getting-started/javascript/ for more details.');t=function(a){var r,n;if("object"!=typeof a)throw new Error("Please supply an object of options");if(!a.message)throw new Error('"message" option must not be null or an empty string.');(a=u.extend({},f,a)).backdrop?a.backdrop="string"!=typeof a.backdrop||"static"!==a.backdrop.toLowerCase()||"static":a.backdrop=!1!==a.backdrop&&0!==a.backdrop&&"static";a.buttons||(a.buttons={});return r=a.buttons,n=h(r),C(r,function(t,e,o){if(u.isFunction(e)&&(e=r[t]={callback:e}),"object"!==u.type(e))throw new Error('button with key "'+t+'" must be an object');e.label||(e.label=t),e.className||(t=!1,t=a.swapButtonOrder?0===o:o===n-1,e.className=n<=2&&t?"btn-primary":"btn-secondary btn-default")}),a}(t),u.fn.modal.Constructor.VERSION?(t.fullBootstrapVersion=u.fn.modal.Constructor.VERSION,i=t.fullBootstrapVersion.indexOf("."),t.bootstrap=t.fullBootstrapVersion.substring(0,i)):(t.bootstrap="2",t.fullBootstrapVersion="2.3.2",console.warn("Bootbox will *mostly* work with Bootstrap 2, but we do not officially support it. Please upgrade, if possible."));var o=u(b.dialog),e=o.find(".modal-dialog"),a=o.find(".modal-body"),r=u(b.header),n=u(b.footer),i=t.buttons,l={onEscape:t.onEscape};if(a.find(".bootbox-body").html(t.message),0<h(t.buttons)&&(C(i,function(t,e){var o=u(b.button);switch(o.data("bb-handler",t),o.addClass(e.className),t){case"ok":case"confirm":o.addClass("bootbox-accept");break;case"cancel":o.addClass("bootbox-cancel")}o.html(e.label),n.append(o),l[t]=e.callback}),a.after(n)),!0===t.animate&&o.addClass("fade"),t.className&&o.addClass(t.className),t.size)switch(t.fullBootstrapVersion.substring(0,3)<"3.1"&&console.warn('"size" requires Bootstrap 3.1.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option."),t.size){case"small":case"sm":e.addClass("modal-sm");break;case"large":case"lg":e.addClass("modal-lg");break;case"extra-large":case"xl":e.addClass("modal-xl"),t.fullBootstrapVersion.substring(0,3)<"4.2"&&console.warn('Using size "xl"/"extra-large" requires Bootstrap 4.2.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")}if(t.scrollable&&(e.addClass("modal-dialog-scrollable"),t.fullBootstrapVersion.substring(0,3)<"4.3"&&console.warn('Using "scrollable" requires Bootstrap 4.3.0 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")),t.title&&(a.before(r),o.find(".modal-title").html(t.title)),t.closeButton&&(r=u(b.closeButton),t.title?3<t.bootstrap?o.find(".modal-header").append(r):o.find(".modal-header").prepend(r):r.prependTo(a)),t.centerVertical&&(e.addClass("modal-dialog-centered"),t.fullBootstrapVersion<"4.0.0"&&console.warn('"centerVertical" requires Bootstrap 4.0.0-beta.3 or higher. You appear to be using '+t.fullBootstrapVersion+". Please upgrade to use this option.")),t.reusable||o.one("hide.bs.modal",{dialog:o},v),t.onHide){if(!u.isFunction(t.onHide))throw new Error('Argument supplied to "onHide" must be a function');o.on("hide.bs.modal",t.onHide)}if(t.reusable||o.one("hidden.bs.modal",{dialog:o},w),t.onHidden){if(!u.isFunction(t.onHidden))throw new Error('Argument supplied to "onHidden" must be a function');o.on("hidden.bs.modal",t.onHidden)}if(t.onShow){if(!u.isFunction(t.onShow))throw new Error('Argument supplied to "onShow" must be a function');o.on("show.bs.modal",t.onShow)}if(o.one("shown.bs.modal",{dialog:o},O),t.onShown){if(!u.isFunction(t.onShown))throw new Error('Argument supplied to "onShown" must be a function');o.on("shown.bs.modal",t.onShown)}return!0===t.backdrop&&o.on("click.dismiss.bs.modal",function(t){o.children(".modal-backdrop").length&&(t.currentTarget=o.children(".modal-backdrop").get(0)),t.target===t.currentTarget&&o.trigger("escape.close.bb")}),o.on("escape.close.bb",function(t){l.onEscape&&g(t,o,l.onEscape)}),o.on("click",".modal-footer button:not(.disabled)",function(t){var e=u(this).data("bb-handler");e!==p&&g(t,o,l[e])}),o.on("click",".bootbox-close-button",function(t){g(t,o,l.onEscape)}),o.on("keyup",function(t){27===t.which&&o.trigger("escape.close.bb")}),u(t.container).append(o),o.modal({backdrop:t.backdrop,keyboard:!1,show:!1}),t.show&&o.modal("show"),o},d.alert=function(){var t=m("alert",["ok"],["message","callback"],arguments);if(t.callback&&!u.isFunction(t.callback))throw new Error('alert requires the "callback" property to be a function when provided');return t.buttons.ok.callback=t.onEscape=function(){return!u.isFunction(t.callback)||t.callback.call(this)},d.dialog(t)},d.confirm=function(){var t=m("confirm",["cancel","confirm"],["message","callback"],arguments);if(!u.isFunction(t.callback))throw new Error("confirm requires a callback");return t.buttons.cancel.callback=t.onEscape=function(){return t.callback.call(this,!1)},t.buttons.confirm.callback=function(){return t.callback.call(this,!0)},d.dialog(t)},d.prompt=function(){var e,r,t,o,a=u(b.form),n=m("prompt",["cancel","confirm"],["title","callback"],arguments);if(n.value||(n.value=f.value),n.inputType||(n.inputType=f.inputType),t=(n.show===p?f:n).show,n.show=!1,n.buttons.cancel.callback=n.onEscape=function(){return n.callback.call(this,null)},n.buttons.confirm.callback=function(){var t;if("checkbox"===n.inputType)t=r.find("input:checked").map(function(){return u(this).val()}).get();else if("radio"===n.inputType)t=r.find("input:checked").val();else{if(r[0].checkValidity&&!r[0].checkValidity())return!1;t="select"===n.inputType&&!0===n.multiple?r.find("option:selected").map(function(){return u(this).val()}).get():r.val()}return n.callback.call(this,t)},!n.title)throw new Error("prompt requires a title");if(!u.isFunction(n.callback))throw new Error("prompt requires a callback");if(!b.inputs[n.inputType])throw new Error("Invalid prompt type");switch(r=u(b.inputs[n.inputType]),n.inputType){case"text":case"textarea":case"email":case"password":r.val(n.value),n.placeholder&&r.attr("placeholder",n.placeholder),n.pattern&&r.attr("pattern",n.pattern),n.maxlength&&r.attr("maxlength",n.maxlength),n.required&&r.prop({required:!0}),n.rows&&!isNaN(parseInt(n.rows))&&"textarea"===n.inputType&&r.attr({rows:n.rows});break;case"date":case"time":case"number":case"range":if(r.val(n.value),n.placeholder&&r.attr("placeholder",n.placeholder),n.pattern&&r.attr("pattern",n.pattern),n.required&&r.prop({required:!0}),"date"!==n.inputType&&n.step){if(!("any"===n.step||!isNaN(n.step)&&0<parseFloat(n.step)))throw new Error('"step" must be a valid positive number or the value "any". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-step for more information.');r.attr("step",n.step)}!function(t,e,o){var a=!1,r=!0,n=!0;if("date"===t)e===p||(r=y(e))?o===p||(n=y(o))||console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your max value may not be enforced by this browser.'):console.warn('Browsers which natively support the "date" input type expect date values to be of the form "YYYY-MM-DD" (see ISO-8601 https://www.iso.org/iso-8601-date-and-time-format.html). Bootbox does not enforce this rule, but your min value may not be enforced by this browser.');else if("time"===t){if(e!==p&&!(r=N(e)))throw new Error('"min" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.');if(o!==p&&!(n=N(o)))throw new Error('"max" is not a valid time. See https://www.w3.org/TR/2012/WD-html-markup-20120315/datatypes.html#form.data.time for more information.')}else{if(e!==p&&isNaN(e))throw r=!1,new Error('"min" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-min for more information.');if(o!==p&&isNaN(o))throw n=!1,new Error('"max" must be a valid number. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.')}if(r&&n){if(o<=e)throw new Error('"max" must be greater than "min". See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-max for more information.');a=!0}return a}(n.inputType,n.min,n.max)||(n.min!==p&&r.attr("min",n.min),n.max!==p&&r.attr("max",n.max));break;case"select":var i={},l=n.inputOptions||[];if(!u.isArray(l))throw new Error("Please pass an array of input options");if(!l.length)throw new Error('prompt with "inputType" set to "select" requires at least one option');n.placeholder&&r.attr("placeholder",n.placeholder),n.required&&r.prop({required:!0}),n.multiple&&r.prop({multiple:!0}),C(l,function(t,e){var o=r;if(e.value===p||e.text===p)throw new Error('each option needs a "value" property and a "text" property');e.group&&(i[e.group]||(i[e.group]=u("<optgroup />").attr("label",e.group)),o=i[e.group]);var a=u(b.option);a.attr("value",e.value).text(e.text),o.append(a)}),C(i,function(t,e){r.append(e)}),r.val(n.value);break;case"checkbox":var s=u.isArray(n.value)?n.value:[n.value];if(!(l=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "checkbox" requires at least one option');r=u('<div class="bootbox-checkbox-list"></div>'),C(l,function(t,o){if(o.value===p||o.text===p)throw new Error('each option needs a "value" property and a "text" property');var a=u(b.inputs[n.inputType]);a.find("input").attr("value",o.value),a.find("label").append("\n"+o.text),C(s,function(t,e){e===o.value&&a.find("input").prop("checked",!0)}),r.append(a)});break;case"radio":if(n.value!==p&&u.isArray(n.value))throw new Error('prompt with "inputType" set to "radio" requires a single, non-array value for "value"');if(!(l=n.inputOptions||[]).length)throw new Error('prompt with "inputType" set to "radio" requires at least one option');r=u('<div class="bootbox-radiobutton-list"></div>');var c=!0;C(l,function(t,e){if(e.value===p||e.text===p)throw new Error('each option needs a "value" property and a "text" property');var o=u(b.inputs[n.inputType]);o.find("input").attr("value",e.value),o.find("label").append("\n"+e.text),n.value!==p&&e.value===n.value&&(o.find("input").prop("checked",!0),c=!1),r.append(o)}),c&&r.find('input[type="radio"]').first().prop("checked",!0)}return a.append(r),a.on("submit",function(t){t.preventDefault(),t.stopPropagation(),e.find(".bootbox-accept").trigger("click")}),""!==u.trim(n.message)&&(o=u(b.promptMessage).html(n.message),a.prepend(o)),n.message=a,(e=d.dialog(n)).off("shown.bs.modal",O),e.on("shown.bs.modal",function(){r.focus()}),!0===t&&e.modal("show"),e},d});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap={},t.jQuery,t.Popper)}(this,function(t,e,n){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var d=i(e),o=i(n);function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u="transitionend";function c(t){var e=this,n=!1;return d.default(this).one(f.TRANSITION_END,function(){n=!0}),setTimeout(function(){n||f.triggerTransitionEnd(e)},t),this}var f={TRANSITION_END:"bsTransitionEnd",getUID:function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");e&&"#"!==e||(e=(t=t.getAttribute("href"))&&"#"!==t?t.trim():"");try{return document.querySelector(e)?e:null}catch(t){return null}},getTransitionDurationFromElement:function(t){if(!t)return 0;var e=d.default(t).css("transition-duration"),n=d.default(t).css("transition-delay"),i=parseFloat(e),t=parseFloat(n);return i||t?(e=e.split(",")[0],n=n.split(",")[0],1e3*(parseFloat(e)+parseFloat(n))):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(t){d.default(t).trigger(u)},supportsTransitionEnd:function(){return Boolean(u)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,n){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var a=n[i],o=e[i],s=o&&f.isElement(o)?"element":null==(s=o)?""+s:{}.toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(a).test(s))throw new Error(t.toUpperCase()+': Option "'+i+'" provided type "'+s+'" but expected type "'+a+'".')}var s},findShadowRoot:function(t){if(!document.documentElement.attachShadow)return null;if("function"!=typeof t.getRootNode)return t instanceof ShadowRoot?t:t.parentNode?f.findShadowRoot(t.parentNode):null;t=t.getRootNode();return t instanceof ShadowRoot?t:null},jQueryDetection:function(){if(void 0===d.default)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var t=d.default.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1===t[0]&&9===t[1]&&t[2]<1||4<=t[0])throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};f.jQueryDetection(),d.default.fn.emulateTransitionEnd=c,d.default.event.special[f.TRANSITION_END]={bindType:u,delegateType:u,handle:function(t){if(d.default(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}};var h="alert",g="bs.alert",m=d.default.fn[h],_=function(){function i(t){this._element=t}var t=i.prototype;return t.close=function(t){var e=this._element;t&&(e=this._getRootElement(t)),this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},t.dispose=function(){d.default.removeData(this._element,g),this._element=null},t._getRootElement=function(t){var e=f.getSelectorFromElement(t),n=!1;return e&&(n=document.querySelector(e)),n=n||d.default(t).closest(".alert")[0]},t._triggerCloseEvent=function(t){var e=d.default.Event("close.bs.alert");return d.default(t).trigger(e),e},t._removeElement=function(e){var t,n=this;d.default(e).removeClass("show"),d.default(e).hasClass("fade")?(t=f.getTransitionDurationFromElement(e),d.default(e).one(f.TRANSITION_END,function(t){return n._destroyElement(e,t)}).emulateTransitionEnd(t)):this._destroyElement(e)},t._destroyElement=function(t){d.default(t).detach().trigger("closed.bs.alert").remove()},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(g);e||(e=new i(this),t.data(g,e)),"close"===n&&e[n](this)})},i._handleDismiss=function(e){return function(t){t&&t.preventDefault(),e.close(this)}},s(i,null,[{key:"VERSION",get:function(){return"4.6.1"}}]),i}();d.default(document).on("click.bs.alert.data-api",'[data-dismiss="alert"]',_._handleDismiss(new _)),d.default.fn[h]=_._jQueryInterface,d.default.fn[h].Constructor=_,d.default.fn[h].noConflict=function(){return d.default.fn[h]=m,_._jQueryInterface};var p="button",v="bs.button",e="."+v,n=".data-api",y=d.default.fn[p],b="active",E='[data-toggle^="button"]',T='input:not([type="hidden"])',w=".btn",C=function(){function a(t){this._element=t,this.shouldAvoidTriggerChange=!1}var t=a.prototype;return t.toggle=function(){var t,e=!0,n=!0,i=d.default(this._element).closest('[data-toggle="buttons"]')[0];!i||(t=this._element.querySelector(T))&&("radio"===t.type&&(t.checked&&this._element.classList.contains(b)?e=!1:(i=i.querySelector(".active"))&&d.default(i).removeClass(b)),e&&("checkbox"!==t.type&&"radio"!==t.type||(t.checked=!this._element.classList.contains(b)),this.shouldAvoidTriggerChange||d.default(t).trigger("change")),t.focus(),n=!1),this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(n&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(b)),e&&d.default(this._element).toggleClass(b))},t.dispose=function(){d.default.removeData(this._element,v),this._element=null},a._jQueryInterface=function(n,i){return this.each(function(){var t=d.default(this),e=t.data(v);e||(e=new a(this),t.data(v,e)),e.shouldAvoidTriggerChange=i,"toggle"===n&&e[n]()})},s(a,null,[{key:"VERSION",get:function(){return"4.6.1"}}]),a}();d.default(document).on("click.bs.button.data-api",E,function(t){var e,n=t.target,i=n;d.default(n).hasClass("btn")||(n=d.default(n).closest(w)[0]),!n||n.hasAttribute("disabled")||n.classList.contains("disabled")||(e=n.querySelector(T))&&(e.hasAttribute("disabled")||e.classList.contains("disabled"))?t.preventDefault():"INPUT"!==i.tagName&&"LABEL"===n.tagName||C._jQueryInterface.call(d.default(n),"toggle","INPUT"===i.tagName)}).on("focus.bs.button.data-api blur.bs.button.data-api",E,function(t){var e=d.default(t.target).closest(w)[0];d.default(e).toggleClass("focus",/^focus(in)?$/.test(t.type))}),d.default(window).on("load.bs.button.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),e=0,n=t.length;e<n;e++){var i=t[e],a=i.querySelector(T);a.checked||a.hasAttribute("checked")?i.classList.add(b):i.classList.remove(b)}for(var o=0,s=(t=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;o<s;o++){var l=t[o];"true"===l.getAttribute("aria-pressed")?l.classList.add(b):l.classList.remove(b)}}),d.default.fn[p]=C._jQueryInterface,d.default.fn[p].Constructor=C,d.default.fn[p].noConflict=function(){return d.default.fn[p]=y,C._jQueryInterface};var S="carousel",N="bs.carousel",D="."+N,e=".data-api",A=d.default.fn[S],I="active",k="next",O="prev",j="slid"+D,P=".active.carousel-item",L={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},R={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},x={TOUCH:"touch",PEN:"pen"},q=function(){function a(t,e){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(e),this._element=t,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||0<navigator.maxTouchPoints,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var t=a.prototype;return t.next=function(){this._isSliding||this._slide(k)},t.nextWhenVisible=function(){var t=d.default(this._element);!document.hidden&&t.is(":visible")&&"hidden"!==t.css("visibility")&&this.next()},t.prev=function(){this._isSliding||this._slide(O)},t.pause=function(t){t||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(f.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},t.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},t.to=function(t){var e=this;this._activeElement=this._element.querySelector(P);var n=this._getItemIndex(this._activeElement);if(!(t>this._items.length-1||t<0))if(this._isSliding)d.default(this._element).one(j,function(){return e.to(t)});else{if(n===t)return this.pause(),void this.cycle();n=n<t?k:O;this._slide(n,this._items[t])}},t.dispose=function(){d.default(this._element).off(D),d.default.removeData(this._element,N),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},t._getConfig=function(t){return t=l({},L,t),f.typeCheckConfig(S,t,R),t},t._handleSwipe=function(){var t=Math.abs(this.touchDeltaX);t<=40||(t=t/this.touchDeltaX,(this.touchDeltaX=0)<t&&this.prev(),t<0&&this.next())},t._addEventListeners=function(){var e=this;this._config.keyboard&&d.default(this._element).on("keydown.bs.carousel",function(t){return e._keydown(t)}),"hover"===this._config.pause&&d.default(this._element).on("mouseenter.bs.carousel",function(t){return e.pause(t)}).on("mouseleave.bs.carousel",function(t){return e.cycle(t)}),this._config.touch&&this._addTouchEventListeners()},t._addTouchEventListeners=function(){var t,e,n=this;this._touchSupported&&(t=function(t){n._pointerEvent&&x[t.originalEvent.pointerType.toUpperCase()]?n.touchStartX=t.originalEvent.clientX:n._pointerEvent||(n.touchStartX=t.originalEvent.touches[0].clientX)},e=function(t){n._pointerEvent&&x[t.originalEvent.pointerType.toUpperCase()]&&(n.touchDeltaX=t.originalEvent.clientX-n.touchStartX),n._handleSwipe(),"hover"===n._config.pause&&(n.pause(),n.touchTimeout&&clearTimeout(n.touchTimeout),n.touchTimeout=setTimeout(function(t){return n.cycle(t)},500+n._config.interval))},d.default(this._element.querySelectorAll(".carousel-item img")).on("dragstart.bs.carousel",function(t){return t.preventDefault()}),this._pointerEvent?(d.default(this._element).on("pointerdown.bs.carousel",t),d.default(this._element).on("pointerup.bs.carousel",e),this._element.classList.add("pointer-event")):(d.default(this._element).on("touchstart.bs.carousel",t),d.default(this._element).on("touchmove.bs.carousel",function(t){return t=t,void(n.touchDeltaX=t.originalEvent.touches&&1<t.originalEvent.touches.length?0:t.originalEvent.touches[0].clientX-n.touchStartX)}),d.default(this._element).on("touchend.bs.carousel",e)))},t._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next()}},t._getItemIndex=function(t){return this._items=t&&t.parentNode?[].slice.call(t.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(t)},t._getItemByDirection=function(t,e){var n=t===k,i=t===O,a=this._getItemIndex(e),o=this._items.length-1;if((i&&0===a||n&&a===o)&&!this._config.wrap)return e;t=(a+(t===O?-1:1))%this._items.length;return-1==t?this._items[this._items.length-1]:this._items[t]},t._triggerSlideEvent=function(t,e){var n=this._getItemIndex(t),i=this._getItemIndex(this._element.querySelector(P)),n=d.default.Event("slide.bs.carousel",{relatedTarget:t,direction:e,from:i,to:n});return d.default(this._element).trigger(n),n},t._setActiveIndicatorElement=function(t){var e;this._indicatorsElement&&(e=[].slice.call(this._indicatorsElement.querySelectorAll(".active")),d.default(e).removeClass(I),(t=this._indicatorsElement.children[this._getItemIndex(t)])&&d.default(t).addClass(I))},t._updateInterval=function(){var t=this._activeElement||this._element.querySelector(P);t&&((t=parseInt(t.getAttribute("data-interval"),10))?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=t):this._config.interval=this._config.defaultInterval||this._config.interval)},t._slide=function(t,e){var n,i,a,o=this,s=this._element.querySelector(P),l=this._getItemIndex(s),r=e||s&&this._getItemByDirection(t,s),u=this._getItemIndex(r),e=Boolean(this._interval),t=t===k?(n="carousel-item-left",i="carousel-item-next","left"):(n="carousel-item-right",i="carousel-item-prev","right");r&&d.default(r).hasClass(I)?this._isSliding=!1:this._triggerSlideEvent(r,t).isDefaultPrevented()||s&&r&&(this._isSliding=!0,e&&this.pause(),this._setActiveIndicatorElement(r),this._activeElement=r,a=d.default.Event(j,{relatedTarget:r,direction:t,from:l,to:u}),d.default(this._element).hasClass("slide")?(d.default(r).addClass(i),f.reflow(r),d.default(s).addClass(n),d.default(r).addClass(n),u=f.getTransitionDurationFromElement(s),d.default(s).one(f.TRANSITION_END,function(){d.default(r).removeClass(n+" "+i).addClass(I),d.default(s).removeClass(I+" "+i+" "+n),o._isSliding=!1,setTimeout(function(){return d.default(o._element).trigger(a)},0)}).emulateTransitionEnd(u)):(d.default(s).removeClass(I),d.default(r).addClass(I),this._isSliding=!1,d.default(this._element).trigger(a)),e&&this.cycle())},a._jQueryInterface=function(i){return this.each(function(){var t=d.default(this).data(N),e=l({},L,d.default(this).data());"object"==typeof i&&(e=l({},e,i));var n="string"==typeof i?i:e.slide;if(t||(t=new a(this,e),d.default(this).data(N,t)),"number"==typeof i)t.to(i);else if("string"==typeof n){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n]()}else e.interval&&e.ride&&(t.pause(),t.cycle())})},a._dataApiClickHandler=function(t){var e,n,i=f.getSelectorFromElement(this);!i||(e=d.default(i)[0])&&d.default(e).hasClass("carousel")&&(n=l({},d.default(e).data(),d.default(this).data()),(i=this.getAttribute("data-slide-to"))&&(n.interval=!1),a._jQueryInterface.call(d.default(e),n),i&&d.default(e).data(N).to(i),t.preventDefault())},s(a,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return L}}]),a}();d.default(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",q._dataApiClickHandler),d.default(window).on("load.bs.carousel.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),e=0,n=t.length;e<n;e++){var i=d.default(t[e]);q._jQueryInterface.call(i,i.data())}}),d.default.fn[S]=q._jQueryInterface,d.default.fn[S].Constructor=q,d.default.fn[S].noConflict=function(){return d.default.fn[S]=A,q._jQueryInterface};var F="collapse",Q="bs.collapse",n="."+Q,B=d.default.fn[F],H="show",U="collapse",M="collapsing",W="collapsed",V='[data-toggle="collapse"]',z={toggle:!0,parent:""},K={toggle:"boolean",parent:"(string|element)"},X=function(){function o(e,t){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(t),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var n=[].slice.call(document.querySelectorAll(V)),i=0,a=n.length;i<a;i++){var o=n[i],s=f.getSelectorFromElement(o),l=[].slice.call(document.querySelectorAll(s)).filter(function(t){return t===e});null!==s&&0<l.length&&(this._selector=s,this._triggerArray.push(o))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var t=o.prototype;return t.toggle=function(){d.default(this._element).hasClass(H)?this.hide():this.show()},t.show=function(){var t,e,n,i,a=this;this._isTransitioning||d.default(this._element).hasClass(H)||(this._parent&&0===(i=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(t){return"string"==typeof a._config.parent?t.getAttribute("data-parent")===a._config.parent:t.classList.contains(U)})).length&&(i=null),i&&(n=d.default(i).not(this._selector).data(Q))&&n._isTransitioning||(t=d.default.Event("show.bs.collapse"),d.default(this._element).trigger(t),t.isDefaultPrevented()||(i&&(o._jQueryInterface.call(d.default(i).not(this._selector),"hide"),n||d.default(i).data(Q,null)),e=this._getDimension(),d.default(this._element).removeClass(U).addClass(M),this._element.style[e]=0,this._triggerArray.length&&d.default(this._triggerArray).removeClass(W).attr("aria-expanded",!0),this.setTransitioning(!0),n="scroll"+(e[0].toUpperCase()+e.slice(1)),i=f.getTransitionDurationFromElement(this._element),d.default(this._element).one(f.TRANSITION_END,function(){d.default(a._element).removeClass(M).addClass(U+" "+H),a._element.style[e]="",a.setTransitioning(!1),d.default(a._element).trigger("shown.bs.collapse")}).emulateTransitionEnd(i),this._element.style[e]=this._element[n]+"px")))},t.hide=function(){var t=this;if(!this._isTransitioning&&d.default(this._element).hasClass(H)){var e=d.default.Event("hide.bs.collapse");if(d.default(this._element).trigger(e),!e.isDefaultPrevented()){e=this._getDimension();this._element.style[e]=this._element.getBoundingClientRect()[e]+"px",f.reflow(this._element),d.default(this._element).addClass(M).removeClass(U+" "+H);var n=this._triggerArray.length;if(0<n)for(var i=0;i<n;i++){var a=this._triggerArray[i],o=f.getSelectorFromElement(a);null!==o&&(d.default([].slice.call(document.querySelectorAll(o))).hasClass(H)||d.default(a).addClass(W).attr("aria-expanded",!1))}this.setTransitioning(!0);this._element.style[e]="";e=f.getTransitionDurationFromElement(this._element);d.default(this._element).one(f.TRANSITION_END,function(){t.setTransitioning(!1),d.default(t._element).removeClass(M).addClass(U).trigger("hidden.bs.collapse")}).emulateTransitionEnd(e)}}},t.setTransitioning=function(t){this._isTransitioning=t},t.dispose=function(){d.default.removeData(this._element,Q),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},t._getConfig=function(t){return(t=l({},z,t)).toggle=Boolean(t.toggle),f.typeCheckConfig(F,t,K),t},t._getDimension=function(){return d.default(this._element).hasClass("width")?"width":"height"},t._getParent=function(){var t,n=this;f.isElement(this._config.parent)?(t=this._config.parent,void 0!==this._config.parent.jquery&&(t=this._config.parent[0])):t=document.querySelector(this._config.parent);var e='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',e=[].slice.call(t.querySelectorAll(e));return d.default(e).each(function(t,e){n._addAriaAndCollapsedClass(o._getTargetFromElement(e),[e])}),t},t._addAriaAndCollapsedClass=function(t,e){t=d.default(t).hasClass(H);e.length&&d.default(e).toggleClass(W,!t).attr("aria-expanded",t)},o._getTargetFromElement=function(t){t=f.getSelectorFromElement(t);return t?document.querySelector(t):null},o._jQueryInterface=function(i){return this.each(function(){var t=d.default(this),e=t.data(Q),n=l({},z,t.data(),"object"==typeof i&&i?i:{});if(!e&&n.toggle&&"string"==typeof i&&/show|hide/.test(i)&&(n.toggle=!1),e||(e=new o(this,n),t.data(Q,e)),"string"==typeof i){if(void 0===e[i])throw new TypeError('No method named "'+i+'"');e[i]()}})},s(o,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return z}}]),o}();d.default(document).on("click.bs.collapse.data-api",V,function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var n=d.default(this),t=f.getSelectorFromElement(this),t=[].slice.call(document.querySelectorAll(t));d.default(t).each(function(){var t=d.default(this),e=t.data(Q)?"toggle":n.data();X._jQueryInterface.call(t,e)})}),d.default.fn[F]=X._jQueryInterface,d.default.fn[F].Constructor=X,d.default.fn[F].noConflict=function(){return d.default.fn[F]=B,X._jQueryInterface};var Y="dropdown",$="bs.dropdown",J="."+$,E=".data-api",G=d.default.fn[Y],Z=new RegExp("38|40|27"),tt="disabled",et="show",nt="dropdown-menu-right",it="hide"+J,at="hidden"+J,e="click"+J+E,n="keydown"+J+E,ot='[data-toggle="dropdown"]',st=".dropdown-menu",lt={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},rt={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},ut=function(){function u(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t=u.prototype;return t.toggle=function(){var t;this._element.disabled||d.default(this._element).hasClass(tt)||(t=d.default(this._menu).hasClass(et),u._clearMenus(),t||this.show(!0))},t.show=function(t){if(void 0===t&&(t=!1),!(this._element.disabled||d.default(this._element).hasClass(tt)||d.default(this._menu).hasClass(et))){var e={relatedTarget:this._element},n=d.default.Event("show.bs.dropdown",e),i=u._getParentFromElement(this._element);if(d.default(i).trigger(n),!n.isDefaultPrevented()){if(!this._inNavbar&&t){if(void 0===o.default)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");t=this._element;"parent"===this._config.reference?t=i:f.isElement(this._config.reference)&&(t=this._config.reference,void 0!==this._config.reference.jquery&&(t=this._config.reference[0])),"scrollParent"!==this._config.boundary&&d.default(i).addClass("position-static"),this._popper=new o.default(t,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===d.default(i).closest(".navbar-nav").length&&d.default(document.body).children().on("mouseover",null,d.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),d.default(this._menu).toggleClass(et),d.default(i).toggleClass(et).trigger(d.default.Event("shown.bs.dropdown",e))}}},t.hide=function(){var t,e,n;this._element.disabled||d.default(this._element).hasClass(tt)||!d.default(this._menu).hasClass(et)||(t={relatedTarget:this._element},e=d.default.Event(it,t),n=u._getParentFromElement(this._element),d.default(n).trigger(e),e.isDefaultPrevented()||(this._popper&&this._popper.destroy(),d.default(this._menu).toggleClass(et),d.default(n).toggleClass(et).trigger(d.default.Event(at,t))))},t.dispose=function(){d.default.removeData(this._element,$),d.default(this._element).off(J),this._element=null,(this._menu=null)!==this._popper&&(this._popper.destroy(),this._popper=null)},t.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},t._addEventListeners=function(){var e=this;d.default(this._element).on("click.bs.dropdown",function(t){t.preventDefault(),t.stopPropagation(),e.toggle()})},t._getConfig=function(t){return t=l({},this.constructor.Default,d.default(this._element).data(),t),f.typeCheckConfig(Y,t,this.constructor.DefaultType),t},t._getMenuElement=function(){var t;return this._menu||(t=u._getParentFromElement(this._element))&&(this._menu=t.querySelector(st)),this._menu},t._getPlacement=function(){var t=d.default(this._element.parentNode),e="bottom-start";return t.hasClass("dropup")?e=d.default(this._menu).hasClass(nt)?"top-end":"top-start":t.hasClass("dropright")?e="right-start":t.hasClass("dropleft")?e="left-start":d.default(this._menu).hasClass(nt)&&(e="bottom-end"),e},t._detectNavbar=function(){return 0<d.default(this._element).closest(".navbar").length},t._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e._config.offset(t.offsets,e._element)),t}:t.offset=this._config.offset,t},t._getPopperConfig=function(){var t={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(t.modifiers.applyStyle={enabled:!1}),l({},t,this._config.popperConfig)},u._jQueryInterface=function(e){return this.each(function(){var t=d.default(this).data($);if(t||(t=new u(this,"object"==typeof e?e:null),d.default(this).data($,t)),"string"==typeof e){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}})},u._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var e=[].slice.call(document.querySelectorAll(ot)),n=0,i=e.length;n<i;n++){var a,o,s=u._getParentFromElement(e[n]),l=d.default(e[n]).data($),r={relatedTarget:e[n]};t&&"click"===t.type&&(r.clickEvent=t),l&&(a=l._menu,d.default(s).hasClass(et)&&(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&d.default.contains(s,t.target)||(o=d.default.Event(it,r),d.default(s).trigger(o),o.isDefaultPrevented()||("ontouchstart"in document.documentElement&&d.default(document.body).children().off("mouseover",null,d.default.noop),e[n].setAttribute("aria-expanded","false"),l._popper&&l._popper.destroy(),d.default(a).removeClass(et),d.default(s).removeClass(et).trigger(d.default.Event(at,r))))))}},u._getParentFromElement=function(t){var e,n=f.getSelectorFromElement(t);return n&&(e=document.querySelector(n)),e||t.parentNode},u._dataApiKeydownHandler=function(t){if((/input|textarea/i.test(t.target.tagName)?!(32===t.which||27!==t.which&&(40!==t.which&&38!==t.which||d.default(t.target).closest(st).length)):Z.test(t.which))&&!this.disabled&&!d.default(this).hasClass(tt)){var e=u._getParentFromElement(this),n=d.default(e).hasClass(et);if(n||27!==t.which){if(t.preventDefault(),t.stopPropagation(),!n||27===t.which||32===t.which)return 27===t.which&&d.default(e.querySelector(ot)).trigger("focus"),void d.default(this).trigger("click");n=[].slice.call(e.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(t){return d.default(t).is(":visible")});0!==n.length&&(e=n.indexOf(t.target),38===t.which&&0<e&&e--,40===t.which&&e<n.length-1&&e++,e<0&&(e=0),n[e].focus())}}},s(u,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return lt}},{key:"DefaultType",get:function(){return rt}}]),u}();d.default(document).on(n,ot,ut._dataApiKeydownHandler).on(n,st,ut._dataApiKeydownHandler).on(e+" keyup.bs.dropdown.data-api",ut._clearMenus).on(e,ot,function(t){t.preventDefault(),t.stopPropagation(),ut._jQueryInterface.call(d.default(this),"toggle")}).on(e,".dropdown form",function(t){t.stopPropagation()}),d.default.fn[Y]=ut._jQueryInterface,d.default.fn[Y].Constructor=ut,d.default.fn[Y].noConflict=function(){return d.default.fn[Y]=G,ut._jQueryInterface};var dt="modal",ct="bs.modal",ft="."+ct,ht=d.default.fn[dt],gt="modal-open",mt="fade",_t="show",pt="modal-static",vt="hidden"+ft,yt="show"+ft,bt="focusin"+ft,Et="resize"+ft,Tt="click.dismiss"+ft,wt="keydown.dismiss"+ft,Ct="mousedown.dismiss"+ft,St=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Nt=".sticky-top",Dt={backdrop:!0,keyboard:!0,focus:!0,show:!0},At={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},It=function(){function a(t,e){this._config=this._getConfig(e),this._element=t,this._dialog=t.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t=a.prototype;return t.toggle=function(t){return this._isShown?this.hide():this.show(t)},t.show=function(t){var e,n=this;this._isShown||this._isTransitioning||(e=d.default.Event(yt,{relatedTarget:t}),d.default(this._element).trigger(e),e.isDefaultPrevented()||(this._isShown=!0,d.default(this._element).hasClass(mt)&&(this._isTransitioning=!0),this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),d.default(this._element).on(Tt,'[data-dismiss="modal"]',function(t){return n.hide(t)}),d.default(this._dialog).on(Ct,function(){d.default(n._element).one("mouseup.dismiss.bs.modal",function(t){d.default(t.target).is(n._element)&&(n._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return n._showElement(t)})))},t.hide=function(t){var e=this;t&&t.preventDefault(),this._isShown&&!this._isTransitioning&&(t=d.default.Event("hide.bs.modal"),d.default(this._element).trigger(t),this._isShown&&!t.isDefaultPrevented()&&(this._isShown=!1,(t=d.default(this._element).hasClass(mt))&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),d.default(document).off(bt),d.default(this._element).removeClass(_t),d.default(this._element).off(Tt),d.default(this._dialog).off(Ct),t?(t=f.getTransitionDurationFromElement(this._element),d.default(this._element).one(f.TRANSITION_END,function(t){return e._hideModal(t)}).emulateTransitionEnd(t)):this._hideModal()))},t.dispose=function(){[window,this._element,this._dialog].forEach(function(t){return d.default(t).off(ft)}),d.default(document).off(bt),d.default.removeData(this._element,ct),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},t.handleUpdate=function(){this._adjustDialog()},t._getConfig=function(t){return t=l({},Dt,t),f.typeCheckConfig(dt,t,At),t},t._triggerBackdropTransition=function(){var t,e,n=this,i=d.default.Event("hidePrevented.bs.modal");d.default(this._element).trigger(i),i.isDefaultPrevented()||((t=this._element.scrollHeight>document.documentElement.clientHeight)||(this._element.style.overflowY="hidden"),this._element.classList.add(pt),e=f.getTransitionDurationFromElement(this._dialog),d.default(this._element).off(f.TRANSITION_END),d.default(this._element).one(f.TRANSITION_END,function(){n._element.classList.remove(pt),t||d.default(n._element).one(f.TRANSITION_END,function(){n._element.style.overflowY=""}).emulateTransitionEnd(n._element,e)}).emulateTransitionEnd(e),this._element.focus())},t._showElement=function(t){var e=this,n=d.default(this._element).hasClass(mt),i=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),d.default(this._dialog).hasClass("modal-dialog-scrollable")&&i?i.scrollTop=0:this._element.scrollTop=0,n&&f.reflow(this._element),d.default(this._element).addClass(_t),this._config.focus&&this._enforceFocus();var a=d.default.Event("shown.bs.modal",{relatedTarget:t}),t=function(){e._config.focus&&e._element.focus(),e._isTransitioning=!1,d.default(e._element).trigger(a)};n?(n=f.getTransitionDurationFromElement(this._dialog),d.default(this._dialog).one(f.TRANSITION_END,t).emulateTransitionEnd(n)):t()},t._enforceFocus=function(){var e=this;d.default(document).off(bt).on(bt,function(t){document!==t.target&&e._element!==t.target&&0===d.default(e._element).has(t.target).length&&e._element.focus()})},t._setEscapeEvent=function(){var e=this;this._isShown?d.default(this._element).on(wt,function(t){e._config.keyboard&&27===t.which?(t.preventDefault(),e.hide()):e._config.keyboard||27!==t.which||e._triggerBackdropTransition()}):this._isShown||d.default(this._element).off(wt)},t._setResizeEvent=function(){var e=this;this._isShown?d.default(window).on(Et,function(t){return e.handleUpdate(t)}):d.default(window).off(Et)},t._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){d.default(document.body).removeClass(gt),t._resetAdjustments(),t._resetScrollbar(),d.default(t._element).trigger(vt)})},t._removeBackdrop=function(){this._backdrop&&(d.default(this._backdrop).remove(),this._backdrop=null)},t._showBackdrop=function(t){var e,n=this,i=d.default(this._element).hasClass(mt)?mt:"";this._isShown&&this._config.backdrop?(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&this._backdrop.classList.add(i),d.default(this._backdrop).appendTo(document.body),d.default(this._element).on(Tt,function(t){n._ignoreBackdropClick?n._ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"===n._config.backdrop?n._triggerBackdropTransition():n.hide())}),i&&f.reflow(this._backdrop),d.default(this._backdrop).addClass(_t),t&&(i?(e=f.getTransitionDurationFromElement(this._backdrop),d.default(this._backdrop).one(f.TRANSITION_END,t).emulateTransitionEnd(e)):t())):!this._isShown&&this._backdrop?(d.default(this._backdrop).removeClass(_t),i=function(){n._removeBackdrop(),t&&t()},d.default(this._element).hasClass(mt)?(e=f.getTransitionDurationFromElement(this._backdrop),d.default(this._backdrop).one(f.TRANSITION_END,i).emulateTransitionEnd(e)):i()):t&&t()},t._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},t._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},t._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(t.left+t.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},t._setScrollbar=function(){var t,e,a=this;this._isBodyOverflowing&&(t=[].slice.call(document.querySelectorAll(St)),e=[].slice.call(document.querySelectorAll(Nt)),d.default(t).each(function(t,e){var n=e.style.paddingRight,i=d.default(e).css("padding-right");d.default(e).data("padding-right",n).css("padding-right",parseFloat(i)+a._scrollbarWidth+"px")}),d.default(e).each(function(t,e){var n=e.style.marginRight,i=d.default(e).css("margin-right");d.default(e).data("margin-right",n).css("margin-right",parseFloat(i)-a._scrollbarWidth+"px")}),t=document.body.style.paddingRight,e=d.default(document.body).css("padding-right"),d.default(document.body).data("padding-right",t).css("padding-right",parseFloat(e)+this._scrollbarWidth+"px")),d.default(document.body).addClass(gt)},t._resetScrollbar=function(){var t=[].slice.call(document.querySelectorAll(St));d.default(t).each(function(t,e){var n=d.default(e).data("padding-right");d.default(e).removeData("padding-right"),e.style.paddingRight=n||""});t=[].slice.call(document.querySelectorAll(Nt));d.default(t).each(function(t,e){var n=d.default(e).data("margin-right");void 0!==n&&d.default(e).css("margin-right",n).removeData("margin-right")});t=d.default(document.body).data("padding-right");d.default(document.body).removeData("padding-right"),document.body.style.paddingRight=t||""},t._getScrollbarWidth=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},a._jQueryInterface=function(n,i){return this.each(function(){var t=d.default(this).data(ct),e=l({},Dt,d.default(this).data(),"object"==typeof n&&n?n:{});if(t||(t=new a(this,e),d.default(this).data(ct,t)),"string"==typeof n){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n](i)}else e.show&&t.show(i)})},s(a,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return Dt}}]),a}();d.default(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var e,n=this,i=f.getSelectorFromElement(this);i&&(e=document.querySelector(i));i=d.default(e).data(ct)?"toggle":l({},d.default(e).data(),d.default(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault();var a=d.default(e).one(yt,function(t){t.isDefaultPrevented()||a.one(vt,function(){d.default(n).is(":visible")&&n.focus()})});It._jQueryInterface.call(d.default(e),i,this)}),d.default.fn[dt]=It._jQueryInterface,d.default.fn[dt].Constructor=It,d.default.fn[dt].noConflict=function(){return d.default.fn[dt]=ht,It._jQueryInterface};var kt=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],e={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ot=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,jt=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function Pt(t,a,e){if(0===t.length)return t;if(e&&"function"==typeof e)return e(t);for(var t=(new window.DOMParser).parseFromString(t,"text/html"),o=Object.keys(a),s=[].slice.call(t.body.querySelectorAll("*")),n=function(t){var e=s[t],n=e.nodeName.toLowerCase();if(-1===o.indexOf(e.nodeName.toLowerCase()))return e.parentNode.removeChild(e),"continue";var t=[].slice.call(e.attributes),i=[].concat(a["*"]||[],a[n]||[]);t.forEach(function(t){!function(t,e){var n=t.nodeName.toLowerCase();if(-1!==e.indexOf(n))return-1===kt.indexOf(n)||Boolean(Ot.test(t.nodeValue)||jt.test(t.nodeValue));for(var i=e.filter(function(t){return t instanceof RegExp}),a=0,o=i.length;a<o;a++)if(i[a].test(n))return 1}(t,i)&&e.removeAttribute(t.nodeName)})},i=0,l=s.length;i<l;i++)n(i);return t.body.innerHTML}var Lt="tooltip",Rt="bs.tooltip",xt="."+Rt,qt=d.default.fn[Lt],Ft="bs-tooltip",Qt=new RegExp("(^|\\s)"+Ft+"\\S+","g"),Bt=["sanitize","whiteList","sanitizeFn"],Ht="fade",Ut="show",Mt="show",Wt="hover",Vt="focus",zt={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},Kt={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",customClass:"",sanitize:!0,sanitizeFn:null,whiteList:e,popperConfig:null},Xt={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Yt={HIDE:"hide"+xt,HIDDEN:"hidden"+xt,SHOW:"show"+xt,SHOWN:"shown"+xt,INSERTED:"inserted"+xt,CLICK:"click"+xt,FOCUSIN:"focusin"+xt,FOCUSOUT:"focusout"+xt,MOUSEENTER:"mouseenter"+xt,MOUSELEAVE:"mouseleave"+xt},$t=function(){function a(t,e){if(void 0===o.default)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var t=a.prototype;return t.enable=function(){this._isEnabled=!0},t.disable=function(){this._isEnabled=!1},t.toggleEnabled=function(){this._isEnabled=!this._isEnabled},t.toggle=function(t){var e,n;this._isEnabled&&(t?(e=this.constructor.DATA_KEY,(n=d.default(t.currentTarget).data(e))||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(e,n)),n._activeTrigger.click=!n._activeTrigger.click,n._isWithActiveTrigger()?n._enter(null,n):n._leave(null,n)):d.default(this.getTipElement()).hasClass(Ut)?this._leave(null,this):this._enter(null,this))},t.dispose=function(){clearTimeout(this._timeout),d.default.removeData(this.element,this.constructor.DATA_KEY),d.default(this.element).off(this.constructor.EVENT_KEY),d.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&d.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},t.show=function(){var e=this;if("none"===d.default(this.element).css("display"))throw new Error("Please use show on visible elements");var t,n,i=d.default.Event(this.constructor.Event.SHOW);this.isWithContent()&&this._isEnabled&&(d.default(this.element).trigger(i),n=f.findShadowRoot(this.element),t=d.default.contains(null!==n?n:this.element.ownerDocument.documentElement,this.element),!i.isDefaultPrevented()&&t&&(n=this.getTipElement(),i=f.getUID(this.constructor.NAME),n.setAttribute("id",i),this.element.setAttribute("aria-describedby",i),this.setContent(),this.config.animation&&d.default(n).addClass(Ht),t="function"==typeof this.config.placement?this.config.placement.call(this,n,this.element):this.config.placement,i=this._getAttachment(t),this.addAttachmentClass(i),t=this._getContainer(),d.default(n).data(this.constructor.DATA_KEY,this),d.default.contains(this.element.ownerDocument.documentElement,this.tip)||d.default(n).appendTo(t),d.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new o.default(this.element,n,this._getPopperConfig(i)),d.default(n).addClass(Ut),d.default(n).addClass(this.config.customClass),"ontouchstart"in document.documentElement&&d.default(document.body).children().on("mouseover",null,d.default.noop),i=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,d.default(e.element).trigger(e.constructor.Event.SHOWN),"out"===t&&e._leave(null,e)},d.default(this.tip).hasClass(Ht)?(n=f.getTransitionDurationFromElement(this.tip),d.default(this.tip).one(f.TRANSITION_END,i).emulateTransitionEnd(n)):i()))},t.hide=function(t){function e(){n._hoverState!==Mt&&i.parentNode&&i.parentNode.removeChild(i),n._cleanTipClass(),n.element.removeAttribute("aria-describedby"),d.default(n.element).trigger(n.constructor.Event.HIDDEN),null!==n._popper&&n._popper.destroy(),t&&t()}var n=this,i=this.getTipElement(),a=d.default.Event(this.constructor.Event.HIDE);d.default(this.element).trigger(a),a.isDefaultPrevented()||(d.default(i).removeClass(Ut),"ontouchstart"in document.documentElement&&d.default(document.body).children().off("mouseover",null,d.default.noop),this._activeTrigger.click=!1,this._activeTrigger[Vt]=!1,this._activeTrigger[Wt]=!1,d.default(this.tip).hasClass(Ht)?(a=f.getTransitionDurationFromElement(i),d.default(i).one(f.TRANSITION_END,e).emulateTransitionEnd(a)):e(),this._hoverState="")},t.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},t.isWithContent=function(){return Boolean(this.getTitle())},t.addAttachmentClass=function(t){d.default(this.getTipElement()).addClass(Ft+"-"+t)},t.getTipElement=function(){return this.tip=this.tip||d.default(this.config.template)[0],this.tip},t.setContent=function(){var t=this.getTipElement();this.setElementContent(d.default(t.querySelectorAll(".tooltip-inner")),this.getTitle()),d.default(t).removeClass(Ht+" "+Ut)},t.setElementContent=function(t,e){"object"!=typeof e||!e.nodeType&&!e.jquery?this.config.html?(this.config.sanitize&&(e=Pt(e,this.config.whiteList,this.config.sanitizeFn)),t.html(e)):t.text(e):this.config.html?d.default(e).parent().is(t)||t.empty().append(e):t.text(d.default(e).text())},t.getTitle=function(){return this.element.getAttribute("data-original-title")||("function"==typeof this.config.title?this.config.title.call(this.element):this.config.title)},t._getPopperConfig=function(t){var e=this;return l({},{placement:t,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){return e._handlePopperPlacementChange(t)}},this.config.popperConfig)},t._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e.config.offset(t.offsets,e.element)),t}:t.offset=this.config.offset,t},t._getContainer=function(){return!1===this.config.container?document.body:f.isElement(this.config.container)?d.default(this.config.container):d.default(document).find(this.config.container)},t._getAttachment=function(t){return zt[t.toUpperCase()]},t._setListeners=function(){var n=this;this.config.trigger.split(" ").forEach(function(t){var e;"click"===t?d.default(n.element).on(n.constructor.Event.CLICK,n.config.selector,function(t){return n.toggle(t)}):"manual"!==t&&(e=t===Wt?n.constructor.Event.MOUSEENTER:n.constructor.Event.FOCUSIN,t=t===Wt?n.constructor.Event.MOUSELEAVE:n.constructor.Event.FOCUSOUT,d.default(n.element).on(e,n.config.selector,function(t){return n._enter(t)}).on(t,n.config.selector,function(t){return n._leave(t)}))}),this._hideModalHandler=function(){n.element&&n.hide()},d.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=l({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},t._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");!this.element.getAttribute("title")&&"string"==t||(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},t._enter=function(t,e){var n=this.constructor.DATA_KEY;(e=e||d.default(t.currentTarget).data(n))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(n,e)),t&&(e._activeTrigger["focusin"===t.type?Vt:Wt]=!0),d.default(e.getTipElement()).hasClass(Ut)||e._hoverState===Mt?e._hoverState=Mt:(clearTimeout(e._timeout),e._hoverState=Mt,e.config.delay&&e.config.delay.show?e._timeout=setTimeout(function(){e._hoverState===Mt&&e.show()},e.config.delay.show):e.show())},t._leave=function(t,e){var n=this.constructor.DATA_KEY;(e=e||d.default(t.currentTarget).data(n))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),d.default(t.currentTarget).data(n,e)),t&&(e._activeTrigger["focusout"===t.type?Vt:Wt]=!1),e._isWithActiveTrigger()||(clearTimeout(e._timeout),e._hoverState="out",e.config.delay&&e.config.delay.hide?e._timeout=setTimeout(function(){"out"===e._hoverState&&e.hide()},e.config.delay.hide):e.hide())},t._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},t._getConfig=function(t){var e=d.default(this.element).data();return Object.keys(e).forEach(function(t){-1!==Bt.indexOf(t)&&delete e[t]}),"number"==typeof(t=l({},this.constructor.Default,e,"object"==typeof t&&t?t:{})).delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),f.typeCheckConfig(Lt,t,this.constructor.DefaultType),t.sanitize&&(t.template=Pt(t.template,t.whiteList,t.sanitizeFn)),t},t._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},t._cleanTipClass=function(){var t=d.default(this.getTipElement()),e=t.attr("class").match(Qt);null!==e&&e.length&&t.removeClass(e.join(""))},t._handlePopperPlacementChange=function(t){this.tip=t.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},t._fixTransition=function(){var t=this.getTipElement(),e=this.config.animation;null===t.getAttribute("x-placement")&&(d.default(t).removeClass(Ht),this.config.animation=!1,this.hide(),this.show(),this.config.animation=e)},a._jQueryInterface=function(i){return this.each(function(){var t=d.default(this),e=t.data(Rt),n="object"==typeof i&&i;if((e||!/dispose|hide/.test(i))&&(e||(e=new a(this,n),t.data(Rt,e)),"string"==typeof i)){if(void 0===e[i])throw new TypeError('No method named "'+i+'"');e[i]()}})},s(a,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return Kt}},{key:"NAME",get:function(){return Lt}},{key:"DATA_KEY",get:function(){return Rt}},{key:"Event",get:function(){return Yt}},{key:"EVENT_KEY",get:function(){return xt}},{key:"DefaultType",get:function(){return Xt}}]),a}();d.default.fn[Lt]=$t._jQueryInterface,d.default.fn[Lt].Constructor=$t,d.default.fn[Lt].noConflict=function(){return d.default.fn[Lt]=qt,$t._jQueryInterface};var Jt="popover",Gt="bs.popover",Zt="."+Gt,te=d.default.fn[Jt],ee="bs-popover",ne=new RegExp("(^|\\s)"+ee+"\\S+","g"),ie=l({},$t.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),ae=l({},$t.DefaultType,{content:"(string|element|function)"}),oe={HIDE:"hide"+Zt,HIDDEN:"hidden"+Zt,SHOW:"show"+Zt,SHOWN:"shown"+Zt,INSERTED:"inserted"+Zt,CLICK:"click"+Zt,FOCUSIN:"focusin"+Zt,FOCUSOUT:"focusout"+Zt,MOUSEENTER:"mouseenter"+Zt,MOUSELEAVE:"mouseleave"+Zt},se=function(t){var e;function i(){return t.apply(this,arguments)||this}n=t,(e=i).prototype=Object.create(n.prototype),r(e.prototype.constructor=e,n);var n=i.prototype;return n.isWithContent=function(){return this.getTitle()||this._getContent()},n.addAttachmentClass=function(t){d.default(this.getTipElement()).addClass(ee+"-"+t)},n.getTipElement=function(){return this.tip=this.tip||d.default(this.config.template)[0],this.tip},n.setContent=function(){var t=d.default(this.getTipElement());this.setElementContent(t.find(".popover-header"),this.getTitle());var e=this._getContent();"function"==typeof e&&(e=e.call(this.element)),this.setElementContent(t.find(".popover-body"),e),t.removeClass("fade show")},n._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},n._cleanTipClass=function(){var t=d.default(this.getTipElement()),e=t.attr("class").match(ne);null!==e&&0<e.length&&t.removeClass(e.join(""))},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this).data(Gt),e="object"==typeof n?n:null;if((t||!/dispose|hide/.test(n))&&(t||(t=new i(this,e),d.default(this).data(Gt,t)),"string"==typeof n)){if(void 0===t[n])throw new TypeError('No method named "'+n+'"');t[n]()}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return ie}},{key:"NAME",get:function(){return Jt}},{key:"DATA_KEY",get:function(){return Gt}},{key:"Event",get:function(){return oe}},{key:"EVENT_KEY",get:function(){return Zt}},{key:"DefaultType",get:function(){return ae}}]),i}($t);d.default.fn[Jt]=se._jQueryInterface,d.default.fn[Jt].Constructor=se,d.default.fn[Jt].noConflict=function(){return d.default.fn[Jt]=te,se._jQueryInterface};var le="scrollspy",re="bs.scrollspy",ue="."+re,de=d.default.fn[le],ce="active",fe="position",he=".nav, .list-group",ge=".nav-link",me=".list-group-item",_e={offset:10,method:"auto",target:""},pe={offset:"number",method:"string",target:"(string|element)"},ve=function(){function n(t,e){var n=this;this._element=t,this._scrollElement="BODY"===t.tagName?window:t,this._config=this._getConfig(e),this._selector=this._config.target+" "+ge+","+this._config.target+" "+me+","+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,d.default(this._scrollElement).on("scroll.bs.scrollspy",function(t){return n._process(t)}),this.refresh(),this._process()}var t=n.prototype;return t.refresh=function(){var e=this,t=this._scrollElement===this._scrollElement.window?"offset":fe,i="auto"===this._config.method?t:this._config.method,a=i===fe?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(t){var e,n=f.getSelectorFromElement(t);if(n&&(e=document.querySelector(n)),e){t=e.getBoundingClientRect();if(t.width||t.height)return[d.default(e)[i]().top+a,n]}return null}).filter(function(t){return t}).sort(function(t,e){return t[0]-e[0]}).forEach(function(t){e._offsets.push(t[0]),e._targets.push(t[1])})},t.dispose=function(){d.default.removeData(this._element,re),d.default(this._scrollElement).off(ue),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},t._getConfig=function(t){var e;return"string"!=typeof(t=l({},_e,"object"==typeof t&&t?t:{})).target&&f.isElement(t.target)&&((e=d.default(t.target).attr("id"))||(e=f.getUID(le),d.default(t.target).attr("id",e)),t.target="#"+e),f.typeCheckConfig(le,t,pe),t},t._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},t._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},t._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},t._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),n=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),n<=t){n=this._targets[this._targets.length-1];this._activeTarget!==n&&this._activate(n)}else{if(this._activeTarget&&t<this._offsets[0]&&0<this._offsets[0])return this._activeTarget=null,void this._clear();for(var i=this._offsets.length;i--;)this._activeTarget!==this._targets[i]&&t>=this._offsets[i]&&(void 0===this._offsets[i+1]||t<this._offsets[i+1])&&this._activate(this._targets[i])}},t._activate=function(e){this._activeTarget=e,this._clear();var t=this._selector.split(",").map(function(t){return t+'[data-target="'+e+'"],'+t+'[href="'+e+'"]'}),t=d.default([].slice.call(document.querySelectorAll(t.join(","))));t.hasClass("dropdown-item")?(t.closest(".dropdown").find(".dropdown-toggle").addClass(ce),t.addClass(ce)):(t.addClass(ce),t.parents(he).prev(ge+", "+me).addClass(ce),t.parents(he).prev(".nav-item").children(ge).addClass(ce)),d.default(this._scrollElement).trigger("activate.bs.scrollspy",{relatedTarget:e})},t._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(t){return t.classList.contains(ce)}).forEach(function(t){return t.classList.remove(ce)})},n._jQueryInterface=function(e){return this.each(function(){var t=d.default(this).data(re);if(t||(t=new n(this,"object"==typeof e&&e),d.default(this).data(re,t)),"string"==typeof e){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}})},s(n,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"Default",get:function(){return _e}}]),n}();d.default(window).on("load.bs.scrollspy.data-api",function(){for(var t=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),e=t.length;e--;){var n=d.default(t[e]);ve._jQueryInterface.call(n,n.data())}}),d.default.fn[le]=ve._jQueryInterface,d.default.fn[le].Constructor=ve,d.default.fn[le].noConflict=function(){return d.default.fn[le]=de,ve._jQueryInterface};var ye="bs.tab",e="."+ye,be=d.default.fn.tab,Ee="active",Te=".active",we="> li > .active",Ce=function(){function i(t){this._element=t}var t=i.prototype;return t.show=function(){var t,e,n,i,a,o,s=this;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&d.default(this._element).hasClass(Ee)||d.default(this._element).hasClass("disabled")||(o=d.default(this._element).closest(".nav, .list-group")[0],e=f.getSelectorFromElement(this._element),o&&(a="UL"===o.nodeName||"OL"===o.nodeName?we:Te,n=(n=d.default.makeArray(d.default(o).find(a)))[n.length-1]),i=d.default.Event("hide.bs.tab",{relatedTarget:this._element}),a=d.default.Event("show.bs.tab",{relatedTarget:n}),n&&d.default(n).trigger(i),d.default(this._element).trigger(a),a.isDefaultPrevented()||i.isDefaultPrevented()||(e&&(t=document.querySelector(e)),this._activate(this._element,o),o=function(){var t=d.default.Event("hidden.bs.tab",{relatedTarget:s._element}),e=d.default.Event("shown.bs.tab",{relatedTarget:n});d.default(n).trigger(t),d.default(s._element).trigger(e)},t?this._activate(t,t.parentNode,o):o()))},t.dispose=function(){d.default.removeData(this._element,ye),this._element=null},t._activate=function(t,e,n){var i=this,a=(!e||"UL"!==e.nodeName&&"OL"!==e.nodeName?d.default(e).children(Te):d.default(e).find(we))[0],o=n&&a&&d.default(a).hasClass("fade"),e=function(){return i._transitionComplete(t,a,n)};a&&o?(o=f.getTransitionDurationFromElement(a),d.default(a).removeClass("show").one(f.TRANSITION_END,e).emulateTransitionEnd(o)):e()},t._transitionComplete=function(t,e,n){var i;e&&(d.default(e).removeClass(Ee),(i=d.default(e.parentNode).find("> .dropdown-menu .active")[0])&&d.default(i).removeClass(Ee),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!1)),d.default(t).addClass(Ee),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),f.reflow(t),t.classList.contains("fade")&&t.classList.add("show");e=t.parentNode;e&&"LI"===e.nodeName&&(e=e.parentNode),e&&d.default(e).hasClass("dropdown-menu")&&((e=d.default(t).closest(".dropdown")[0])&&(e=[].slice.call(e.querySelectorAll(".dropdown-toggle")),d.default(e).addClass(Ee)),t.setAttribute("aria-expanded",!0)),n&&n()},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(ye);if(e||(e=new i(this),t.data(ye,e)),"string"==typeof n){if(void 0===e[n])throw new TypeError('No method named "'+n+'"');e[n]()}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.1"}}]),i}();d.default(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(t){t.preventDefault(),Ce._jQueryInterface.call(d.default(this),"show")}),d.default.fn.tab=Ce._jQueryInterface,d.default.fn.tab.Constructor=Ce,d.default.fn.tab.noConflict=function(){return d.default.fn.tab=be,Ce._jQueryInterface};var Se="toast",Ne="bs.toast",e="."+Ne,De=d.default.fn[Se],Ae="show",Ie="showing",ke="click.dismiss"+e,Oe={animation:!0,autohide:!0,delay:500},je={animation:"boolean",autohide:"boolean",delay:"number"},Pe=function(){function i(t,e){this._element=t,this._config=this._getConfig(e),this._timeout=null,this._setListeners()}var t=i.prototype;return t.show=function(){var t,e=this,n=d.default.Event("show.bs.toast");d.default(this._element).trigger(n),n.isDefaultPrevented()||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),t=function(){e._element.classList.remove(Ie),e._element.classList.add(Ae),d.default(e._element).trigger("shown.bs.toast"),e._config.autohide&&(e._timeout=setTimeout(function(){e.hide()},e._config.delay))},this._element.classList.remove("hide"),f.reflow(this._element),this._element.classList.add(Ie),this._config.animation?(n=f.getTransitionDurationFromElement(this._element),d.default(this._element).one(f.TRANSITION_END,t).emulateTransitionEnd(n)):t())},t.hide=function(){var t;this._element.classList.contains(Ae)&&(t=d.default.Event("hide.bs.toast"),d.default(this._element).trigger(t),t.isDefaultPrevented()||this._close())},t.dispose=function(){this._clearTimeout(),this._element.classList.contains(Ae)&&this._element.classList.remove(Ae),d.default(this._element).off(ke),d.default.removeData(this._element,Ne),this._element=null,this._config=null},t._getConfig=function(t){return t=l({},Oe,d.default(this._element).data(),"object"==typeof t&&t?t:{}),f.typeCheckConfig(Se,t,this.constructor.DefaultType),t},t._setListeners=function(){var t=this;d.default(this._element).on(ke,'[data-dismiss="toast"]',function(){return t.hide()})},t._close=function(){function t(){n._element.classList.add("hide"),d.default(n._element).trigger("hidden.bs.toast")}var e,n=this;this._element.classList.remove(Ae),this._config.animation?(e=f.getTransitionDurationFromElement(this._element),d.default(this._element).one(f.TRANSITION_END,t).emulateTransitionEnd(e)):t()},t._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},i._jQueryInterface=function(n){return this.each(function(){var t=d.default(this),e=t.data(Ne);if(e||(e=new i(this,"object"==typeof n&&n),t.data(Ne,e)),"string"==typeof n){if(void 0===e[n])throw new TypeError('No method named "'+n+'"');e[n](this)}})},s(i,null,[{key:"VERSION",get:function(){return"4.6.1"}},{key:"DefaultType",get:function(){return je}},{key:"Default",get:function(){return Oe}}]),i}();d.default.fn[Se]=Pe._jQueryInterface,d.default.fn[Se].Constructor=Pe,d.default.fn[Se].noConflict=function(){return d.default.fn[Se]=De,Pe._jQueryInterface},t.Alert=_,t.Button=C,t.Carousel=q,t.Collapse=X,t.Dropdown=ut,t.Modal=It,t.Popover=se,t.Scrollspy=ve,t.Tab=Ce,t.Toast=Pe,t.Tooltip=$t,t.Util=f,Object.defineProperty(t,"__esModule",{value:!0})});
!function(I){"use strict";var d=["sanitize","whiteList","sanitizeFn"],v=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],e={"*":["class","dir","id","lang","role","tabindex","style",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},g=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,b=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function z(e,t,i){if(i&&"function"==typeof i)return i(e);for(var s=Object.keys(t),n=0,o=e.length;n<o;n++)for(var l=e[n].querySelectorAll("*"),r=0,a=l.length;r<a;r++){var c=l[r],d=c.nodeName.toLowerCase();if(-1!==s.indexOf(d))for(var h=[].slice.call(c.attributes),p=[].concat(t["*"]||[],t[d]||[]),u=0,f=h.length;u<f;u++){var m=h[u];!function(e,t){var i=e.nodeName.toLowerCase();if(-1!==I.inArray(i,t))return-1===I.inArray(i,v)||Boolean(e.nodeValue.match(g)||e.nodeValue.match(b));for(var s=I(t).filter(function(e,t){return t instanceof RegExp}),n=0,o=s.length;n<o;n++)if(i.match(s[n]))return 1}(m,p)&&c.removeAttribute(m.nodeName)}else c.parentNode.removeChild(c)}}"classList"in document.createElement("_")||function(e){if("Element"in e){var t="classList",i="prototype",s=e.Element[i],n=Object,e=function(){var i=I(this);return{add:function(e){return e=Array.prototype.slice.call(arguments).join(" "),i.addClass(e)},remove:function(e){return e=Array.prototype.slice.call(arguments).join(" "),i.removeClass(e)},toggle:function(e,t){return i.toggleClass(e,t)},contains:function(e){return i.hasClass(e)}}};if(n.defineProperty){var o={get:e,enumerable:!0,configurable:!0};try{n.defineProperty(s,t,o)}catch(e){void 0!==e.number&&-2146823252!==e.number||(o.enumerable=!1,n.defineProperty(s,t,o))}}else n[i].__defineGetter__&&s.__defineGetter__(t,e)}}(window);var t,i,s,r,n=document.createElement("_");function o(e){if(null==this)throw new TypeError;var t=String(this);if(e&&"[object RegExp]"==r.call(e))throw new TypeError;var i=t.length,s=String(e),n=s.length;(e=(e=1<arguments.length?arguments[1]:void 0)?Number(e):0)!=e&&(e=0);var o=Math.min(Math.max(e,0),i);if(i<n+o)return!1;for(var l=-1;++l<n;)if(t.charCodeAt(o+l)!=s.charCodeAt(l))return!1;return!0}function x(e,t){var i,s=e.selectedOptions,n=[];if(t){for(var o=0,l=s.length;o<l;o++)(i=s[o]).disabled||"OPTGROUP"===i.parentNode.tagName&&i.parentNode.disabled||n.push(i);return n}return s}function k(e,t){for(var i,s=[],n=t||e.selectedOptions,o=0,l=n.length;o<l;o++)(i=n[o]).disabled||"OPTGROUP"===i.parentNode.tagName&&i.parentNode.disabled||s.push(i.value);return e.multiple?s:s.length?s[0]:null}n.classList.add("c1","c2"),n.classList.contains("c2")||(t=DOMTokenList.prototype.add,i=DOMTokenList.prototype.remove,DOMTokenList.prototype.add=function(){Array.prototype.forEach.call(arguments,t.bind(this))},DOMTokenList.prototype.remove=function(){Array.prototype.forEach.call(arguments,i.bind(this))}),n.classList.toggle("c3",!1),n.classList.contains("c3")&&(s=DOMTokenList.prototype.toggle,DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:s.call(this,e)}),n=null,String.prototype.startsWith||(n=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),r={}.toString,n?n(String.prototype,"startsWith",{value:o,configurable:!0,writable:!0}):String.prototype.startsWith=o),Object.keys||(Object.keys=function(e,t,i){for(t in i=[],e)i.hasOwnProperty.call(e,t)&&i.push(t);return i}),HTMLSelectElement&&!HTMLSelectElement.prototype.hasOwnProperty("selectedOptions")&&Object.defineProperty(HTMLSelectElement.prototype,"selectedOptions",{get:function(){return this.querySelectorAll(":checked")}});var l={useDefault:!1,_set:I.valHooks.select.set};I.valHooks.select.set=function(e,t){return t&&!l.useDefault&&I(e).data("selected",!0),l._set.apply(this,arguments)};var y=null,a=function(){try{return new Event("change"),!0}catch(e){return!1}}();function w(e,t,i,s){for(var n=["display","subtext","tokens"],o=!1,l=0;l<n.length;l++){var r=n[l],a=e[r];if(a&&(a=a.toString(),"display"===r&&(a=a.replace(/<[^>]+>/g,"")),s&&(a=f(a)),a=a.toUpperCase(),o="contains"===i?0<=a.indexOf(t):a.startsWith(t)))break}return o}function $(e){return parseInt(e,10)||0}I.fn.triggerNative=function(e){var t,i=this[0];i.dispatchEvent?(a?t=new Event(e,{bubbles:!0}):(t=document.createEvent("Event")).initEvent(e,!0,!1),i.dispatchEvent(t)):i.fireEvent?((t=document.createEventObject()).eventType=e,i.fireEvent("on"+e,t)):this.trigger(e)};var c={"Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã":"C","Ã§":"c","Ã":"D","Ã°":"d","Ã":"E","Ã":"E","Ã":"E","Ã":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã":"I","Ã":"I","Ã":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã":"N","Ã±":"n","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã":"U","Ã":"U","Ã":"U","Ã":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã":"Ae","Ã¦":"ae","Ã":"Th","Ã¾":"th","Ã":"ss","Ä":"A","Ä":"A","Ä":"A","Ä":"a","Ä":"a","Ä":"a","Ä":"C","Ä":"C","Ä":"C","Ä":"C","Ä":"c","Ä":"c","Ä":"c","Ä":"c","Ä":"D","Ä":"D","Ä":"d","Ä":"d","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"E","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"e","Ä":"G","Ä":"G","Ä ":"G","Ä¢":"G","Ä":"g","Ä":"g","Ä¡":"g","Ä£":"g","Ä¤":"H","Ä¦":"H","Ä¥":"h","Ä§":"h","Ä¨":"I","Äª":"I","Ä¬":"I","Ä®":"I","Ä°":"I","Ä©":"i","Ä«":"i","Ä­":"i","Ä¯":"i","Ä±":"i","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Ä»":"L","Ä½":"L","Ä¿":"L","Å":"L","Äº":"l","Ä¼":"l","Ä¾":"l","Å":"l","Å":"l","Å":"N","Å":"N","Å":"N","Å":"N","Å":"n","Å":"n","Å":"n","Å":"n","Å":"O","Å":"O","Å":"O","Å":"o","Å":"o","Å":"o","Å":"R","Å":"R","Å":"R","Å":"r","Å":"r","Å":"r","Å":"S","Å":"S","Å":"S","Å ":"S","Å":"s","Å":"s","Å":"s","Å¡":"s","Å¢":"T","Å¤":"T","Å¦":"T","Å£":"t","Å¥":"t","Å§":"t","Å¨":"U","Åª":"U","Å¬":"U","Å®":"U","Å°":"U","Å²":"U","Å©":"u","Å«":"u","Å­":"u","Å¯":"u","Å±":"u","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Å»":"Z","Å½":"Z","Åº":"z","Å¼":"z","Å¾":"z","Ä²":"IJ","Ä³":"ij","Å":"Oe","Å":"oe","Å":"'n","Å¿":"s"},h=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,p=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\u1ab0-\\u1aff\\u1dc0-\\u1dff]","g");function u(e){return c[e]}function f(e){return(e=e.toString())&&e.replace(h,u).replace(p,"")}var m,S,E,C=(m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n="(?:"+Object.keys(m).join("|")+")",S=RegExp(n),E=RegExp(n,"g"),function(e){return e=null==e?"":""+e,S.test(e)?e.replace(E,O):e});function O(e){return m[e]}var T={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},N=27,A=13,L=32,D=9,H=38,P=40,W={success:!1,major:"3"};try{W.full=(I.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split("."),W.major=W.full[0],W.success=!0}catch(e){}var B=0,R=".bs.select",M={DISABLED:"disabled",DIVIDER:"divider",SHOW:"open",DROPUP:"dropup",MENU:"dropdown-menu",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left",BUTTONCLASS:"btn-default",POPOVERHEADER:"popover-title",ICONBASE:"glyphicon",TICKICON:"glyphicon-ok"},U={MENU:"."+M.MENU},V={div:document.createElement("div"),span:document.createElement("span"),i:document.createElement("i"),subtext:document.createElement("small"),a:document.createElement("a"),li:document.createElement("li"),whitespace:document.createTextNode("Â "),fragment:document.createDocumentFragment()};V.noResults=V.li.cloneNode(!1),V.noResults.className="no-results",V.a.setAttribute("role","option"),V.a.className="dropdown-item",V.subtext.className="text-muted",V.text=V.span.cloneNode(!1),V.text.className="text",V.checkMark=V.span.cloneNode(!1);var j=new RegExp(H+"|"+P),F=new RegExp("^"+D+"$|"+N),_={li:function(e,t,i){var s=V.li.cloneNode(!1);return e&&(1===e.nodeType||11===e.nodeType?s.appendChild(e):s.innerHTML=e),void 0!==t&&""!==t&&(s.className=t),null!=i&&s.classList.add("optgroup-"+i),s},a:function(e,t,i){var s=V.a.cloneNode(!0);return e&&(11===e.nodeType?s.appendChild(e):s.insertAdjacentHTML("beforeend",e)),void 0!==t&&""!==t&&s.classList.add.apply(s.classList,t.split(/\s+/)),i&&s.setAttribute("style",i),s},text:function(e,t){var i,s,n=V.text.cloneNode(!1);if(e.content?n.innerHTML=e.content:(n.textContent=e.text,e.icon&&(i=V.whitespace.cloneNode(!1),(s=(!0===t?V.i:V.span).cloneNode(!1)).className=this.options.iconBase+" "+e.icon,V.fragment.appendChild(s),V.fragment.appendChild(i)),e.subtext&&((i=V.subtext.cloneNode(!1)).textContent=e.subtext,n.appendChild(i))),!0===t)for(;0<n.childNodes.length;)V.fragment.appendChild(n.childNodes[0]);else V.fragment.appendChild(n);return V.fragment},label:function(e){var t,i,s=V.text.cloneNode(!1);return s.innerHTML=e.display,e.icon&&(t=V.whitespace.cloneNode(!1),(i=V.span.cloneNode(!1)).className=this.options.iconBase+" "+e.icon,V.fragment.appendChild(i),V.fragment.appendChild(t)),e.subtext&&((t=V.subtext.cloneNode(!1)).textContent=e.subtext,s.appendChild(t)),V.fragment.appendChild(s),V.fragment}},G=function(e,t){var i=this;l.useDefault||(I.valHooks.select.set=l._set,l.useDefault=!0),this.$element=I(e),this.$newElement=null,this.$button=null,this.$menu=null,this.options=t,this.selectpicker={main:{},search:{},current:{},view:{},isSearching:!1,keydown:{keyHistory:"",resetKeyHistory:{start:function(){return setTimeout(function(){i.selectpicker.keydown.keyHistory=""},800)}}}},this.sizeInfo={},null===this.options.title&&(this.options.title=this.$element.attr("title"));t=this.options.windowPadding;"number"==typeof t&&(this.options.windowPadding=[t,t,t,t]),this.val=G.prototype.val,this.render=G.prototype.render,this.refresh=G.prototype.refresh,this.setStyle=G.prototype.setStyle,this.selectAll=G.prototype.selectAll,this.deselectAll=G.prototype.deselectAll,this.destroy=G.prototype.destroy,this.remove=G.prototype.remove,this.show=G.prototype.show,this.hide=G.prototype.hide,this.init()};function K(e){var r,a=arguments,c=e;if([].shift.apply(a),!W.success){try{W.full=(I.fn.dropdown.Constructor.VERSION||"").split(" ")[0].split(".")}catch(e){G.BootstrapVersion?W.full=G.BootstrapVersion.split(" ")[0].split("."):(W.full=[W.major,"0","0"],console.warn("There was an issue retrieving Bootstrap's version. Ensure Bootstrap is being loaded before bootstrap-select and there is no namespace collision. If loading Bootstrap asynchronously, the version may need to be manually specified via $.fn.selectpicker.Constructor.BootstrapVersion.",e))}W.major=W.full[0],W.success=!0}if("4"===W.major){var t=[];G.DEFAULTS.style===M.BUTTONCLASS&&t.push({name:"style",className:"BUTTONCLASS"}),G.DEFAULTS.iconBase===M.ICONBASE&&t.push({name:"iconBase",className:"ICONBASE"}),G.DEFAULTS.tickIcon===M.TICKICON&&t.push({name:"tickIcon",className:"TICKICON"}),M.DIVIDER="dropdown-divider",M.SHOW="show",M.BUTTONCLASS="btn-light",M.POPOVERHEADER="popover-header",M.ICONBASE="",M.TICKICON="bs-ok-default";for(var i=0;i<t.length;i++){e=t[i];G.DEFAULTS[e.name]=M[e.className]}}var s=this.each(function(){var e=I(this);if(e.is("select")){var t=e.data("selectpicker"),i="object"==typeof c&&c;if(t){if(i)for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t.options[s]=i[s])}else{var n,o=e.data();for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&-1!==I.inArray(n,d)&&delete o[n];var l=I.extend({},G.DEFAULTS,I.fn.selectpicker.defaults||{},o,i);l.template=I.extend({},G.DEFAULTS.template,I.fn.selectpicker.defaults?I.fn.selectpicker.defaults.template:{},o.template,i.template),e.data("selectpicker",t=new G(this,l))}"string"==typeof c&&(r=t[c]instanceof Function?t[c].apply(t,a):t.options[c])}});return void 0!==r?r:s}G.VERSION="1.13.18",G.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(e,t){return 1==e?"{0} item selected":"{0} items selected"},maxOptionsText:function(e,t){return[1==e?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==t?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:M.BUTTONCLASS,size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:M.ICONBASE,tickIcon:M.TICKICON,showTick:!1,template:{caret:'<span class="caret"></span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,windowPadding:0,virtualScroll:600,display:!1,sanitize:!0,sanitizeFn:null,whiteList:e},G.prototype={constructor:G,init:function(){var i=this,e=this.$element.attr("id"),t=this.$element[0],s=t.form;B++,this.selectId="bs-select-"+B,t.classList.add("bs-select-hidden"),this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),t.classList.contains("show-tick")&&(this.options.showTick=!0),this.$newElement=this.createDropdown(),this.buildData(),this.$element.after(this.$newElement).prependTo(this.$newElement),s&&null===t.form&&(s.id||(s.id="form-"+this.selectId),t.setAttribute("form",s.id)),this.$button=this.$newElement.children("button"),this.$menu=this.$newElement.children(U.MENU),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),t.classList.remove("bs-select-hidden"),!0===this.options.dropdownAlignRight&&this.$menu[0].classList.add(M.MENURIGHT),void 0!==e&&this.$button.attr("data-id",e),this.checkDisabled(),this.clickListener(),this.options.liveSearch?(this.liveSearchListener(),this.focusedParent=this.$searchbox[0]):this.focusedParent=this.$menuInner[0],this.setStyle(),this.render(),this.setWidth(),this.options.container?this.selectPosition():this.$element.on("hide"+R,function(){var e,t;i.isVirtual()&&(t=(e=i.$menuInner[0]).firstChild.cloneNode(!1),e.replaceChild(t,e.firstChild),e.scrollTop=0)}),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile(),this.$newElement.on({"hide.bs.dropdown":function(e){i.$element.trigger("hide"+R,e)},"hidden.bs.dropdown":function(e){i.$element.trigger("hidden"+R,e)},"show.bs.dropdown":function(e){i.$element.trigger("show"+R,e)},"shown.bs.dropdown":function(e){i.$element.trigger("shown"+R,e)}}),t.hasAttribute("required")&&this.$element.on("invalid"+R,function(){i.$button[0].classList.add("bs-invalid"),i.$element.on("shown"+R+".invalid",function(){i.$element.val(i.$element.val()).off("shown"+R+".invalid")}).on("rendered"+R,function(){this.validity.valid&&i.$button[0].classList.remove("bs-invalid"),i.$element.off("rendered"+R)}),i.$button.on("blur"+R,function(){i.$element.trigger("focus").trigger("blur"),i.$button.off("blur"+R)})}),setTimeout(function(){i.buildList(),i.$element.trigger("loaded"+R)})},createDropdown:function(){var e=this.multiple||this.options.showTick?" show-tick":"",t=this.multiple?' aria-multiselectable="true"':"",i="",s=this.autofocus?" autofocus":"";W.major<4&&this.$element.parent().hasClass("input-group")&&(i=" input-group-btn");var n="",o="",l="",r="";return this.options.header&&(n='<div class="'+M.POPOVERHEADER+'"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>"),this.options.liveSearch&&(o='<div class="bs-searchbox"><input type="search" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+C(this.options.liveSearchPlaceholder)+'"')+' role="combobox" aria-label="Search" aria-controls="'+this.selectId+'" aria-autocomplete="list"></div>'),this.multiple&&this.options.actionsBox&&(l='<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn '+M.BUTTONCLASS+'">'+this.options.selectAllText+'</button><button type="button" class="actions-btn bs-deselect-all btn '+M.BUTTONCLASS+'">'+this.options.deselectAllText+"</button></div></div>"),this.multiple&&this.options.doneButton&&(r='<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm '+M.BUTTONCLASS+'">'+this.options.doneButtonText+"</button></div></div>"),r='<div class="dropdown bootstrap-select'+e+i+'"><button type="button" tabindex="-1" class="'+this.options.styleBase+' dropdown-toggle" '+("static"===this.options.display?'data-display="static"':"")+'data-toggle="dropdown"'+s+' role="combobox" aria-owns="'+this.selectId+'" aria-haspopup="listbox" aria-expanded="false"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner"></div></div> </div>'+("4"===W.major?"":'<span class="bs-caret">'+this.options.template.caret+"</span>")+'</button><div class="'+M.MENU+" "+("4"===W.major?"":M.SHOW)+'">'+n+o+l+'<div class="inner '+M.SHOW+'" role="listbox" id="'+this.selectId+'" tabindex="-1" '+t+'><ul class="'+M.MENU+" inner "+("4"===W.major?M.SHOW:"")+'" role="presentation"></ul></div>'+r+"</div></div>",I(r)},setPositionData:function(){this.selectpicker.view.canHighlight=[],this.selectpicker.view.size=0,this.selectpicker.view.firstHighlightIndex=!1;for(var e=0;e<this.selectpicker.current.data.length;e++){var t=this.selectpicker.current.data[e],i=!0;"divider"===t.type?(i=!1,t.height=this.sizeInfo.dividerHeight):"optgroup-label"===t.type?(i=!1,t.height=this.sizeInfo.dropdownHeaderHeight):t.height=this.sizeInfo.liHeight,t.disabled&&(i=!1),this.selectpicker.view.canHighlight.push(i),i&&(this.selectpicker.view.size++,t.posinset=this.selectpicker.view.size,!1===this.selectpicker.view.firstHighlightIndex&&(this.selectpicker.view.firstHighlightIndex=e)),t.position=(0===e?0:this.selectpicker.current.data[e-1].position)+t.height}},isVirtual:function(){return!1!==this.options.virtualScroll&&this.selectpicker.main.elements.length>=this.options.virtualScroll||!0===this.options.virtualScroll},createView:function($,e,t){var S,E,C=this,i=0,O=[];function s(e,t){var i,s,n,o,l,r,a=C.selectpicker.current.elements.length,c=[],d=!0,h=C.isVirtual();C.selectpicker.view.scrollTop=e,i=Math.ceil(C.sizeInfo.menuInnerHeight/C.sizeInfo.liHeight*1.5),s=Math.round(a/i)||1;for(var p,u=0;u<s;u++){var f=u===s-1?a:(u+1)*i;if(c[u]=[u*i+(u?1:0),f],!a)break;void 0===l&&e-1<=C.selectpicker.current.data[f-1].position-C.sizeInfo.menuInnerHeight&&(l=u)}if(void 0===l&&(l=0),r=[C.selectpicker.view.position0,C.selectpicker.view.position1],n=Math.max(0,l-1),o=Math.min(s-1,l+1),C.selectpicker.view.position0=!1!==h&&Math.max(0,c[n][0])||0,C.selectpicker.view.position1=!1===h?a:Math.min(a,c[o][1])||0,r=r[0]!==C.selectpicker.view.position0||r[1]!==C.selectpicker.view.position1,void 0!==C.activeIndex&&(E=C.selectpicker.main.elements[C.prevActiveIndex],O=C.selectpicker.main.elements[C.activeIndex],S=C.selectpicker.main.elements[C.selectedIndex],t&&(C.activeIndex!==C.selectedIndex&&C.defocusItem(O),C.activeIndex=void 0),C.activeIndex&&C.activeIndex!==C.selectedIndex&&C.defocusItem(S)),void 0!==C.prevActiveIndex&&C.prevActiveIndex!==C.activeIndex&&C.prevActiveIndex!==C.selectedIndex&&C.defocusItem(E),(t||r)&&(r=C.selectpicker.view.visibleElements?C.selectpicker.view.visibleElements.slice():[],C.selectpicker.view.visibleElements=!1===h?C.selectpicker.current.elements:C.selectpicker.current.elements.slice(C.selectpicker.view.position0,C.selectpicker.view.position1),C.setOptionStatus(),($||!1===h&&t)&&(g=r,p=C.selectpicker.view.visibleElements,d=!(g.length===p.length&&g.every(function(e,t){return e===p[t]}))),(t||!0===h)&&d)){var m=C.$menuInner[0],v=document.createDocumentFragment(),g=m.firstChild.cloneNode(!1),b=C.selectpicker.view.visibleElements,w=[];m.replaceChild(g,m.firstChild);for(var u=0,I=b.length;u<I;u++){var x,k,y=b[u];C.options.sanitize&&(x=y.lastChild)&&(k=C.selectpicker.current.data[u+C.selectpicker.view.position0])&&k.content&&!k.sanitized&&(w.push(x),k.sanitized=!0),v.appendChild(y)}C.options.sanitize&&w.length&&z(w,C.options.whiteList,C.options.sanitizeFn),!0===h?(d=0===C.selectpicker.view.position0?0:C.selectpicker.current.data[C.selectpicker.view.position0-1].position,g=C.selectpicker.view.position1>a-1?0:C.selectpicker.current.data[a-1].position-C.selectpicker.current.data[C.selectpicker.view.position1-1].position,m.firstChild.style.marginTop=d+"px",m.firstChild.style.marginBottom=g+"px"):(m.firstChild.style.marginTop=0,m.firstChild.style.marginBottom=0),m.firstChild.appendChild(v),!0===h&&C.sizeInfo.hasScrollBar&&(h=m.firstChild.offsetWidth,t&&h<C.sizeInfo.menuInnerInnerWidth&&C.sizeInfo.totalMenuWidth>C.sizeInfo.selectWidth?m.firstChild.style.minWidth=C.sizeInfo.menuInnerInnerWidth+"px":h>C.sizeInfo.menuInnerInnerWidth&&(C.$menu[0].style.minWidth=0,(h=m.firstChild.offsetWidth)>C.sizeInfo.menuInnerInnerWidth&&(C.sizeInfo.menuInnerInnerWidth=h,m.firstChild.style.minWidth=C.sizeInfo.menuInnerInnerWidth+"px"),C.$menu[0].style.minWidth=""))}C.prevActiveIndex=C.activeIndex,C.options.liveSearch?$&&t&&(m=0,C.selectpicker.view.canHighlight[m]||(m=1+C.selectpicker.view.canHighlight.slice(1).indexOf(!0)),t=C.selectpicker.view.visibleElements[m],C.defocusItem(C.selectpicker.view.currentActive),C.activeIndex=(C.selectpicker.current.data[m]||{}).index,C.focusItem(t)):C.$menuInner.trigger("focus")}this.selectpicker.isSearching=$,this.selectpicker.current=$?this.selectpicker.search:this.selectpicker.main,this.setPositionData(),e&&(t?i=this.$menuInner[0].scrollTop:C.multiple||("number"!=typeof(t=((t=C.$element[0]).options[t.selectedIndex]||{}).liIndex)||!1===C.options.size||(t=(t=C.selectpicker.main.data[t])&&t.position)&&(i=t-(C.sizeInfo.menuInnerHeight+C.sizeInfo.liHeight)/2))),s(i,!0),this.$menuInner.off("scroll.createView").on("scroll.createView",function(e,t){C.noScroll||s(this.scrollTop,t),C.noScroll=!1}),I(window).off("resize"+R+"."+this.selectId+".createView").on("resize"+R+"."+this.selectId+".createView",function(){C.$newElement.hasClass(M.SHOW)&&s(C.$menuInner[0].scrollTop)})},focusItem:function(e,t,i){var s;e&&(t=t||this.selectpicker.main.data[this.activeIndex],(s=e.firstChild)&&(s.setAttribute("aria-setsize",this.selectpicker.view.size),s.setAttribute("aria-posinset",t.posinset),!0!==i&&(this.focusedParent.setAttribute("aria-activedescendant",s.id),e.classList.add("active"),s.classList.add("active"))))},defocusItem:function(e){e&&(e.classList.remove("active"),e.firstChild&&e.firstChild.classList.remove("active"))},setPlaceholder:function(){var e,t,i,s,n,o,l=this,r=!1;return this.options.title&&!this.multiple&&(this.selectpicker.view.titleOption||(this.selectpicker.view.titleOption=document.createElement("option")),r=!0,e=this.$element[0],t=!1,i=!this.selectpicker.view.titleOption.parentNode,s=e.selectedIndex,n=e.options[s],o=(o=window.performance&&window.performance.getEntriesByType("navigation"))&&o.length?"back_forward"!==o[0].type:2!==window.performance.navigation.type,i&&(this.selectpicker.view.titleOption.className="bs-title-option",this.selectpicker.view.titleOption.value="",t=!n||0===s&&!1===n.defaultSelected&&void 0===this.$element.data("selected")),!i&&0===this.selectpicker.view.titleOption.index||e.insertBefore(this.selectpicker.view.titleOption,e.firstChild),t&&o?e.selectedIndex=0:"complete"!==document.readyState&&window.addEventListener("pageshow",function(){l.selectpicker.view.displayedValue!==e.value&&l.render()})),r},buildData:function(){var h=':not([hidden]):not([data-hidden="true"])',p=[],u=0,f=this.setPlaceholder()?1:0;this.options.hideDisabled&&(h+=":not(:disabled)");var e=this.$element[0].querySelectorAll("select > *"+h);function m(e){var t=p[p.length-1];t&&"divider"===t.type&&(t.optID||e.optID)||((e=e||{}).type="divider",p.push(e))}function v(e,t){var i,s,n;(t=t||{}).divider="true"===e.getAttribute("data-divider"),t.divider?m({optID:t.optID}):(i=p.length,s=(n=e.style.cssText)?C(n):"",n=(e.className||"")+(t.optgroupClass||""),t.optID&&(n="opt "+n),t.optionClass=n.trim(),t.inlineStyle=s,t.text=e.textContent,t.content=e.getAttribute("data-content"),t.tokens=e.getAttribute("data-tokens"),t.subtext=e.getAttribute("data-subtext"),t.icon=e.getAttribute("data-icon"),e.liIndex=i,t.display=t.content||t.text,t.type="option",t.index=i,t.option=e,t.selected=!!e.selected,t.disabled=t.disabled||!!e.disabled,p.push(t))}for(var t=e.length,i=f;i<t;i++){var s=e[i];"OPTGROUP"!==s.tagName?v(s,{}):function(e,t){var i=t[e],s=!(e-1<f)&&t[e-1],e=t[e+1],n=i.querySelectorAll("option"+h);if(n.length){var o,l,r={display:C(i.label),subtext:i.getAttribute("data-subtext"),icon:i.getAttribute("data-icon"),type:"optgroup-label",optgroupClass:" "+(i.className||"")};u++,s&&m({optID:u}),r.optID=u,p.push(r);for(var a=0,c=n.length;a<c;a++){var d=n[a];0===a&&(l=(o=p.length-1)+c),v(d,{headerIndex:o,lastIndex:l,optID:r.optID,optgroupClass:r.optgroupClass,disabled:i.disabled})}e&&m({optID:u})}}(i,e)}this.selectpicker.main.data=this.selectpicker.current.data=p},buildList:function(){var s=this,e=this.selectpicker.main.data,n=[],o=0;!s.options.showTick&&!s.multiple||V.checkMark.parentNode||(V.checkMark.className=this.options.iconBase+" "+s.options.tickIcon+" check-mark",V.a.appendChild(V.checkMark));for(var t=e.length,i=0;i<t;i++)!function(e){var t,i=0;switch(e.type){case"divider":t=_.li(!1,M.DIVIDER,e.optID?e.optID+"div":void 0);break;case"option":(t=_.li(_.a(_.text.call(s,e),e.optionClass,e.inlineStyle),"",e.optID)).firstChild&&(t.firstChild.id=s.selectId+"-"+e.index);break;case"optgroup-label":t=_.li(_.label.call(s,e),"dropdown-header"+e.optgroupClass,e.optID)}e.element=t,n.push(t),e.display&&(i+=e.display.length),e.subtext&&(i+=e.subtext.length),e.icon&&(i+=1),o<i&&(o=i,s.selectpicker.view.widestOption=n[n.length-1])}(e[i]);this.selectpicker.main.elements=this.selectpicker.current.elements=n},findLis:function(){return this.$menuInner.find(".inner > li")},render:function(){var e=this,t=this.$element[0],i=this.setPlaceholder()&&0===t.selectedIndex,s=x(t,this.options.hideDisabled),n=s.length,o=this.$button[0],l=o.querySelector(".filter-option-inner-inner"),r=document.createTextNode(this.options.multipleSeparator),a=V.fragment.cloneNode(!1),c=!1;if(o.classList.toggle("bs-placeholder",e.multiple?!n:!k(t,s)),e.multiple||1!==s.length||(e.selectpicker.view.displayedValue=k(t,s)),"static"===this.options.selectedTextFormat)a=_.text.call(this,{text:this.options.title},!0);else if(!1===(this.multiple&&-1!==this.options.selectedTextFormat.indexOf("count")&&1<n&&(1<(t=this.options.selectedTextFormat.split(">")).length&&n>t[1]||1===t.length&&2<=n))){if(!i){for(var d=0;d<n&&d<50;d++){var h=s[d],p=this.selectpicker.main.data[h.liIndex],u={};this.multiple&&0<d&&a.appendChild(r.cloneNode(!1)),h.title?u.text=h.title:p&&(p.content&&e.options.showContent?(u.content=p.content.toString(),c=!0):(e.options.showIcon&&(u.icon=p.icon),e.options.showSubtext&&!e.multiple&&p.subtext&&(u.subtext=" "+p.subtext),u.text=h.textContent.trim())),a.appendChild(_.text.call(this,u,!0))}49<n&&a.appendChild(document.createTextNode("..."))}}else{i=':not([hidden]):not([data-hidden="true"]):not([data-divider="true"])';this.options.hideDisabled&&(i+=":not(:disabled)");var f=this.$element[0].querySelectorAll("select > option"+i+", optgroup"+i+" option"+i).length,i="function"==typeof this.options.countSelectedText?this.options.countSelectedText(n,f):this.options.countSelectedText,a=_.text.call(this,{text:i.replace("{0}",n.toString()).replace("{1}",f.toString())},!0)}null==this.options.title&&(this.options.title=this.$element.attr("title")),a.childNodes.length||(a=_.text.call(this,{text:void 0!==this.options.title?this.options.title:this.options.noneSelectedText},!0)),o.title=a.textContent.replace(/<[^>]*>?/g,"").trim(),this.options.sanitize&&c&&z([a],e.options.whiteList,e.options.sanitizeFn),l.innerHTML="",l.appendChild(a),W.major<4&&this.$newElement[0].classList.contains("bs3-has-addon")&&(f=o.querySelector(".filter-expand"),(l=l.cloneNode(!0)).className="filter-expand",f?o.replaceChild(l,f):o.appendChild(l)),this.$element.trigger("rendered"+R)},setStyle:function(e,t){var i=this.$button[0],s=this.$newElement[0],n=this.options.style.trim();this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,"")),W.major<4&&(s.classList.add("bs3"),s.parentNode.classList&&s.parentNode.classList.contains("input-group")&&(s.previousElementSibling||s.nextElementSibling)&&(s.previousElementSibling||s.nextElementSibling).classList.contains("input-group-addon")&&s.classList.add("bs3-has-addon")),e=e?e.trim():n,"add"==t?e&&i.classList.add.apply(i.classList,e.split(" ")):"remove"==t?e&&i.classList.remove.apply(i.classList,e.split(" ")):(n&&i.classList.remove.apply(i.classList,n.split(" ")),e&&i.classList.add.apply(i.classList,e.split(" ")))},liHeight:function(e){if(e||!1!==this.options.size&&!Object.keys(this.sizeInfo).length){var t,i=V.div.cloneNode(!1),s=V.div.cloneNode(!1),n=V.div.cloneNode(!1),o=document.createElement("ul"),l=V.li.cloneNode(!1),r=V.li.cloneNode(!1),a=V.a.cloneNode(!1),c=V.span.cloneNode(!1),d=this.options.header&&0<this.$menu.find("."+M.POPOVERHEADER).length?this.$menu.find("."+M.POPOVERHEADER)[0].cloneNode(!0):null,h=this.options.liveSearch?V.div.cloneNode(!1):null,p=this.options.actionsBox&&this.multiple&&0<this.$menu.find(".bs-actionsbox").length?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,u=this.options.doneButton&&this.multiple&&0<this.$menu.find(".bs-donebutton").length?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null,e=this.$element.find("option")[0];if(this.sizeInfo.selectWidth=this.$newElement[0].offsetWidth,c.className="text",a.className="dropdown-item "+(e?e.className:""),i.className=this.$menu[0].parentNode.className+" "+M.SHOW,i.style.width=0,"auto"===this.options.width&&(s.style.minWidth=0),s.className=M.MENU+" "+M.SHOW,n.className="inner "+M.SHOW,o.className=M.MENU+" inner "+("4"===W.major?M.SHOW:""),l.className=M.DIVIDER,r.className="dropdown-header",c.appendChild(document.createTextNode("â")),this.selectpicker.current.data.length)for(var f=0;f<this.selectpicker.current.data.length;f++){var m=this.selectpicker.current.data[f];if("option"===m.type){t=m.element;break}}else t=V.li.cloneNode(!1),a.appendChild(c),t.appendChild(a);r.appendChild(c.cloneNode(!0)),this.selectpicker.view.widestOption&&o.appendChild(this.selectpicker.view.widestOption.cloneNode(!0)),o.appendChild(t),o.appendChild(l),o.appendChild(r),d&&s.appendChild(d),h&&(v=document.createElement("input"),h.className="bs-searchbox",v.className="form-control",h.appendChild(v),s.appendChild(h)),p&&s.appendChild(p),n.appendChild(o),s.appendChild(n),u&&s.appendChild(u),i.appendChild(s),document.body.appendChild(i);var e=t.offsetHeight,a=r?r.offsetHeight:0,c=d?d.offsetHeight:0,v=h?h.offsetHeight:0,o=p?p.offsetHeight:0,r=u?u.offsetHeight:0,d=I(l).outerHeight(!0),h=!!window.getComputedStyle&&window.getComputedStyle(s),p=s.offsetWidth,u=h?null:I(s),l={vert:$(h?h.paddingTop:u.css("paddingTop"))+$(h?h.paddingBottom:u.css("paddingBottom"))+$(h?h.borderTopWidth:u.css("borderTopWidth"))+$(h?h.borderBottomWidth:u.css("borderBottomWidth")),horiz:$(h?h.paddingLeft:u.css("paddingLeft"))+$(h?h.paddingRight:u.css("paddingRight"))+$(h?h.borderLeftWidth:u.css("borderLeftWidth"))+$(h?h.borderRightWidth:u.css("borderRightWidth"))},u={vert:l.vert+$(h?h.marginTop:u.css("marginTop"))+$(h?h.marginBottom:u.css("marginBottom"))+2,horiz:l.horiz+$(h?h.marginLeft:u.css("marginLeft"))+$(h?h.marginRight:u.css("marginRight"))+2};n.style.overflowY="scroll",s=s.offsetWidth-p,document.body.removeChild(i),this.sizeInfo.liHeight=e,this.sizeInfo.dropdownHeaderHeight=a,this.sizeInfo.headerHeight=c,this.sizeInfo.searchHeight=v,this.sizeInfo.actionsHeight=o,this.sizeInfo.doneButtonHeight=r,this.sizeInfo.dividerHeight=d,this.sizeInfo.menuPadding=l,this.sizeInfo.menuExtras=u,this.sizeInfo.menuWidth=p,this.sizeInfo.menuInnerInnerWidth=p-l.horiz,this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth,this.sizeInfo.scrollBarWidth=s,this.sizeInfo.selectHeight=this.$newElement[0].offsetHeight,this.setPositionData()}},getSelectPosition:function(){var e,t=I(window),i=this.$newElement.offset(),s=I(this.options.container);this.options.container&&s.length&&!s.is("body")?((e=s.offset()).top+=parseInt(s.css("borderTopWidth")),e.left+=parseInt(s.css("borderLeftWidth"))):e={top:0,left:0};s=this.options.windowPadding;this.sizeInfo.selectOffsetTop=i.top-e.top-t.scrollTop(),this.sizeInfo.selectOffsetBot=t.height()-this.sizeInfo.selectOffsetTop-this.sizeInfo.selectHeight-e.top-s[2],this.sizeInfo.selectOffsetLeft=i.left-e.left-t.scrollLeft(),this.sizeInfo.selectOffsetRight=t.width()-this.sizeInfo.selectOffsetLeft-this.sizeInfo.selectWidth-e.left-s[1],this.sizeInfo.selectOffsetTop-=s[0],this.sizeInfo.selectOffsetLeft-=s[3]},setMenuSize:function(e){this.getSelectPosition();var t,i,s,n,o,l,r=this.sizeInfo.selectWidth,a=this.sizeInfo.liHeight,c=this.sizeInfo.headerHeight,d=this.sizeInfo.searchHeight,h=this.sizeInfo.actionsHeight,p=this.sizeInfo.doneButtonHeight,u=this.sizeInfo.dividerHeight,f=this.sizeInfo.menuPadding,m=0;if(this.options.dropupAuto&&(l=a*this.selectpicker.current.elements.length+f.vert,l=this.sizeInfo.selectOffsetTop-this.sizeInfo.selectOffsetBot>this.sizeInfo.menuExtras.vert&&l+this.sizeInfo.menuExtras.vert+50>this.sizeInfo.selectOffsetBot,!0===this.selectpicker.isSearching&&(l=this.selectpicker.dropup),this.$newElement.toggleClass(M.DROPUP,l),this.selectpicker.dropup=l),"auto"===this.options.size)s=3<this.selectpicker.current.elements.length?3*this.sizeInfo.liHeight+this.sizeInfo.menuExtras.vert-2:0,t=this.sizeInfo.selectOffsetBot-this.sizeInfo.menuExtras.vert,i=s+c+d+h+p,o=Math.max(s-f.vert,0),this.$newElement.hasClass(M.DROPUP)&&(t=this.sizeInfo.selectOffsetTop-this.sizeInfo.menuExtras.vert),s=(n=t)-c-d-h-p-f.vert;else if(this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size){for(var v=0;v<this.options.size;v++)"divider"===this.selectpicker.current.data[v].type&&m++;s=(t=a*this.options.size+m*u+f.vert)-f.vert,n=t+c+d+h+p,i=o=""}this.$menu.css({"max-height":n+"px",overflow:"hidden","min-height":i+"px"}),this.$menuInner.css({"max-height":s+"px","overflow-y":"auto","min-height":o+"px"}),this.sizeInfo.menuInnerHeight=Math.max(s,1),this.selectpicker.current.data.length&&this.selectpicker.current.data[this.selectpicker.current.data.length-1].position>this.sizeInfo.menuInnerHeight&&(this.sizeInfo.hasScrollBar=!0,this.sizeInfo.totalMenuWidth=this.sizeInfo.menuWidth+this.sizeInfo.scrollBarWidth),"auto"===this.options.dropdownAlignRight&&this.$menu.toggleClass(M.MENURIGHT,this.sizeInfo.selectOffsetLeft>this.sizeInfo.selectOffsetRight&&this.sizeInfo.selectOffsetRight<this.sizeInfo.totalMenuWidth-r),this.dropdown&&this.dropdown._popper&&this.dropdown._popper.update()},setSize:function(e){var t,i;this.liHeight(e),this.options.header&&this.$menu.css("padding-top",0),!1!==this.options.size&&(t=this,i=I(window),this.setMenuSize(),this.options.liveSearch&&this.$searchbox.off("input.setMenuSize propertychange.setMenuSize").on("input.setMenuSize propertychange.setMenuSize",function(){return t.setMenuSize()}),"auto"===this.options.size?i.off("resize"+R+"."+this.selectId+".setMenuSize scroll"+R+"."+this.selectId+".setMenuSize").on("resize"+R+"."+this.selectId+".setMenuSize scroll"+R+"."+this.selectId+".setMenuSize",function(){return t.setMenuSize()}):this.options.size&&"auto"!=this.options.size&&this.selectpicker.current.elements.length>this.options.size&&i.off("resize"+R+"."+this.selectId+".setMenuSize scroll"+R+"."+this.selectId+".setMenuSize")),this.createView(!1,!0,e)},setWidth:function(){var i=this;"auto"===this.options.width?requestAnimationFrame(function(){i.$menu.css("min-width","0"),i.$element.on("loaded"+R,function(){i.liHeight(),i.setMenuSize();var e=i.$newElement.clone().appendTo("body"),t=e.css("width","auto").children("button").outerWidth();e.remove(),i.sizeInfo.selectWidth=Math.max(i.sizeInfo.totalMenuWidth,t),i.$newElement.css("width",i.sizeInfo.selectWidth+"px")})}):"fit"===this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width","")),this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement[0].classList.remove("fit-width")},selectPosition:function(){this.$bsContainer=I('<div class="bs-container" />');function e(e){var t={},i=l.options.display||!!I.fn.dropdown.Constructor.Default&&I.fn.dropdown.Constructor.Default.display;l.$bsContainer.addClass(e.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass(M.DROPUP,e.hasClass(M.DROPUP)),s=e.offset(),r.is("body")?n={top:0,left:0}:((n=r.offset()).top+=parseInt(r.css("borderTopWidth"))-r.scrollTop(),n.left+=parseInt(r.css("borderLeftWidth"))-r.scrollLeft()),o=e.hasClass(M.DROPUP)?0:e[0].offsetHeight,(W.major<4||"static"===i)&&(t.top=s.top-n.top+o,t.left=s.left-n.left),t.width=e[0].offsetWidth,l.$bsContainer.css(t)}var s,n,o,l=this,r=I(this.options.container);this.$button.on("click.bs.dropdown.data-api",function(){l.isDisabled()||(e(l.$newElement),l.$bsContainer.appendTo(l.options.container).toggleClass(M.SHOW,!l.$button.hasClass(M.SHOW)).append(l.$menu))}),I(window).off("resize"+R+"."+this.selectId+" scroll"+R+"."+this.selectId).on("resize"+R+"."+this.selectId+" scroll"+R+"."+this.selectId,function(){l.$newElement.hasClass(M.SHOW)&&e(l.$newElement)}),this.$element.on("hide"+R,function(){l.$menu.data("height",l.$menu.height()),l.$bsContainer.detach()})},setOptionStatus:function(e){var t=this;if(t.noScroll=!1,t.selectpicker.view.visibleElements&&t.selectpicker.view.visibleElements.length)for(var i=0;i<t.selectpicker.view.visibleElements.length;i++){var s=t.selectpicker.current.data[i+t.selectpicker.view.position0],n=s.option;n&&(!0!==e&&t.setDisabled(s.index,s.disabled),t.setSelected(s.index,n.selected))}},setSelected:function(e,t){var i,s=this.selectpicker.main.elements[e],n=this.selectpicker.main.data[e],o=void 0!==this.activeIndex,l=this.activeIndex===e||t&&!this.multiple&&!o;n.selected=t,i=s.firstChild,t&&(this.selectedIndex=e),s.classList.toggle("selected",t),l?(this.focusItem(s,n),this.selectpicker.view.currentActive=s,this.activeIndex=e):this.defocusItem(s),i&&(i.classList.toggle("selected",t),t?i.setAttribute("aria-selected",!0):this.multiple?i.setAttribute("aria-selected",!1):i.removeAttribute("aria-selected")),l||o||!t||void 0===this.prevActiveIndex||(t=this.selectpicker.main.elements[this.prevActiveIndex],this.defocusItem(t))},setDisabled:function(e,t){var i=this.selectpicker.main.elements[e];this.selectpicker.main.data[e].disabled=t,e=i.firstChild,i.classList.toggle(M.DISABLED,t),e&&("4"===W.major&&e.classList.toggle(M.DISABLED,t),t?(e.setAttribute("aria-disabled",t),e.setAttribute("tabindex",-1)):(e.removeAttribute("aria-disabled"),e.setAttribute("tabindex",0)))},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){this.isDisabled()?(this.$newElement[0].classList.add(M.DISABLED),this.$button.addClass(M.DISABLED).attr("aria-disabled",!0)):this.$button[0].classList.contains(M.DISABLED)&&(this.$newElement[0].classList.remove(M.DISABLED),this.$button.removeClass(M.DISABLED).attr("aria-disabled",!1))},clickListener:function(){var w=this,t=I(document);function e(){(w.options.liveSearch?w.$searchbox:w.$menuInner).trigger("focus")}function i(){w.dropdown&&w.dropdown._popper&&w.dropdown._popper.state.isCreated?e():requestAnimationFrame(i)}t.data("spaceSelect",!1),this.$button.on("keyup",function(e){/(32)/.test(e.keyCode.toString(10))&&t.data("spaceSelect")&&(e.preventDefault(),t.data("spaceSelect",!1))}),this.$newElement.on("show.bs.dropdown",function(){3<W.major&&!w.dropdown&&(w.dropdown=w.$button.data("bs.dropdown"),w.dropdown._menu=w.$menu[0])}),this.$button.on("click.bs.dropdown.data-api",function(){w.$newElement.hasClass(M.SHOW)||w.setSize()}),this.$element.on("shown"+R,function(){w.$menuInner[0].scrollTop!==w.selectpicker.view.scrollTop&&(w.$menuInner[0].scrollTop=w.selectpicker.view.scrollTop),3<W.major?requestAnimationFrame(i):e()}),this.$menuInner.on("mouseenter","li a",function(e){var t=this.parentElement,i=w.isVirtual()?w.selectpicker.view.position0:0,s=Array.prototype.indexOf.call(t.parentElement.children,t),i=w.selectpicker.current.data[s+i];w.focusItem(t,i,!0)}),this.$menuInner.on("click","li a",function(e,t){var i=I(this),s=w.$element[0],n=w.isVirtual()?w.selectpicker.view.position0:0,o=w.selectpicker.current.data[i.parent().index()+n],l=o.index,r=k(s),a=s.selectedIndex,c=s.options[a],d=!0;if(w.multiple&&1!==w.options.maxOptions&&e.stopPropagation(),e.preventDefault(),!w.isDisabled()&&!i.parent().hasClass(M.DISABLED)){var h=o.option,p=I(h),u=h.selected,f=p.parent("optgroup"),m=f.find("option"),n=w.options.maxOptions,e=f.data("maxOptions")||!1;if(l===w.activeIndex&&(t=!0),t||(w.prevActiveIndex=w.activeIndex,w.activeIndex=void 0),w.multiple){if(h.selected=!u,w.setSelected(l,!u),w.focusedParent.focus(),!1!==n||!1!==e){i=n<x(s).length,o=e<f.find("option:selected").length;if(n&&i||e&&o)if(n&&1==n)s.selectedIndex=-1,h.selected=!0,w.setOptionStatus(!0);else if(e&&1==e){for(var v=0;v<m.length;v++){var g=m[v];g.selected=!1,w.setSelected(g.liIndex,!1)}h.selected=!0,w.setSelected(l,!0)}else{var t="string"==typeof w.options.maxOptionsText?[w.options.maxOptionsText,w.options.maxOptionsText]:w.options.maxOptionsText,u="function"==typeof t?t(n,e):t,f=u[0].replace("{n}",n),t=u[1].replace("{n}",e),b=I('<div class="notify"></div>');u[2]&&(f=f.replace("{var}",u[2][1<n?0:1]),t=t.replace("{var}",u[2][1<e?0:1])),h.selected=!1,w.$menu.append(b),n&&i&&(b.append(I("<div>"+f+"</div>")),d=!1,w.$element.trigger("maxReached"+R)),e&&o&&(b.append(I("<div>"+t+"</div>")),d=!1,w.$element.trigger("maxReachedGrp"+R)),setTimeout(function(){w.setSelected(l,!1)},10),b[0].classList.add("fadeOut"),setTimeout(function(){b.remove()},1050)}}}else c&&(c.selected=!1),h.selected=!0,w.setSelected(l,!0);!w.multiple||w.multiple&&1===w.options.maxOptions?w.$button.trigger("focus"):w.options.liveSearch&&w.$searchbox.trigger("focus"),d&&(!w.multiple&&a===s.selectedIndex||(y=[h.index,p.prop("selected"),r],w.$element.triggerNative("change")))}}),this.$menu.on("click","li."+M.DISABLED+" a, ."+M.POPOVERHEADER+", ."+M.POPOVERHEADER+" :not(.close)",function(e){e.currentTarget==this&&(e.preventDefault(),e.stopPropagation(),(w.options.liveSearch&&!I(e.target).hasClass("close")?w.$searchbox:w.$button).trigger("focus"))}),this.$menuInner.on("click",".divider, .dropdown-header",function(e){e.preventDefault(),e.stopPropagation(),(w.options.liveSearch?w.$searchbox:w.$button).trigger("focus")}),this.$menu.on("click","."+M.POPOVERHEADER+" .close",function(){w.$button.trigger("click")}),this.$searchbox.on("click",function(e){e.stopPropagation()}),this.$menu.on("click",".actions-btn",function(e){(w.options.liveSearch?w.$searchbox:w.$button).trigger("focus"),e.preventDefault(),e.stopPropagation(),I(this).hasClass("bs-select-all")?w.selectAll():w.deselectAll()}),this.$button.on("focus"+R,function(e){var t=w.$element[0].getAttribute("tabindex");void 0!==t&&e.originalEvent&&e.originalEvent.isTrusted&&(this.setAttribute("tabindex",t),w.$element[0].setAttribute("tabindex",-1),w.selectpicker.view.tabindex=t)}).on("blur"+R,function(e){void 0!==w.selectpicker.view.tabindex&&e.originalEvent&&e.originalEvent.isTrusted&&(w.$element[0].setAttribute("tabindex",w.selectpicker.view.tabindex),this.setAttribute("tabindex",-1),w.selectpicker.view.tabindex=void 0)}),this.$element.on("change"+R,function(){w.render(),w.$element.trigger("changed"+R,y),y=null}).on("focus"+R,function(){w.options.mobile||w.$button[0].focus()})},liveSearchListener:function(){var p=this;this.$button.on("click.bs.dropdown.data-api",function(){p.$searchbox.val()&&(p.$searchbox.val(""),p.selectpicker.search.previousValue=void 0)}),this.$searchbox.on("click.bs.dropdown.data-api focus.bs.dropdown.data-api touchend.bs.dropdown.data-api",function(e){e.stopPropagation()}),this.$searchbox.on("input propertychange",function(){var e=p.$searchbox[0].value;if(p.selectpicker.search.elements=[],p.selectpicker.search.data=[],e){var t=[],i=e.toUpperCase(),s={},n=[],o=p._searchStyle(),l=p.options.liveSearchNormalize;l&&(i=f(i));for(var r=0;r<p.selectpicker.main.data.length;r++){var a=p.selectpicker.main.data[r];s[r]||(s[r]=w(a,i,o,l)),s[r]&&void 0!==a.headerIndex&&-1===n.indexOf(a.headerIndex)&&(0<a.headerIndex&&(s[a.headerIndex-1]=!0,n.push(a.headerIndex-1)),s[a.headerIndex]=!0,n.push(a.headerIndex),s[a.lastIndex+1]=!0),s[r]&&"optgroup-label"!==a.type&&n.push(r)}for(var r=0,c=n.length;r<c;r++){var d=n[r],h=n[r-1],a=p.selectpicker.main.data[d],h=p.selectpicker.main.data[h];("divider"!==a.type||"divider"===a.type&&h&&"divider"!==h.type&&c-1!==r)&&(p.selectpicker.search.data.push(a),t.push(p.selectpicker.main.elements[d]))}p.activeIndex=void 0,p.noScroll=!0,p.$menuInner.scrollTop(0),p.selectpicker.search.elements=t,p.createView(!0),function(e,t){e.length||(V.noResults.innerHTML=this.options.noneResultsText.replace("{0}",'"'+C(t)+'"'),this.$menuInner[0].firstChild.appendChild(V.noResults))}.call(p,t,e)}else p.selectpicker.search.previousValue&&(p.$menuInner.scrollTop(0),p.createView(!1));p.selectpicker.search.previousValue=e})},_searchStyle:function(){return this.options.liveSearchStyle||"contains"},val:function(e){var t=this.$element[0];if(void 0===e)return this.$element.val();var i=k(t);return y=[null,null,i],this.$element.val(e).trigger("changed"+R,y),this.$newElement.hasClass(M.SHOW)&&(this.multiple?this.setOptionStatus(!0):"number"==typeof(t=(t.options[t.selectedIndex]||{}).liIndex)&&(this.setSelected(this.selectedIndex,!1),this.setSelected(t,!0))),this.render(),y=null,this.$element},changeAll:function(e){if(this.multiple){void 0===e&&(e=!0);var t=this.$element[0],i=0,s=0,n=k(t);t.classList.add("bs-select-hidden");for(var o=0,l=this.selectpicker.current.data,r=l.length;o<r;o++){var a=l[o],c=a.option;c&&!a.disabled&&"divider"!==a.type&&(a.selected&&i++,!0===(c.selected=e)&&s++)}t.classList.remove("bs-select-hidden"),i!==s&&(this.setOptionStatus(),y=[null,null,n],this.$element.triggerNative("change"))}},selectAll:function(){return this.changeAll(!0)},deselectAll:function(){return this.changeAll(!1)},toggle:function(e){(e=e||window.event)&&e.stopPropagation(),this.$button.trigger("click.bs.dropdown.data-api")},keydown:function(e){var t,i,s,n=I(this),o=n.hasClass("dropdown-toggle"),l=(o?n.closest(".dropdown"):n.closest(U.MENU)).data("this"),r=l.findLis(),a=!1,c=e.which===D&&!o&&!l.options.selectOnTab,d=j.test(e.which)||c,h=l.$menuInner[0].scrollTop,p=!0===l.isVirtual()?l.selectpicker.view.position0:0;if(!(112<=e.which&&e.which<=123))if(o=l.$newElement.hasClass(M.SHOW),!o&&(d||48<=e.which&&e.which<=57||96<=e.which&&e.which<=105||65<=e.which&&e.which<=90)&&(l.$button.trigger("click.bs.dropdown.data-api"),l.options.liveSearch))l.$searchbox.trigger("focus");else{if(e.which===N&&o&&(e.preventDefault(),l.$button.trigger("click.bs.dropdown.data-api").trigger("focus")),d){if(!r.length)return;-1!==(d=(t=l.selectpicker.main.elements[l.activeIndex])?Array.prototype.indexOf.call(t.parentElement.children,t):-1)&&l.defocusItem(t),e.which===H?(-1!==d&&d--,d+p<0&&(d+=r.length),l.selectpicker.view.canHighlight[d+p]||-1===(d=l.selectpicker.view.canHighlight.slice(0,d+p).lastIndexOf(!0)-p)&&(d=r.length-1)):e.which!==P&&!c||(++d+p>=l.selectpicker.view.canHighlight.length&&(d=l.selectpicker.view.firstHighlightIndex),l.selectpicker.view.canHighlight[d+p]||(d=d+1+l.selectpicker.view.canHighlight.slice(d+p+1).indexOf(!0))),e.preventDefault();var u=p+d;e.which===H?0===p&&d===r.length-1?(l.$menuInner[0].scrollTop=l.$menuInner[0].scrollHeight,u=l.selectpicker.current.elements.length-1):a=(s=(i=l.selectpicker.current.data[u]).position-i.height)<h:e.which!==P&&!c||(d===l.selectpicker.view.firstHighlightIndex?(l.$menuInner[0].scrollTop=0,u=l.selectpicker.view.firstHighlightIndex):a=h<(s=(i=l.selectpicker.current.data[u]).position-l.sizeInfo.menuInnerHeight)),t=l.selectpicker.current.elements[u],l.activeIndex=l.selectpicker.current.data[u].index,l.focusItem(t),l.selectpicker.view.currentActive=t,a&&(l.$menuInner[0].scrollTop=s),(l.options.liveSearch?l.$searchbox:n).trigger("focus")}else if(!n.is("input")&&!F.test(e.which)||e.which===L&&l.selectpicker.keydown.keyHistory){var f,m=[];e.preventDefault(),l.selectpicker.keydown.keyHistory+=T[e.which],l.selectpicker.keydown.resetKeyHistory.cancel&&clearTimeout(l.selectpicker.keydown.resetKeyHistory.cancel),l.selectpicker.keydown.resetKeyHistory.cancel=l.selectpicker.keydown.resetKeyHistory.start(),f=l.selectpicker.keydown.keyHistory,/^(.)\1+$/.test(f)&&(f=f.charAt(0));for(var v=0;v<l.selectpicker.current.data.length;v++){var g=l.selectpicker.current.data[v];w(g,f,"startsWith",!0)&&l.selectpicker.view.canHighlight[v]&&m.push(g.index)}m.length&&(u=0,r.removeClass("active").find("a").removeClass("active"),1===f.length&&(-1===(u=m.indexOf(l.activeIndex))||u===m.length-1?u=0:u++),r=m[u],a=0<h-(i=l.selectpicker.main.data[r]).position?(s=i.position-i.height,!0):(s=i.position-l.sizeInfo.menuInnerHeight,i.position>h+l.sizeInfo.menuInnerHeight),t=l.selectpicker.main.elements[r],l.activeIndex=m[u],l.focusItem(t),t&&t.firstChild.focus(),a&&(l.$menuInner[0].scrollTop=s),n.trigger("focus"))}o&&(e.which===L&&!l.selectpicker.keydown.keyHistory||e.which===A||e.which===D&&l.options.selectOnTab)&&(e.which!==L&&e.preventDefault(),l.options.liveSearch&&e.which===L||(l.$menuInner.find(".active a").trigger("click",!0),n.trigger("focus"),l.options.liveSearch||(e.preventDefault(),I(document).data("spaceSelect",!0))))}},mobile:function(){this.options.mobile=!0,this.$element[0].classList.add("mobile-device")},refresh:function(){var e=I.extend({},this.options,this.$element.data());this.options=e,this.checkDisabled(),this.buildData(),this.setStyle(),this.render(),this.buildList(),this.setWidth(),this.setSize(!0),this.$element.trigger("refreshed"+R)},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()},destroy:function(){this.$newElement.before(this.$element).remove(),(this.$bsContainer||this.$menu).remove(),this.selectpicker.view.titleOption&&this.selectpicker.view.titleOption.parentNode&&this.selectpicker.view.titleOption.parentNode.removeChild(this.selectpicker.view.titleOption),this.$element.off(R).removeData("selectpicker").removeClass("bs-select-hidden selectpicker"),I(window).off(R+"."+this.selectId)}};var q=I.fn.selectpicker;function Y(){if(I.fn.dropdown)return(I.fn.dropdown.Constructor._dataApiKeydownHandler||I.fn.dropdown.Constructor.prototype.keydown).apply(this,arguments)}I.fn.selectpicker=K,I.fn.selectpicker.Constructor=G,I.fn.selectpicker.noConflict=function(){return I.fn.selectpicker=q,this},I(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api",':not(.bootstrap-select) > [data-toggle="dropdown"]',Y).on("keydown.bs.dropdown.data-api",":not(.bootstrap-select) > .dropdown-menu",Y).on("keydown"+R,'.bootstrap-select [data-toggle="dropdown"], .bootstrap-select [role="listbox"], .bootstrap-select .bs-searchbox input',G.prototype.keydown).on("focusin.modal",'.bootstrap-select [data-toggle="dropdown"], .bootstrap-select [role="listbox"], .bootstrap-select .bs-searchbox input',function(e){e.stopPropagation()}),I(window).on("load"+R+".data-api",function(){I(".selectpicker").each(function(){var e=I(this);K.call(e,e.data())})})}(jQuery);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},windowIsDefined="object"===("undefined"==typeof window?"undefined":_typeof(window));!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){var e;try{e=require("jquery")}catch(t){e=null}module.exports=t(e)}else window&&(window.Slider=t(window.jQuery))}(function(t){var e,p,n="slider",a="bootstrapSlider";function i(){}return windowIsDefined&&!window.console&&(window.console={}),windowIsDefined&&!window.console.log&&(window.console.log=function(){}),windowIsDefined&&!window.console.warn&&(window.console.warn=function(){}),p=Array.prototype.slice,function(r){if(r){var d="undefined"==typeof console?i:function(t){console.error(t)};r.bridget=function(t,e){var i,h,l;(i=e).prototype.option||(i.prototype.option=function(t){r.isPlainObject(t)&&(this.options=r.extend(!0,this.options,t))}),h=t,l=e,r.fn[h]=function(e){if("string"==typeof e){for(var t=p.call(arguments,1),i=0,s=this.length;i<s;i++){var o=this[i],n=r.data(o,h);if(n)if(r.isFunction(n[e])&&"_"!==e.charAt(0)){o=n[e].apply(n,t);if(void 0!==o&&o!==n)return o}else d("no such method '"+e+"' for "+h+" instance");else d("cannot call methods on "+h+" prior to initialization; attempted to call '"+e+"'")}return this}var a=this.map(function(){var t=r.data(this,h);return t?(t.option(e),t._init()):(t=new l(this,e),r.data(this,h,t)),r(this)});return 1===a.length?a[0]:a}},r.bridget}}(t),function(P){var i=void 0,s=function(t){return"Invalid input value '"+t+"' passed in"},A={linear:{getValue:function(t,e){return t<e.min?e.min:t>e.max?e.max:t},toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(0<this.options.ticks_positions.length){for(var s,o,n,a=0,h=1;h<this.options.ticks_positions.length;h++)if(t<=this.options.ticks_positions[h]){s=this.options.ticks[h-1],n=this.options.ticks_positions[h-1],o=this.options.ticks[h],a=this.options.ticks_positions[h];break}e=s+(t-n)/(a-n)*(o-s),i=!1}e=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return A.linear.getValue(e,this.options)},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(0<this.options.ticks_positions.length){for(var e,i,s,o=0,n=0;n<this.options.ticks.length;n++)if(t<=this.options.ticks[n]){e=0<n?this.options.ticks[n-1]:0,s=0<n?this.options.ticks_positions[n-1]:0,i=this.options.ticks[n],o=this.options.ticks_positions[n];break}if(0<n)return s+(t-e)/(i-e)*(o-s)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=1-this.options.min,i=Math.log(this.options.min+e),s=Math.log(this.options.max+e),e=Math.exp(i+(s-i)*t/100)-e;return Math.round(e)===s?s:(e=this.options.min+Math.round((e-this.options.min)/this.options.step)*this.options.step,A.linear.getValue(e,this.options))},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=1-this.options.min,i=Math.log(this.options.max+e),s=Math.log(this.options.min+e);return 100*(Math.log(t+e)-s)/(i-s)}}};function o(t,e){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1,tickIndex:null},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof t?this.element=document.querySelector(t):t instanceof HTMLElement&&(this.element=t),e=e||{};for(var i=Object.keys(this.defaultOptions),s=e.hasOwnProperty("min"),o=e.hasOwnProperty("max"),n=0;n<i.length;n++){var a=i[n],h=e[a];h=null!==(h=void 0!==h?h:function(t,e){var e="data-slider-"+e.replace(/_/g,"-"),i=t.getAttribute(e);try{return JSON.parse(i)}catch(t){return i}}(this.element,a))?h:this.defaultOptions[a],this.options||(this.options={}),this.options[a]=h}this.ticksAreValid=Array.isArray(this.options.ticks)&&0<this.options.ticks.length,this.ticksAreValid||(this.options.lock_to_ticks=!1),"auto"===this.options.rtl&&(L=window.getComputedStyle(this.element),this.options.rtl=null!=L?"rtl"===L.direction:"rtl"===this.element.style.direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var l,r,d,p=this.element.style.width,c=!1,u=this.element.parentNode;if(this.sliderElem)c=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var m=document.createElement("div");m.className="slider-track",(r=document.createElement("div")).className="slider-track-low",(l=document.createElement("div")).className="slider-selection",(d=document.createElement("div")).className="slider-track-high",(T=document.createElement("div")).className="slider-handle min-slider-handle",T.setAttribute("role","slider"),T.setAttribute("aria-valuemin",this.options.min),T.setAttribute("aria-valuemax",this.options.max),(M=document.createElement("div")).className="slider-handle max-slider-handle",M.setAttribute("role","slider"),M.setAttribute("aria-valuemin",this.options.min),M.setAttribute("aria-valuemax",this.options.max),m.appendChild(r),m.appendChild(l),m.appendChild(d),this.rangeHighlightElements=[];var _=this.options.rangeHighlights;if(Array.isArray(_)&&0<_.length)for(var v=0;v<_.length;v++){var g=document.createElement("div"),f=_[v].class||"";g.className="slider-rangeHighlight slider-selection "+f,this.rangeHighlightElements.push(g),m.appendChild(g)}var b=Array.isArray(this.options.labelledby);if(b&&this.options.labelledby[0]&&T.setAttribute("aria-labelledby",this.options.labelledby[0]),b&&this.options.labelledby[1]&&M.setAttribute("aria-labelledby",this.options.labelledby[1]),!b&&this.options.labelledby&&(T.setAttribute("aria-labelledby",this.options.labelledby),M.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&0<this.options.ticks.length){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",n=0;n<this.options.ticks.length;n++){var y,k,E=document.createElement("div");E.className="slider-tick",this.options.ticks_tooltip&&(y=(k=this._addTickListener()).addMouseEnter(this,E,n),k=k.addMouseLeave(this,E),this.ticksCallbackMap[n]={mouseEnter:y,mouseLeave:k}),this.ticks.push(E),this.ticksContainer.appendChild(E)}l.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&0<this.options.ticks_labels.length)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",n=0;n<this.options.ticks_labels.length;n++){var C=document.createElement("div"),w=0===this.options.ticks_positions.length,w=this.options.reversed&&w?this.options.ticks_labels.length-(n+1):n;C.className="slider-tick-label",C.innerHTML=this.options.ticks_labels[w],this.tickLabels.push(C),this.tickLabelContainer.appendChild(C)}var x=function(t){var e=document.createElement("div");e.className="arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},t=document.createElement("div");t.className="tooltip tooltip-main",t.setAttribute("role","presentation"),x(t);var L=document.createElement("div");L.className="tooltip tooltip-min",L.setAttribute("role","presentation"),x(L);b=document.createElement("div");b.className="tooltip tooltip-max",b.setAttribute("role","presentation"),x(b),this.sliderElem.appendChild(m),this.sliderElem.appendChild(t),this.sliderElem.appendChild(L),this.sliderElem.appendChild(b),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(T),this.sliderElem.appendChild(M),u.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(P&&(this.$element=P(this.element),this.$sliderElem=P(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),A[this.options.scale]&&(this.options.scale=A[this.options.scale]),!0===c&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach(function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)},this),[this.handle1,this.handle2].forEach(function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(t){this._removeProperty(t,"bs-tooltip-left"),this._removeProperty(t,"bs-tooltip-right"),this._removeProperty(t,"bs-tooltip-top"),this._removeClass(t,"bs-tooltip-right"),this._removeClass(t,"bs-tooltip-left"),this._removeClass(t,"bs-tooltip-top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=p,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="clientX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&0<this.options.ticks.length&&(o||(this.options.max=Math.max.apply(Math,this.options.ticks)),s||(this.options.min=Math.min.apply(Math,this.options.ticks))),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=r||this.trackLow,this.trackSelection=l||this.trackSelection,this.trackHigh=d||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=T||this.handle1,this.handle2=M||this.handle2,!0===c)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),n=0;n<this.ticks.length;n++)this._removeClass(this.ticks[n],"round triangle hide");var T,M;if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),n=0;n<this.ticks.length;n++)this._addClass(this.ticks[n],this.options.handle);this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable&&(this.sliderElem.addEventListener("touchstart",this.touchstart,!1),this.sliderElem.addEventListener("touchmove",this.touchmove,!1)),this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip?(M=(T=this._addTickListener()).addMouseEnter(this,this.handle1),c=T.addMouseLeave(this,this.handle1),this.handleCallbackMap.handle1={mouseEnter:M,mouseLeave:c},M=T.addMouseEnter(this,this.handle2),c=T.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:M,mouseLeave:c}):(this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.touchCapable&&(this.sliderElem.addEventListener("touchstart",this.showTooltip,!1),this.sliderElem.addEventListener("touchmove",this.showTooltip,!1),this.sliderElem.addEventListener("touchend",this.hideTooltip,!1))),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1),this.touchCapable&&(this.handle1.addEventListener("touchstart",this.showTooltip,!1),this.handle1.addEventListener("touchmove",this.showTooltip,!1),this.handle1.addEventListener("touchend",this.hideTooltip,!1),this.handle2.addEventListener("touchstart",this.showTooltip,!1),this.handle2.addEventListener("touchmove",this.showTooltip,!1),this.handle2.addEventListener("touchend",this.hideTooltip,!1))),this.options.enabled?this.enable():this.disable()}(e=function(t,e){return o.call(this,t,e),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,lock_to_ticks:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t=t||0;var s=this.getValue();this._state.value=this._validateInputValue(t);t=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=t(this._state.value[0]),this._state.value[1]=t(this._state.value[1]),this.ticksAreValid&&this.options.lock_to_ticks&&(this._state.value[0]=this.options.ticks[this._getClosestTickIndex(this._state.value[0])],this._state.value[1]=this.options.ticks[this._getClosestTickIndex(this._state.value[1])]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=t(this._state.value),this.ticksAreValid&&this.options.lock_to_ticks&&(this._state.value=this.options.ticks[this._getClosestTickIndex(this._state.value)]),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this._setTickIndex(),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();t=this.options.range?this._state.value:this._state.value[0];this._setDataVal(t),!0===e&&this._trigger("slide",t);return(Array.isArray(t)?s[0]!==t[0]||s[1]!==t[1]:s!==t)&&!0===i&&this._trigger("change",{oldValue:s,newValue:t}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),P&&(this._unbindJQueryEventHandlers(),i===n&&this.$element.removeData(i),this.$element.removeData(a))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(t,e){P?(this.$element.off(t,e),this.$sliderElem.off(t,e)):this._unbindNonQueryEventHandler(t,e)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(t){var e=this.getValue();return this._removeSliderEventHandlers(),o.call(this,this.element,this.options),t&&!0===t.useCurrentValue&&this.setValue(e),P&&(i===n&&P.data(this.element,n,this),P.data(this.element,a,this)),this},relayout:function(){return this._resize(),this},_removeTooltipListener:function(t,e){this.handle1.removeEventListener(t,e,!1),this.handle2.removeEventListener(t,e,!1)},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handleCallbackMap.handle1&&this.handleCallbackMap.handle2&&(this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1))}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&this._removeTooltipListener("focus",this.showTooltip),this.hideTooltip&&this._removeTooltipListener("blur",this.hideTooltip),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),this.touchCapable&&(this.showTooltip&&(this.handle1.removeEventListener("touchstart",this.showTooltip,!1),this.handle1.removeEventListener("touchmove",this.showTooltip,!1),this.handle2.removeEventListener("touchstart",this.showTooltip,!1),this.handle2.removeEventListener("touchmove",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("touchend",this.hideTooltip,!1),this.handle2.removeEventListener("touchend",this.hideTooltip,!1)),this.showTooltip&&(this.sliderElem.removeEventListener("touchstart",this.showTooltip,!1),this.sliderElem.removeEventListener("touchmove",this.showTooltip,!1)),this.hideTooltip&&this.sliderElem.removeEventListener("touchend",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1)),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"show"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"show"),this._addClass(this.tooltip_max,"show"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this._alwaysShowTooltip&&(this._removeClass(this.tooltip,"show"),this._removeClass(this.tooltip_min,"show"),this._removeClass(this.tooltip_max,"show")),this._state.over=!1},_setToolTipOnMouseOver:function(t){var i=this,e=this.options.formatter((t||this._state).value[0]),t=s(t||this._state,this.options.reversed);function s(t,e){return e?[100-t.percentage[0],i.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%"},_copyState:function(){return{value:[this._state.value[0],this._state.value[1]],enabled:this._state.enabled,offset:this._state.offset,size:this._state.size,percentage:[this._state.percentage[0],this._state.percentage[1],this._state.percentage[2]],inDrag:this._state.inDrag,over:this._state.over,dragged:this._state.dragged,keyCtrl:this._state.keyCtrl}},_addTickListener:function(){return{addMouseEnter:function(s,o,n){function t(){var t=s._copyState(),e=o===s.handle1?t.value[0]:t.value[1],i=void 0,i=void 0!==n?(e=s.options.ticks[n],0<s.options.ticks_positions.length&&s.options.ticks_positions[n]||s._toPercentage(s.options.ticks[n])):s._toPercentage(e);t.value[0]=e,t.percentage[0]=i,s._setToolTipOnMouseOver(t),s._showTooltip()}return o.addEventListener("mouseenter",t,!1),t},addMouseLeave:function(t,e){function i(){t._hideTooltip()}return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e,i,s=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]];if(this.handle1.style[this.stylePos]=s[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),t=this.options.formatter(this._state.value[0]),isNaN(t)?this.handle1.setAttribute("aria-valuetext",t):this.handle1.removeAttribute("aria-valuetext"),this.handle2.style[this.stylePos]=s[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),t=this.options.formatter(this._state.value[1]),isNaN(t)?this.handle2.setAttribute("aria-valuetext",t):this.handle2.removeAttribute("aria-valuetext"),0<this.rangeHighlightElements.length&&Array.isArray(this.options.rangeHighlights)&&0<this.options.rangeHighlights.length)for(var o=0;o<this.options.rangeHighlights.length;o++){var n,a=this._toPercentage(this.options.rangeHighlights[o].start),h=this._toPercentage(this.options.rangeHighlights[o].end);this.options.reversed&&(n=100-h,h=100-a,a=n);h=this._createHighlightRange(a,h);h?"vertical"===this.options.orientation?(this.rangeHighlightElements[o].style.top=h.start+"%",this.rangeHighlightElements[o].style.height=h.size+"%"):(this.options.rtl?this.rangeHighlightElements[o].style.right=h.start+"%":this.rangeHighlightElements[o].style.left=h.start+"%",this.rangeHighlightElements[o].style.width=h.size+"%"):this.rangeHighlightElements[o].style.display="none"}if(Array.isArray(this.options.ticks)&&0<this.options.ticks.length){var l="vertical"===this.options.orientation?"height":"width",r="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft",d=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var p=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[r]=-d/2+"px"),p=this.tickLabelContainer.offsetHeight;else for(c=0;c<this.tickLabelContainer.childNodes.length;c++)this.tickLabelContainer.childNodes[c].offsetHeight>p&&(p=this.tickLabelContainer.childNodes[c].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=p+"px")}for(var c=0;c<this.options.ticks.length;c++){var u=this.options.ticks_positions[c]||this._toPercentage(this.options.ticks[c]);this.options.reversed&&(u=100-u),this.ticks[c].style[this.stylePos]=u+"%",this._removeClass(this.ticks[c],"in-selection"),this.options.range?u>=s[0]&&u<=s[1]&&this._addClass(this.ticks[c],"in-selection"):("after"===this.options.selection&&u>=s[0]||"before"===this.options.selection&&u<=s[0])&&this._addClass(this.ticks[c],"in-selection"),this.tickLabels[c]&&(this.tickLabels[c].style[l]=d+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[c]?(this.tickLabels[c].style.position="absolute",this.tickLabels[c].style[this.stylePos]=u+"%",this.tickLabels[c].style[r]=-d/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[c].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[c].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[r]=this.sliderElem.offsetWidth/2*-1+"px"),this._removeClass(this.tickLabels[c],"label-in-selection label-is-selection"),this.options.range?u>=s[0]&&u<=s[1]&&(this._addClass(this.tickLabels[c],"label-in-selection"),u!==s[0]&&!s[1]||this._addClass(this.tickLabels[c],"label-is-selection")):(("after"===this.options.selection&&u>=s[0]||"before"===this.options.selection&&u<=s[0])&&this._addClass(this.tickLabels[c],"label-in-selection"),u===s[0]&&this._addClass(this.tickLabels[c],"label-is-selection")))}}this.options.range?(i=this.options.formatter(this._state.value),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=(s[1]+s[0])/2+"%",e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner_min,e),e=this.options.formatter(this._state.value[1]),this._setText(this.tooltipInner_max,e),this.tooltip_min.style[this.stylePos]=s[0]+"%",this.tooltip_max.style[this.stylePos]=s[1]+"%"):(i=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,i),this.tooltip.style[this.stylePos]=s[0]+"%"),"vertical"===this.options.orientation?(this.trackLow.style.top="0",this.trackLow.style.height=Math.min(s[0],s[1])+"%",this.trackSelection.style.top=Math.min(s[0],s[1])+"%",this.trackSelection.style.height=Math.abs(s[0]-s[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(s[0],s[1])-Math.abs(s[0]-s[1])+"%"):("right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(s[0],s[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(s[0],s[1])+"%":this.trackSelection.style.left=Math.min(s[0],s[1])+"%",this.trackSelection.style.width=Math.abs(s[0]-s[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(s[0],s[1])-Math.abs(s[0]-s[1])+"%",e=this.tooltip_min.getBoundingClientRect(),i=this.tooltip_max.getBoundingClientRect(),"bottom"===this.options.tooltip_position?e.right>i.left?(this._removeClass(this.tooltip_max,"bs-tooltip-bottom"),this._addClass(this.tooltip_max,"bs-tooltip-top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"bs-tooltip-top"),this._addClass(this.tooltip_max,"bs-tooltip-bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):e.right>i.left?(this._removeClass(this.tooltip_max,"bs-tooltip-top"),this._addClass(this.tooltip_max,"bs-tooltip-bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bs-tooltip-bottom"),this._addClass(this.tooltip_max,"bs-tooltip-top"),this.tooltip_max.style.top=this.tooltip_min.style.top))},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?e<t?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;t.preventDefault&&t.preventDefault(),this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e,i,s=this._getPercentage(t);this.options.range?(e=Math.abs(this._state.percentage[0]-s),i=Math.abs(this._state.percentage[1]-s),this._state.dragged=e<i?0:1,this._adjustPercentageForRangeSliders(s)):this._state.dragged=0,this._state.percentage[this._state.dragged]=s,this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;s=this._calculateValue();return this._trigger("slideStart",s),this.setValue(s,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i,s,o,n;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){this.options.natural_arrow_keys&&(s="horizontal"===this.options.orientation,o="vertical"===this.options.orientation,n=this.options.rtl,a=this.options.reversed,s?n?a||(i=-i):a&&(i=-i):o&&(a||(i=-i))),a=this.ticksAreValid&&this.options.lock_to_ticks?(h=void 0,-1===(h=this.options.ticks.indexOf(this._state.value[t]))&&(h=0,window.console.warn("(lock_to_ticks) _keydown: index should not be -1")),h+=i,h=Math.max(0,Math.min(this.options.ticks.length-1,h)),this.options.ticks[h]):this._state.value[t]+i*this.options.step;var a,h=this._toPercentage(a);return this._state.keyCtrl=t,a=this.options.range?(this._adjustPercentageForRangeSliders(h),t=this._state.keyCtrl?this._state.value[0]:a,h=this._state.keyCtrl?a:this._state.value[1],[Math.max(this.options.min,Math.min(this.options.max,t)),Math.max(this.options.min,Math.min(this.options.max,h))]):Math.max(this.options.min,Math.min(this.options.max,a)),this._trigger("slideStart",a),this.setValue(a,!0,!0),this._trigger("slideStop",a),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;t=this._getPercentage(t);this._adjustPercentageForRangeSliders(t),this._state.percentage[this._state.dragged]=t;t=this._calculateValue(!0);return this.setValue(t,!0,!0),!1},_touchmove:function(t){void 0!==t.changedTouches&&t.preventDefault&&t.preventDefault()},_adjustPercentageForRangeSliders:function(t){var e,i;this.options.range&&(e=(e=this._getNumDigitsAfterDecimalPlace(t))?e-1:0,i=this._applyToFixedAndParseFloat(t,e),0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._toPercentage(this._state.value[1])<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._toPercentage(this._state.value[0])>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus()))},_mouseup:function(t){if(!this._state.enabled)return!1;t=this._getPercentage(t);this._adjustPercentageForRangeSliders(t),this._state.percentage[this._state.dragged]=t,this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),(this._state.inDrag=!1)===this._state.over&&this._hideTooltip();t=this._calculateValue(!0);return this.setValue(t,!1,!0),this._trigger("slideStop",t),this._state.dragged=null,!1},_setValues:function(t,e){var i=0===t?0:100;this._state.percentage[t]!==i&&(e.data[t]=this._toValue(this._state.percentage[t]),e.data[t]=this._applyPrecision(e.data[t]))},_calculateValue:function(t){var e={};return this.options.range?(e.data=[this.options.min,this.options.max],this._setValues(0,e),this._setValues(1,e),t&&(e.data[0]=this._snapToClosestTick(e.data[0]),e.data[1]=this._snapToClosestTick(e.data[1]))):(e.data=this._toValue(this._state.percentage[0]),e.data=parseFloat(e.data),e.data=this._applyPrecision(e.data),t&&(e.data=this._snapToClosestTick(e.data))),e.data},_snapToClosestTick:function(t){for(var e=[t,1/0],i=0;i<this.options.ticks.length;i++){var s=Math.abs(this.options.ticks[i]-t);s<=e[1]&&(e=[this.options.ticks[i],s])}return e[1]<=this.options.ticks_snap_bounds?e[0]:t},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){t=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){e=t.toFixed(e);return parseFloat(e)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type&&"touchend"!==t.type||(t=t.changedTouches[0]);t=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(t=-t);t=t/this._state.size*100,t=Math.round(t/this._state.percentage[2])*this._state.percentage[2];return this.options.reversed&&(t=100-t),Math.max(0,Math.min(100,t))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(s(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("number"!=typeof i)throw new Error(s(i))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(t,e){e=e||0===e?e:void 0;var i=this.eventToCallbackMap[t];if(i&&i.length)for(var s=0;s<i.length;s++)(0,i[s])(e);P&&this._triggerJQueryEvent(t,e)},_triggerJQueryEvent:function(t,e){e={type:t,value:e};this.$element.trigger(e),this.$sliderElem.trigger(e)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++)var n=i[o],n=new RegExp("(?:\\s|^)"+n+"(?:\\s|$)"),s=s.replace(n," ");t.className=s.trim()},_addClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++){var n=i[o];new RegExp("(?:\\s|^)"+n+"(?:\\s|$)").test(s)||(s+=" "+n)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(t,e,i){P?P.style(t,e,i):(e=e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),t.style[e]=i)},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var e,i,t=[this.tooltip,this.tooltip_min,this.tooltip_max];"vertical"===this.options.orientation?(e=this.options.tooltip_position||(this.options.rtl?"left":"right"),i="left"===e?"right":"left",t.forEach(function(t){this._addClass(t,"bs-tooltip-"+e),t.style[i]="100%"}.bind(this))):"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bs-tooltip-bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"bs-tooltip-top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))},_getClosestTickIndex:function(t){for(var e=Math.abs(t-this.options.ticks[0]),i=0,s=0;s<this.options.ticks.length;++s){var o=Math.abs(t-this.options.ticks[s]);o<e&&(e=o,i=s)}return i},_setTickIndex:function(){this.ticksAreValid&&(this._state.tickIndex=[this.options.ticks.indexOf(this._state.value[0]),this.options.ticks.indexOf(this._state.value[1])])}},P&&P.fn&&(i=P.fn.slider?(windowIsDefined&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),a):(P.bridget(n,e),n),P.bridget(a,e),P(function(){P("input[data-provide=slider]")[i]()}))}(t),e});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CodeMirror=t()}(this,function(){"use strict";var e=navigator.userAgent,t=navigator.platform,d=/gecko\/\d/i.test(e),n=/MSIE \d/.test(e),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),i=/Edge\/(\d+)/.exec(e),w=n||r||i,v=w&&(n?document.documentMode||6:+(i||r)[1]),f=!i&&/WebKit\//.test(e),r=f&&/Qt\/\d+\.\d+/.test(e),o=!i&&/Chrome\//.test(e),p=/Opera\//.test(e),c=/Apple Computer/.test(navigator.vendor),l=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),u=/PhantomJS/.test(e),s=c&&(/Mobile\/\w+/.test(e)||2<navigator.maxTouchPoints),a=/Android/.test(e),h=s||a||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),g=s||/Mac/.test(t),m=/\bCrOS\b/.test(e),y=/win/i.test(t),e=p&&e.match(/Version\/(\d*\.\d*)/);(e=e&&Number(e[1]))&&15<=e&&(f=!(p=!1));var b=g&&(r||p&&(null==e||e<12.11)),x=d||w&&9<=v;function C(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var S,L=function(e,t){var n=e.className,r=C(t).exec(n);r&&(t=n.slice(r.index+r[0].length),e.className=n.slice(0,r.index)+(t?r[1]+t:""))};function k(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function T(e,t){return k(e).appendChild(t)}function M(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function N(e,t,n,r){r=M(e,t,n,r);return r.setAttribute("role","presentation"),r}function O(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function A(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function D(e,t){var n=e.className;C(t).test(n)||(e.className+=(n?" ":"")+t)}function W(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!C(n[r]).test(t)&&(t+=" "+n[r]);return t}S=document.createRange?function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r};var H=function(e){e.select()};function F(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function P(e,t,n){for(var r in t=t||{},e)!e.hasOwnProperty(r)||!1===n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function E(e,t,n,r,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=r||0,l=i||0;;){var s=e.indexOf("\t",o);if(s<0||t<=s)return l+(t-o);l+=s-o,l+=n-l%n,o=s+1}}s?H=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:w&&(H=function(e){try{e.select()}catch(e){}});var I=function(){this.id=null,this.f=null,this.time=0,this.handler=F(this.onTimeout,this)};function z(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}I.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},I.prototype.set=function(e,t){this.f=t;t=+new Date+e;(!this.id||t<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=t)};var R=50,B={toString:function(){return"CodeMirror.Pass"}},G={scroll:!1},U={origin:"*mouse"},V={origin:"+move"};function K(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("\t",r);-1==o&&(o=e.length);var l=o-r;if(o==e.length||t<=i+l)return r+Math.min(l,t-i);if(i+=o-r,r=o+1,t<=(i+=n-i%n))return r}}var j=[""];function X(e){for(;j.length<=e;)j.push(Y(j)+" ");return j[e]}function Y(e){return e[e.length-1]}function _(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function $(){}function q(e,t){e=Object.create?Object.create(e):($.prototype=e,new $);return t&&P(t,e),e}var Z=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Q(e){return/\w/.test(e)||"Â"<e&&(e.toUpperCase()!=e.toLowerCase()||Z.test(e))}function J(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Q(e))||t.test(e):Q(e)}function ee(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var te=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ne(e){return 768<=e.charCodeAt(0)&&te.test(e)}function re(e,t,n){for(;(n<0?0<t:t<e.length)&&ne(e.charAt(t));)t+=n;return t}function ie(e,t,n){for(var r=n<t?-1:1;;){if(t==n)return t;var i=(t+n)/2,i=r<0?Math.ceil(i):Math.floor(i);if(i==t)return e(i)?t:n;e(i)?n=i:t=i+r}}var oe=null;function le(e,t,n){var r;oe=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==n?r=i:oe=i),o.from==t&&(o.from!=o.to&&"before"!=n?r=i:oe=i)}return null!=r?r:oe}var se,ae,ue,ce,he,de,fe,pe=(se="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",ae="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",ue=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,ce=/[stwN]/,he=/[LRr]/,de=/[Lb1n]/,fe=/[1n]/,function(e,t){var n="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!ue.test(e))return!1;for(var r,i=e.length,o=[],l=0;l<i;++l)o.push((r=e.charCodeAt(l))<=247?se.charAt(r):1424<=r&&r<=1524?"R":1536<=r&&r<=1785?ae.charAt(r-1536):1774<=r&&r<=2220?"r":8192<=r&&r<=8203?"w":8204==r?"b":"L");for(var s=0,a=n;s<i;++s){var u=o[s];"m"==u?o[s]=a:a=u}for(var c=0,h=n;c<i;++c){var d=o[c];"1"==d&&"r"==h?o[c]="n":he.test(d)&&"r"==(h=d)&&(o[c]="R")}for(var f=1,p=o[0];f<i-1;++f){var g=o[f];"+"==g&&"1"==p&&"1"==o[f+1]?o[f]="1":","!=g||p!=o[f+1]||"1"!=p&&"n"!=p||(o[f]=p),p=g}for(var m=0;m<i;++m){var v=o[m];if(","==v)o[m]="N";else if("%"==v){for(var y=void 0,y=m+1;y<i&&"%"==o[y];++y);for(var b=m&&"!"==o[m-1]||y<i&&"1"==o[y]?"1":"N",w=m;w<y;++w)o[w]=b;m=y-1}}for(var x=0,C=n;x<i;++x){var S=o[x];"L"==C&&"1"==S?o[x]="L":he.test(S)&&(C=S)}for(var L=0;L<i;++L)if(ce.test(o[L])){for(var k=void 0,k=L+1;k<i&&ce.test(o[k]);++k);for(var T="L"==(L?o[L-1]:n),M=T==("L"==(k<i?o[k]:n))?T?"L":"R":n,N=L;N<k;++N)o[N]=M;L=k-1}for(var O,A=[],D=0;D<i;)if(de.test(o[D])){var W=D;for(++D;D<i&&de.test(o[D]);++D);A.push(new ge(0,W,D))}else{var H=D,F=A.length,P="rtl"==t?1:0;for(++D;D<i&&"L"!=o[D];++D);for(var E=H;E<D;)if(fe.test(o[E])){H<E&&(A.splice(F,0,new ge(1,H,E)),F+=P);var I=E;for(++E;E<D&&fe.test(o[E]);++E);A.splice(F,0,new ge(2,I,E)),F+=P,H=E}else++E;H<D&&A.splice(F,0,new ge(1,H,D))}return"ltr"==t&&(1==A[0].level&&(O=e.match(/^\s+/))&&(A[0].from=O[0].length,A.unshift(new ge(0,0,O[0].length))),1==Y(A).level&&(O=e.match(/\s+$/))&&(Y(A).to-=O[0].length,A.push(new ge(0,i-O[0].length,i)))),"rtl"==t?A.reverse():A});function ge(e,t,n){this.level=e,this.from=t,this.to=n}function me(e,t){var n=e.order;return null==n&&(n=e.order=pe(e.text,t)),n}var ve=[],ye=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}))[t]=(e[t]||ve).concat(n)};function be(e,t){return e._handlers&&e._handlers[t]||ve}function we(e,t,n){var r;e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):!(e=(r=e._handlers)&&r[t])||-1<(n=z(e,n))&&(r[t]=e.slice(0,n).concat(e.slice(n+1)))}function xe(e,t){var n=be(e,t);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function Ce(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),xe(e,n||t.type,e,t),Ne(t)||t.codemirrorIgnore}function Se(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==z(n,t[r])&&n.push(t[r])}function Le(e,t){return 0<be(e,t).length}function ke(e){e.prototype.on=function(e,t){ye(this,e,t)},e.prototype.off=function(e,t){we(this,e,t)}}function Te(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Me(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Ne(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Oe(e){Te(e),Me(e)}function Ae(e){return e.target||e.srcElement}function De(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),g&&e.ctrlKey&&1==t&&(t=3),t}var We,He,Fe=function(){if(w&&v<9)return!1;var e=M("div");return"draggable"in e||"dragDrop"in e}();var Pe=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;t<=r;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),l=o.indexOf("\r");-1!=l?(n.push(o.slice(0,l)),t+=l+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Ee=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Ie="oncopy"in(r=M("div"))||(r.setAttribute("oncopy","return;"),"function"==typeof r.oncopy),ze=null;var Re={},Be={};function Ge(e){if("string"==typeof e&&Be.hasOwnProperty(e))e=Be[e];else if(e&&"string"==typeof e.name&&Be.hasOwnProperty(e.name)){var t=Be[e.name];"string"==typeof t&&(t={name:t}),(e=q(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Ge("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Ge("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ue(e,t){t=Ge(t);var n=Re[t.name];if(!n)return Ue(e,"text/plain");var r=n(e,t);if(Ve.hasOwnProperty(t.name)){var i,o=Ve[t.name];for(i in o)o.hasOwnProperty(i)&&(r.hasOwnProperty(i)&&(r["_"+i]=r[i]),r[i]=o[i])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var l in t.modeProps)r[l]=t.modeProps[l];return r}var Ve={};function Ke(e,t){P(t,Ve.hasOwnProperty(e)?Ve[e]:Ve[e]={})}function je(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n,r={};for(n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function Xe(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function Ye(e,t,n){return!e.startState||e.startState(t,n)}var _e=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function $e(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(t<o){n=i;break}t-=o}return n.lines[t]}function qe(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text;i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),r.push(e),++i}),r}function Ze(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function Qe(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function Je(e){if(null==e.parent)return null;for(var t=e.parent,n=z(t.lines,e),r=t.parent;r;r=(t=r).parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function et(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(t<o){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var l=0;l<e.lines.length;++l){var s=e.lines[l].height;if(t<s)break;t-=s}return n+l}function tt(e,t){return t>=e.first&&t<e.first+e.size}function nt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function rt(e,t,n){if(void 0===n&&(n=null),!(this instanceof rt))return new rt(e,t,n);this.line=e,this.ch=t,this.sticky=n}function it(e,t){return e.line-t.line||e.ch-t.ch}function ot(e,t){return e.sticky==t.sticky&&0==it(e,t)}function lt(e){return rt(e.line,e.ch)}function st(e,t){return it(e,t)<0?t:e}function at(e,t){return it(e,t)<0?e:t}function ut(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function ct(e,t){if(t.line<e.first)return rt(e.first,0);var n=e.first+e.size-1;return t.line>n?rt(n,$e(e,n).text.length):(e=$e(e,(n=t).line).text.length,null==(t=n.ch)||e<t?rt(n.line,e):t<0?rt(n.line,0):n)}function ht(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=ct(e,t[r]);return n}_e.prototype.eol=function(){return this.pos>=this.string.length},_e.prototype.sol=function(){return this.pos==this.lineStart},_e.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},_e.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},_e.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},_e.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},_e.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},_e.prototype.skipToEnd=function(){this.pos=this.string.length},_e.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},_e.prototype.backUp=function(e){this.pos-=e},_e.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=E(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?E(this.string,this.lineStart,this.tabSize):0)},_e.prototype.indentation=function(){return E(this.string,null,this.tabSize)-(this.lineStart?E(this.string,this.lineStart,this.tabSize):0)},_e.prototype.match=function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&0<r.index?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}r=function(e){return n?e.toLowerCase():e};if(r(this.string.substr(this.pos,e.length))==r(e))return!1!==t&&(this.pos+=e.length),!0},_e.prototype.current=function(){return this.string.slice(this.start,this.pos)},_e.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},_e.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},_e.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var dt=function(e,t){this.state=e,this.lookAhead=t},ft=function(e,t,n,r){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function pt(t,n,r,e){var a=[t.state.modeGen],i={};St(t,n.text,t.doc.mode,r,function(e,t){return a.push(e,t)},i,e);for(var u=r.state,o=0;o<t.state.overlays.length;++o)!function(e){r.baseTokens=a;var o=t.state.overlays[e],l=1,s=0;r.state=!0,St(t,n.text,o.mode,r,function(e,t){for(var n=l;s<e;){var r=a[l];e<r&&a.splice(l,1,e,a[l+1],r),l+=2,s=Math.min(e,r)}if(t)if(o.opaque)a.splice(n,l-n,e,"overlay "+t),l=n+2;else for(;n<l;n+=2){var i=a[n+1];a[n+1]=(i?i+" ":"")+"overlay "+t}},i),r.state=u,r.baseTokens=null,r.baseTokenPos=1}(o);return{styles:a,classes:i.bgClass||i.textClass?i:null}}function gt(e,t,n){var r,i,o;return t.styles&&t.styles[0]==e.state.modeGen||(r=mt(e,Je(t)),i=t.text.length>e.options.maxHighlightLength&&je(e.doc.mode,r.state),o=pt(e,t,r),i&&(r.state=i),t.stateAfter=r.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function mt(n,r,e){var t=n.doc,i=n.display;if(!t.mode.startState)return new ft(t,!0,r);var o=function(e,t,n){for(var r,i,o=e.doc,l=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;l<s;--s){if(s<=o.first)return o.first;var a=$e(o,s-1),u=a.stateAfter;if(u&&(!n||s+(u instanceof dt?u.lookAhead:0)<=o.modeFrontier))return s;a=E(a.text,null,e.options.tabSize);(null==i||a<r)&&(i=s-1,r=a)}return i}(n,r,e),l=o>t.first&&$e(t,o-1).stateAfter,s=l?ft.fromSaved(t,l,o):new ft(t,Ye(t.mode),o);return t.iter(o,r,function(e){vt(n,e.text,s);var t=s.line;e.stateAfter=t==r-1||t%5==0||t>=i.viewFrom&&t<i.viewTo?s.save():null,s.nextLine()}),e&&(t.modeFrontier=s.line),s}function vt(e,t,n,r){var i=e.doc.mode,o=new _e(t,e.options.tabSize,n);for(o.start=o.pos=r||0,""==t&&yt(i,n.state);!o.eol();)bt(i,o,n.state),o.start=o.pos}function yt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){t=Xe(e,t);return t.mode.blankLine?t.mode.blankLine(t.state):void 0}}function bt(e,t,n,r){for(var i=0;i<10;i++){r&&(r[0]=Xe(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}ft.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ft.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ft.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},ft.fromSaved=function(e,t,n){return t instanceof dt?new ft(e,je(e.mode,t.state),n,t.lookAhead):new ft(e,je(e.mode,t),n)},ft.prototype.save=function(e){e=!1!==e?je(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new dt(e,this.maxLookAhead):e};var wt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function xt(e,t,n,r){var i,o,l=e.doc,s=l.mode,a=$e(l,(t=ct(l,t)).line),u=mt(e,t.line,n),c=new _e(a.text,e.options.tabSize,u);for(r&&(o=[]);(r||c.pos<t.ch)&&!c.eol();)c.start=c.pos,i=bt(s,c,u.state),r&&o.push(new wt(c,i,je(l.mode,u.state)));return r?o:new wt(c,i,u.state)}function Ct(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|\\s)"+n[2]+"(?:$|\\s)").test(t[r])||(t[r]+=" "+n[2])}return e}function St(e,t,n,r,i,o,l){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var a=0,u=null,c=new _e(t,e.options.tabSize,r),h=e.options.addModeClass&&[null];for(""==t&&Ct(yt(n,r.state),o);!c.eol();){var d,f=c.pos>e.options.maxHighlightLength?(s=!1,l&&vt(e,t,r,c.pos),c.pos=t.length,null):Ct(bt(n,c,r.state,h),o);if(!h||(d=h[0].name)&&(f="m-"+(f?d+" "+f:d)),!s||u!=f){for(;a<c.start;)i(a=Math.min(c.start,a+5e3),u);u=f}c.start=c.pos}for(;a<c.pos;){var p=Math.min(c.pos,a+5e3);i(p,u),a=p}}var Lt=!1,kt=!1;function Tt(e,t,n){this.marker=e,this.from=t,this.to=n}function Mt(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Nt(e,t){if(t.full)return null;var n=tt(e,t.from.line)&&$e(e,t.from.line).markedSpans,r=tt(e,t.to.line)&&$e(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,o=t.to.ch,e=0==it(t.from,t.to),l=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t))&&(l.from!=t||"bookmark"!=s.type||n&&l.marker.insertLeft)||(o=null==l.to||(s.inclusiveRight?l.to>=t:l.to>t),(r=r||[]).push(new Tt(s,l.from,o?null:l.to)))}return r}(n,i,e),s=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,l=e[i],s=l.marker;!(null==l.to||(s.inclusiveRight?l.to>=t:l.to>t))&&(l.from!=t||"bookmark"!=s.type||n&&!l.marker.insertLeft)||(o=null==l.from||(s.inclusiveLeft?l.from<=t:l.from<t),(r=r||[]).push(new Tt(s,o?null:l.from-t,null==l.to?null:l.to-t)))}return r}(r,o,e),a=1==t.text.length,u=Y(t.text).length+(a?i:0);if(l)for(var c=0;c<l.length;++c){var h,d=l[c];null==d.to&&((h=Mt(s,d.marker))?a&&(d.to=null==h.to?null:h.to+u):d.to=i)}if(s)for(var f=0;f<s.length;++f){var p=s[f];null!=p.to&&(p.to+=u),null==p.from?Mt(l,p.marker)||(p.from=u,a&&(l=l||[]).push(p)):(p.from+=u,a&&(l=l||[]).push(p))}l=l&&Ot(l),s&&s!=l&&(s=Ot(s));var g=[l];if(!a){var m,v=t.text.length-2;if(0<v&&l)for(var y=0;y<l.length;++y)null==l[y].to&&(m=m||[]).push(new Tt(l[y].marker,null,null));for(var b=0;b<v;++b)g.push(m);g.push(s)}return g}function Ot(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function At(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Dt(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Wt(e){return e.inclusiveLeft?-1:0}function Ht(e){return e.inclusiveRight?1:0}function Ft(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),n=it(r.from,i.from)||Wt(e)-Wt(t);if(n)return-n;i=it(r.to,i.to)||Ht(e)-Ht(t);return i||t.id-e.id}function Pt(e,t){var n,r=kt&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)(i=r[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!n||Ft(n,i.marker)<0)&&(n=i.marker);return n}function Et(e){return Pt(e,!0)}function It(e){return Pt(e,!1)}function zt(e,t,n,r,i){var t=$e(e,t),o=kt&&t.markedSpans;if(o)for(var l=0;l<o.length;++l){var s=o[l];if(s.marker.collapsed){var a=s.marker.find(0),u=it(a.from,n)||Wt(s.marker)-Wt(i),c=it(a.to,r)||Ht(s.marker)-Ht(i);if(!(0<=u&&c<=0||u<=0&&0<=c)&&(u<=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?0<=it(a.to,n):0<it(a.to,n))||0<=u&&(s.marker.inclusiveRight&&i.inclusiveLeft?it(a.from,r)<=0:it(a.from,r)<0)))return 1}}}function Rt(e){for(var t;t=Et(e);)e=t.find(-1,!0).line;return e}function Bt(e,t){var n=$e(e,t),e=Rt(n);return n==e?t:Je(e)}function Gt(e,t){if(t>e.lastLine())return t;var n,r=$e(e,t);if(!Ut(e,r))return t;for(;n=It(r);)r=n.find(1,!0).line;return Je(r)+1}function Ut(e,t){var n=kt&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if((r=n[i]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&function e(t,n,r){if(null==r.to){var i=r.marker.find(1,!0);return e(t,i.line,Mt(i.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==n.text.length)return!0;for(var o=void 0,l=0;l<n.markedSpans.length;++l)if((o=n.markedSpans[l]).marker.collapsed&&!o.marker.widgetNode&&o.from==r.to&&(null==o.to||o.to!=r.from)&&(o.marker.inclusiveLeft||r.marker.inclusiveRight)&&e(t,n,o))return!0}(e,t,r))return!0}}function Vt(e){for(var t=0,n=(e=Rt(e)).parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;o=(n=o).parent)for(var l=0;l<o.children.length;++l){var s=o.children[l];if(s==n)break;t+=s.height}return t}function Kt(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=Et(r);){var i=t.find(0,!0),r=i.from.line;n+=i.from.ch-i.to.ch}for(r=e;t=It(r);){var o=t.find(0,!0);n-=r.text.length-o.from.ch,n+=(r=o.to.line).text.length-o.to.ch}return n}function jt(e){var n=e.display,e=e.doc;n.maxLine=$e(e,e.first),n.maxLineLength=Kt(n.maxLine),n.maxLineChanged=!0,e.iter(function(e){var t=Kt(e);t>n.maxLineLength&&(n.maxLineLength=t,n.maxLine=e)})}var Xt=function(e,t,n){this.text=e,Dt(this,t),this.height=n?n(this):1};Xt.prototype.lineNo=function(){return Je(this)},ke(Xt);var Yt={},_t={};function $t(e,t){if(!e||/^\s*$/.test(e))return null;t=t.addModeClass?_t:Yt;return t[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function qt(e,t){var n=N("span",null,null,f?"padding-right: .1px":null),r={pre:N("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o=i?t.rest[i-1]:t.line,l=void 0;r.pos=0,r.addToken=Qt,function(e){if(null!=He)return He;var t=T(e,document.createTextNode("AØ®A")),n=S(t,0,1).getBoundingClientRect(),t=S(t,1,2).getBoundingClientRect();return k(e),n&&n.left!=n.right&&(He=t.right-n.right<3)}(e.display.measure)&&(l=me(o,e.doc.direction))&&(r.addToken=function(h,d){return function(e,t,n,r,i,o,l){n=n?n+" cm-force-border":"cm-force-border";for(var s=e.pos,a=s+t.length;;){for(var u=void 0,c=0;c<d.length&&!((u=d[c]).to>s&&u.from<=s);c++);if(u.to>=a)return h(e,t,n,r,i,o,l);h(e,t.slice(0,u.to-s),n,r,null,o,l),r=null,t=t.slice(u.to-s),s=u.to}}}(r.addToken,l)),r.map=[],function(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var l,s,a,u,c,h,d,f=i.length,p=0,g=1,m="",v=0;;){if(v==p){a=u=c=s="",h=d=null,v=1/0;for(var y=[],b=void 0,w=0;w<r.length;++w){var x=r[w],C=x.marker;if("bookmark"==C.type&&x.from==p&&C.widgetNode)y.push(C);else if(x.from<=p&&(null==x.to||x.to>p||C.collapsed&&x.to==p&&x.from==p)){if(null!=x.to&&x.to!=p&&v>x.to&&(v=x.to,u=""),C.className&&(a+=" "+C.className),C.css&&(s=(s?s+";":"")+C.css),C.startStyle&&x.from==p&&(c+=" "+C.startStyle),C.endStyle&&x.to==v&&(b=b||[]).push(C.endStyle,x.to),C.title&&((d=d||{}).title=C.title),C.attributes)for(var S in C.attributes)(d=d||{})[S]=C.attributes[S];C.collapsed&&(!h||Ft(h.marker,C)<0)&&(h=x)}else x.from>p&&v>x.from&&(v=x.from)}if(b)for(var L=0;L<b.length;L+=2)b[L+1]==v&&(u+=" "+b[L]);if(!h||h.from==p)for(var k=0;k<y.length;++k)Jt(t,0,y[k]);if(h&&(h.from||0)==p){if(Jt(t,(null==h.to?f+1:h.to)-p,h.marker,null==h.from),null==h.to)return;h.to==p&&(h=!1)}}if(f<=p)break;for(var T=Math.min(f,v);;){if(m){var M,N=p+m.length;if(h||(M=T<N?m.slice(0,T-p):m,t.addToken(t,M,l?l+a:a,c,p+M.length==v?u:"",s,d)),T<=N){m=m.slice(T-p),p=T;break}p=N,c=""}m=i.slice(o,o=n[g++]),l=$t(n[g++],t.cm.options)}}else for(var O=1;O<n.length;O+=2)t.addToken(t,i.slice(o,o=n[O]),$t(n[O+1],t.cm.options))}(o,r,gt(e,o,t!=e.display.externalMeasured&&Je(o))),o.styleClasses&&(o.styleClasses.bgClass&&(r.bgClass=W(o.styleClasses.bgClass,r.bgClass||"")),o.styleClasses.textClass&&(r.textClass=W(o.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(function(e){null==We&&(t=M("span","â"),T(e,M("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(We=t.offsetWidth<=1&&2<t.offsetHeight&&!(w&&v<8)));var t=We?M("span","â"):M("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px");return t.setAttribute("cm-text",""),t}(e.display.measure))),0==i?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return f&&(n=r.content.lastChild,(/\bcm-tab\b/.test(n.className)||n.querySelector&&n.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")),xe(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=W(r.pre.className,r.textClass||"")),r}function Zt(e){var t=M("span","â¢","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Qt(e,t,n,r,i,o,l){if(t){var s,a=e.splitSpaces?function(e,t){if(1<e.length&&!/  /.test(e))return e;for(var n=t,r="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!n||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o="Â "),r+=o,n=" "==o}return r}(t,e.trailingSpace):t,u=e.cm.state.specialChars,c=!1;if(u.test(t)){s=document.createDocumentFragment();for(var h=0;;){u.lastIndex=h;var d=u.exec(t),f=d?d.index-h:t.length-h;if(f&&(p=document.createTextNode(a.slice(h,h+f)),w&&v<9?s.appendChild(M("span",[p])):s.appendChild(p),e.map.push(e.pos,e.pos+f,p),e.col+=f,e.pos+=f),!d)break;h+=1+f;var p=void 0;"\t"==d[0]?(f=(f=e.cm.options.tabSize)-e.col%f,(p=s.appendChild(M("span",X(f),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text","\t"),e.col+=f):("\r"==d[0]||"\n"==d[0]?(p=s.appendChild(M("span","\r"==d[0]?"â":"â¤","cm-invalidchar"))).setAttribute("cm-text",d[0]):((p=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),w&&v<9?s.appendChild(M("span",[p])):s.appendChild(p)),e.col+=1),e.map.push(e.pos,e.pos+1,p),e.pos++}}else e.col+=t.length,s=document.createTextNode(a),e.map.push(e.pos,e.pos+t.length,s),w&&v<9&&(c=!0),e.pos+=t.length;if(e.trailingSpace=32==a.charCodeAt(t.length-1),n||r||i||c||o||l){n=n||"";r&&(n+=r),i&&(n+=i);var g=M("span",[s],n,o);if(l)for(var m in l)l.hasOwnProperty(m)&&"style"!=m&&"class"!=m&&g.setAttribute(m,l[m]);return e.content.appendChild(g)}e.content.appendChild(s)}}function Jt(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i=i||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",n.id),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function en(e,t,n){this.line=t,this.rest=function(e){for(var t,n;t=It(e);)e=t.find(1,!0).line,(n=n||[]).push(e);return n}(t),this.size=this.rest?Je(Y(this.rest))-n+1:1,this.node=this.text=null,this.hidden=Ut(e,t)}function tn(e,t,n){for(var r=[],i=t;i<n;i=l){var o=new en(e.doc,$e(e.doc,i),i),l=i+o.size;r.push(o)}return r}var nn=null;function rn(e,t){var n=e.ownsGroup;if(n)try{!function(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<t.length)}(n)}finally{nn=null,t(n)}}var on=null;function ln(e,t){var n=be(e,t);if(n.length){var r,i=Array.prototype.slice.call(arguments,2);nn?r=nn.delayedCallbacks:on?r=on:(r=on=[],setTimeout(sn,0));for(var o=0;o<n.length;++o)!function(e){r.push(function(){return n[e].apply(null,i)})}(o)}}function sn(){var e=on;on=null;for(var t=0;t<e.length;++t)e[t]()}function an(e,t,n,r){for(var i,o,l,s,a=0;a<t.changes.length;a++){var u=t.changes[a];"text"==u?(i=e,s=l=void 0,l=(o=t).text.className,s=cn(i,o),o.text==o.node&&(o.node=s.pre),o.text.parentNode.replaceChild(s.pre,o.text),o.text=s.pre,s.bgClass!=o.bgClass||s.textClass!=o.textClass?(o.bgClass=s.bgClass,o.textClass=s.textClass,hn(i,o)):l&&(o.text.className=l)):"gutter"==u?dn(e,t,n,r):"class"==u?hn(e,t):"widget"==u&&function(e,t,n){t.alignable&&(t.alignable=null);for(var r=C("CodeMirror-linewidget"),i=t.node.firstChild,o=void 0;i;i=o)o=i.nextSibling,r.test(i.className)&&t.node.removeChild(i);fn(e,t,n)}(e,t,r)}t.changes=null}function un(e){return e.node==e.text&&(e.node=M("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),w&&v<8&&(e.node.style.zIndex=2)),e.node}function cn(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):qt(e,t)}function hn(e,t){var n,r;n=e,(r=(i=t).bgClass?i.bgClass+" "+(i.line.bgClass||""):i.line.bgClass)&&(r+=" CodeMirror-linebackground"),i.background?r?i.background.className=r:(i.background.parentNode.removeChild(i.background),i.background=null):r&&(e=un(i),i.background=e.insertBefore(M("div",null,r),e.firstChild),n.display.input.setUneditable(i.background)),t.line.wrapClass?un(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function dn(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(o=un(t),t.gutterBackground=M("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),o.insertBefore(t.gutterBackground,t.text));var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=un(t),l=t.gutter=M("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(l.setAttribute("aria-hidden","true"),e.display.input.setUneditable(l),o.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(M("div",nt(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var s=0;s<e.display.gutterSpecs.length;++s){var a=e.display.gutterSpecs[s].className,u=i.hasOwnProperty(a)&&i[a];u&&l.appendChild(M("div",[u],"CodeMirror-gutter-elt","left: "+r.gutterLeft[a]+"px; width: "+r.gutterWidth[a]+"px"))}}}function fn(e,t,n){if(pn(e,t.line,t,n,!0),t.rest)for(var r=0;r<t.rest.length;r++)pn(e,t.rest[r],t,n,!1)}function pn(e,t,n,r,i){if(t.widgets)for(var o,l,s,a,u=un(n),c=0,h=t.widgets;c<h.length;++c){var d=h[c],f=M("div",[d.node],"CodeMirror-linewidget"+(d.className?" "+d.className:""));d.handleMouseEvents||f.setAttribute("cm-ignore-events","true"),l=f,s=n,a=r,(o=d).noHScroll&&((s.alignable||(s.alignable=[])).push(l),s=a.wrapperWidth,l.style.left=a.fixedPos+"px",o.coverGutter||(s-=a.gutterTotalWidth,l.style.paddingLeft=a.gutterTotalWidth+"px"),l.style.width=s+"px"),o.coverGutter&&(l.style.zIndex=5,l.style.position="relative",o.noHScroll||(l.style.marginLeft=-a.gutterTotalWidth+"px")),e.display.input.setUneditable(f),i&&d.above?u.insertBefore(f,n.gutter||n.text):u.appendChild(f),ln(d,"redraw")}}function gn(e){if(null!=e.height)return e.height;var t,n=e.doc.cm;return n?(O(document.body,e.node)||(t="position: relative;",e.coverGutter&&(t+="margin-left: -"+n.display.gutters.offsetWidth+"px;"),e.noHScroll&&(t+="width: "+n.display.wrapper.clientWidth+"px;"),T(n.display.measure,M("div",[e.node],null,t))),e.height=e.node.parentNode.offsetHeight):0}function mn(e,t){for(var n=Ae(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return 1}function vn(e){return e.lineSpace.offsetTop}function yn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function bn(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=T(e.measure,M("pre","x","CodeMirror-line-like")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)};return isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t}function wn(e){return R-e.display.nativeBarWidth}function xn(e){return e.display.scroller.clientWidth-wn(e)-e.display.barWidth}function Cn(e){return e.display.scroller.clientHeight-wn(e)-e.display.barHeight}function Sn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var i=0;i<e.rest.length;i++)if(Je(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Ln(e,t,n,r){return Mn(e,Tn(e,t),n,r)}function kn(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[er(e,t)];e=e.display.externalMeasured;return e&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Tn(e,t){var n,r,i=Je(t),o=kn(e,i);o&&!o.text?o=null:o&&o.changes&&(an(e,o,i,$n(e)),e.curOp.forceUpdate=!0),o||(n=e,e=Je(r=Rt(r=t)),(r=n.display.externalMeasured=new en(n.doc,r,e)).lineN=e,e=r.built=qt(n,r),r.text=e.pre,T(n.display.lineMeasure,e.pre),o=r);i=Sn(o,t,i);return{line:t,view:o,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Mn(e,t,n,r,i){t.before&&(n=-1);var o,l=n+(r||"");return t.cache.hasOwnProperty(l)?o=t.cache[l]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,n){var r=e.options.lineWrapping,e=r&&xn(e);if(!t.measure.heights||r&&t.measure.width!=e){var i=t.measure.heights=[];if(r){t.measure.width=e;for(var o=t.text.firstChild.getClientRects(),l=0;l<o.length-1;l++){var s=o[l],a=o[l+1];2<Math.abs(s.bottom-a.bottom)&&i.push((s.bottom+a.top)/2-n.top)}}i.push(n.bottom-n.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,n,r){var i,o=An(t.map,n,r),l=o.node,s=o.start,a=o.end,u=o.collapse;if(3==l.nodeType){for(var c=0;c<4;c++){for(;s&&ne(t.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+a<o.coverEnd&&ne(t.line.text.charAt(o.coverStart+a));)++a;if((i=w&&v<9&&0==s&&a==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():function(e,t){var n=On;if("left"==t)for(var r=0;r<e.length&&(n=e[r]).left==n.right;r++);else for(var i=e.length-1;0<=i&&(n=e[i]).left==n.right;i--);return n}(S(l,s,a).getClientRects(),r)).left||i.right||0==s)break;a=s,--s,u="right"}w&&v<11&&(i=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=ze)return ze;var e=(t=T(e,M("span","x"))).getBoundingClientRect(),t=S(t,0,1).getBoundingClientRect();return ze=1<Math.abs(e.left-t.left)}(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,e=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*e,bottom:t.bottom*e}}(e.display.measure,i))}else 0<s&&(u=r="right"),i=e.options.lineWrapping&&1<(g=l.getClientRects()).length?g["right"==r?g.length-1:0]:l.getBoundingClientRect();!(w&&v<9)||s||i&&(i.left||i.right)||(m=l.parentNode.getClientRects()[0],i=m?{left:m.left,right:m.left+_n(e.display),top:m.top,bottom:m.bottom}:On);for(var h=i.top-t.rect.top,n=i.bottom-t.rect.top,d=(h+n)/2,f=t.view.measure.heights,p=0;p<f.length-1&&!(d<f[p]);p++);var g=p?f[p-1]:0,m=f[p],m={left:("right"==u?i.right:i.left)-t.rect.left,right:("left"==u?i.left:i.right)-t.rect.left,top:g,bottom:m};i.left||i.right||(m.bogus=!0);e.options.singleCursorHeightPerLine||(m.rtop=h,m.rbottom=n);return m}(e,t,n,r)).bogus||(t.cache[l]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var Nn,On={left:0,right:0,top:0,bottom:0};function An(e,t,n){for(var r,i,o,l,s,a,u=0;u<e.length;u+=3)if(s=e[u],a=e[u+1],t<s?(i=0,o=1,l="left"):t<a?o=(i=t-s)+1:(u==e.length-3||t==a&&e[u+3]>t)&&(i=(o=a-s)-1,a<=t&&(l="right")),null!=i){if(r=e[u+2],s==a&&n==(r.insertLeft?"left":"right")&&(l=n),"left"==n&&0==i)for(;u&&e[u-2]==e[u-3]&&e[u-1].insertLeft;)r=e[2+(u-=3)],l="left";if("right"==n&&i==a-s)for(;u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft;)r=e[(u+=3)+2],l="right";break}return{node:r,start:i,end:o,collapse:l,coverStart:s,coverEnd:a}}function Dn(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Wn(e){e.display.externalMeasure=null,k(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Dn(e.display.view[t])}function Hn(e){Wn(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Fn(){return o&&a?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Pn(){return o&&a?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function En(e){var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;++n)e.widgets[n].above&&(t+=gn(e.widgets[n]));return t}function In(e,t,n,r,i){if(i||(i=En(t),n.top+=i,n.bottom+=i),"line"==r)return n;r=r||"local";t=Vt(t);return"local"==r?t+=vn(e.display):t-=e.display.viewOffset,"page"!=r&&"window"!=r||(t+=(e=e.display.lineSpace.getBoundingClientRect()).top+("window"==r?0:Pn()),r=e.left+("window"==r?0:Fn()),n.left+=r,n.right+=r),n.top+=t,n.bottom+=t,n}function zn(e,t,n){if("div"==n)return t;var r=t.left,t=t.top;"page"==n?(r-=Fn(),t-=Pn()):"local"!=n&&n||(r+=(n=e.display.sizer.getBoundingClientRect()).left,t+=n.top);e=e.display.lineSpace.getBoundingClientRect();return{left:r-e.left,top:t-e.top}}function Rn(e,t,n,r,i){return In(e,r=r||$e(e.doc,t.line),Ln(e,r,t.ch,i),n)}function Bn(n,e,r,i,o,l){function s(e,t){e=Mn(n,o,e,t?"right":"left",l);return t?e.left=e.right:e.right=e.left,In(n,i,e,r)}i=i||$e(n.doc,e.line),o=o||Tn(n,i);var a=me(i,n.doc.direction),t=e.ch,u=e.sticky;if(t>=i.text.length?(t=i.text.length,u="before"):t<=0&&(t=0,u="after"),!a)return s("before"==u?t-1:t,"before"==u);function c(e,t,n){return s(n?e-1:e,1==a[t].level!=n)}var h=le(a,t,u),e=oe,h=c(t,h,"before"==u);return null!=e&&(h.other=c(t,e,"before"!=u)),h}function Gn(e,t){var n=0;t=ct(e.doc,t),e.options.lineWrapping||(n=_n(e.display)*t.ch);t=$e(e.doc,t.line),e=Vt(t)+vn(e.display);return{left:n,right:n,top:e,bottom:e+t.height}}function Un(e,t,n,r,i){n=rt(e,t,n);return n.xRel=i,r&&(n.outside=r),n}function Vn(e,t,n){var r=e.doc;if((n+=e.display.viewOffset)<0)return Un(r.first,0,null,-1,-1);var i=et(r,n),o=r.first+r.size-1;if(o<i)return Un(r.first+r.size-1,$e(r,o).text.length,null,1,1);t<0&&(t=0);for(var l=$e(r,i);;){var s=function(n,e,t,r,i){i-=Vt(e);var o=Tn(n,e),l=En(e),s=0,a=e.text.length,u=!0,c=me(e,n.doc.direction);c&&(f=(n.options.lineWrapping?function(e,t,n,r,i,o,l){var l=Kn(e,t,r,l),s=l.begin,a=l.end;/\s/.test(t.text.charAt(a-1))&&a--;for(var u=null,c=null,h=0;h<i.length;h++){var d,f=i[h];f.from>=a||f.to<=s||(d=1!=f.level,d=Mn(e,r,d?Math.min(a,f.to)-1:Math.max(s,f.from)).right,d=d<o?o-d+1e9:d-o,(!u||d<c)&&(u=f,c=d))}u=u||i[i.length-1];u.from<s&&(u={from:s,to:u.to,level:u.level});u.to>a&&(u={from:u.from,to:a,level:u.level});return u}:function(n,r,i,o,l,s,a){var e=ie(function(e){var t=l[e],e=1!=t.level;return Xn(Bn(n,rt(i,e?t.to:t.from,e?"before":"after"),"line",r,o),s,a,!0)},0,l.length-1),t=l[e];{var u;0<e&&(u=1!=t.level,Xn(u=Bn(n,rt(i,u?t.from:t.to,u?"after":"before"),"line",r,o),s,a,!0)&&u.top>a&&(t=l[e-1]))}return t})(n,e,t,o,c,r,i),u=1!=f.level,s=u?f.from:f.to-1,a=u?f.to:f.from-1);var h=null,d=null,c=ie(function(e){var t=Mn(n,o,e);return t.top+=l,t.bottom+=l,Xn(t,r,i,!1)&&(t.top<=i&&t.left<=r&&(h=e,d=t),1)},s,a),f=!1;{var p,g;d?(p=r-d.left<d.right-r,c=h+((g=p==u)?0:1),g=g?"after":"before",p=p?d.left:d.right):(u||c!=a&&c!=s||c++,g=0==c||c!=e.text.length&&Mn(n,o,c-(u?1:0)).bottom+l<=i==u?"after":"before",u=Bn(n,rt(t,c,g),"line",e,o),p=u.left,f=i<u.top?-1:i>=u.bottom?1:0)}return c=re(e.text,c,1),Un(t,c,g,f,r-p)}(e,l,i,t,n),a=function(e,t){var n,r=kt&&e.markedSpans;if(r)for(var i=0;i<r.length;++i){var o=r[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||Ft(n,o.marker)<0)&&(n=o.marker)}return n}(l,s.ch+(0<s.xRel||0<s.outside?1:0));if(!a)return s;a=a.find(1);if(a.line==i)return a;l=$e(r,i=a.line)}}function Kn(t,e,n,r){r-=En(e);var i=e.text.length,e=ie(function(e){return Mn(t,n,e-1).bottom<=r},i,0);return{begin:e,end:i=ie(function(e){return Mn(t,n,e).top>r},e,i)}}function jn(e,t,n,r){return Kn(e,t,n=n||Tn(e,t),In(e,t,Mn(e,n,r),"line").top)}function Xn(e,t,n,r){return!(e.bottom<=n)&&(e.top>n||(r?e.left:e.right)>t)}function Yn(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Nn){Nn=M("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)Nn.appendChild(document.createTextNode("x")),Nn.appendChild(M("br"));Nn.appendChild(document.createTextNode("x"))}T(e.measure,Nn);var n=Nn.offsetHeight/50;return 3<n&&(e.cachedTextHeight=n),k(e.measure),n||1}function _n(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=M("span","xxxxxxxxxx"),n=M("pre",[t],"CodeMirror-line-like");T(e.measure,n);t=t.getBoundingClientRect(),t=(t.right-t.left)/10;return 2<t&&(e.cachedCharWidth=t),t||10}function $n(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,l=0;o;o=o.nextSibling,++l){var s=e.display.gutterSpecs[l].className;n[s]=o.offsetLeft+o.clientLeft+i,r[s]=o.clientWidth}return{fixedPos:qn(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function qn(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Zn(r){var i=Yn(r.display),o=r.options.lineWrapping,l=o&&Math.max(5,r.display.scroller.clientWidth/_n(r.display)-3);return function(e){if(Ut(r.doc,e))return 0;var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;n++)e.widgets[n].height&&(t+=e.widgets[n].height);return o?t+(Math.ceil(e.text.length/l)||1)*i:t+i}}function Qn(e){var t=e.doc,n=Zn(e);t.iter(function(e){var t=n(e);t!=e.height&&Qe(e,t)})}function Jn(e,t,n,r){var i=e.display;if(!n&&"true"==Ae(t).getAttribute("cm-not-content"))return null;var o,l,s=i.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,l=t.clientY-s.top}catch(e){return null}var a,i=Vn(e,o,l);return r&&0<i.xRel&&(a=$e(e.doc,i.line).text).length==i.ch&&(a=E(a,a.length,e.options.tabSize)-a.length,i=rt(i.line,Math.max(0,Math.round((o-bn(e.display).left)/_n(e.display))-a))),i}function er(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if((t-=n[r].size)<0)return r}function tr(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),r=r||0;var i,o,l=e.display;r&&n<l.viewTo&&(null==l.updateLineNumbers||l.updateLineNumbers>t)&&(l.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=l.viewTo?kt&&Bt(e.doc,t)<l.viewTo&&rr(e):n<=l.viewFrom?kt&&Gt(e.doc,n+r)>l.viewFrom?rr(e):(l.viewFrom+=r,l.viewTo+=r):t<=l.viewFrom&&n>=l.viewTo?rr(e):t<=l.viewFrom?(i=ir(e,n,n+r,1))?(l.view=l.view.slice(i.index),l.viewFrom=i.lineN,l.viewTo+=r):rr(e):n>=l.viewTo?(o=ir(e,t,t,-1))?(l.view=l.view.slice(0,o.index),l.viewTo=o.lineN):rr(e):(i=ir(e,t,t,-1),o=ir(e,n,n+r,1),i&&o?(l.view=l.view.slice(0,i.index).concat(tn(e,i.lineN,o.lineN)).concat(l.view.slice(o.index)),l.viewTo+=r):rr(e));e=l.externalMeasured;e&&(n<e.lineN?e.lineN+=r:t<e.lineN+e.size&&(l.externalMeasured=null))}function nr(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),t<r.viewFrom||t>=r.viewTo||(null==(t=r.view[er(e,t)]).node||-1==z(t=t.changes||(t.changes=[]),n)&&t.push(n))}function rr(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function ir(e,t,n,r){var i,o=er(e,t),l=e.display.view;if(!kt||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=e.display.viewFrom,a=0;a<o;a++)s+=l[a].size;if(s!=t){if(0<r){if(o==l.length-1)return null;i=s+l[o].size-t,o++}else i=s-t;t+=i,n+=i}for(;Bt(e.doc,n)!=n;){if(o==(r<0?0:l.length-1))return null;n+=r*l[o-(r<0?1:0)].size,o+=r}return{index:o,lineN:n}}function or(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function lr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function sr(e,t){void 0===t&&(t=!0);for(var n,r,i=e.doc,o={},l=o.cursors=document.createDocumentFragment(),s=o.selection=document.createDocumentFragment(),a=0;a<i.sel.ranges.length;a++)!t&&a==i.sel.primIndex||((n=i.sel.ranges[a]).from().line>=e.display.viewTo||n.to().line<e.display.viewFrom||(((r=n.empty())||e.options.showCursorWhenSelecting)&&ar(e,n.head,l),r||function(i,e,t){var n=i.display,o=i.doc,l=document.createDocumentFragment(),r=bn(i.display),S=r.left,L=Math.max(n.sizerWidth,xn(i)-n.sizer.offsetLeft)-r.right,k="ltr"==o.direction;function T(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),l.appendChild(M("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?L-e:n)+"px;\n                             height: "+(r-t)+"px"))}function s(n,g,m){var v,y,r=$e(o,n),b=r.text.length;function w(e,t){return Rn(i,rt(n,e),"div",r,t)}function x(e,t,n){e=jn(i,r,null,e),t="ltr"==t==("after"==n)?"left":"right";return w("after"==n?e.begin:e.end-(/\s/.test(r.text.charAt(e.end-1))?2:1),t)[t]}var C=me(r,o.direction);return function(e,t,n,r){if(!e)return r(t,n,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var l=e[o];(l.from<n&&l.to>t||t==n&&l.to==t)&&(r(Math.max(l.from,t),Math.min(l.to,n),1==l.level?"rtl":"ltr",o),i=!0)}i||r(t,n,"ltr")}(C,g||0,null==m?b:m,function(e,t,n,r){var i,o,l,s,a="ltr"==n,u=w(e,a?"left":"right"),c=w(t-1,a?"right":"left"),h=null==g&&0==e,d=null==m&&t==b,f=0==r,p=!C||r==C.length-1;c.top-u.top<=3?(i=(k?d:h)&&p,r=(k?h:d)&&f?S:(a?u:c).left,i=i?L:(a?c:u).right,T(r,u.top,i-r,u.bottom)):(n=a?(o=k&&h&&f?S:u.left,l=k?L:x(e,n,"before"),s=k?S:x(t,n,"after"),k&&d&&p?L:c.right):(o=k?x(e,n,"before"):S,l=!k&&h&&f?L:u.right,s=!k&&d&&p?S:c.left,k?x(t,n,"after"):L),T(o,u.top,l-o,u.bottom),u.bottom<c.top&&T(S,u.bottom,null,c.top),T(s,c.top,n-s,c.bottom)),(!v||ur(u,v)<0)&&(v=u),ur(c,v)<0&&(v=c),(!y||ur(u,y)<0)&&(y=u),ur(c,y)<0&&(y=c)}),{start:v,end:y}}var a=e.from(),n=e.to();a.line==n.line?s(a.line,a.ch,n.ch):(r=$e(o,a.line),e=$e(o,n.line),e=Rt(r)==Rt(e),r=s(a.line,a.ch,e?r.text.length+1:null).end,n=s(n.line,e?0:null,n.ch).start,e&&(r.top<n.top-2?(T(r.right,r.top,null,r.bottom),T(S,n.top,n.left,n.bottom)):T(r.right,r.top,n.left-r.right,r.bottom)),r.bottom<n.top&&T(S,r.bottom,null,n.top)),t.appendChild(l)}(e,n,s)));return o}function ar(e,t,n){var r=Bn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),t=n.appendChild(M("div","Â ","CodeMirror-cursor"));t.style.left=r.left+"px",t.style.top=r.top+"px",t.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other&&((n=n.appendChild(M("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",n.style.left=r.other.left+"px",n.style.top=r.other.top+"px",n.style.height=.85*(r.other.bottom-r.other.top)+"px")}function ur(e,t){return e.top-t.top||e.left-t.left}function cr(e){var t,n;e.state.focused&&(t=e.display,clearInterval(t.blinker),n=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){e.hasFocus()||pr(e),t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function hr(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||fr(e))}function dr(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&pr(e))},100)}function fr(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(xe(e,"focus",e,t),e.state.focused=!0,D(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),f&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),cr(e))}function pr(e,t){e.state.delayingBlurEvent||(e.state.focused&&(xe(e,"blur",e,t),e.state.focused=!1,L(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function gr(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i,o=t.view[r],l=e.options.lineWrapping,s=void 0,a=0;if(!o.hidden){w&&v<8?(s=(i=o.node.offsetTop+o.node.offsetHeight)-n,n=i):(s=(u=o.node.getBoundingClientRect()).bottom-u.top,!l&&o.text.firstChild&&(a=o.text.firstChild.getBoundingClientRect().right-u.left-1));var u=o.line.height-s;if((.005<u||u<-.005)&&(Qe(o.line,s),mr(o.line),o.rest))for(var c=0;c<o.rest.length;c++)mr(o.rest[c]);a>e.display.sizerWidth&&((a=Math.ceil(a/_n(e.display)))>e.display.maxLineLength&&(e.display.maxLineLength=a,e.display.maxLine=o.line,e.display.maxLineChanged=!0))}}}function mr(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],r=n.node.parentNode;r&&(n.height=r.offsetHeight)}}function vr(e,t,n){var r=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop,r=Math.floor(r-vn(e)),i=n&&null!=n.bottom?n.bottom:r+e.wrapper.clientHeight,o=et(t,r),r=et(t,i);return n&&n.ensure&&(i=n.ensure.from.line,n=n.ensure.to.line,i<o?r=et(t,Vt($e(t,o=i))+e.wrapper.clientHeight):Math.min(n,t.lastLine())>=r&&(o=et(t,Vt($e(t,n))-e.wrapper.clientHeight),r=n)),{from:o,to:Math.max(r,o+1)}}function yr(e,t){var n=e.display,r=Yn(e.display);t.top<0&&(t.top=0);var i=(e.curOp&&null!=e.curOp.scrollTop?e.curOp:n.scroller).scrollTop,o=Cn(e),l={};t.bottom-t.top>o&&(t.bottom=t.top+o);var s=e.doc.height+yn(n),a=t.top<r,r=t.bottom>s-r;t.top<i?l.scrollTop=a?0:t.top:t.bottom>i+o&&((u=Math.min(t.top,(r?s:t.bottom)-o))!=i&&(l.scrollTop=u));var i=e.options.fixedGutter?0:n.gutters.offsetWidth,u=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft-i,e=xn(e)-n.gutters.offsetWidth,n=t.right-t.left>e;return n&&(t.right=t.left+e),t.left<10?l.scrollLeft=0:t.left<u?l.scrollLeft=Math.max(0,t.left+i-(n?0:10)):t.right>e+u-3&&(l.scrollLeft=t.right+(n?0:10)-e),l}function br(e,t){null!=t&&(Cr(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function wr(e){Cr(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function xr(e,t,n){null==t&&null==n||Cr(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function Cr(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Sr(e,Gn(e,t.from),Gn(e,t.to),t.margin))}function Sr(e,t,n,r){r=yr(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-r,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+r});xr(e,r.scrollLeft,r.scrollTop)}function Lr(e,t){Math.abs(e.doc.scrollTop-t)<2||(d||Kr(e,{top:t}),kr(e,t,!0),d&&Kr(e),Rr(e,100))}function kr(e,t,n){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),e.display.scroller.scrollTop==t&&!n||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Tr(e,t,n,r){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r||(e.doc.scrollLeft=t,Yr(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Mr(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+yn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+wn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}e=function(e,t,n){this.cm=n;var r=this.vert=M("div",[M("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=M("div",[M("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=i.tabIndex=-1,e(r),e(i),ye(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),ye(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,w&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};e.prototype.update=function(e){var t,n=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;return r?(this.vert.style.display="block",this.vert.style.bottom=n?i+"px":"0",t=e.viewHeight-(n?i:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),n?(this.horiz.style.display="block",this.horiz.style.right=r?i+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(r?i:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?i:0,bottom:n?i:0}},e.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},e.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},e.prototype.zeroWidthHack=function(){var e=g&&!l?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new I,this.disableVert=new I},e.prototype.enableZeroWidthBar=function(n,r,i){n.style.pointerEvents="auto",r.set(1e3,function e(){var t=n.getBoundingClientRect();("vert"==i?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=n?n.style.pointerEvents="none":r.set(1e3,e)})},e.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};r=function(){};function Nr(e,t){t=t||Mr(e);var n=e.display.barWidth,r=e.display.barHeight;Or(e,t);for(var i=0;i<4&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&gr(e),Or(e,Mr(e)),n=e.display.barWidth,r=e.display.barHeight}function Or(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}r.prototype.update=function(){return{bottom:0,right:0}},r.prototype.setScrollLeft=function(){},r.prototype.setScrollTop=function(){},r.prototype.clear=function(){};var Ar={native:e,null:r};function Dr(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass&&L(n.display.wrapper,n.display.scrollbars.addClass)),n.display.scrollbars=new Ar[n.options.scrollbarStyle](function(e){n.display.wrapper.insertBefore(e,n.display.scrollbarFiller),ye(e,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Tr:Lr)(n,e)},n),n.display.scrollbars.addClass&&D(n.display.wrapper,n.display.scrollbars.addClass)}var Wr=0;function Hr(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Wr},e=e.curOp,nn?nn.ops.push(e):e.ownsGroup=nn={ops:[e],delayedCallbacks:[]}}function Fr(e){e=e.curOp;e&&rn(e,function(l){for(var e=0;e<l.ops.length;e++)l.ops[e].cm.curOp=null;!function(){for(var e=l.ops,t=0;t<e.length;t++)!function(e){var t=e.cm,n=t.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=wn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=wn(e)+"px",t.scrollbarsClipped=!0)})(t),e.updateMaxLine&&jt(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new Gr(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}(e[t]);for(var n=0;n<e.length;n++)!function(e){e.updatedDisplay=e.mustUpdate&&Ur(e.cm,e.update)}(e[n]);for(var r=0;r<e.length;r++)!function(e){var t=e.cm,n=t.display;e.updatedDisplay&&gr(t),e.barMeasure=Mr(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Ln(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+wn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-xn(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}(e[r]);for(var i=0;i<e.length;i++)!function(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Tr(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==A();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),!e.updatedDisplay&&e.startHeight==t.doc.height||Nr(t,e.barMeasure),e.updatedDisplay&&Xr(t,e.barMeasure),e.selectionChanged&&cr(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&hr(e.cm)}(e[i]);for(var o=0;o<e.length;o++)!function(e){var t,n=e.cm,r=n.display,i=n.doc;e.updatedDisplay&&Vr(n,e.update),null==r.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=e.scrollTop&&kr(n,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&Tr(n,e.scrollLeft,!0,!0),e.scrollToPos&&(t=function(e,t,n,r){null==r&&(r=0),e.options.lineWrapping||t!=n||(n="before"==(t=t.ch?rt(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?rt(t.line,t.ch+1,"before"):t);for(var i=0;i<5;i++){var o,l=!1,s=Bn(e,t),a=n&&n!=t?Bn(e,n):s,u=yr(e,o={left:Math.min(s.left,a.left),top:Math.min(s.top,a.top)-r,right:Math.max(s.left,a.left),bottom:Math.max(s.bottom,a.bottom)+r}),s=e.doc.scrollTop,a=e.doc.scrollLeft;if(null!=u.scrollTop&&(Lr(e,u.scrollTop),1<Math.abs(e.doc.scrollTop-s)&&(l=!0)),null!=u.scrollLeft&&(Tr(e,u.scrollLeft),1<Math.abs(e.doc.scrollLeft-a)&&(l=!0)),!l)break}return o}(n,ct(i,e.scrollToPos.from),ct(i,e.scrollToPos.to),e.scrollToPos.margin),function(e,t){var n,r,i;Ce(e,"scrollCursorIntoView")||(r=(n=e.display).sizer.getBoundingClientRect(),i=null,t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null==i||u||(t=M("div","â",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-vn(e.display))+"px;\n                         height: "+(t.bottom-t.top+wn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(t),t.scrollIntoView(i),e.display.lineSpace.removeChild(t)))}(n,t));var o=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||xe(o[s],"hide");if(l)for(var a=0;a<l.length;++a)l[a].lines.length&&xe(l[a],"unhide");r.wrapper.offsetHeight&&(i.scrollTop=n.display.scroller.scrollTop),e.changeObjs&&xe(n,"changes",n,e.changeObjs),e.update&&e.update.finish()}(e[o])}()})}function Pr(e,t){if(e.curOp)return t();Hr(e);try{return t()}finally{Fr(e)}}function Er(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Hr(e);try{return t.apply(e,arguments)}finally{Fr(e)}}}function Ir(e){return function(){if(this.curOp)return e.apply(this,arguments);Hr(this);try{return e.apply(this,arguments)}finally{Fr(this)}}}function zr(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Hr(e);try{return t.apply(this,arguments)}finally{Fr(e)}}}function Rr(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,F(Br,e))}function Br(l){var s,a,u,c=l.doc;c.highlightFrontier>=l.display.viewTo||(s=+new Date+l.options.workTime,a=mt(l,c.highlightFrontier),u=[],c.iter(a.line,Math.min(c.first+c.size,l.display.viewTo+500),function(e){if(a.line>=l.display.viewFrom){var t=e.styles,n=e.text.length>l.options.maxHighlightLength?je(c.mode,a.state):null,r=pt(l,e,a,!0);n&&(a.state=n),e.styles=r.styles;n=e.styleClasses,r=r.classes;r?e.styleClasses=r:n&&(e.styleClasses=null);for(var i=!t||t.length!=e.styles.length||n!=r&&(!n||!r||n.bgClass!=r.bgClass||n.textClass!=r.textClass),o=0;!i&&o<t.length;++o)i=t[o]!=e.styles[o];i&&u.push(a.line),e.stateAfter=a.save(),a.nextLine()}else e.text.length<=l.options.maxHighlightLength&&vt(l,e.text,a),e.stateAfter=a.line%5==0?a.save():null,a.nextLine();if(+new Date>s)return Rr(l,l.options.workDelay),!0}),c.highlightFrontier=a.line,c.modeFrontier=Math.max(c.modeFrontier,a.line),u.length&&Pr(l,function(){for(var e=0;e<u.length;e++)nr(l,u[e],"text")}))}var Gr=function(e,t,n){var r=e.display;this.viewport=t,this.visible=vr(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=xn(e),this.force=n,this.dims=$n(e),this.events=[]};function Ur(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return rr(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==or(e))return!1;_r(e)&&(rr(e),t.dims=$n(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),l=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>l&&n.viewTo-l<20&&(l=Math.min(i,n.viewTo)),kt&&(o=Bt(e.doc,o),l=Gt(e.doc,l));var s=o!=n.viewFrom||l!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;r=o,i=l,0==(l=(o=e).display).view.length||r>=l.viewTo||i<=l.viewFrom?(l.view=tn(o,r,i),l.viewFrom=r):(l.viewFrom>r?l.view=tn(o,r,l.viewFrom).concat(l.view):l.viewFrom<r&&(l.view=l.view.slice(er(o,r))),l.viewFrom=r,l.viewTo<i?l.view=l.view.concat(tn(o,l.viewTo,i)):l.viewTo>i&&(l.view=l.view.slice(0,er(o,i)))),l.viewTo=i,n.viewOffset=Vt($e(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";o=or(e);if(!s&&0==o&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;l=function(e){if(e.hasFocus())return null;var t=A();if(!t||!O(e.display.lineDiv,t))return null;var n={activeElt:t};return!window.getSelection||(t=window.getSelection()).anchorNode&&t.extend&&O(e.display.lineDiv,t.anchorNode)&&(n.anchorNode=t.anchorNode,n.anchorOffset=t.anchorOffset,n.focusNode=t.focusNode,n.focusOffset=t.focusOffset),n}(e);return 4<o&&(n.lineDiv.style.display="none"),function(n,e,t){var r=n.display,i=n.options.lineNumbers,o=r.lineDiv,l=o.firstChild;function s(e){var t=e.nextSibling;return f&&g&&n.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var a=r.view,u=r.viewFrom,c=0;c<a.length;c++){var h=a[c];if(!h.hidden)if(h.node&&h.node.parentNode==o){for(;l!=h.node;)l=s(l);var d=i&&null!=e&&e<=u&&h.lineNumber;h.changes&&(-1<z(h.changes,"gutter")&&(d=!1),an(n,h,u,t)),d&&(k(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(nt(n.options,u)))),l=h.node.nextSibling}else{d=function(e,t,n,r){var i=cn(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),hn(e,t),dn(e,t,n,r),fn(e,t,r),t.node}(n,h,u,t);o.insertBefore(d,l)}u+=h.size}for(;l;)l=s(l)}(e,n.updateLineNumbers,t.dims),4<o&&(n.lineDiv.style.display=""),n.renderedView=n.view,(i=l)&&i.activeElt&&i.activeElt!=A()&&(i.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(i.activeElt.nodeName)&&i.anchorNode&&O(document.body,i.anchorNode)&&O(document.body,i.focusNode)&&(o=window.getSelection(),(l=document.createRange()).setEnd(i.anchorNode,i.anchorOffset),l.collapse(!1),o.removeAllRanges(),o.addRange(l),o.extend(i.focusNode,i.focusOffset))),k(n.cursorDiv),k(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Rr(e,400)),!(n.updateLineNumbers=null)}function Vr(e,t){for(var n=t.viewport,r=!0;;r=!1){if(r&&e.options.lineWrapping&&t.oldDisplayWidth!=xn(e))r&&(t.visible=vr(e.display,e.doc,n));else if(n&&null!=n.top&&(n={top:Math.min(e.doc.height+yn(e.display)-Cn(e),n.top)}),t.visible=vr(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!Ur(e,t))break;gr(e);var i=Mr(e);lr(e),Nr(e,i),Xr(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Kr(e,t){var n=new Gr(e,t);Ur(e,n)&&(gr(e),Vr(e,n),t=Mr(e),lr(e),Nr(e,t),Xr(e,t),n.finish())}function jr(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",ln(e,"gutterChanged",e)}function Xr(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+wn(e)+"px"}function Yr(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=qn(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",l=0;l<n.length;l++)if(!n[l].hidden){e.options.fixedGutter&&(n[l].gutter&&(n[l].gutter.style.left=o),n[l].gutterBackground&&(n[l].gutterBackground.style.left=o));var s=n[l].alignable;if(s)for(var a=0;a<s.length;a++)s[a].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function _r(e){if(e.options.lineNumbers){var t=e.doc,n=nt(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(M("div",[M("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),t=i.firstChild.offsetWidth,i=i.offsetWidth-t;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(t,r.lineGutter.offsetWidth-i)+1,r.lineNumWidth=r.lineNumInnerWidth+i,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",jr(e.display),1}}}function $r(e,t){for(var n=[],r=!1,i=0;i<e.length;i++){var o=e[i],l=null;if("string"!=typeof o&&(l=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;r=!0}n.push({className:o,style:l})}return t&&!r&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function qr(e){var t=e.gutters,n=e.gutterSpecs;k(t),e.lineGutter=null;for(var r=0;r<n.length;++r){var i=n[r],o=i.className,l=i.style,i=t.appendChild(M("div",null,"CodeMirror-gutter "+o));l&&(i.style.cssText=l),"CodeMirror-linenumbers"==o&&((e.lineGutter=i).style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",jr(e)}function Zr(e){qr(e.display),tr(e),Yr(e)}function Qr(e,t,n,r){var i=this;this.input=n,i.scrollbarFiller=M("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=M("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=N("div",null,"CodeMirror-code"),i.selectionDiv=M("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=M("div",null,"CodeMirror-cursors"),i.measure=M("div",null,"CodeMirror-measure"),i.lineMeasure=M("div",null,"CodeMirror-measure"),i.lineSpace=N("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none");var o=N("div",[i.lineSpace],"CodeMirror-lines");i.mover=M("div",[o],null,"position: relative"),i.sizer=M("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=M("div",null,null,"position: absolute; height: "+R+"px; width: 1px;"),i.gutters=M("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=M("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=M("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),w&&v<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),f||d&&h||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,i.gutterSpecs=$r(r.gutters,r.lineNumbers),qr(i),n.init(i)}Gr.prototype.signal=function(e,t){Le(e,t)&&this.events.push(arguments)},Gr.prototype.finish=function(){for(var e=0;e<this.events.length;e++)xe.apply(null,this.events[e])};var Jr=0,ei=null;function ti(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function ni(e){e=ti(e);return e.x*=ei,e.y*=ei,e}function ri(e,t){var n=ti(t),r=n.x,i=n.y,o=e.display,l=o.scroller,s=l.scrollWidth>l.clientWidth,a=l.scrollHeight>l.clientHeight;if(r&&s||i&&a){if(i&&g&&f)e:for(var u=t.target,c=o.view;u!=l;u=u.parentNode)for(var h=0;h<c.length;h++)if(c[h].node==u){e.display.currentWheelTarget=u;break e}if(r&&!d&&!p&&null!=ei)return i&&a&&Lr(e,Math.max(0,l.scrollTop+i*ei)),Tr(e,Math.max(0,l.scrollLeft+r*ei)),(!i||i&&a)&&Te(t),void(o.wheelStartX=null);i&&null!=ei&&(n=i*ei,a=(s=e.doc.scrollTop)+o.wrapper.clientHeight,n<0?s=Math.max(0,s+n-50):a=Math.min(e.doc.height,a+n+50),Kr(e,{top:s,bottom:a})),Jr<20&&(null==o.wheelStartX?(o.wheelStartX=l.scrollLeft,o.wheelStartY=l.scrollTop,o.wheelDX=r,o.wheelDY=i,setTimeout(function(){var e,t;null!=o.wheelStartX&&(t=l.scrollLeft-o.wheelStartX,t=(e=l.scrollTop-o.wheelStartY)&&o.wheelDY&&e/o.wheelDY||t&&o.wheelDX&&t/o.wheelDX,o.wheelStartX=o.wheelStartY=null,t&&(ei=(ei*Jr+t)/(Jr+1),++Jr))},200)):(o.wheelDX+=r,o.wheelDY+=i))}}w?ei=-.53:d?ei=15:o?ei=-.7:c&&(ei=-1/3);var ii=function(e,t){this.ranges=e,this.primIndex=t};ii.prototype.primary=function(){return this.ranges[this.primIndex]},ii.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(!ot(n.anchor,r.anchor)||!ot(n.head,r.head))return!1}return!0},ii.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new oi(lt(this.ranges[t].anchor),lt(this.ranges[t].head));return new ii(e,this.primIndex)},ii.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},ii.prototype.contains=function(e,t){t=t||e;for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(0<=it(t,r.from())&&it(e,r.to())<=0)return n}return-1};var oi=function(e,t){this.anchor=e,this.head=t};function li(e,t,n){var r=e&&e.options.selectionsMayTouch,e=t[n];t.sort(function(e,t){return it(e.from(),t.from())}),n=z(t,e);for(var i=1;i<t.length;i++){var o,l=t[i],s=t[i-1],a=it(s.to(),l.from());(r&&!l.empty()?0<a:0<=a)&&(o=at(s.from(),l.from()),a=st(s.to(),l.to()),s=s.empty()?l.from()==l.head:s.from()==s.head,i<=n&&--n,t.splice(--i,2,new oi(s?a:o,s?o:a)))}return new ii(t,n)}function si(e,t){return new ii([new oi(e,t||e)],0)}function ai(e){return e.text?rt(e.from.line+e.text.length-1,Y(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function ui(e,t){if(it(e,t.from)<0)return e;if(it(e,t.to)<=0)return ai(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=ai(t).ch-t.to.ch),rt(n,r)}function ci(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new oi(ui(i.anchor,t),ui(i.head,t)))}return li(e.cm,n,e.sel.primIndex)}function hi(e,t,n){return e.line==t.line?rt(n.line,e.ch-t.ch+n.ch):rt(n.line+(e.line-t.line),e.ch)}function di(e){e.doc.mode=Ue(e.options,e.doc.modeOption),fi(e)}function fi(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Rr(e,100),e.state.modeGen++,e.curOp&&tr(e)}function pi(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Y(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function gi(e,o,t,l){function i(e){return t?t[e]:null}function n(e,t,n){var r,i;r=t,i=n,t=l,(n=e).text=r,n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null),null!=n.order&&(n.order=null),At(n),Dt(n,i),(t=t?t(n):1)!=n.height&&Qe(n,t),ln(e,"change",e,o)}function r(e,t){for(var n=[],r=e;r<t;++r)n.push(new Xt(c[r],i(r),l));return n}var s,a=o.from,u=o.to,c=o.text,h=$e(e,a.line),d=$e(e,u.line),f=Y(c),p=i(c.length-1),g=u.line-a.line;o.full?(e.insert(0,r(0,c.length)),e.remove(c.length,e.size-c.length)):pi(e,o)?(s=r(0,c.length-1),n(d,d.text,p),g&&e.remove(a.line,g),s.length&&e.insert(a.line,s)):h==d?1==c.length?n(h,h.text.slice(0,a.ch)+f+h.text.slice(u.ch),p):((s=r(1,c.length-1)).push(new Xt(f+h.text.slice(u.ch),p,l)),n(h,h.text.slice(0,a.ch)+c[0],i(0)),e.insert(a.line+1,s)):1==c.length?(n(h,h.text.slice(0,a.ch)+c[0]+d.text.slice(u.ch),i(0)),e.remove(a.line+1,g)):(n(h,h.text.slice(0,a.ch)+c[0],i(0)),n(d,f+d.text.slice(u.ch),p),p=r(1,c.length-1),1<g&&e.remove(a.line+1,g-1),e.insert(a.line+1,p)),ln(e,"change",e,o)}function mi(e,s,a){!function e(t,n,r){if(t.linked)for(var i=0;i<t.linked.length;++i){var o,l=t.linked[i];l.doc!=n&&(o=r&&l.sharedHist,a&&!o||(s(l.doc,o),e(l.doc,t,o)))}}(e,null,!0)}function vi(e,t){if(t.cm)throw new Error("This document is already in use.");Qn((e.doc=t).cm=e),di(e),yi(e),e.options.lineWrapping||jt(e),e.options.mode=t.modeOption,tr(e)}function yi(e){("rtl"==e.doc.direction?D:L)(e.display.lineDiv,"CodeMirror-rtl")}function bi(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function wi(e,t){var n={from:lt(t.from),to:ai(t),text:qe(e,t.from,t.to)};return ki(e,n,t.from.line,t.to.line+1),mi(e,function(e){return ki(e,n,t.from.line,t.to.line+1),0},!0),n}function xi(e){for(;e.length;){if(!Y(e).ranges)break;e.pop()}}function Ci(e,t,n,r){var i=e.history;i.undone.length=0;var o,l,s=+new Date;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&i.lastModTime>s-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=(a=i).lastOp==r?(xi(a.done),Y(a.done)):a.done.length&&!Y(a.done).ranges?Y(a.done):1<a.done.length&&!a.done[a.done.length-2].ranges?(a.done.pop(),Y(a.done)):void 0))l=Y(o.changes),0==it(t.from,t.to)&&0==it(t.from,l.to)?l.to=ai(t):o.changes.push(wi(e,t));else{var a=Y(i.done);for(a&&a.ranges||Li(e.sel,i.done),o={changes:[wi(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,l||xe(e,"historyAdded")}function Si(e,t,n,r){var i,o,l,s=e.history,a=r&&r.origin;n==s.lastSelOp||a&&s.lastSelOrigin==a&&(s.lastModTime==s.lastSelTime&&s.lastOrigin==a||(i=e,o=a,l=Y(s.done),e=t,"*"==(o=o.charAt(0))||"+"==o&&l.ranges.length==e.ranges.length&&l.somethingSelected()==e.somethingSelected()&&new Date-i.history.lastSelTime<=(i.cm?i.cm.options.historyEventDelay:500)))?s.done[s.done.length-1]=t:Li(t,s.done),s.lastSelTime=+new Date,s.lastSelOrigin=a,s.lastSelOp=n,r&&!1!==r.clearRedo&&xi(s.undone)}function Li(e,t){var n=Y(t);n&&n.ranges&&n.equals(e)||t.push(e)}function ki(t,n,e,r){var i=n["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,r),function(e){e.markedSpans&&((i=i||(n["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Ti(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=[],i=0;i<t.text.length;++i)r.push(function(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t=t||e.slice(0,n):t&&t.push(e[n]);return t?t.length?t:null:e}(n[i]));return r}function Mi(e,t){var n=Ti(e,t),r=Nt(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],l=r[i];if(o&&l)e:for(var s=0;s<l.length;++s){for(var a=l[s],u=0;u<o.length;++u)if(o[u].marker==a.marker)continue e;o.push(a)}else l&&(n[i]=l)}return n}function Ni(e,t,n){for(var r=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?ii.prototype.deepCopy.call(o):o);else{var l=o.changes,s=[];r.push({changes:s});for(var a=0;a<l.length;++a){var u,c=l[a];if(s.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&-1<z(t,Number(u[1]))&&(Y(s)[h]=c[h],delete c[h])}}}return r}function Oi(e,t,n,r){if(r){r=e.anchor;return n&&((e=it(t,r)<0)!=it(n,r)<0?(r=t,t=n):e!=it(t,n)<0&&(t=n)),new oi(r,t)}return new oi(n||t,t)}function Ai(e,t,n,r,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),Pi(e,new ii([Oi(e.sel.primary(),t,n,i)],0),r)}function Di(e,t,n){for(var r=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)r[o]=Oi(e.sel.ranges[o],t[o],null,i);Pi(e,li(e.cm,r,e.sel.primIndex),n)}function Wi(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,Pi(e,li(e.cm,i,e.sel.primIndex),r)}function Hi(e,t,n,r){Pi(e,si(t,n),r)}function Fi(e,t,n){var r=e.history.done,i=Y(r);i&&i.ranges?Ei(e,r[r.length-1]=t,n):Pi(e,t,n)}function Pi(e,t,n){Ei(e,t,n),Si(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Ei(e,t,n){var r,i;(Le(e,"beforeSelectionChange")||e.cm&&Le(e.cm,"beforeSelectionChange"))&&(r=e,i=n,i={ranges:(o=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new oi(ct(r,e[t].anchor),ct(r,e[t].head))},origin:i&&i.origin},xe(r,"beforeSelectionChange",r,i),r.cm&&xe(r.cm,"beforeSelectionChange",r.cm,i),t=i.ranges!=o.ranges?li(r.cm,i.ranges,i.ranges.length-1):o);var o=n&&n.bias||(it(t.primary().head,e.sel.primary().head)<0?-1:1);Ii(e,Ri(e,t,o,!0)),n&&!1===n.scroll||!e.cm||"nocursor"==e.cm.getOption("readOnly")||wr(e.cm)}function Ii(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Se(e.cm)),ln(e,"cursorActivity",e))}function zi(e){Ii(e,Ri(e,e.sel,null,!1))}function Ri(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var l=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],a=Gi(e,l.anchor,s&&s.anchor,n,r),s=Gi(e,l.head,s&&s.head,n,r);!i&&a==l.anchor&&s==l.head||((i=i||t.ranges.slice(0,o))[o]=new oi(a,s))}return i?li(e.cm,i,t.primIndex):t}function Bi(e,t,n,r,i){var o=$e(e,t.line);if(o.markedSpans)for(var l=0;l<o.markedSpans.length;++l){var s=o.markedSpans[l],a=s.marker,u="selectLeft"in a?!a.selectLeft:a.inclusiveLeft,c="selectRight"in a?!a.selectRight:a.inclusiveRight;if((null==s.from||(u?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(c?s.to>=t.ch:s.to>t.ch))){if(i&&(xe(a,"beforeCursorEnter"),a.explicitlyCleared)){if(o.markedSpans){--l;continue}break}if(a.atomic){if(n){var h=a.find(r<0?1:-1),s=void 0;if((r<0?c:u)&&(h=Ui(e,h,-r,h&&h.line==t.line?o:null)),h&&h.line==t.line&&(s=it(h,n))&&(r<0?s<0:0<s))return Bi(e,h,t,r,i)}a=a.find(r<0?-1:1);return(r<0?u:c)&&(a=Ui(e,a,r,a.line==t.line?o:null)),a?Bi(e,a,t,r,i):null}}}return t}function Gi(e,t,n,r,i){r=r||1,r=Bi(e,t,n,r,i)||!i&&Bi(e,t,n,r,!0)||Bi(e,t,n,-r,i)||!i&&Bi(e,t,n,-r,!0);return r||(e.cantEdit=!0,rt(e.first,0))}function Ui(e,t,n,r){return n<0&&0==t.ch?t.line>e.first?ct(e,rt(t.line-1)):null:0<n&&t.ch==(r||$e(e,t.line)).text.length?t.line<e.first+e.size-1?rt(t.line+1,0):null:new rt(t.line,t.ch+n)}function Vi(e){e.setSelection(rt(e.firstLine(),0),rt(e.lastLine()),G)}function Ki(i,e,t){var o={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return o.canceled=!0}};return t&&(o.update=function(e,t,n,r){e&&(o.from=ct(i,e)),t&&(o.to=ct(i,t)),n&&(o.text=n),void 0!==r&&(o.origin=r)}),xe(i,"beforeChange",i,o),i.cm&&xe(i.cm,"beforeChange",i.cm,o),o.canceled?(i.cm&&(i.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function ji(e,t,n){if(e.cm){if(!e.cm.curOp)return Er(e.cm,ji)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Le(e,"beforeChange")||e.cm&&Le(e.cm,"beforeChange"))||(t=Ki(e,t,!0))){var r=Lt&&!n&&function(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=z(r,n)||(r=r||[]).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var l=r[o],s=l.find(0),a=0;a<i.length;++a){var u,c,h,d=i[a];it(d.to,s.from)<0||0<it(d.from,s.to)||(u=[a,1],c=it(d.from,s.from),h=it(d.to,s.to),(c<0||!l.inclusiveLeft&&!c)&&u.push({from:d.from,to:s.from}),(0<h||!l.inclusiveRight&&!h)&&u.push({from:s.to,to:d.to}),i.splice.apply(i,u),a+=u.length-3)}return i}(e,t.from,t.to);if(r)for(var i=r.length-1;0<=i;--i)Xi(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text,origin:t.origin});else Xi(e,t)}}function Xi(e,n){var t,r;1==n.text.length&&""==n.text[0]&&0==it(n.from,n.to)||(t=ci(e,n),Ci(e,n,t,e.cm?e.cm.curOp.id:NaN),$i(e,n,t,Nt(e,n)),r=[],mi(e,function(e,t){t||-1!=z(r,e.history)||(Ji(e.history,n),r.push(e.history)),$i(e,n,null,Nt(e,n))}))}function Yi(i,o,e){var t=i.cm&&i.cm.state.suppressEdits;if(!t||e){for(var l,n=i.history,r=i.sel,s="undo"==o?n.done:n.undone,a="undo"==o?n.undone:n.done,u=0;u<s.length&&(l=s[u],e?!l.ranges||l.equals(i.sel):l.ranges);u++);if(u!=s.length){for(n.lastOrigin=n.lastSelOrigin=null;;){if(!(l=s.pop()).ranges){if(t)return void s.push(l);break}if(Li(l,a),e&&!l.equals(i.sel))return void Pi(i,l,{clearRedo:!1});r=l}var c=[];Li(r,a),a.push({changes:c,generation:n.generation}),n.generation=l.generation||++n.maxGeneration;for(var h=Le(i,"beforeChange")||i.cm&&Le(i.cm,"beforeChange"),d=l.changes.length-1;0<=d;--d){var f=function(e){var n=l.changes[e];if(n.origin=o,h&&!Ki(i,n,!1))return s.length=0,{};c.push(wi(i,n));var t=e?ci(i,n):Y(s);$i(i,n,t,Mi(i,n)),!e&&i.cm&&i.cm.scrollIntoView({from:n.from,to:ai(n)});var r=[];mi(i,function(e,t){t||-1!=z(r,e.history)||(Ji(e.history,n),r.push(e.history)),$i(e,n,null,Mi(e,n))})}(d);if(f)return f.v}}}}function _i(e,t){if(0!=t&&(e.first+=t,e.sel=new ii(_(e.sel.ranges,function(e){return new oi(rt(e.anchor.line+t,e.anchor.ch),rt(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){tr(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)nr(e.cm,r,"gutter")}}function $i(e,t,n,r){if(e.cm&&!e.cm.curOp)return Er(e.cm,$i)(e,t,n,r);var i,o,l,s,a,u,c,h,d;t.to.line<e.first?_i(e,t.text.length-1-(t.to.line-t.from.line)):t.from.line>e.lastLine()||(t.from.line<e.first&&(_i(e,c=t.text.length-1-(e.first-t.from.line)),t={from:rt(e.first,0),to:rt(t.to.line+c,t.to.ch),text:[Y(t.text)],origin:t.origin}),d=e.lastLine(),t.to.line>d&&(t={from:t.from,to:rt(d,$e(e,d).text.length),text:[t.text[0]],origin:t.origin}),t.removed=qe(e,t.from,t.to),n=n||ci(e,t),e.cm?(i=e.cm,o=t,l=r,s=i.doc,a=i.display,u=o.from,c=o.to,h=!1,d=u.line,i.options.lineWrapping||(d=Je(Rt($e(s,u.line))),s.iter(d,c.line+1,function(e){if(e==a.maxLine)return h=!0})),-1<s.sel.contains(o.from,o.to)&&Se(i),gi(s,o,l,Zn(i)),i.options.lineWrapping||(s.iter(d,u.line+o.text.length,function(e){var t=Kt(e);t>a.maxLineLength&&(a.maxLine=e,a.maxLineLength=t,a.maxLineChanged=!0,h=!1)}),h&&(i.curOp.updateMaxLine=!0)),function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,r=t-1;n<r;r--){var i=$e(e,r).stateAfter;if(i&&(!(i instanceof dt)||r+i.lookAhead<t)){n=r+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}}(s,u.line),Rr(i,400),d=o.text.length-(c.line-u.line)-1,o.full?tr(i):u.line!=c.line||1!=o.text.length||pi(i.doc,o)?tr(i,u.line,c.line+1,d):nr(i,u.line,"text"),s=Le(i,"changes"),((d=Le(i,"change"))||s)&&(o={from:u,to:c,text:o.text,removed:o.removed,origin:o.origin},d&&ln(i,"change",i,o),s&&(i.curOp.changeObjs||(i.curOp.changeObjs=[])).push(o)),i.display.selForContextMenu=null):gi(e,t,r),Ei(e,n,G),e.cantEdit&&Gi(e,rt(e.firstLine(),0))&&(e.cantEdit=!1))}function qi(e,t,n,r,i){var o;it(r=r||n,n)<0&&(n=(o=[r,n])[0],r=o[1]),"string"==typeof t&&(t=e.splitLines(t)),ji(e,{from:n,to:r,text:t,origin:i})}function Zi(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Qi(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],l=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var s=0;s<o.ranges.length;s++)Zi(o.ranges[s].anchor,t,n,r),Zi(o.ranges[s].head,t,n,r)}else{for(var a=0;a<o.changes.length;++a){var u=o.changes[a];if(n<u.from.line)u.from=rt(u.from.line+r,u.from.ch),u.to=rt(u.to.line+r,u.to.ch);else if(t<=u.to.line){l=!1;break}}l||(e.splice(0,i+1),i=0)}}}function Ji(e,t){var n=t.from.line,r=t.to.line,t=t.text.length-(r-n)-1;Qi(e.done,n,r,t),Qi(e.undone,n,r,t)}function eo(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=$e(e,ut(e,t)):i=Je(t),null==i?null:(r(o,i)&&e.cm&&nr(e.cm,i,n),o)}function to(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function no(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}oi.prototype.from=function(){return at(this.anchor,this.head)},oi.prototype.to=function(){return st(this.anchor,this.head)},oi.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},to.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n,r=e,i=e+t;r<i;++r){var o=this.lines[r];this.height-=o.height,(n=o).parent=null,At(n),ln(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},no.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n,r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e),s=i.height;if(i.removeInner(e,l),this.height-=s-i.height,o==l&&(this.children.splice(r--,1),i.parent=null),0==(t-=l))break;e=0}else e-=o}this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof to))&&(n=[],this.collapse(n),this.children=[new to(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,n),i.lines&&50<i.lines.length){for(var l=i.lines.length%25+25,s=l;s<i.lines.length;){var a=new to(i.lines.slice(s,s+=25));i.height-=a.height,this.children.splice(++r,0,a),a.parent=this}i.lines=i.lines.slice(0,l),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,n=new no(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=n.size,e.height-=n.height,t=z(e.parent.children,e),e.parent.children.splice(t+1,0,n)):(((t=new no(e.children)).parent=e).children=[t,n],e=t),n.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var l=Math.min(t,o-e);if(i.iterN(e,l,n))return!0;if(0==(t-=l))break;e=0}else e-=o}}};function ro(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=e,this.node=t}function io(e,t,n){Vt(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&br(e,n)}ro.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,r=Je(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=gn(this);Qe(n,Math.max(0,n.height-o)),e&&(Pr(e,function(){io(e,n,-o),nr(e,r,"widget")}),ln(e,"lineWidgetCleared",e,this,r))}},ro.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,r=this.line;this.height=null;var i=gn(this)-t;i&&(Ut(this.doc,r)||Qe(r,r.height+i),n&&Pr(n,function(){n.curOp.forceUpdate=!0,io(n,r,i),ln(n,"lineWidgetChanged",n,e,Je(r))}))},ke(ro);var oo=0,lo=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++oo};function so(t,n,r,e,i){if(e&&e.shared)return function(e,n,r,i,o){(i=P(i)).shared=!1;var l=[so(e,n,r,i,o)],s=l[0],a=i.widgetNode;return mi(e,function(e){a&&(i.widgetNode=a.cloneNode(!0)),l.push(so(e,ct(e,n),ct(e,r),i,o));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;s=Y(l)}),new ao(l,s)}(t,n,r,e,i);if(t.cm&&!t.cm.curOp)return Er(t.cm,so)(t,n,r,e,i);var o=new lo(t,i),i=it(n,r);if(e&&P(e,o,!1),0<i||0==i&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=N("span",[o.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(zt(t,n.line,n,r,o)||n.line!=r.line&&zt(t,r.line,n,r,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");kt=!0}o.addToHistory&&Ci(t,{from:n,to:r,origin:"markText"},t.sel,NaN);var l,s=n.line,a=t.cm;if(t.iter(s,r.line+1,function(e){var t;a&&o.collapsed&&!a.options.lineWrapping&&Rt(e)==a.display.maxLine&&(l=!0),o.collapsed&&s!=n.line&&Qe(e,0),t=e,e=new Tt(o,s==n.line?n.ch:null,s==r.line?r.ch:null),t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t),++s}),o.collapsed&&t.iter(n.line,r.line+1,function(e){Ut(t,e)&&Qe(e,0)}),o.clearOnEnter&&ye(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(Lt=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++oo,o.atomic=!0),a){if(l&&(a.curOp.updateMaxLine=!0),o.collapsed)tr(a,n.line,r.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var u=n.line;u<=r.line;u++)nr(a,u,"text");o.atomic&&zi(a.doc),ln(a,"markerAdded",a,o)}return o}lo.prototype.clear=function(){if(!this.explicitlyCleared){var e,t=this.doc.cm,n=t&&!t.curOp;n&&Hr(t),!Le(this,"clear")||(e=this.find())&&ln(this,"clear",e.from,e.to);for(var r=null,i=null,o=0;o<this.lines.length;++o){var l=this.lines[o],s=Mt(l.markedSpans,this);t&&!this.collapsed?nr(t,Je(l),"text"):t&&(null!=s.to&&(i=Je(l)),null!=s.from&&(r=Je(l))),l.markedSpans=function(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n=n||[]).push(e[r]);return n}(l.markedSpans,s),null==s.from&&this.collapsed&&!Ut(this.doc,l)&&t&&Qe(l,Yn(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var a=0;a<this.lines.length;++a){var u=Rt(this.lines[a]),c=Kt(u);c>t.display.maxLineLength&&(t.display.maxLine=u,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&tr(t,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&zi(t.doc)),t&&ln(t,"markerCleared",t,this,r,i),n&&Fr(t),this.parent&&this.parent.clear()}},lo.prototype.find=function(e,t){var n,r;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],l=Mt(o.markedSpans,this);if(null!=l.from&&(n=rt(t?o:Je(o),l.from),-1==e))return n;if(null!=l.to&&(r=rt(t?o:Je(o),l.to),1==e))return r}return n&&{from:n,to:r}},lo.prototype.changed=function(){var n=this,r=this.find(-1,!0),i=this,o=this.doc.cm;r&&o&&Pr(o,function(){var e=r.line,t=Je(r.line),t=kn(o,t);t&&(Dn(t),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,Ut(i.doc,e)||null==i.height||(t=i.height,i.height=null,(t=gn(i)-t)&&Qe(e,e.height+t)),ln(o,"markerChanged",o,n)})},lo.prototype.attachLine=function(e){var t;!this.lines.length&&this.doc.cm&&((t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=z(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)),this.lines.push(e)},lo.prototype.detachLine=function(e){this.lines.splice(z(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},ke(lo);var ao=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function uo(e){return e.findMarks(rt(e.first,0),e.clipPos(rt(e.lastLine())),function(e){return e.parent})}function co(i){for(var o=0;o<i.length;o++)!function(){var e=i[o],t=[e.primary.doc];mi(e.primary.doc,function(e){return t.push(e)});for(var n=0;n<e.markers.length;n++){var r=e.markers[n];-1==z(t,r.doc)&&(r.parent=null,e.markers.splice(n--,1))}}()}ao.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ln(this,"clear")}},ao.prototype.find=function(e,t){return this.primary.find(e,t)},ke(ao);var ho=0,fo=function(e,t,n,r,i){if(!(this instanceof fo))return new fo(e,t,n,r,i);null==n&&(n=0),no.call(this,[new to([new Xt("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1;n=rt(this.modeFrontier=this.highlightFrontier=n,0);this.sel=si(n),this.history=new bi(null),this.id=++ho,this.modeOption=t,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),gi(this,{from:n,to:n,text:e}),Pi(this,si(n),G)};fo.prototype=q(no.prototype,{constructor:fo,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ze(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:zr(function(e){var t=rt(this.first,0),n=this.first+this.size-1;ji(this,{from:t,to:rt(n,$e(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&xr(this.cm,0,0),Pi(this,si(t),G)}),replaceRange:function(e,t,n,r){qi(this,e,t=ct(this,t),n=n?ct(this,n):t,r)},getRange:function(e,t,n){t=qe(this,ct(this,e),ct(this,t));return!1===n?t:t.join(n||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(tt(this,e))return $e(this,e)},getLineNumber:Je,getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=$e(this,e)),Rt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return ct(this,e)},getCursor:function(e){var t=this.sel.primary(),t=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from();return t},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:zr(function(e,t,n){Hi(this,ct(this,"number"==typeof e?rt(e,t||0):e),null,n)}),setSelection:zr(function(e,t,n){Hi(this,ct(this,e),ct(this,t||e),n)}),extendSelection:zr(function(e,t,n){Ai(this,ct(this,e),t&&ct(this,t),n)}),extendSelections:zr(function(e,t){Di(this,ht(this,e),t)}),extendSelectionsBy:zr(function(e,t){Di(this,ht(this,_(this.sel.ranges,e)),t)}),setSelections:zr(function(e,t,n){if(e.length){for(var r=[],i=0;i<e.length;i++)r[i]=new oi(ct(this,e[i].anchor),ct(this,e[i].head||e[i].anchor));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Pi(this,li(this.cm,r,t),n)}}),addSelection:zr(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new oi(ct(this,e),ct(this,t||e))),Pi(this,li(this.cm,r,r.length-1),n)}),getSelection:function(e){for(var t=this.sel.ranges,n=0;n<t.length;n++)var r=qe(this,t[n].from(),t[n].to()),i=i?i.concat(r):r;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=qe(this,n[r].from(),n[r].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:zr(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var l=i.ranges[o];r[o]={from:l.from(),to:l.to(),text:this.splitLines(e[o]),origin:n}}for(var t=t&&"end"!=t&&function(e,t,n){for(var r=[],i=u=rt(e.first,0),o=0;o<t.length;o++){var l=t[o],s=hi(l.from,u,i),a=hi(ai(l),u,i),u=l.to,i=a;"around"==n?(l=it((l=e.sel.ranges[o]).head,l.anchor)<0,r[o]=new oi(l?a:s,l?s:a)):r[o]=new oi(s,s)}return new ii(r,e.sel.primIndex)}(this,r,t),s=r.length-1;0<=s;s--)ji(this,r[s]);t?Fi(this,t):this.cm&&wr(this.cm)}),undo:zr(function(){Yi(this,"undo")}),redo:zr(function(){Yi(this,"redo")}),undoSelection:zr(function(){Yi(this,"undo",!0)}),redoSelection:zr(function(){Yi(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){var t=this;this.history=new bi(this.history),mi(this,function(e){return e.history=t.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Ni(this.history.done),undone:Ni(this.history.undone)}},setHistory:function(e){var t=this.history=new bi(this.history);t.done=Ni(e.done.slice(0),null,!0),t.undone=Ni(e.undone.slice(0),null,!0)},setGutterMarker:zr(function(e,n,r){return eo(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[n]=r)&&ee(t)&&(e.gutterMarkers=null),1})}),clearGutter:zr(function(t){var n=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&eo(n,e,"gutter",function(){return e.gutterMarkers[t]=null,ee(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!tt(this,e))return null;if(!(e=$e(this,t=e)))return null}else if(null==(t=Je(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:zr(function(e,n,r){return eo(this,e,"gutter"==n?"gutter":"class",function(e){var t="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(e[t]){if(C(r).test(e[t]))return;e[t]+=" "+r}else e[t]=r;return 1})}),removeLineClass:zr(function(e,o,l){return eo(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",n=e[t];if(n){if(null==l)e[t]=null;else{var r=n.match(C(l));if(!r)return;var i=r.index+r[0].length;e[t]=n.slice(0,r.index)+(r.index&&i!=n.length?" ":"")+n.slice(i)||null}return 1}})}),addLineWidget:zr(function(e,t,n){return e=e,i=new ro(r=this,t,n),(o=r.cm)&&i.noHScroll&&(o.display.alignWidgets=!0),eo(r,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==i.insertAt?t.push(i):t.splice(Math.min(t.length,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!Ut(r,e)&&(t=Vt(e)<r.scrollTop,Qe(e,e.height+gn(i)),t&&br(o,i.height),o.curOp.forceUpdate=!0),1}),o&&ln(o,"lineWidgetAdded",o,i,"number"==typeof e?e:Je(e)),i;var r,i,o}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return so(this,ct(this,e),ct(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return so(this,e=ct(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],n=$e(this,(e=ct(this,e)).line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(i,o,l){i=ct(this,i),o=ct(this,o);var s=[],a=i.line;return this.iter(i.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;n++){var r=t[n];null!=r.to&&a==i.line&&i.ch>=r.to||null==r.from&&a!=i.line||null!=r.from&&a==o.line&&r.from>=o.ch||l&&!l(r.marker)||s.push(r.marker.parent||r.marker)}++a}),s},getAllMarks:function(){var r=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;++n)null!=t[n].from&&r.push(t[n].marker)}),r},posFromIndex:function(t){var n,r=this.first,i=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+i;if(t<e)return n=t,!0;t-=e,++r}),ct(this,rt(r,n))},indexFromPos:function(e){var t=(e=ct(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new fo(Ze(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e=e||{};var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);t=new fo(Ze(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:e.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),o=e.clipPos(i.from),i=e.clipPos(i.to);it(o,i)&&(i=so(e,o,i,r.primary,r.primary.type),r.markers.push(i),i.parent=r)}}(t,uo(this)),t},unlinkDoc:function(e){if(e instanceof cl&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),co(uo(this));break}var n;e.history==this.history&&(n=[e.id],mi(e,function(e){return n.push(e.id)},!0),e.history=new bi(null),e.history.done=Ni(this.history.done,n),e.history.undone=Ni(this.history.undone,n))},iterLinkedDocs:function(e){mi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Pe(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:zr(function(e){var t;"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm&&Pr(t=this.cm,function(){yi(t),tr(t)}))})}),fo.prototype.eachLine=fo.prototype.iter;var po=0;function go(e){var r=this;if(mo(r),!Ce(r,e)&&!mn(r.display,e)){Te(e),w&&(po=+new Date);var t=Jn(r,e,!0),n=e.dataTransfer.files;if(t&&!r.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,o=Array(i),l=0,s=function(){++l==i&&Er(r,function(){var e={from:t=ct(r.doc,t),to:t,text:r.doc.splitLines(o.filter(function(e){return null!=e}).join(r.doc.lineSeparator())),origin:"paste"};ji(r.doc,e),Fi(r.doc,si(ct(r.doc,t),ct(r.doc,ai(e))))})()},a=0;a<n.length;a++)!function(e,t){var n;r.options.allowDropFileTypes&&-1==z(r.options.allowDropFileTypes,e.type)?s():((n=new FileReader).onerror=s,n.onload=function(){var e=n.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(o[t]=e),s()},n.readAsText(e))}(n[a],a);else{if(r.state.draggingText&&-1<r.doc.sel.contains(t))return r.state.draggingText(e),void setTimeout(function(){return r.display.input.focus()},20);try{var u,c=e.dataTransfer.getData("Text");if(c){if(r.state.draggingText&&!r.state.draggingText.copy&&(u=r.listSelections()),Ei(r.doc,si(t,t)),u)for(var h=0;h<u.length;++h)qi(r.doc,"",u[h].anchor,u[h].head,"drag");r.replaceSelection(c,"around","paste"),r.display.input.focus()}}catch(e){}}}}function mo(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function vo(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),n=[],r=0;r<e.length;r++){var i=e[r].CodeMirror;i&&n.push(i)}n.length&&n[0].operation(function(){for(var e=0;e<n.length;e++)t(n[e])})}}var yo=!1;function bo(){var e;yo||(ye(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,vo(wo)},100))}),ye(window,"blur",function(){return vo(pr)}),yo=!0)}function wo(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var xo={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Co=0;Co<10;Co++)xo[Co+48]=xo[Co+96]=String(Co);for(var So=65;So<=90;So++)xo[So]=String.fromCharCode(So);for(var Lo=1;Lo<=12;Lo++)xo[Lo+111]=xo[Lo+63235]="F"+Lo;var ko={};function To(e){var t,n,r,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var l=0;l<o.length-1;l++){var s=o[l];if(/^(cmd|meta|m)$/i.test(s))i=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)?$/i.test(s))throw new Error("Unrecognized modifier name: "+s);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function Mo(e){var t,n,r={};for(t in e)if(e.hasOwnProperty(t)){var i=e[t];if(!/^(name|fallthrough|(de|at)tach)$/.test(t))if("..."!=i){for(var o=_(t.split(" "),To),l=0;l<o.length;l++){var s=void 0,a=void 0,s=l==o.length-1?(a=o.join(" "),i):(a=o.slice(0,l+1).join(" "),"..."),u=r[a];if(u){if(u!=s)throw new Error("Inconsistent bindings for "+a)}else r[a]=s}delete e[t]}else delete e[t]}for(n in r)e[n]=r[n];return e}function No(e,t,n,r){var i=(t=Wo(t)).call?t.call(e,r):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return No(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var l=No(e,t.fallthrough[o],n,r);if(l)return l}}}function Oo(e){e="string"==typeof e?e:xo[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Ao(e,t,n){var r=e;return t.altKey&&"Alt"!=r&&(e="Alt-"+e),(b?t.metaKey:t.ctrlKey)&&"Ctrl"!=r&&(e="Ctrl-"+e),(b?t.ctrlKey:t.metaKey)&&"Mod"!=r&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=r&&(e="Shift-"+e),e}function Do(e,t){if(p&&34==e.keyCode&&e.char)return!1;var n=xo[e.keyCode];return null!=n&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(n=e.code),Ao(n,e,t))}function Wo(e){return"string"==typeof e?ko[e]:e}function Ho(t,e){for(var n=t.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=e(n[i]);r.length&&it(o.from,Y(r).to)<=0;){var l=r.pop();if(it(l.from,o.from)<0){o.from=l.from;break}}r.push(o)}Pr(t,function(){for(var e=r.length-1;0<=e;e--)qi(t.doc,"",r[e].from,r[e].to,"+delete");wr(t)})}function Fo(e,t,n){n=re(e.text,t+n,n);return n<0||n>e.text.length?null:n}function Po(e,t,n){e=Fo(e,t.ch,n);return null==e?null:new rt(t.line,e,n<0?"after":"before")}function Eo(e,t,n,r,i){if(e){"rtl"==t.doc.direction&&(i=-i);var o=me(n,t.doc.direction);if(o){var l,s,a,e=i<0?Y(o):o[0],o=i<0==(1==e.level)?"after":"before";return 0<e.level||"rtl"==t.doc.direction?(l=Tn(t,n),s=i<0?n.text.length-1:0,a=Mn(t,l,s).top,s=ie(function(e){return Mn(t,l,e).top==a},i<0==(1==e.level)?e.from:e.to-1,s),"before"==o&&(s=Fo(n,s,1))):s=i<0?e.to:e.from,new rt(r,s,o)}}return new rt(r,i<0?n.text.length:0,i<0?"before":"after")}function Io(t,n,s,e){var a=me(n,t.doc.direction);if(!a)return Po(n,s,e);s.ch>=n.text.length?(s.ch=n.text.length,s.sticky="before"):s.ch<=0&&(s.ch=0,s.sticky="after");var r=le(a,s.ch,s.sticky),i=a[r];if("ltr"==t.doc.direction&&i.level%2==0&&(0<e?i.to>s.ch:i.from<s.ch))return Po(n,s,e);function u(e,t){return Fo(n,e instanceof rt?e.ch:e,t)}function o(e){return t.options.lineWrapping?(l=l||Tn(t,n),jn(t,n,l,e)):{begin:0,end:n.text.length}}var l,c=o("before"==s.sticky?u(s,-1):s.ch);if("rtl"==t.doc.direction||1==i.level){var h=1==i.level==e<0,d=u(s,h?1:-1);if(null!=d&&(h?d<=i.to&&d<=c.end:d>=i.from&&d>=c.begin)){var f=h?"before":"after";return new rt(s.line,d,f)}}f=function(e,t,n){for(var r=function(e,t){return t?new rt(s.line,u(e,1),"before"):new rt(s.line,e,"after")};0<=e&&e<a.length;e+=t){var i=a[e],o=0<t==(1!=i.level),l=o?n.begin:u(n.end,-1);if(i.from<=l&&l<i.to)return r(l,o);if(l=o?i.from:u(i.to,-1),n.begin<=l&&l<n.end)return r(l,o)}},r=f(r+e,e,c);if(r)return r;c=0<e?c.end:u(c.begin,-1);return null==c||0<e&&c==n.text.length||!(r=f(0<e?0:a.length-1,e,o(c)))?null:r}ko.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ko.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ko.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ko.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ko.default=g?ko.macDefault:ko.pcDefault;var zo={selectAll:Vi,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),G)},killLine:function(n){return Ho(n,function(e){if(e.empty()){var t=$e(n.doc,e.head.line).text.length;return e.head.ch==t&&e.head.line<n.lastLine()?{from:e.head,to:rt(e.head.line+1,0)}:{from:e.head,to:rt(e.head.line,t)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return Ho(t,function(e){return{from:rt(e.from().line,0),to:ct(t.doc,rt(e.to().line+1,0))}})},delLineLeft:function(e){return Ho(e,function(e){return{from:rt(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(n){return Ho(n,function(e){var t=n.charCoords(e.head,"div").top+5;return{from:n.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(n){return Ho(n,function(e){var t=n.charCoords(e.head,"div").top+5,t=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(rt(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(rt(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Ro(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Bo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return function(e,t){var n=$e(e.doc,t),r=function(e){for(var t;t=It(e);)e=t.find(1,!0).line;return e}(n);r!=n&&(t=Je(r));return Eo(!0,e,n,t,-1)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},V)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},V)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(e){var t=n.cursorCoords(e.head,"div").top+5,t=n.coordsChar({left:0,top:t},"div");return t.ch<n.getLine(t.line).search(/\S/)?Bo(n,e.head):t},V)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),o=E(e.getLine(o.line),o.ch,r);t.push(X(r-o%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(l){return Pr(l,function(){for(var e,t,n,r=l.listSelections(),i=[],o=0;o<r.length;o++)r[o].empty()&&(e=r[o].head,(t=$e(l.doc,e.line).text)&&(e.ch==t.length&&(e=new rt(e.line,e.ch-1)),0<e.ch?(e=new rt(e.line,e.ch+1),l.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),rt(e.line,e.ch-2),e,"+transpose")):e.line>l.doc.first&&((n=$e(l.doc,e.line-1).text)&&(e=new rt(e.line,1),l.replaceRange(t.charAt(0)+l.doc.lineSeparator()+n.charAt(n.length-1),rt(e.line-1,n.length-1),e,"+transpose")))),i.push(new oi(e,e)));l.setSelections(i)})},newlineAndIndent:function(r){return Pr(r,function(){for(var e=r.listSelections(),t=e.length-1;0<=t;t--)r.replaceRange(r.doc.lineSeparator(),e[t].anchor,e[t].head,"+input");e=r.listSelections();for(var n=0;n<e.length;n++)r.indentLine(e[n].from().line,null,!0);wr(r)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Ro(e,t){var n=$e(e.doc,t),r=Rt(n);return r!=n&&(t=Je(r)),Eo(!0,e,r,t,1)}function Bo(e,t){var n=Ro(e,t.line),r=$e(e.doc,n.line),e=me(r,e.doc.direction);if(e&&0!=e[0].level)return n;r=Math.max(n.ch,r.text.search(/\S/)),t=t.line==n.line&&t.ch<=r&&t.ch;return rt(n.line,t?0:r,n.sticky)}function Go(e,t,n){if("string"==typeof t&&!(t=zo[t]))return!1;e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=B}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}var Uo=new I;function Vo(e,t,n,r){var i=e.state.keySeq;if(i){if(Oo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Uo.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),Ko(e,i+" "+t,n,r))return!0}return Ko(e,t,n,r)}function Ko(e,t,n,r){r=function(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=No(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&No(t,e.options.extraKeys,n,e)||No(t,e.options.keyMap,n,e)}(e,t,r);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&ln(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(Te(n),cr(e)),!!r}function jo(t,e){var n=Do(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?Vo(t,"Shift-"+n,e,function(e){return Go(t,e,!0)})||Vo(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return Go(t,e)}):Vo(t,n,e,function(e){return Go(t,e)}))}var Xo=null;function Yo(e){var t,n,r,i=this;function o(e){18!=e.keyCode&&e.altKey||(L(r,"CodeMirror-crosshair"),we(document,"keyup",o),we(document,"mouseover",o))}e.target&&e.target!=i.display.input.getField()||(i.curOp.focus=A(),Ce(i,e)||(w&&v<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,i.display.shift=16==t||e.shiftKey,n=jo(i,e),p&&(Xo=n?t:null,!n&&88==t&&!Ie&&(g?e.metaKey:e.ctrlKey)&&i.replaceSelection("",null,"cut")),d&&!g&&!n&&46==t&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=t||/\bCodeMirror-crosshair\b/.test(i.display.lineDiv.className)||(D(r=i.display.lineDiv,"CodeMirror-crosshair"),ye(document,"keyup",o),ye(document,"mouseover",o))))}function _o(e){16==e.keyCode&&(this.doc.sel.shift=!1),Ce(this,e)}function $o(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||mn(t.display,e)||Ce(t,e)||e.ctrlKey&&!e.altKey||g&&e.metaKey)){var n,r=e.keyCode,i=e.charCode;if(p&&r==Xo)return Xo=null,void Te(e);p&&(!e.which||e.which<10)&&jo(t,e)||"\b"!=(i=String.fromCharCode(null==i?r:i))&&(Vo(n=t,"'"+i+"'",e,function(e){return Go(n,e,!0)})||t.display.input.onKeyPress(e))}}var qo,Zo,Qo=function(e,t,n){this.time=e,this.pos=t,this.button=n};function Jo(e){var t,n,r,i,o,l=this,s=l.display;Ce(l,e)||s.activeTouch&&s.input.supportsTouch()||(s.input.ensurePolled(),s.shift=e.shiftKey,mn(s,e)?f||(s.scroller.draggable=!1,setTimeout(function(){return s.scroller.draggable=!0},100)):nl(l,e)||(t=Jn(l,e),n=De(e),i=t?(r=t,i=n,o=+new Date,Zo&&Zo.compare(o,r,i)?(qo=Zo=null,"triple"):qo&&qo.compare(o,r,i)?(Zo=new Qo(o,r,i),qo=null,"double"):(qo=new Qo(o,r,i),Zo=null,"single")):"single",window.focus(),1==n&&l.state.selectingText&&l.state.selectingText(e),t&&function(n,e,r,t,i){var o="Click";"double"==t?o="Double"+o:"triple"==t&&(o="Triple"+o);return Vo(n,Ao(o=(1==e?"Left":2==e?"Middle":"Right")+o,i),i,function(e){if("string"==typeof e&&(e=zo[e]),!e)return!1;var t=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0),t=e(n,r)!=B}finally{n.state.suppressEdits=!1}return t})}(l,n,t,i,e)||(1==n?t?function(e,t,n,r){w?setTimeout(F(hr,e),0):e.curOp.focus=A();var i,o=function(e,t,n){var r=e.getOption("configureMouse"),i=r?r(e,t,n):{};null==i.unit&&(r=m?n.shiftKey&&n.metaKey:n.altKey,i.unit=r?"rectangle":"single"==t?"char":"double"==t?"word":"line");null!=i.extend&&!e.doc.extend||(i.extend=e.doc.extend||n.shiftKey);null==i.addNew&&(i.addNew=g?n.metaKey:n.ctrlKey);null==i.moveOnDrag&&(i.moveOnDrag=!(g?n.altKey:n.ctrlKey));return i}(e,n,r),l=e.doc.sel;(e.options.dragDrop&&Fe&&!e.isReadOnly()&&"single"==n&&-1<(i=l.contains(t))&&(it((i=l.ranges[i]).from(),t)<0||0<t.xRel)&&(0<it(i.to(),t)||t.xRel<0)?function(t,n,r,i){var o=t.display,l=!1,s=Er(t,function(e){f&&(o.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:dr(t)),we(o.wrapper.ownerDocument,"mouseup",s),we(o.wrapper.ownerDocument,"mousemove",a),we(o.scroller,"dragstart",u),we(o.scroller,"drop",s),l||(Te(e),i.addNew||Ai(t.doc,r,null,null,i.extend),f&&!c||w&&9==v?setTimeout(function(){o.wrapper.ownerDocument.body.focus({preventScroll:!0}),o.input.focus()},20):o.input.focus())}),a=function(e){l=l||10<=Math.abs(n.clientX-e.clientX)+Math.abs(n.clientY-e.clientY)},u=function(){return l=!0};f&&(o.scroller.draggable=!0),(t.state.draggingText=s).copy=!i.moveOnDrag,ye(o.wrapper.ownerDocument,"mouseup",s),ye(o.wrapper.ownerDocument,"mousemove",a),ye(o.scroller,"dragstart",u),ye(o.scroller,"drop",s),t.state.delayingBlurEvent=!0,setTimeout(function(){return o.input.focus()},20),o.scroller.dragDrop&&o.scroller.dragDrop()}:function(d,e,f,p){w&&dr(d);var l=d.display,g=d.doc;Te(e);var m,v,y=g.sel,t=y.ranges;p.addNew&&!p.extend?(v=g.sel.contains(f),m=-1<v?t[v]:new oi(f,f)):(m=g.sel.primary(),v=g.sel.primIndex),"rectangle"==p.unit?(p.addNew||(m=new oi(f,f)),f=Jn(d,e,!0,!0),v=-1):(e=el(d,f,p.unit),m=p.extend?Oi(m,e.anchor,e.head,p.extend):e),p.addNew?-1==v?(v=t.length,Pi(g,li(d,t.concat([m]),v),{scroll:!1,origin:"*mouse"})):1<t.length&&t[v].empty()&&"char"==p.unit&&!p.extend?(Pi(g,li(d,t.slice(0,v).concat(t.slice(v+1)),0),{scroll:!1,origin:"*mouse"}),y=g.sel):Wi(g,v,m,U):(Pi(g,new ii([m],v=0),U),y=g.sel);var b=f;function s(e){if(0!=it(b,e))if(b=e,"rectangle"==p.unit){for(var t=[],n=d.options.tabSize,r=E($e(g,f.line).text,f.ch,n),i=E($e(g,e.line).text,e.ch,n),o=Math.min(r,i),l=Math.max(r,i),s=Math.min(f.line,e.line),a=Math.min(d.lastLine(),Math.max(f.line,e.line));s<=a;s++){var u=$e(g,s).text,c=K(u,o,n);o==l?t.push(new oi(rt(s,c),rt(s,c))):u.length>c&&t.push(new oi(rt(s,c),rt(s,K(u,l,n))))}t.length||t.push(new oi(f,f)),Pi(g,li(d,y.ranges.slice(0,v).concat(t),v),{origin:"*mouse",scroll:!1}),d.scrollIntoView(e)}else{var h,r=m,i=el(d,e,p.unit),e=r.anchor,e=0<it(i.anchor,e)?(h=i.head,at(r.from(),i.anchor)):(h=i.anchor,st(r.to(),i.head)),i=y.ranges.slice(0);i[v]=function(e,t){var n=t.anchor,r=t.head,i=$e(e.doc,n.line);if(0==it(n,r)&&n.sticky==r.sticky)return t;var o=me(i);if(!o)return t;var l=le(o,n.ch,n.sticky),s=o[l];if(s.from!=n.ch&&s.to!=n.ch)return t;i=l+(s.from==n.ch==(1!=s.level)?0:1);if(0==i||i==o.length)return t;a=r.line!=n.line?0<(r.line-n.line)*("ltr"==e.doc.direction?1:-1):(e=le(o,r.ch,r.sticky),a=e-l||(r.ch-n.ch)*(1==s.level?-1:1),e==i-1||e==i?a<0:0<a);var i=o[i+(a?-1:0)],a=a==(1==i.level),i=a?i.from:i.to,a=a?"after":"before";return n.ch==i&&n.sticky==a?t:new oi(new rt(n.line,i,a),r)}(d,new oi(ct(g,e),h)),Pi(g,li(d,i,v),U)}}var a=l.wrapper.getBoundingClientRect(),u=0;function n(e){d.state.selectingText=!1,u=1/0,e&&(Te(e),l.input.focus()),we(l.wrapper.ownerDocument,"mousemove",r),we(l.wrapper.ownerDocument,"mouseup",i),g.history.lastSelOrigin=null}var r=Er(d,function(e){(0!==e.buttons&&De(e)?function e(t){var n,r,i=++u,o=Jn(d,t,!0,"rectangle"==p.unit);o&&(0!=it(o,b)?(d.curOp.focus=A(),s(o),n=vr(l,g),(o.line>=n.to||o.line<n.from)&&setTimeout(Er(d,function(){u==i&&e(t)}),150)):(r=t.clientY<a.top?-20:t.clientY>a.bottom?20:0)&&setTimeout(Er(d,function(){u==i&&(l.scroller.scrollTop+=r,e(t))}),50))}:n)(e)}),i=Er(d,n);d.state.selectingText=i,ye(l.wrapper.ownerDocument,"mousemove",r),ye(l.wrapper.ownerDocument,"mouseup",i)})(e,r,t,o)}(l,t,i,e):Ae(e)==s.scroller&&Te(e):2==n?(t&&Ai(l.doc,t),setTimeout(function(){return s.input.focus()},20)):3==n&&(x?l.display.input.onContextMenu(e):dr(l)))))}function el(e,t,n){if("char"==n)return new oi(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new oi(rt(t.line,0),ct(e.doc,rt(t.line+1,0)));t=n(e,t);return new oi(t.from,t.to)}function tl(e,t,n,r){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(e){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&Te(t);var l=e.display,r=l.lineDiv.getBoundingClientRect();if(o>r.bottom||!Le(e,n))return Ne(t);o-=r.top-l.viewOffset;for(var s=0;s<e.display.gutterSpecs.length;++s){var a=l.gutters.childNodes[s];if(a&&a.getBoundingClientRect().right>=i)return xe(e,n,e,et(e.doc,o),e.display.gutterSpecs[s].className,t),Ne(t)}}function nl(e,t){return tl(e,t,"gutterClick",!0)}function rl(e,t){var n,r;mn(e.display,t)||(r=t,Le(n=e,"gutterContextMenu")&&tl(n,r,"gutterContextMenu",!1))||Ce(e,t,"contextmenu")||x||e.display.input.onContextMenu(t)}function il(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Hn(e)}Qo.prototype.compare=function(e,t,n){return this.time+400>e&&0==it(t,this.pos)&&n==this.button};var ol={toString:function(){return"CodeMirror.Init"}},ll={},sl={};function al(e,t,n){!t!=!(n&&n!=ol)&&(n=e.display.dragFunctions,(t=t?ye:we)(e.display.scroller,"dragstart",n.start),t(e.display.scroller,"dragenter",n.enter),t(e.display.scroller,"dragover",n.over),t(e.display.scroller,"dragleave",n.leave),t(e.display.scroller,"drop",n.drop))}function ul(e){e.options.lineWrapping?(D(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(L(e.display.wrapper,"CodeMirror-wrap"),jt(e)),Qn(e),tr(e),Hn(e),setTimeout(function(){return Nr(e)},100)}function cl(e,t){var n=this;if(!(this instanceof cl))return new cl(e,t);this.options=t=t?P(t):{},P(ll,t,!1);var r=t.value;"string"==typeof r?r=new fo(r,t.mode,null,t.lineSeparator,t.direction):t.mode&&(r.modeOption=t.mode),this.doc=r;var i,o=new cl.inputStyles[t.inputStyle](this),o=this.display=new Qr(e,r,o,t);for(i in il(o.wrapper.CodeMirror=this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Dr(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new I,keySeq:null,specialChars:null},t.autofocus&&!h&&o.input.focus(),w&&v<11&&setTimeout(function(){return n.display.input.reset(!0)},20),function(r){var i=r.display;ye(i.scroller,"mousedown",Er(r,Jo)),ye(i.scroller,"dblclick",w&&v<11?Er(r,function(e){var t;Ce(r,e)||(!(t=Jn(r,e))||nl(r,e)||mn(r.display,e)||(Te(e),t=r.findWordAt(t),Ai(r.doc,t.anchor,t.head)))}):function(e){return Ce(r,e)||Te(e)}),ye(i.scroller,"contextmenu",function(e){return rl(r,e)}),ye(i.input.getField(),"contextmenu",function(e){i.scroller.contains(e.target)||rl(r,e)});var n,o={end:0};function l(){i.activeTouch&&(n=setTimeout(function(){return i.activeTouch=null},1e3),(o=i.activeTouch).end=+new Date)}function s(e,t){if(null==t.left)return 1;var n=t.left-e.left,e=t.top-e.top;return 400<n*n+e*e}ye(i.scroller,"touchstart",function(e){var t;Ce(r,e)||function(e){if(1==e.touches.length){e=e.touches[0];return e.radiusX<=1&&e.radiusY<=1}}(e)||nl(r,e)||(i.input.ensurePolled(),clearTimeout(n),t=+new Date,i.activeTouch={start:t,moved:!1,prev:t-o.end<=300?o:null},1==e.touches.length&&(i.activeTouch.left=e.touches[0].pageX,i.activeTouch.top=e.touches[0].pageY))}),ye(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)}),ye(i.scroller,"touchend",function(e){var t,n=i.activeTouch;n&&!mn(i,e)&&null!=n.left&&!n.moved&&new Date-n.start<300&&(t=r.coordsChar(i.activeTouch,"page"),t=!n.prev||s(n,n.prev)?new oi(t,t):!n.prev.prev||s(n,n.prev.prev)?r.findWordAt(t):new oi(rt(t.line,0),ct(r.doc,rt(t.line+1,0))),r.setSelection(t.anchor,t.head),r.focus(),Te(e)),l()}),ye(i.scroller,"touchcancel",l),ye(i.scroller,"scroll",function(){i.scroller.clientHeight&&(Lr(r,i.scroller.scrollTop),Tr(r,i.scroller.scrollLeft,!0),xe(r,"scroll",r))}),ye(i.scroller,"mousewheel",function(e){return ri(r,e)}),ye(i.scroller,"DOMMouseScroll",function(e){return ri(r,e)}),ye(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),i.dragFunctions={enter:function(e){Ce(r,e)||Oe(e)},over:function(e){var t,n;Ce(r,e)||((n=Jn(t=r,n=e))&&(ar(t,n,n=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=M("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),T(t.display.dragCursor,n)),Oe(e))},start:function(e){return t=r,n=e,void(w&&(!t.state.draggingText||+new Date-po<100)?Oe(n):Ce(t,n)||mn(t.display,n)||(n.dataTransfer.setData("Text",t.getSelection()),n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setDragImage&&!c&&((e=M("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",p&&(e.width=e.height=1,t.display.wrapper.appendChild(e),e._top=e.offsetTop),n.dataTransfer.setDragImage(e,0,0),p&&e.parentNode.removeChild(e))));var t,n},drop:Er(r,go),leave:function(e){Ce(r,e)||mo(r)}};var e=i.input.getField();ye(e,"keyup",function(e){return _o.call(r,e)}),ye(e,"keydown",Er(r,Yo)),ye(e,"keypress",Er(r,$o)),ye(e,"focus",function(e){return fr(r,e)}),ye(e,"blur",function(e){return pr(r,e)})}(this),bo(),Hr(this),this.curOp.forceUpdate=!0,vi(this,r),t.autofocus&&!h||this.hasFocus()?setTimeout(function(){n.hasFocus()&&!n.state.focused&&fr(n)},20):pr(this),sl)sl.hasOwnProperty(i)&&sl[i](this,t[i],ol);_r(this),t.finishInit&&t.finishInit(this);for(var l=0;l<hl.length;++l)hl[l](this);Fr(this),f&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}cl.defaults=ll,cl.optionHandlers=sl;var hl=[];function dl(e,t,n,r){var i,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?i=mt(e,t).state:n="prev");var l=e.options.tabSize,s=$e(o,t),a=E(s.text,null,l);s.stateAfter&&(s.stateAfter=null);var u,c=s.text.match(/^\s*/)[0];if(r||/\S/.test(s.text)){if("smart"==n&&((u=o.mode.indent(i,s.text.slice(c.length),s.text))==B||150<u)){if(!r)return;n="prev"}}else u=0,n="not";"prev"==n?u=t>o.first?E($e(o,t-1).text,null,l):0:"add"==n?u=a+e.options.indentUnit:"subtract"==n?u=a-e.options.indentUnit:"number"==typeof n&&(u=a+n),u=Math.max(0,u);var h="",d=0;if(e.options.indentWithTabs)for(var f=Math.floor(u/l);f;--f)d+=l,h+="\t";if(d<u&&(h+=X(u-d)),h!=c)return qi(o,h,rt(t,0),rt(t,c.length),"+input"),!(s.stateAfter=null);for(var p=0;p<o.sel.ranges.length;p++){var g=o.sel.ranges[p];if(g.head.line==t&&g.head.ch<c.length){g=rt(t,c.length);Wi(o,p,new oi(g,g));break}}}cl.defineInitHook=function(e){return hl.push(e)};var fl=null;function pl(e){fl=e}function gl(e,t,n,r,i){var o=e.doc;e.display.shift=!1,r=r||o.sel;var l=+new Date-200,s="paste"==i||e.state.pasteIncoming>l,a=Pe(t),u=null;if(s&&1<r.ranges.length)if(fl&&fl.text.join("\n")==t){if(r.ranges.length%fl.text.length==0){u=[];for(var c=0;c<fl.text.length;c++)u.push(o.splitLines(fl.text[c]))}}else a.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(u=_(a,function(e){return[e]}));for(var h=e.curOp.updateInput,d=r.ranges.length-1;0<=d;d--){var f=r.ranges[d],p=f.from(),g=f.to();f.empty()&&(n&&0<n?p=rt(p.line,p.ch-n):e.state.overwrite&&!s?g=rt(g.line,Math.min($e(o,g.line).text.length,g.ch+Y(a).length)):s&&fl&&fl.lineWise&&fl.text.join("\n")==a.join("\n")&&(p=g=rt(p.line,0)));g={from:p,to:g,text:u?u[d%u.length]:a,origin:i||(s?"paste":e.state.cutIncoming>l?"cut":"+input")};ji(e.doc,g),ln(e,"inputRead",e,g)}t&&!s&&vl(e,t),wr(e),e.curOp.updateInput<2&&(e.curOp.updateInput=h),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function ml(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");return n&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||Pr(t,function(){return gl(t,n,0,null,"paste")}),1)}function vl(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,r=n.ranges.length-1;0<=r;r--){var i=n.ranges[r];if(!(100<i.head.ch||r&&n.ranges[r-1].head.line==i.head.line)){var o=e.getModeAt(i.head),l=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(-1<t.indexOf(o.electricChars.charAt(s))){l=dl(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test($e(e.doc,i.head.line).text.slice(0,i.head.ch))&&(l=dl(e,i.head.line,"smart"));l&&ln(e,"electricInput",e,i.head.line)}}}function yl(e){for(var t=[],n=[],r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,i={anchor:rt(i,0),head:rt(i+1,0)};n.push(i),t.push(e.getRange(i.anchor,i.head))}return{text:t,ranges:n}}function bl(e,t,n,r){e.setAttribute("autocorrect",n?"":"off"),e.setAttribute("autocapitalize",r?"":"off"),e.setAttribute("spellcheck",!!t)}function wl(){var e=M("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=M("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return f?e.style.width="1000px":e.setAttribute("wrap","off"),s&&(e.style.border="1px solid black"),bl(e),t}function xl(i,o,l,s,a){var e=o,t=l,u=$e(i,o.line),c=a&&"rtl"==i.direction?-l:l;function n(e){var t,n,r;if(null==(n="codepoint"==s?(t=u.text.charCodeAt(o.ch+(0<l?0:-1)),isNaN(t)?null:(n=0<l?55296<=t&&t<56320:56320<=t&&t<57343,new rt(o.line,Math.max(0,Math.min(u.text.length,o.ch+l*(n?2:1))),-l))):a?Io(i.cm,u,o,l):Po(u,o,l))){if(e||(r=o.line+c)<i.first||r>=i.first+i.size||(o=new rt(r,o.ch,o.sticky),!(u=$e(i,r))))return;o=Eo(a,i.cm,u,o.line,c)}else o=n;return 1}if("char"==s||"codepoint"==s)n();else if("column"==s)n(!0);else if("word"==s||"group"==s)for(var r=null,h="group"==s,d=i.cm&&i.cm.getHelper(o,"wordChars"),f=!0;!(l<0)||n(!f);f=!1){var p=u.text.charAt(o.ch)||"\n",p=J(p,d)?"w":h&&"\n"==p?"n":!h||/\s/.test(p)?null:"p";if(!h||f||p||(p="s"),r&&r!=p){l<0&&(l=1,n(),o.sticky="after");break}if(p&&(r=p),0<l&&!n(!f))break}t=Gi(i,o,e,t,!0);return ot(e,t)&&(t.hitSide=!0),t}function Cl(e,t,n,r){var i,o,l,s=e.doc,a=t.left;for("page"==r?(i=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),i=Math.max(i-.5*Yn(e.display),3),o=(0<n?t.bottom:t.top)+n*i):"line"==r&&(o=0<n?t.bottom+3:t.top-3);(l=Vn(e,a,o)).outside;){if(n<0?o<=0:o>=s.height){l.hitSide=!0;break}o+=5*n}return l}e=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new I,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Sl(e,t){var n=kn(e,t.line);if(!n||n.hidden)return null;var r=$e(e.doc,t.line),n=Sn(n,r,t.line),r=me(r,e.doc.direction),e="left";r&&(e=le(r,t.ch)%2?"right":"left");e=An(n.map,t.ch,e);return e.offset="right"==e.collapse?e.end:e.start,e}function Ll(e,t){return t&&(e.bad=!0),e}function kl(e,t,n){var r;if(t==e.display.lineDiv){if(!(r=e.display.lineDiv.childNodes[n]))return Ll(e.clipPos(rt(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==r)return function(u,e,t){var n=u.text.firstChild,r=!1;if(!e||!O(n,e))return Ll(rt(Je(u.line),0),!0);if(e==n&&(r=!0,e=n.childNodes[t],t=0,!e)){var i=u.rest?Y(u.rest):u.line;return Ll(rt(Je(i),i.text.length),r)}var i=3==e.nodeType?e:null,o=e;i||1!=e.childNodes.length||3!=e.firstChild.nodeType||(i=e.firstChild,t=t&&i.nodeValue.length);for(;o.parentNode!=n;)o=o.parentNode;var c=u.measure,h=c.maps;function l(e,t,n){for(var r=-1;r<(h?h.length:0);r++)for(var i=r<0?c.map:h[r],o=0;o<i.length;o+=3){var l=i[o+2];if(l==e||l==t){var s=Je(r<0?u.line:u.rest[r]),a=i[o]+n;return(n<0||l!=e)&&(a=i[o+(n?1:0)]),rt(s,a)}}}var s=l(i,o,t);if(s)return Ll(s,r);for(var a=o.nextSibling,d=i?i.nodeValue.length-t:0;a;a=a.nextSibling){if(s=l(a,a.firstChild,0))return Ll(rt(s.line,s.ch-d),r);d+=a.textContent.length}for(var f=o.previousSibling,p=t;f;f=f.previousSibling){if(s=l(f,f.firstChild,-1))return Ll(rt(s.line,s.ch+p),r);p+=f.textContent.length}}(o,t,n)}}e.prototype.init=function(e){var t=this,o=this,l=o.cm,s=o.div=e.lineDiv;function a(e){for(var t=e.target;t;t=t.parentNode){if(t==s)return 1;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}}function n(e){if(a(e)&&!Ce(l,e)){if(l.somethingSelected())pl({lineWise:!1,text:l.getSelections()}),"cut"==e.type&&l.replaceSelection("",null,"cut");else{if(!l.options.lineWiseCopyCut)return;var t=yl(l);pl({lineWise:!0,text:t.text}),"cut"==e.type&&l.operation(function(){l.setSelections(t.ranges,0,G),l.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var n=fl.text.join("\n");if(e.clipboardData.setData("Text",n),e.clipboardData.getData("Text")==n)return void e.preventDefault()}var r=wl(),e=r.firstChild;l.display.lineSpace.insertBefore(r,l.display.lineSpace.firstChild),e.value=fl.text.join("\n");var i=A();H(e),setTimeout(function(){l.display.lineSpace.removeChild(r),i.focus(),i==s&&o.showPrimarySelection()},50)}}s.contentEditable=!0,bl(s,l.options.spellcheck,l.options.autocorrect,l.options.autocapitalize),ye(s,"paste",function(e){!a(e)||Ce(l,e)||ml(e,l)||v<=11&&setTimeout(Er(l,function(){return t.updateFromDOM()}),20)}),ye(s,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),ye(s,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),ye(s,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),ye(s,"touchstart",function(){return o.forceCompositionEnd()}),ye(s,"input",function(){t.composing||t.readFromDOMSoon()}),ye(s,"copy",n),ye(s,"cut",n)},e.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},e.prototype.prepareSelection=function(){var e=sr(this.cm,!1);return e.focus=A()==this.div,e},e.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},e.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},e.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),r=n.from(),i=n.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||i.line<t.display.viewFrom)e.removeAllRanges();else{var o=kl(t,e.anchorNode,e.anchorOffset),n=kl(t,e.focusNode,e.focusOffset);if(!o||o.bad||!n||n.bad||0!=it(at(o,n),r)||0!=it(st(o,n),i)){var n=t.display.view,l=r.line>=t.display.viewFrom&&Sl(t,r)||{node:n[0].measure.map[2],offset:0},s=i.line<t.display.viewTo&&Sl(t,i);if(s||(s={node:(u=(u=n[n.length-1].measure).maps?u.maps[u.maps.length-1]:u.map)[u.length-1],offset:u[u.length-2]-u[u.length-3]}),l&&s){var a,u=e.rangeCount&&e.getRangeAt(0);try{a=S(l.node,l.offset,s.offset,s.node)}catch(e){}a&&(!d&&t.state.focused?(e.collapse(l.node,l.offset),a.collapsed||(e.removeAllRanges(),e.addRange(a))):(e.removeAllRanges(),e.addRange(a)),u&&null==e.anchorNode?e.addRange(u):d&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},e.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},e.prototype.showMultipleSelections=function(e){T(this.cm.display.cursorDiv,e.cursors),T(this.cm.display.selectionDiv,e.selection)},e.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},e.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;e=e.getRangeAt(0).commonAncestorContainer;return O(this.div,e)},e.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&A()==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},e.prototype.blur=function(){this.div.blur()},e.prototype.getField=function(){return this.div},e.prototype.supportsTouch=function(){return!0},e.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():Pr(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},e.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},e.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e,t,n=this.getSelection(),r=this.cm;if(a&&o&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(n.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();this.composing||(this.rememberSelection(),e=kl(r,n.anchorNode,n.anchorOffset),t=kl(r,n.focusNode,n.focusOffset),e&&t&&Pr(r,function(){Pi(r.doc,si(e,t),G),(e.bad||t.bad)&&(r.curOp.selectionChanged=!0)}))}},e.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t=this.cm,n=t.display,r=t.doc.sel.primary(),i=r.from(),r=r.to();if(0==i.ch&&i.line>t.firstLine()&&(i=rt(i.line-1,$e(t.doc,i.line-1).length)),r.ch==$e(t.doc,r.line).text.length&&r.line<t.lastLine()&&(r=rt(r.line+1,0)),i.line<n.viewFrom||r.line>n.viewTo-1)return!1;m=i.line==n.viewFrom||0==(m=er(t,i.line))?(e=Je(n.view[0].line),n.view[0].node):(e=Je(n.view[m].line),n.view[m-1].node.nextSibling);var o,r=er(t,r.line),r=r==n.view.length-1?(o=n.viewTo-1,n.lineDiv.lastChild):(o=Je(n.view[r+1].line)-1,n.view[r+1].node.previousSibling);if(!m)return!1;for(var l=t.doc.splitLines(function(l,e,t,s,a){var n="",u=!1,c=l.doc.lineSeparator(),h=!1;function d(){u&&(n+=c,h&&(n+=c),u=h=!1)}function f(e){e&&(d(),n+=e)}for(;!function e(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)f(n);else if(n=t.getAttribute("cm-marker"))(n=l.findMarks(rt(s,0),rt(a+1,0),(o=+n,function(e){return e.id==o}))).length&&(r=n[0].find(0))&&f(qe(l.doc,r.from,r.to).join(c));else if("false"!=t.getAttribute("contenteditable")){var r=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(/^br$/i.test(t.nodeName)||0!=t.textContent.length){r&&d();for(var i=0;i<t.childNodes.length;i++)e(t.childNodes[i]);/^(pre|p)$/i.test(t.nodeName)&&(h=!0),r&&(u=!0)}}}else 3==t.nodeType&&f(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var o}(e),e!=t;)e=e.nextSibling,h=!1;return n}(t,m,r,e,o)),s=qe(t.doc,rt(e,0),rt(o,$e(t.doc,o).text.length));1<l.length&&1<s.length;)if(Y(l)==Y(s))l.pop(),s.pop(),o--;else{if(l[0]!=s[0])break;l.shift(),s.shift(),e++}for(var a=0,u=0,c=l[0],h=s[0],d=Math.min(c.length,h.length);a<d&&c.charCodeAt(a)==h.charCodeAt(a);)++a;for(var f=Y(l),p=Y(s),g=Math.min(f.length-(1==l.length?a:0),p.length-(1==s.length?a:0));u<g&&f.charCodeAt(f.length-u-1)==p.charCodeAt(p.length-u-1);)++u;if(1==l.length&&1==s.length&&e==i.line)for(;a&&a>i.ch&&f.charCodeAt(f.length-u-1)==p.charCodeAt(p.length-u-1);)a--,u++;l[l.length-1]=f.slice(0,f.length-u).replace(/^\u200b+/,""),l[0]=l[0].slice(a).replace(/\u200b+$/,"");var m=rt(e,a),r=rt(o,s.length?Y(s).length-u:0);return 1<l.length||l[0]||it(m,r)?(qi(t.doc,l,m,r,"+input"),!0):void 0},e.prototype.ensurePolled=function(){this.forceCompositionEnd()},e.prototype.reset=function(){this.forceCompositionEnd()},e.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},e.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},e.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Pr(this.cm,function(){return tr(e.cm)})},e.prototype.setUneditable=function(e){e.contentEditable="false"},e.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Er(this.cm,gl)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},e.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},e.prototype.onContextMenu=function(){},e.prototype.resetPosition=function(){},e.prototype.needsContentAttribute=!0;var Tl,Ml,Nl,Ol,Al,r=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new I,this.hasSelection=!1,this.composing=null};function Dl(e,t,r,n){Tl.defaults[e]=t,r&&(Ml[e]=n?function(e,t,n){n!=ol&&r(e,t,n)}:r)}r.prototype.init=function(n){var e=this,r=this,i=this.cm;this.createField(n);var o=this.textarea;function t(e){if(!Ce(i,e)){if(i.somethingSelected())pl({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=yl(i);pl({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,G):(r.prevInput="",o.value=t.text.join("\n"),H(o))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}n.wrapper.insertBefore(this.wrapper,n.wrapper.firstChild),s&&(o.style.width="0px"),ye(o,"input",function(){w&&9<=v&&e.hasSelection&&(e.hasSelection=null),r.poll()}),ye(o,"paste",function(e){Ce(i,e)||ml(e,i)||(i.state.pasteIncoming=+new Date,r.fastPoll())}),ye(o,"cut",t),ye(o,"copy",t),ye(n.scroller,"paste",function(e){if(!mn(n,e)&&!Ce(i,e)){if(!o.dispatchEvent)return i.state.pasteIncoming=+new Date,void r.focus();var t=new Event("paste");t.clipboardData=e.clipboardData,o.dispatchEvent(t)}}),ye(n.lineSpace,"selectstart",function(e){mn(n,e)||Te(e)}),ye(o,"compositionstart",function(){var e=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),ye(o,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},r.prototype.createField=function(e){this.wrapper=wl(),this.textarea=this.wrapper.firstChild},r.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},r.prototype.prepareSelection=function(){var e,t=this.cm,n=t.display,r=t.doc,i=sr(t);return t.options.moveInputWithCursor&&(e=Bn(t,r.sel.primary().head,"div"),t=n.wrapper.getBoundingClientRect(),r=n.lineDiv.getBoundingClientRect(),i.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,e.top+r.top-t.top)),i.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,e.left+r.left-t.left))),i},r.prototype.showSelection=function(e){var t=this.cm.display;T(t.cursorDiv,e.cursors),T(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},r.prototype.reset=function(e){var t,n;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",n=t.getSelection(),this.textarea.value=n,t.state.focused&&H(this.textarea),w&&9<=v&&(this.hasSelection=n)):e||(this.prevInput=this.textarea.value="",w&&9<=v&&(this.hasSelection=null)))},r.prototype.getField=function(){return this.textarea},r.prototype.supportsTouch=function(){return!1},r.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!h||A()!=this.textarea))try{this.textarea.focus()}catch(e){}},r.prototype.blur=function(){this.textarea.blur()},r.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},r.prototype.receivedFocus=function(){this.slowPoll()},r.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},r.prototype.fastPoll=function(){var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,function e(){n.poll()||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))})},r.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!t.state.focused||Ee(n)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=n.value;if(i==r&&!t.somethingSelected())return!1;if(w&&9<=v&&this.hasSelection===i||g&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||r||(r="â"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,s=Math.min(r.length,i.length);l<s&&r.charCodeAt(l)==i.charCodeAt(l);)++l;return Pr(t,function(){gl(t,i.slice(l),r.length-l,null,e.composing?"*compose":null),1e3<i.length||-1<i.indexOf("\n")?n.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},r.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},r.prototype.onKeyPress=function(){w&&9<=v&&(this.hasSelection=null),this.fastPoll()},r.prototype.onContextMenu=function(e){var n=this,r=n.cm,i=r.display,o=n.textarea;n.contextMenuPending&&n.contextMenuPending();var l,s,t,a,u=Jn(r,e),c=i.scroller.scrollTop;function h(){var e,t;null!=o.selectionStart&&(t="â"+((e=r.somethingSelected())?o.value:""),o.value="â",o.value=t,n.prevInput=e?"":"â",o.selectionStart=1,o.selectionEnd=t.length,i.selForContextMenu=r.doc.sel)}function d(){var e,t;n.contextMenuPending==d&&(n.contextMenuPending=!1,n.wrapper.style.cssText=s,o.style.cssText=l,w&&v<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=o.selectionStart&&((!w||w&&v<9)&&h(),e=0,t=function(){i.selForContextMenu==r.doc.sel&&0==o.selectionStart&&0<o.selectionEnd&&"â"==n.prevInput?Er(r,Vi)(r):e++<10?i.detectingSelectAll=setTimeout(t,500):(i.selForContextMenu=null,i.input.reset())},i.detectingSelectAll=setTimeout(t,200)))}u&&!p&&(r.options.resetSelectionOnContextMenu&&-1==r.doc.sel.contains(u)&&Er(r,Pi)(r.doc,si(u),G),l=o.style.cssText,s=n.wrapper.style.cssText,u=n.wrapper.offsetParent.getBoundingClientRect(),n.wrapper.style.cssText="position: static",o.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-u.top-5)+"px; left: "+(e.clientX-u.left-5)+"px;\n      z-index: 1000; background: "+(w?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",f&&(t=window.scrollY),i.input.focus(),f&&window.scrollTo(null,t),i.input.reset(),r.somethingSelected()||(o.value=n.prevInput=" "),n.contextMenuPending=d,i.selForContextMenu=r.doc.sel,clearTimeout(i.detectingSelectAll),w&&9<=v&&h(),x?(Oe(e),a=function(){we(window,"mouseup",a),setTimeout(d,20)},ye(window,"mouseup",a)):setTimeout(d,50))},r.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},r.prototype.setUneditable=function(){},r.prototype.needsContentAttribute=!1,Ml=(Tl=cl).optionHandlers,Tl.defineOption=Dl,Tl.Init=ol,Dl("value","",function(e,t){return e.setValue(t)},!0),Dl("mode",null,function(e,t){e.doc.modeOption=t,di(e)},!0),Dl("indentUnit",2,di,!0),Dl("indentWithTabs",!1),Dl("smartIndent",!0),Dl("tabSize",4,function(e){fi(e),Hn(e),tr(e)},!0),Dl("lineSeparator",null,function(e,r){if(e.doc.lineSep=r){var i=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var n=e.text.indexOf(r,t);if(-1==n)break;t=n+r.length,i.push(rt(o,n))}o++});for(var t=i.length-1;0<=t;t--)qi(e.doc,r,i[t],rt(i[t].line,i[t].ch+r.length))}}),Dl("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=ol&&e.refresh()}),Dl("specialCharPlaceholder",Zt,function(e){return e.refresh()},!0),Dl("electricChars",!0),Dl("inputStyle",h?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Dl("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),Dl("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),Dl("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),Dl("rtlMoveVisually",!y),Dl("wholeLineUpdateBefore",!0),Dl("theme","default",function(e){il(e),Zr(e)},!0),Dl("keyMap","default",function(e,t,n){t=Wo(t),n=n!=ol&&Wo(n);n&&n.detach&&n.detach(e,t),t.attach&&t.attach(e,n||null)}),Dl("extraKeys",null),Dl("configureMouse",null),Dl("lineWrapping",!1,ul,!0),Dl("gutters",[],function(e,t){e.display.gutterSpecs=$r(t,e.options.lineNumbers),Zr(e)},!0),Dl("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?qn(e.display)+"px":"0",e.refresh()},!0),Dl("coverGutterNextToScrollbar",!1,function(e){return Nr(e)},!0),Dl("scrollbarStyle","native",function(e){Dr(e),Nr(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Dl("lineNumbers",!1,function(e,t){e.display.gutterSpecs=$r(e.options.gutters,t),Zr(e)},!0),Dl("firstLineNumber",1,Zr,!0),Dl("lineNumberFormatter",function(e){return e},Zr,!0),Dl("showCursorWhenSelecting",!1,lr,!0),Dl("resetSelectionOnContextMenu",!0),Dl("lineWiseCopyCut",!0),Dl("pasteLinesPerSelection",!0),Dl("selectionsMayTouch",!1),Dl("readOnly",!1,function(e,t){"nocursor"==t&&(pr(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),Dl("screenReaderLabel",null,function(e,t){t=""===t?null:t,e.display.input.screenReaderLabelChanged(t)}),Dl("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Dl("dragDrop",!0,al),Dl("allowDropFileTypes",null),Dl("cursorBlinkRate",530),Dl("cursorScrollMargin",0),Dl("cursorHeight",1,lr,!0),Dl("singleCursorHeightPerLine",!0,lr,!0),Dl("workTime",100),Dl("workDelay",100),Dl("flattenSpans",!0,fi,!0),Dl("addModeClass",!1,fi,!0),Dl("pollInterval",100),Dl("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),Dl("historyEventDelay",1250),Dl("viewportMargin",10,function(e){return e.refresh()},!0),Dl("maxHighlightLength",1e4,fi,!0),Dl("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Dl("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),Dl("autofocus",null),Dl("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),Dl("phrases",null),Ol=(Nl=cl).optionHandlers,Al=Nl.helpers={},Nl.prototype={constructor:Nl,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,r=n[e];n[e]==t&&"mode"!=e||(n[e]=t,Ol.hasOwnProperty(e)&&Er(this,Ol[e])(this,t,r),xe(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Wo(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Ir(function(e,t){var n=e.token?e:Nl.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");!function(e,t,n){for(var r=0,i=n(t);r<e.length&&n(e[r])<=i;)r++;e.splice(r,0,t)}(this.state.overlays,{mode:n,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},function(e){return e.priority}),this.state.modeGen++,tr(this)}),removeOverlay:Ir(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,void tr(this)}}),indentLine:Ir(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),tt(this.doc,e)&&dl(this,e,t,n)}),indentSelection:Ir(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(dl(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&wr(this));else{for(var o=i.from(),l=i.to(),i=Math.max(n,o.line),n=Math.min(this.lastLine(),l.line-(l.ch?0:1))+1,s=i;s<n;++s)dl(this,s,e);i=this.doc.sel.ranges;0==o.ch&&t.length==i.length&&0<i[r].from().ch&&Wi(this.doc,r,new oi(o,i[r].to()),G)}}}),getTokenAt:function(e,t){return xt(this,e,t)},getLineTokens:function(e,t){return xt(this,rt(e),t,!0)},getTokenTypeAt:function(e){e=ct(this.doc,e);var t,n=gt(this,$e(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var l=r+i>>1;if((l?n[2*l-1]:0)>=o)i=l;else{if(!(n[2*l+1]<o)){t=n[2*l+2];break}r=1+l}}e=t?t.indexOf("overlay "):-1;return e<0?t:0==e?null:t.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Nl.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Al.hasOwnProperty(t))return n;var r=Al[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var l=r[i[t][o]];l&&n.push(l)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var s=0;s<r._global.length;s++){var a=r._global[s];a.pred(i,this)&&-1==z(n,a.val)&&n.push(a.val)}return n},getStateAfter:function(e,t){var n=this.doc;return mt(this,(e=ut(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary(),n=null==e?n.head:"object"==typeof e?ct(this.doc,e):e?n.from():n.to();return Bn(this,n,t||"page")},charCoords:function(e,t){return Rn(this,ct(this.doc,e),t||"page")},coordsChar:function(e,t){return Vn(this,(e=zn(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=zn(this,{top:e,left:0},t||"page").top,et(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var r,i=!1,e="number"==typeof e?(r=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:r<e&&(e=r,i=!0),$e(this.doc,e)):e;return In(this,e,{top:0,left:0},t||"page",n||i).top+(i?this.doc.height-Vt(e):0)},defaultTextHeight:function(){return Yn(this.display)},defaultCharWidth:function(){return _n(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o,l,s=this.display,a=(e=Bn(this,ct(this.doc,e))).bottom,u=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==r?a=e.top:"above"!=r&&"near"!=r||(o=Math.max(s.wrapper.clientHeight,this.doc.height),l=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth),("above"==r||e.bottom+t.offsetHeight>o)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=o&&(a=e.bottom),u+t.offsetWidth>l&&(u=l-t.offsetWidth)),t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&(n=this,t={left:u,top:a,right:u+t.offsetWidth,bottom:a+t.offsetHeight},null!=(t=yr(n,t)).scrollTop&&Lr(n,t.scrollTop),null!=t.scrollLeft&&Tr(n,t.scrollLeft))},triggerOnKeyDown:Ir(Yo),triggerOnKeyPress:Ir($o),triggerOnKeyUp:_o,triggerOnMouseDown:Ir(Jo),execCommand:function(e){if(zo.hasOwnProperty(e))return zo[e].call(null,this)},triggerElectric:Ir(function(e){vl(this,e)}),findPosH:function(e,t,n,r){var i=1;t<0&&(i=-1,t=-t);for(var o=ct(this.doc,e),l=0;l<t&&!(o=xl(this.doc,o,i,n,r)).hitSide;++l);return o},moveH:Ir(function(t,n){var r=this;this.extendSelectionsBy(function(e){return r.display.shift||r.doc.extend||e.empty()?xl(r.doc,e.head,t,n,r.options.rtlMoveVisually):t<0?e.from():e.to()},V)}),deleteH:Ir(function(n,r){var e=this.doc.sel,i=this.doc;e.somethingSelected()?i.replaceSelection("",null,"+delete"):Ho(this,function(e){var t=xl(i,e.head,n,r,!1);return n<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,n,r){var i=1,o=r;t<0&&(i=-1,t=-t);for(var l=ct(this.doc,e),s=0;s<t;++s){var a=Bn(this,l,"div");if(null==o?o=a.left:a.left=o,(l=Cl(this,a,i,n)).hitSide)break}return l},moveV:Ir(function(r,i){var o=this,l=this.doc,s=[],a=!this.display.shift&&!l.extend&&l.sel.somethingSelected();if(l.extendSelectionsBy(function(e){if(a)return r<0?e.from():e.to();var t=Bn(o,e.head,"div");null!=e.goalColumn&&(t.left=e.goalColumn),s.push(t.left);var n=Cl(o,t,r,i);return"page"==i&&e==l.sel.primary()&&br(o,Rn(o,n,"div").top-t.top),n},V),s.length)for(var e=0;e<l.sel.ranges.length;e++)l.sel.ranges[e].goalColumn=s[e]}),findWordAt:function(e){var t=$e(this.doc,e.line).text,n=e.ch,r=e.ch;if(t){var i=this.getHelper(e,"wordChars");"before"!=e.sticky&&r!=t.length||!n?++r:--n;for(var o=t.charAt(n),l=J(o,i)?function(e){return J(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!J(e)};0<n&&l(t.charAt(n-1));)--n;for(;r<t.length&&l(t.charAt(r));)++r}return new oi(rt(e.line,n),rt(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?D:L)(this.display.cursorDiv,"CodeMirror-overwrite"),xe(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==A()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ir(function(e,t){xr(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-wn(this)-this.display.barHeight,width:e.scrollWidth-wn(this)-this.display.barWidth,clientHeight:Cn(this),clientWidth:xn(this)}},scrollIntoView:Ir(function(e,t){var n;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:rt(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(n=e,Cr(t=this),t.curOp.scrollToPos=n):Sr(this,e.from,e.to,e.margin)}),setSize:Ir(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this;null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&Wn(this);var i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){nr(r,i,"widget");break}++i}),this.curOp.forceUpdate=!0,xe(this,"refresh",this)}),operation:function(e){return Pr(this,e)},startOperation:function(){return Hr(this)},endOperation:function(){return Fr(this)},refresh:Ir(function(){var e=this.display.cachedTextHeight;tr(this),this.curOp.forceUpdate=!0,Hn(this),xr(this,this.doc.scrollLeft,this.doc.scrollTop),jr(this.display),(null==e||.5<Math.abs(e-Yn(this.display))||this.options.lineWrapping)&&Qn(this),xe(this,"refresh",this)}),swapDoc:Ir(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),vi(this,e),Hn(this),this.display.input.reset(),xr(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,ln(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},ke(Nl),Nl.registerHelper=function(e,t,n){Al.hasOwnProperty(e)||(Al[e]=Nl[e]={_global:[]}),Al[e][t]=n},Nl.registerGlobalHelper=function(e,t,n,r){Nl.registerHelper(e,t,r),Al[e]._global.push({pred:n,val:r})};var Wl,Hl,Fl="iter insert remove copy getEditor constructor".split(" ");for(Wl in fo.prototype)fo.prototype.hasOwnProperty(Wl)&&z(Fl,Wl)<0&&(cl.prototype[Wl]=function(e){return function(){return e.apply(this.doc,arguments)}}(fo.prototype[Wl]));return ke(fo),cl.inputStyles={textarea:r,contenteditable:e},cl.defineMode=function(e){cl.defaults.mode||"null"==e||(cl.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Re[e]=t}.apply(this,arguments)},cl.defineMIME=function(e,t){Be[e]=t},cl.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),cl.defineMIME("text/plain","null"),cl.defineExtension=function(e,t){cl.prototype[e]=t},cl.defineDocExtension=function(e,t){fo.prototype[e]=t},cl.fromTextArea=function(t,n){var e;function r(){t.value=s.getValue()}if(n=n?P(n):{},n.value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus&&(e=A(),n.autofocus=e==t||null!=t.getAttribute("autofocus")&&e==document.body),t.form&&(ye(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var l=i.submit=function(){r(),i.submit=o,i.submit(),i.submit=l}}catch(e){}}n.finishInit=function(e){e.save=r,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,r(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(we(t.form,"submit",r),n.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=o))}},t.style.display="none";var s=cl(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},n);return s},(Hl=cl).off=we,Hl.on=ye,Hl.wheelEventPixels=ni,Hl.Doc=fo,Hl.splitLines=Pe,Hl.countColumn=E,Hl.findColumn=K,Hl.isWordChar=Q,Hl.Pass=B,Hl.signal=xe,Hl.Line=Xt,Hl.changeEnd=ai,Hl.scrollbarModel=Ar,Hl.Pos=rt,Hl.cmpPos=it,Hl.modes=Re,Hl.mimeModes=Be,Hl.resolveMode=Ge,Hl.getMode=Ue,Hl.modeExtensions=Ve,Hl.extendMode=Ke,Hl.copyState=je,Hl.startState=Ye,Hl.innerMode=Xe,Hl.commands=zo,Hl.keyMap=ko,Hl.keyName=Do,Hl.isModifierKey=Oo,Hl.lookupKey=No,Hl.normalizeKeyMap=Mo,Hl.StringStream=_e,Hl.SharedTextMarker=ao,Hl.TextMarker=lo,Hl.LineWidget=ro,Hl.e_preventDefault=Te,Hl.e_stopPropagation=Me,Hl.e_stop=Oe,Hl.addClass=D,Hl.contains=O,Hl.rmClass=L,Hl.keyNames=xo,cl.version="5.61.0",cl});
!function(n){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(t){return n(t,window,document)}):"object"==typeof exports?module.exports=function(t,e){return t=t||window,e=e||("undefined"!=typeof window?require("jquery"):require("jquery")(t)),n(e,t,t.document)}:n(jQuery,window,document)}(function(j,T,m,N){"use strict";function r(t){return!t||!0===t||"-"===t}function f(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null}function o(t,e){return a[e]||(a[e]=new RegExp(_t(e),"g")),"string"==typeof t&&"."!==e?t.replace(/\./g,"").replace(a[e],"."):t}function i(t,e,n){var a="string"==typeof t;return!!r(t)||(e&&a&&(t=o(t,e)),n&&a&&(t=t.replace(h,"")),!isNaN(parseFloat(t))&&isFinite(t))}function n(t,e,n){return!!r(t)||((r(a=t)||"string"==typeof a)&&!!i(g(t),e,n)||null);var a}function S(t,e,n,a){var r=[],o=0,i=e.length;if(a!==N)for(;o<i;o++)t[e[o]][n]&&r.push(t[e[o]][n][a]);else for(;o<i;o++)r.push(t[e[o]][n]);return r}function d(t,e){var n,a=[];e===N?(e=0,n=t):(n=e,e=t);for(var r=e;r<n;r++)a.push(r);return a}function v(t){for(var e=[],n=0,a=t.length;n<a;n++)t[n]&&e.push(t[n]);return e}var p,e,t,w=function(D){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new be(t?re(this[p.iApiIndex]):this)},this.fnAddData=function(t,e){var n=this.api(!0),t=(j.isArray(t)&&(j.isArray(t[0])||j.isPlainObject(t[0]))?n.rows:n.row).add(t);return e!==N&&!e||n.draw(),t.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),n=e.settings()[0],a=n.oScroll;t===N||t?e.draw(!1):""===a.sX&&""===a.sY||Et(n)},this.fnClearTable=function(t){var e=this.api(!0).clear();t!==N&&!t||e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,n){var a=this.api(!0),r=a.rows(t),o=r.settings()[0],t=o.aoData[r[0][0]];return r.remove(),e&&e.call(this,o,t),n!==N&&!n||a.draw(),t},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(t)},this.fnFilter=function(t,e,n,a,r,o){var i=this.api(!0);(null===e||e===N?i:i.column(e)).search(t,n,a,o),i.draw()},this.fnGetData=function(t,e){var n=this.api(!0);if(t===N)return n.data().toArray();var a=t.nodeName?t.nodeName.toLowerCase():"";return e!==N||"td"==a||"th"==a?n.cell(t,e).data():n.row(t).data()||null},this.fnGetNodes=function(t){var e=this.api(!0);return t!==N?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();if("TR"==n)return e.row(t).index();if("TD"!=n&&"TH"!=n)return null;t=e.cell(t).index();return[t.row,t.columnVisible,t.column]},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){t=this.api(!0).page(t);e!==N&&!e||t.draw(!1)},this.fnSetColumnVis=function(t,e,n){e=this.api(!0).column(t).visible(e);n!==N&&!n||e.columns.adjust().draw()},this.fnSettings=function(){return re(this[p.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,n,a,r){var o=this.api(!0);return(n===N||null===n?o.row(e):o.cell(e,n)).data(t),r!==N&&!r||o.columns.adjust(),a!==N&&!a||o.draw(),0},this.fnVersionCheck=p.fnVersionCheck;var t,y=this,_=D===N,C=this.length;for(t in _&&(D={}),this.oApi=this.internal=p.internal,w.ext.internal)t&&(this[t]=Ne(t));return this.each(function(){var a=1<C?le({},D,!0):D,r=0,t=this.getAttribute("id"),o=!1,e=w.defaults,i=j(this);if("table"==this.nodeName.toLowerCase()){A(e),F(e.column),x(e,e,!0),x(e.column,e.column,!0),x(e,j.extend(a,i.data()));for(var n=w.settings,r=0,l=n.length;r<l;r++){var s=n[r];if(s.nTable==this||s.nTHead&&s.nTHead.parentNode==this||s.nTFoot&&s.nTFoot.parentNode==this){var u=(a.bRetrieve!==N?a:e).bRetrieve,c=(a.bDestroy!==N?a:e).bDestroy;if(_||u)return s.oInstance;if(c){s.oInstance.fnDestroy();break}return void oe(s,0,"Cannot reinitialise DataTable",3)}if(s.sTableId==this.id){n.splice(r,1);break}}null!==t&&""!==t||(t="DataTables_Table_"+w.ext._unique++,this.id=t);var f=j.extend(!0,{},w.models.oSettings,{sDestroyWidth:i[0].style.width,sInstance:t,sTableId:t});f.nTable=this,f.oApi=y.internal,f.oInit=a,n.push(f),f.oInstance=1===y.length?y:i.dataTable(),A(a),I(a.oLanguage),a.aLengthMenu&&!a.iDisplayLength&&(a.iDisplayLength=(j.isArray(a.aLengthMenu[0])?a.aLengthMenu[0]:a.aLengthMenu)[0]),a=le(j.extend(!0,{},e),a),ie(f.oFeatures,a,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),ie(f,a,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]),ie(f.oScroll,a,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),ie(f.oLanguage,a,"fnInfoCallback"),ue(f,"aoDrawCallback",a.fnDrawCallback,"user"),ue(f,"aoServerParams",a.fnServerParams,"user"),ue(f,"aoStateSaveParams",a.fnStateSaveParams,"user"),ue(f,"aoStateLoadParams",a.fnStateLoadParams,"user"),ue(f,"aoStateLoaded",a.fnStateLoaded,"user"),ue(f,"aoRowCallback",a.fnRowCallback,"user"),ue(f,"aoRowCreatedCallback",a.fnCreatedRow,"user"),ue(f,"aoHeaderCallback",a.fnHeaderCallback,"user"),ue(f,"aoFooterCallback",a.fnFooterCallback,"user"),ue(f,"aoInitComplete",a.fnInitComplete,"user"),ue(f,"aoPreDrawCallback",a.fnPreDrawCallback,"user"),f.rowIdFn=z(a.rowId),L(f);var d=f.oClasses;j.extend(d,w.ext.classes,a.oClasses),i.addClass(d.sTable),f.iInitDisplayStart===N&&(f.iInitDisplayStart=a.iDisplayStart,f._iDisplayStart=a.iDisplayStart),null!==a.iDeferLoading&&(f.bDeferLoading=!0,p=j.isArray(a.iDeferLoading),f._iRecordsDisplay=p?a.iDeferLoading[0]:a.iDeferLoading,f._iRecordsTotal=p?a.iDeferLoading[1]:a.iDeferLoading);var h=f.oLanguage;j.extend(!0,h,a.oLanguage),h.sUrl&&(j.ajax({dataType:"json",url:h.sUrl,success:function(t){I(t),x(e.oLanguage,t),j.extend(!0,h,t),Pt(f)},error:function(){Pt(f)}}),o=!0),null===a.asStripeClasses&&(f.asStripeClasses=[d.sStripeOdd,d.sStripeEven]);var p=f.asStripeClasses,g=i.children("tbody").find("tr").eq(0);-1!==j.inArray(!0,j.map(p,function(t,e){return g.hasClass(t)}))&&(j("tbody tr",this).removeClass(p.join(" ")),f.asDestroyStripes=p.slice());var b,S,m=[],p=this.getElementsByTagName("thead");if(0!==p.length&&(ut(f.aoHeader,p[0]),m=ct(f)),null===a.aoColumns)for(b=[],r=0,l=m.length;r<l;r++)b.push(null);else b=a.aoColumns;for(r=0,l=b.length;r<l;r++)P(f,m?m[r]:null);B(f,a.aoColumnDefs,b,function(t,e){R(f,t,e)}),g.length&&(S=function(t,e){return null!==t.getAttribute("data-"+e)?e:null},j(g[0]).children("th, td").each(function(t,e){var n,a=f.aoColumns[t];a.mData===t&&(n=S(e,"sort")||S(e,"order"),e=S(e,"filter")||S(e,"search"),null===n&&null===e||(a.mData={_:t+".display",sort:null!==n?t+".@data-"+n:N,type:null!==n?t+".@data-"+n:N,filter:null!==e?t+".@data-"+e:N},R(f,t)))}));var v=f.oFeatures,p=function(){if(a.aaSorting===N){var t=f.aaSorting;for(r=0,l=t.length;r<l;r++)t[r][1]=f.aoColumns[r].asSorting[0]}te(f),v.bSort&&ue(f,"aoDrawCallback",function(){var t,n;f.bSorted&&(t=zt(f),n={},j.each(t,function(t,e){n[e.src]=e.dir}),ce(f,null,"order",[f,t,n]),Zt(f))}),ue(f,"aoDrawCallback",function(){(f.bSorted||"ssp"===he(f)||v.bDeferRender)&&te(f)},"sc");var e=i.children("caption").each(function(){this._captionSide=j(this).css("caption-side")}),n=i.children("thead");0===n.length&&(n=j("<thead/>").appendTo(i)),f.nTHead=n[0];n=i.children("tbody");0===n.length&&(n=j("<tbody/>").appendTo(i)),f.nTBody=n[0];n=i.children("tfoot");if(0===n.length&&0<e.length&&(""!==f.oScroll.sX||""!==f.oScroll.sY)&&(n=j("<tfoot/>").appendTo(i)),0===n.length||0===n.children().length?i.addClass(d.sNoFooter):0<n.length&&(f.nTFoot=n[0],ut(f.aoFooter,f.nTFoot)),a.aaData)for(r=0;r<a.aaData.length;r++)U(f,a.aaData[r]);else!f.bDeferLoading&&"dom"!=he(f)||V(f,j(f.nTBody).children("tr"));f.aiDisplay=f.aiDisplayMaster.slice(),!(f.bInitialised=!0)===o&&Pt(f)};a.bStateSave?(v.bStateSave=!0,ue(f,"aoDrawCallback",ne,"state_save"),ae(f,0,p)):p()}else oe(null,0,"Non-table node initialisation ("+this.nodeName+")",2)}),y=null,this},a={},l=/[\r\n]/g,s=/<.*?>/g,u=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,c=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),h=/[',$Â£â¬Â¥%\u2009\u202F\u20BD\u20a9\u20BArfkÉÎ]/gi,H=function(t,e,n){var a=[],r=0,o=t.length;if(n!==N)for(;r<o;r++)t[r]&&t[r][e]&&a.push(t[r][e][n]);else for(;r<o;r++)t[r]&&a.push(t[r][e]);return a},g=function(t){return t.replace(s,"")},b=function(t){if(function(t){if(t.length<2)return!0;for(var e=t.slice().sort(),n=e[0],a=1,r=e.length;a<r;a++){if(e[a]===n)return!1;n=e[a]}return!0}(t))return t.slice();var e,n,a,r=[],o=t.length,i=0;t:for(n=0;n<o;n++){for(e=t[n],a=0;a<i;a++)if(r[a]===e)continue t;r.push(e),i++}return r};function D(n){var a,r,o={};j.each(n,function(t,e){(a=t.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(a[1]+" ")&&(r=t.replace(a[0],a[2].toLowerCase()),o[r]=t,"o"===a[1]&&D(n[t]))}),n._hungarianMap=o}function x(n,a,r){var o;n._hungarianMap||D(n),j.each(a,function(t,e){(o=n._hungarianMap[t])===N||!r&&a[o]!==N||("o"===o.charAt(0)?(a[o]||(a[o]={}),j.extend(!0,a[o],a[t]),x(n[o],a[o],r)):a[o]=a[t])})}function I(t){var e,n=w.defaults.oLanguage,a=n.sDecimal;a&&Re(a),t&&(e=t.sZeroRecords,!t.sEmptyTable&&e&&"No data available in table"===n.sEmptyTable&&ie(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&e&&"Loading..."===n.sLoadingRecords&&ie(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands),(t=t.sDecimal)&&a!==t&&Re(t))}w.util={throttle:function(a,t){var r,o,i=t!==N?t:200;return function(){var t=this,e=+new Date,n=arguments;r&&e<r+i?(clearTimeout(o),o=setTimeout(function(){r=N,a.apply(t,n)},i)):(r=e,a.apply(t,n))}},escapeRegex:function(t){return t.replace(c,"\\$1")}};var y=function(t,e,n){t[e]!==N&&(t[n]=t[e])};function A(t){y(t,"ordering","bSort"),y(t,"orderMulti","bSortMulti"),y(t,"orderClasses","bSortClasses"),y(t,"orderCellsTop","bSortCellsTop"),y(t,"order","aaSorting"),y(t,"orderFixed","aaSortingFixed"),y(t,"paging","bPaginate"),y(t,"pagingType","sPaginationType"),y(t,"pageLength","iDisplayLength"),y(t,"searching","bFilter"),"boolean"==typeof t.sScrollX&&(t.sScrollX=t.sScrollX?"100%":""),"boolean"==typeof t.scrollX&&(t.scrollX=t.scrollX?"100%":"");var e=t.aoSearchCols;if(e)for(var n=0,a=e.length;n<a;n++)e[n]&&x(w.models.oSearch,e[n])}function F(t){y(t,"orderable","bSortable"),y(t,"orderData","aDataSort"),y(t,"orderSequence","asSorting"),y(t,"orderDataType","sortDataType");var e=t.aDataSort;"number"!=typeof e||j.isArray(e)||(t.aDataSort=[e])}function L(t){var e,n,a,r;w.__browser||(e={},w.__browser=e,r=(a=(n=j("<div/>").css({position:"fixed",top:0,left:-1*j(T).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(j("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(j("<div/>").css({width:"100%",height:10}))).appendTo("body")).children()).children(),e.barWidth=a[0].offsetWidth-a[0].clientWidth,e.bScrollOversize=100===r[0].offsetWidth&&100!==a[0].clientWidth,e.bScrollbarLeft=1!==Math.round(r.offset().left),e.bBounding=!!n[0].getBoundingClientRect().width,n.remove()),j.extend(t.oBrowser,w.__browser),t.oScroll.iBarWidth=w.__browser.barWidth}function _(t,e,n,a,r,o){var i,l=a,s=!1;for(n!==N&&(i=n,s=!0);l!==r;)t.hasOwnProperty(l)&&(i=s?e(i,t[l],l,t):t[l],s=!0,l+=o);return i}function P(t,e){var n=w.defaults.column,a=t.aoColumns.length,n=j.extend({},w.models.oColumn,n,{nTh:e||m.createElement("th"),sTitle:n.sTitle||(e?e.innerHTML:""),aDataSort:n.aDataSort||[a],mData:n.mData||a,idx:a});t.aoColumns.push(n);n=t.aoPreSearchCols;n[a]=j.extend({},w.models.oSearch,n[a]),R(t,a,j(e).data())}function R(t,e,n){var a=t.aoColumns[e],r=t.oClasses,o=j(a.nTh);a.sWidthOrig||(a.sWidthOrig=o.attr("width")||null,(e=(o.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/))&&(a.sWidthOrig=e[1])),n!==N&&null!==n&&(F(n),x(w.defaults.column,n),n.mDataProp===N||n.mData||(n.mData=n.mDataProp),n.sType&&(a._sManualType=n.sType),n.className&&!n.sClass&&(n.sClass=n.className),n.sClass&&o.addClass(n.sClass),j.extend(a,n),ie(a,n,"sWidth","sWidthOrig"),n.iDataSort!==N&&(a.aDataSort=[n.iDataSort]),ie(a,n,"aDataSort"));var i=a.mData,l=z(i),s=a.mRender?z(a.mRender):null,n=function(t){return"string"==typeof t&&-1!==t.indexOf("@")};a._bAttrSrc=j.isPlainObject(i)&&(n(i.sort)||n(i.type)||n(i.filter)),a._setter=null,a.fnGetData=function(t,e,n){var a=l(t,e,N,n);return s&&e?s(a,e,t,n):a},a.fnSetData=function(t,e,n){return Y(i)(t,e,n)},"number"!=typeof i&&(t._rowReadObject=!0),t.oFeatures.bSort||(a.bSortable=!1,o.addClass(r.sSortableNone));t=-1!==j.inArray("asc",a.asSorting),o=-1!==j.inArray("desc",a.asSorting);a.bSortable&&(t||o)?t&&!o?(a.sSortingClass=r.sSortableAsc,a.sSortingClassJUI=r.sSortJUIAscAllowed):!t&&o?(a.sSortingClass=r.sSortableDesc,a.sSortingClassJUI=r.sSortJUIDescAllowed):(a.sSortingClass=r.sSortable,a.sSortingClassJUI=r.sSortJUI):(a.sSortingClass=r.sSortableNone,a.sSortingClassJUI="")}function O(t){if(!1!==t.oFeatures.bAutoWidth){var e=t.aoColumns;Vt(t);for(var n=0,a=e.length;n<a;n++)e[n].nTh.style.width=e[n].sWidth}var r=t.oScroll;""===r.sY&&""===r.sX||Et(t),ce(t,null,"column-sizing",[t])}function k(t,e){t=W(t,"bVisible");return"number"==typeof t[e]?t[e]:null}function C(t,e){t=W(t,"bVisible"),t=j.inArray(e,t);return-1!==t?t:null}function M(t){var n=0;return j.each(t.aoColumns,function(t,e){e.bVisible&&"none"!==j(e.nTh).css("display")&&n++}),n}function W(t,n){var a=[];return j.map(t.aoColumns,function(t,e){t[n]&&a.push(e)}),a}function E(t){for(var e,n,a,r,o,i,l,s=t.aoColumns,u=t.aoData,c=w.ext.type.detect,f=0,d=s.length;f<d;f++)if(l=[],!(o=s[f]).sType&&o._sManualType)o.sType=o._sManualType;else if(!o.sType){for(e=0,n=c.length;e<n;e++){for(a=0,r=u.length;a<r&&(l[a]===N&&(l[a]=X(t,a,f,"type")),(i=c[e](l[a],t))||e===c.length-1)&&"html"!==i;a++);if(i){o.sType=i;break}}o.sType||(o.sType="string")}}function B(t,e,n,a){var r,o,i,l,s,u,c,f=t.aoColumns;if(e)for(r=e.length-1;0<=r;r--){var d=(c=e[r]).targets!==N?c.targets:c.aTargets;for(j.isArray(d)||(d=[d]),i=0,l=d.length;i<l;i++)if("number"==typeof d[i]&&0<=d[i]){for(;f.length<=d[i];)P(t);a(d[i],c)}else if("number"==typeof d[i]&&d[i]<0)a(f.length+d[i],c);else if("string"==typeof d[i])for(s=0,u=f.length;s<u;s++)"_all"!=d[i]&&!j(f[s].nTh).hasClass(d[i])||a(s,c)}if(n)for(r=0,o=n.length;r<o;r++)a(r,n[r])}function U(t,e,n,a){var r=t.aoData.length,o=j.extend(!0,{},w.models.oRow,{src:n?"dom":"data",idx:r});o._aData=e,t.aoData.push(o);for(var i=t.aoColumns,l=0,s=i.length;l<s;l++)i[l].sType=null;t.aiDisplayMaster.push(r);e=t.rowIdFn(e);return e!==N&&(t.aIds[e]=o),!n&&t.oFeatures.bDeferRender||nt(t,r,n,a),r}function V(n,t){var a;return t instanceof j||(t=j(t)),t.map(function(t,e){return a=et(n,e),U(n,a.data,e,a.cells)})}function X(t,e,n,a){var r=t.iDraw,o=t.aoColumns[n],i=t.aoData[e]._aData,l=o.sDefaultContent,s=o.fnGetData(i,a,{settings:t,row:e,col:n});if(s===N)return t.iDrawError!=r&&null===l&&(oe(t,0,"Requested unknown parameter "+("function"==typeof o.mData?"{function}":"'"+o.mData+"'")+" for row "+e+", column "+n,4),t.iDrawError=r),l;if(s!==i&&null!==s||null===l||a===N){if("function"==typeof s)return s.call(i)}else s=l;return null===s&&"display"==a?"":s}function J(t,e,n,a){var r=t.aoColumns[n],o=t.aoData[e]._aData;r.fnSetData(o,a,{settings:t,row:e,col:n})}var q=/\[.*?\]$/,G=/\(\)$/;function $(t){return j.map(t.match(/(\\.|[^\.])+/g)||[""],function(t){return t.replace(/\\\./g,".")})}function z(r){if(j.isPlainObject(r)){var o={};return j.each(r,function(t,e){e&&(o[t]=z(e))}),function(t,e,n,a){var r=o[e]||o._;return r!==N?r(t,e,n,a):t}}if(null===r)return function(t){return t};if("function"==typeof r)return function(t,e,n,a){return r(t,e,n,a)};if("string"!=typeof r||-1===r.indexOf(".")&&-1===r.indexOf("[")&&-1===r.indexOf("("))return function(t,e){return t[r]};var d=function(t,e,n){var a,r,o;if(""!==n)for(var i=$(n),l=0,s=i.length;l<s;l++){if(f=i[l].match(q),a=i[l].match(G),f){if(i[l]=i[l].replace(q,""),""!==i[l]&&(t=t[i[l]]),r=[],i.splice(0,l+1),o=i.join("."),j.isArray(t))for(var u=0,c=t.length;u<c;u++)r.push(d(t[u],e,o));var f=f[0].substring(1,f[0].length-1);t=""===f?r:r.join(f);break}if(a)i[l]=i[l].replace(G,""),t=t[i[l]]();else{if(null===t||t[i[l]]===N)return N;t=t[i[l]]}}return t};return function(t,e){return d(t,e,r)}}function Y(a){if(j.isPlainObject(a))return Y(a._);if(null===a)return function(){};if("function"==typeof a)return function(t,e,n){a(t,"set",e,n)};if("string"!=typeof a||-1===a.indexOf(".")&&-1===a.indexOf("[")&&-1===a.indexOf("("))return function(t,e){t[a]=e};var d=function(t,e,n){for(var a,r,o,i,l=$(n),n=l[l.length-1],s=0,u=l.length-1;s<u;s++){if(a=l[s].match(q),r=l[s].match(G),a){if(l[s]=l[s].replace(q,""),t[l[s]]=[],(a=l.slice()).splice(0,s+1),i=a.join("."),j.isArray(e))for(var c=0,f=e.length;c<f;c++)d(o={},e[c],i),t[l[s]].push(o);else t[l[s]]=e;return}r&&(l[s]=l[s].replace(G,""),t=t[l[s]](e)),null!==t[l[s]]&&t[l[s]]!==N||(t[l[s]]={}),t=t[l[s]]}n.match(G)?t=t[n.replace(G,"")](e):t[n.replace(q,"")]=e};return function(t,e){return d(t,e,a)}}function Z(t){return H(t.aoData,"_aData")}function K(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0,t.aIds={}}function Q(t,e,n){for(var a=-1,r=0,o=t.length;r<o;r++)t[r]==e?a=r:t[r]>e&&t[r]--;-1!=a&&n===N&&t.splice(a,1)}function tt(n,a,t,e){function r(t,e){for(;t.childNodes.length;)t.removeChild(t.firstChild);t.innerHTML=X(n,a,e,"display")}var o,i,l=n.aoData[a];if("dom"!==t&&(t&&"auto"!==t||"dom"!==l.src)){var s=l.anCells;if(s)if(e!==N)r(s[e],e);else for(o=0,i=s.length;o<i;o++)r(s[o],o)}else l._aData=et(n,l,e,e===N?N:l._aData).data;l._aSortData=null,l._aFilterData=null;var u=n.aoColumns;if(e!==N)u[e].sType=null;else{for(o=0,i=u.length;o<i;o++)u[o].sType=null;at(n,l)}}function et(t,e,n,a){var r,o,i,l=[],s=e.firstChild,u=0,c=t.aoColumns,f=t._rowReadObject;a=a!==N?a:f?{}:[];function d(t,e){var n;"string"!=typeof t||-1!==(n=t.indexOf("@"))&&(n=t.substring(n+1),Y(t)(a,e.getAttribute(n)))}function h(t){n!==N&&n!==u||(o=c[u],i=j.trim(t.innerHTML),o&&o._bAttrSrc?(Y(o.mData._)(a,i),d(o.mData.sort,t),d(o.mData.type,t),d(o.mData.filter,t)):f?(o._setter||(o._setter=Y(o.mData)),o._setter(a,i)):a[u]=i),u++}if(s)for(;s;)"TD"!=(r=s.nodeName.toUpperCase())&&"TH"!=r||(h(s),l.push(s)),s=s.nextSibling;else for(var p=0,g=(l=e.anCells).length;p<g;p++)h(l[p]);e=e.firstChild?e:e.nTr;return!e||(e=e.getAttribute("id"))&&Y(t.rowId)(a,e),{data:a,cells:l}}function nt(t,e,n,a){var r,o,i,l,s,u=t.aoData[e],c=u._aData,f=[];if(null===u.nTr){for(r=n||m.createElement("tr"),u.nTr=r,u.anCells=f,r._DT_RowIndex=e,at(t,u),l=0,s=t.aoColumns.length;l<s;l++)i=t.aoColumns[l],(o=n?a[l]:m.createElement(i.sCellType))._DT_CellIndex={row:e,column:l},f.push(o),n&&!i.mRender&&i.mData===l||j.isPlainObject(i.mData)&&i.mData._===l+".display"||(o.innerHTML=X(t,e,l,"display")),i.sClass&&(o.className+=" "+i.sClass),i.bVisible&&!n?r.appendChild(o):!i.bVisible&&n&&o.parentNode.removeChild(o),i.fnCreatedCell&&i.fnCreatedCell.call(t.oInstance,o,X(t,e,l),c,e,l);ce(t,"aoRowCreatedCallback",null,[r,c,e,f])}u.nTr.setAttribute("role","row")}function at(t,e){var n=e.nTr,a=e._aData;n&&((t=t.rowIdFn(a))&&(n.id=t),a.DT_RowClass&&(t=a.DT_RowClass.split(" "),e.__rowc=e.__rowc?b(e.__rowc.concat(t)):t,j(n).removeClass(e.__rowc.join(" ")).addClass(a.DT_RowClass)),a.DT_RowAttr&&j(n).attr(a.DT_RowAttr),a.DT_RowData&&j(n).data(a.DT_RowData))}function rt(t){var e,n,a,r=t.nTHead,o=t.nTFoot,i=0===j("th, td",r).length,l=t.oClasses,s=t.aoColumns;for(i&&(n=j("<tr/>").appendTo(r)),c=0,f=s.length;c<f;c++)a=s[c],e=j(a.nTh).addClass(a.sClass),i&&e.appendTo(n),t.oFeatures.bSort&&(e.addClass(a.sSortingClass),!1!==a.bSortable&&(e.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),Qt(t,a.nTh,c))),a.sTitle!=e[0].innerHTML&&e.html(a.sTitle),de(t,"header")(t,e,a,l);if(i&&ut(t.aoHeader,r),j(r).find(">tr").attr("role","row"),j(r).find(">tr>th, >tr>td").addClass(l.sHeaderTH),j(o).find(">tr>th, >tr>td").addClass(l.sFooterTH),null!==o)for(var u=t.aoFooter[0],c=0,f=u.length;c<f;c++)(a=s[c]).nTf=u[c].cell,a.sClass&&j(a.nTf).addClass(a.sClass)}function ot(t,e,n){var a,r,o,i,l,s,u,c,f,d=[],h=[],p=t.aoColumns.length;if(e){for(n===N&&(n=!1),a=0,r=e.length;a<r;a++){for(d[a]=e[a].slice(),d[a].nTr=e[a].nTr,o=p-1;0<=o;o--)t.aoColumns[o].bVisible||n||d[a].splice(o,1);h.push([])}for(a=0,r=d.length;a<r;a++){if(u=d[a].nTr)for(;s=u.firstChild;)u.removeChild(s);for(o=0,i=d[a].length;o<i;o++)if(f=c=1,h[a][o]===N){for(u.appendChild(d[a][o].cell),h[a][o]=1;d[a+c]!==N&&d[a][o].cell==d[a+c][o].cell;)h[a+c][o]=1,c++;for(;d[a][o+f]!==N&&d[a][o].cell==d[a][o+f].cell;){for(l=0;l<c;l++)h[a+l][o+f]=1;f++}j(d[a][o].cell).attr("rowspan",c).attr("colspan",f)}}}}function it(t){var e=ce(t,"aoPreDrawCallback","preDraw",[t]);if(-1===j.inArray(!1,e)){var n=[],a=0,r=t.asStripeClasses,o=r.length,i=(t.aoOpenRows.length,t.oLanguage),l=t.iInitDisplayStart,s="ssp"==he(t),u=t.aiDisplay;t.bDrawing=!0,l!==N&&-1!==l&&(t._iDisplayStart=!s&&l>=t.fnRecordsDisplay()?0:l,t.iInitDisplayStart=-1);e=t._iDisplayStart,l=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,Mt(t,!1);else if(s){if(!t.bDestroying&&!dt(t))return}else t.iDraw++;if(0!==u.length)for(var c=s?0:e,f=s?t.aoData.length:l,d=c;d<f;d++){var h=u[d],p=t.aoData[h];null===p.nTr&&nt(t,h);var g,b=p.nTr;0!==o&&(g=r[a%o],p._sRowStripe!=g&&(j(b).removeClass(p._sRowStripe).addClass(g),p._sRowStripe=g)),ce(t,"aoRowCallback",null,[b,p._aData,a,d,h]),n.push(b),a++}else{c=i.sZeroRecords;1==t.iDraw&&"ajax"==he(t)?c=i.sLoadingRecords:i.sEmptyTable&&0===t.fnRecordsTotal()&&(c=i.sEmptyTable),n[0]=j("<tr/>",{class:o?r[0]:""}).append(j("<td />",{valign:"top",colSpan:M(t),class:t.oClasses.sRowEmpty}).html(c))[0]}ce(t,"aoHeaderCallback","header",[j(t.nTHead).children("tr")[0],Z(t),e,l,u]),ce(t,"aoFooterCallback","footer",[j(t.nTFoot).children("tr")[0],Z(t),e,l,u]);l=j(t.nTBody);l.children().detach(),l.append(j(n)),ce(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}else Mt(t,!1)}function lt(t,e){var n=t.oFeatures,a=n.bSort,n=n.bFilter;a&&Yt(t),n?St(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),!0!==e&&(t._iDisplayStart=0),t._drawHold=e,it(t),t._drawHold=!1}function st(t){var e=t.oClasses,n=j(t.nTable),n=j("<div/>").insertBefore(n),a=t.oFeatures,r=j("<div/>",{id:t.sTableId+"_wrapper",class:e.sWrapper+(t.nTFoot?"":" "+e.sNoFooter)});t.nHolding=n[0],t.nTableWrapper=r[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var o,i,l,s,u,c,f,d=t.sDom.split(""),h=0;h<d.length;h++){if(o=null,"<"==(i=d[h])){if(f=j("<div/>")[0],"'"==(l=d[h+1])||'"'==l){for(s="",u=2;d[h+u]!=l;)s+=d[h+u],u++;"H"==s?s=e.sJUIHeader:"F"==s&&(s=e.sJUIFooter),-1!=s.indexOf(".")?(c=s.split("."),f.id=c[0].substr(1,c[0].length-1),f.className=c[1]):"#"==s.charAt(0)?f.id=s.substr(1,s.length-1):f.className=s,h+=u}r.append(f),r=j(f)}else if(">"==i)r=r.parent();else if("l"==i&&a.bPaginate&&a.bLengthChange)o=Nt(t);else if("f"==i&&a.bFilter)o=bt(t);else if("r"==i&&a.bProcessing)o=kt(t);else if("t"==i)o=Wt(t);else if("i"==i&&a.bInfo)o=At(t);else if("p"==i&&a.bPaginate)o=Ht(t);else if(0!==w.ext.feature.length)for(var p=w.ext.feature,g=0,b=p.length;g<b;g++)if(i==p[g].cFeature){o=p[g].fnInit(t);break}o&&((f=t.aanFeatures)[i]||(f[i]=[]),f[i].push(o),r.append(o))}n.replaceWith(r),t.nHolding=null}function ut(t,e){var n,a,r,o,i,l,s,u,c,f,d=j(e).children("tr");for(t.splice(0,t.length),r=0,l=d.length;r<l;r++)t.push([]);for(r=0,l=d.length;r<l;r++)for(a=(n=d[r]).firstChild;a;){if("TD"==a.nodeName.toUpperCase()||"TH"==a.nodeName.toUpperCase())for(u=(u=+a.getAttribute("colspan"))&&0!==u&&1!==u?u:1,c=(c=+a.getAttribute("rowspan"))&&0!==c&&1!==c?c:1,s=function(t,e,n){for(var a=t[e];a[n];)n++;return n}(t,r,0),f=1===u,i=0;i<u;i++)for(o=0;o<c;o++)t[r+o][s+i]={cell:a,unique:f},t[r+o].nTr=n;a=a.nextSibling}}function ct(t,e,n){var a=[];n||(n=t.aoHeader,e&&ut(n=[],e));for(var r=0,o=n.length;r<o;r++)for(var i=0,l=n[r].length;i<l;i++)!n[r][i].unique||a[i]&&t.bSortCellsTop||(a[i]=n[r][i].cell);return a}function ft(r,t,e){var a,o,n;ce(r,"aoServerParams","serverParams",[t]),t&&j.isArray(t)&&(a={},o=/(.*?)\[\]$/,j.each(t,function(t,e){var n=e.name.match(o);n?(n=n[0],a[n]||(a[n]=[]),a[n].push(e.value)):a[e.name]=e.value}),t=a);function i(t){ce(r,null,"xhr",[r,t,r.jqXHR]),e(t)}var l=r.ajax,s=r.oInstance;j.isPlainObject(l)&&l.data&&(u="function"==typeof(n=l.data)?n(t,r):n,t="function"==typeof n&&u?u:j.extend(!0,t,u),delete l.data);var u={data:t,success:function(t){var e=t.error||t.sError;e&&oe(r,0,e),r.json=t,i(t)},dataType:"json",cache:!1,type:r.sServerMethod,error:function(t,e,n){var a=ce(r,null,"xhr",[r,null,r.jqXHR]);-1===j.inArray(!0,a)&&("parsererror"==e?oe(r,0,"Invalid JSON response",1):4===t.readyState&&oe(r,0,"Ajax error",7)),Mt(r,!1)}};r.oAjaxData=t,ce(r,null,"preXhr",[r,t]),r.fnServerData?r.fnServerData.call(s,r.sAjaxSource,j.map(t,function(t,e){return{name:e,value:t}}),i,r):r.sAjaxSource||"string"==typeof l?r.jqXHR=j.ajax(j.extend(u,{url:l||r.sAjaxSource})):"function"==typeof l?r.jqXHR=l.call(s,t,i,r):(r.jqXHR=j.ajax(j.extend(u,l)),l.data=n)}function dt(e){return!e.bAjaxDataGet||(e.iDraw++,Mt(e,!0),ft(e,ht(e),function(t){pt(e,t)}),!1)}function ht(t){function n(t,e){c.push({name:t,value:e})}var e,a,r,o=t.aoColumns,i=o.length,l=t.oFeatures,s=t.oPreviousSearch,u=t.aoPreSearchCols,c=[],f=zt(t),d=t._iDisplayStart,h=!1!==l.bPaginate?t._iDisplayLength:-1;n("sEcho",t.iDraw),n("iColumns",i),n("sColumns",H(o,"sName").join(",")),n("iDisplayStart",d),n("iDisplayLength",h);for(var p={draw:t.iDraw,columns:[],order:[],start:d,length:h,search:{value:s.sSearch,regex:s.bRegex}},g=0;g<i;g++)a=o[g],r=u[g],e="function"==typeof a.mData?"function":a.mData,p.columns.push({data:e,name:a.sName,searchable:a.bSearchable,orderable:a.bSortable,search:{value:r.sSearch,regex:r.bRegex}}),n("mDataProp_"+g,e),l.bFilter&&(n("sSearch_"+g,r.sSearch),n("bRegex_"+g,r.bRegex),n("bSearchable_"+g,a.bSearchable)),l.bSort&&n("bSortable_"+g,a.bSortable);l.bFilter&&(n("sSearch",s.sSearch),n("bRegex",s.bRegex)),l.bSort&&(j.each(f,function(t,e){p.order.push({column:e.col,dir:e.dir}),n("iSortCol_"+t,e.col),n("sSortDir_"+t,e.dir)}),n("iSortingCols",f.length));f=w.ext.legacy.ajax;return null===f?t.sAjaxSource?c:p:f?c:p}function pt(t,n){var e=function(t,e){return n[t]!==N?n[t]:n[e]},a=gt(t,n),r=e("sEcho","draw"),o=e("iTotalRecords","recordsTotal"),e=e("iTotalDisplayRecords","recordsFiltered");if(r){if(+r<t.iDraw)return;t.iDraw=+r}K(t),t._iRecordsTotal=parseInt(o,10),t._iRecordsDisplay=parseInt(e,10);for(var i=0,l=a.length;i<l;i++)U(t,a[i]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,it(t),t._bInitComplete||Rt(t,n),t.bAjaxDataGet=!0,Mt(t,!1)}function gt(t,e){t=j.isPlainObject(t.ajax)&&t.ajax.dataSrc!==N?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===t?e.aaData||e[t]:""!==t?z(t)(e):e}function bt(n){var t=n.oClasses,e=n.sTableId,a=n.oLanguage,r=n.oPreviousSearch,o=n.aanFeatures,i='<input type="search" class="'+t.sFilterInput+'"/>',l=(l=a.sSearch).match(/_INPUT_/)?l.replace("_INPUT_",i):l+i,i=j("<div/>",{id:o.f?null:e+"_filter",class:t.sFilter}).append(j("<label/>").append(l)),t=function(){o.f;var t=this.value||"";t!=r.sSearch&&(St(n,{sSearch:t,bRegex:r.bRegex,bSmart:r.bSmart,bCaseInsensitive:r.bCaseInsensitive}),n._iDisplayStart=0,it(n))},l=null!==n.searchDelay?n.searchDelay:"ssp"===he(n)?400:0,s=j("input",i).val(r.sSearch).attr("placeholder",a.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",l?Xt(t,l):t).on("keypress.DT",function(t){if(13==t.keyCode)return!1}).attr("aria-controls",e);return j(n.nTable).on("search.dt.DT",function(t,e){if(n===e)try{s[0]!==m.activeElement&&s.val(r.sSearch)}catch(t){}}),i[0]}function St(t,e,n){function a(t){o.sSearch=t.sSearch,o.bRegex=t.bRegex,o.bSmart=t.bSmart,o.bCaseInsensitive=t.bCaseInsensitive}function r(t){return t.bEscapeRegex!==N?!t.bEscapeRegex:t.bRegex}var o=t.oPreviousSearch,i=t.aoPreSearchCols;if(E(t),"ssp"!=he(t)){Dt(t,e.sSearch,n,r(e),e.bSmart,e.bCaseInsensitive),a(e);for(var l=0;l<i.length;l++)vt(t,i[l].sSearch,l,r(i[l]),i[l].bSmart,i[l].bCaseInsensitive);mt(t)}else a(e);t.bFiltered=!0,ce(t,null,"search",[t])}function mt(t){for(var e,n,a=w.ext.search,r=t.aiDisplay,o=0,i=a.length;o<i;o++){for(var l=[],s=0,u=r.length;s<u;s++)n=r[s],e=t.aoData[n],a[o](t,e._aFilterData,n,e._aData,s)&&l.push(n);r.length=0,j.merge(r,l)}}function vt(t,e,n,a,r,o){if(""!==e){for(var i,l=[],s=t.aiDisplay,u=yt(e,a,r,o),c=0;c<s.length;c++)i=t.aoData[s[c]]._aFilterData[n],u.test(i)&&l.push(s[c]);t.aiDisplay=l}}function Dt(t,e,n,a,r,o){var i,l,s=yt(e,a,r,o),a=t.oPreviousSearch.sSearch,r=t.aiDisplayMaster,u=[];if(0!==w.ext.search.length&&(n=!0),o=wt(t),e.length<=0)t.aiDisplay=r.slice();else{for((o||n||a.length>e.length||0!==e.indexOf(a)||t.bSorted)&&(t.aiDisplay=r.slice()),i=t.aiDisplay,l=0;l<i.length;l++)s.test(t.aoData[i[l]]._sFilterRow)&&u.push(i[l]);t.aiDisplay=u}}function yt(t,e,n,a){return t=e?t:_t(t),n&&(t="^(?=.*?"+j.map(t.match(/"[^"]+"|[^ ]+/g)||[""],function(t){var e;return'"'===t.charAt(0)&&(t=(e=t.match(/^"(.*)"$/))?e[1]:t),t.replace('"',"")}).join(")(?=.*?")+").*$"),new RegExp(t,a?"i":"")}var _t=w.util.escapeRegex,Ct=j("<div>")[0],Tt=Ct.textContent!==N;function wt(t){for(var e,n,a,r,o,i,l=t.aoColumns,s=w.ext.type.search,u=!1,c=0,f=t.aoData.length;c<f;c++)if(!(i=t.aoData[c])._aFilterData){for(r=[],n=0,a=l.length;n<a;n++)(e=l[n]).bSearchable?(o=X(t,c,n,"filter"),s[e.sType]&&(o=s[e.sType](o)),null===o&&(o=""),"string"!=typeof o&&o.toString&&(o=o.toString())):o="",o.indexOf&&-1!==o.indexOf("&")&&(Ct.innerHTML=o,o=Tt?Ct.textContent:Ct.innerText),o.replace&&(o=o.replace(/[\r\n]/g,"")),r.push(o);i._aFilterData=r,i._sFilterRow=r.join("  "),u=!0}return u}function xt(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function It(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}}function At(t){var e=t.sTableId,n=t.aanFeatures.i,a=j("<div/>",{class:t.oClasses.sInfo,id:n?null:e+"_info"});return n||(t.aoDrawCallback.push({fn:Ft,sName:"information"}),a.attr("role","status").attr("aria-live","polite"),j(t.nTable).attr("aria-describedby",e+"_info")),a[0]}function Ft(t){var e,n,a,r,o,i,l=t.aanFeatures.i;0!==l.length&&(i=t.oLanguage,e=t._iDisplayStart+1,n=t.fnDisplayEnd(),a=t.fnRecordsTotal(),o=(r=t.fnRecordsDisplay())?i.sInfo:i.sInfoEmpty,r!==a&&(o+=" "+i.sInfoFiltered),o=Lt(t,o+=i.sInfoPostFix),null!==(i=i.fnInfoCallback)&&(o=i.call(t.oInstance,t,e,n,a,r,o)),j(l).html(o))}function Lt(t,e){var n=t.fnFormatNumber,a=t._iDisplayStart+1,r=t._iDisplayLength,o=t.fnRecordsDisplay(),i=-1===r;return e.replace(/_START_/g,n.call(t,a)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,o)).replace(/_PAGE_/g,n.call(t,i?1:Math.ceil(a/r))).replace(/_PAGES_/g,n.call(t,i?1:Math.ceil(o/r)))}function Pt(n){var a,t,e,r=n.iInitDisplayStart,o=n.aoColumns,i=n.oFeatures,l=n.bDeferLoading;if(n.bInitialised){for(st(n),rt(n),ot(n,n.aoHeader),ot(n,n.aoFooter),Mt(n,!0),i.bAutoWidth&&Vt(n),a=0,t=o.length;a<t;a++)(e=o[a]).sWidth&&(e.nTh.style.width=$t(e.sWidth));ce(n,null,"preInit",[n]),lt(n);i=he(n);"ssp"==i&&!l||("ajax"==i?ft(n,[],function(t){var e=gt(n,t);for(a=0;a<e.length;a++)U(n,e[a]);n.iInitDisplayStart=r,lt(n),Mt(n,!1),Rt(n,t)}):(Mt(n,!1),Rt(n)))}else setTimeout(function(){Pt(n)},200)}function Rt(t,e){t._bInitComplete=!0,(e||t.oInit.aaData)&&O(t),ce(t,null,"plugin-init",[t,e]),ce(t,"aoInitComplete","init",[t,e])}function jt(t,e){e=parseInt(e,10);t._iDisplayLength=e,fe(t),ce(t,null,"length",[t,e])}function Nt(a){for(var t=a.oClasses,e=a.sTableId,n=a.aLengthMenu,r=j.isArray(n[0]),o=r?n[0]:n,i=r?n[1]:n,l=j("<select/>",{name:e+"_length","aria-controls":e,class:t.sLengthSelect}),s=0,u=o.length;s<u;s++)l[0][s]=new Option("number"==typeof i[s]?a.fnFormatNumber(i[s]):i[s],o[s]);var c=j("<div><label/></div>").addClass(t.sLength);return a.aanFeatures.l||(c[0].id=e+"_length"),c.children().append(a.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),j("select",c).val(a._iDisplayLength).on("change.DT",function(t){jt(a,j(this).val()),it(a)}),j(a.nTable).on("length.dt.DT",function(t,e,n){a===e&&j("select",c).val(n)}),c[0]}function Ht(t){function c(t){it(t)}var e=t.sPaginationType,f=w.ext.pager[e],d="function"==typeof f,e=j("<div/>").addClass(t.oClasses.sPaging+e)[0],h=t.aanFeatures;return d||f.fnInit(t,e,c),h.p||(e.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(t){if(d)for(var e=t._iDisplayStart,n=t._iDisplayLength,a=t.fnRecordsDisplay(),r=-1===n,o=r?0:Math.ceil(e/n),i=r?1:Math.ceil(a/n),l=f(o,i),s=0,u=h.p.length;s<u;s++)de(t,"pageButton")(t,h.p[s],s,l,o,i);else f.fnUpdate(t,c)},sName:"pagination"})),e}function Ot(t,e,n){var a=t._iDisplayStart,r=t._iDisplayLength,o=t.fnRecordsDisplay();0===o||-1===r?a=0:"number"==typeof e?o<(a=e*r)&&(a=0):"first"==e?a=0:"previous"==e?(a=0<=r?a-r:0)<0&&(a=0):"next"==e?a+r<o&&(a+=r):"last"==e?a=Math.floor((o-1)/r)*r:oe(t,0,"Unknown paging action: "+e,5);e=t._iDisplayStart!==a;return t._iDisplayStart=a,e&&(ce(t,null,"page",[t]),n&&it(t)),e}function kt(t){return j("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing",class:t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function Mt(t,e){t.oFeatures.bProcessing&&j(t.aanFeatures.r).css("display",e?"block":"none"),ce(t,null,"processing",[t,e])}function Wt(t){var e=j(t.nTable);e.attr("role","grid");var n=t.oScroll;if(""===n.sX&&""===n.sY)return t.nTable;function a(t){return t?$t(t):null}var r=n.sX,o=n.sY,i=t.oClasses,l=e.children("caption"),s=l.length?l[0]._captionSide:null,u=j(e[0].cloneNode(!1)),c=j(e[0].cloneNode(!1)),f=e.children("tfoot"),d="<div/>";f.length||(f=null);u=j(d,{class:i.sScrollWrapper}).append(j(d,{class:i.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:r?a(r):"100%"}).append(j(d,{class:i.sScrollHeadInner}).css({"box-sizing":"content-box",width:n.sXInner||"100%"}).append(u.removeAttr("id").css("margin-left",0).append("top"===s?l:null).append(e.children("thead"))))).append(j(d,{class:i.sScrollBody}).css({position:"relative",overflow:"auto",width:a(r)}).append(e));f&&u.append(j(d,{class:i.sScrollFoot}).css({overflow:"hidden",border:0,width:r?a(r):"100%"}).append(j(d,{class:i.sScrollFootInner}).append(c.removeAttr("id").css("margin-left",0).append("bottom"===s?l:null).append(e.children("tfoot")))));var l=u.children(),h=l[0],e=l[1],p=f?l[2]:null;return r&&j(e).on("scroll.DT",function(t){var e=this.scrollLeft;h.scrollLeft=e,f&&(p.scrollLeft=e)}),j(e).css(o&&n.bCollapse?"max-height":"height",o),t.nScrollHead=h,t.nScrollBody=e,t.nScrollFoot=p,t.aoDrawCallback.push({fn:Et,sName:"scrolling"}),u[0]}function Et(n){var t,e,a,r,o,i=n.oScroll,l=i.sX,s=i.sXInner,u=i.sY,c=i.iBarWidth,f=j(n.nScrollHead),d=f[0].style,h=f.children("div"),p=h[0].style,g=h.children("table"),b=n.nScrollBody,S=j(b),m=b.style,v=j(n.nScrollFoot).children("div"),D=v.children("table"),y=j(n.nTHead),_=j(n.nTable),C=_[0],T=C.style,w=n.nTFoot?j(n.nTFoot):null,x=n.oBrowser,I=x.bScrollOversize,A=H(n.aoColumns,"nTh"),F=[],L=[],P=[],R=[],i=function(t){t=t.style;t.paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0},h=b.scrollHeight>b.clientHeight;if(n.scrollBarVis!==h&&n.scrollBarVis!==N)return n.scrollBarVis=h,void O(n);n.scrollBarVis=h,_.children("thead, tfoot").remove(),w&&(a=w.clone().prependTo(_),t=w.find("tr"),e=a.find("tr")),h=y.clone().prependTo(_),a=y.find("tr"),y=h.find("tr"),h.find("th, td").removeAttr("tabindex"),l||(m.width="100%",f[0].style.width="100%"),j.each(ct(n,h),function(t,e){r=k(n,t),e.style.width=n.aoColumns[r].sWidth}),w&&Bt(function(t){t.style.width=""},e),h=_.outerWidth(),""===l?(T.width="100%",I&&(_.find("tbody").height()>b.offsetHeight||"scroll"==S.css("overflow-y"))&&(T.width=$t(_.outerWidth()-c)),h=_.outerWidth()):""!==s&&(T.width=$t(s),h=_.outerWidth()),Bt(i,y),Bt(function(t){P.push(t.innerHTML),F.push($t(j(t).css("width")))},y),Bt(function(t,e){-1!==j.inArray(t,A)&&(t.style.width=F[e])},a),j(y).height(0),w&&(Bt(i,e),Bt(function(t){R.push(t.innerHTML),L.push($t(j(t).css("width")))},e),Bt(function(t,e){t.style.width=L[e]},t),j(e).height(0)),Bt(function(t,e){t.innerHTML='<div class="dataTables_sizing">'+P[e]+"</div>",t.childNodes[0].style.height="0",t.childNodes[0].style.overflow="hidden",t.style.width=F[e]},y),w&&Bt(function(t,e){t.innerHTML='<div class="dataTables_sizing">'+R[e]+"</div>",t.childNodes[0].style.height="0",t.childNodes[0].style.overflow="hidden",t.style.width=L[e]},e),_.outerWidth()<h?(o=b.scrollHeight>b.offsetHeight||"scroll"==S.css("overflow-y")?h+c:h,I&&(b.scrollHeight>b.offsetHeight||"scroll"==S.css("overflow-y"))&&(T.width=$t(o-c)),""!==l&&""===s||oe(n,1,"Possible column misalignment",6)):o="100%",m.width=$t(o),d.width=$t(o),w&&(n.nScrollFoot.style.width=$t(o)),u||I&&(m.height=$t(C.offsetHeight+c));C=_.outerWidth();g[0].style.width=$t(C),p.width=$t(C);g=_.height()>b.clientHeight||"scroll"==S.css("overflow-y"),x="padding"+(x.bScrollbarLeft?"Left":"Right");p[x]=g?c+"px":"0px",w&&(D[0].style.width=$t(C),v[0].style.width=$t(C),v[0].style[x]=g?c+"px":"0px"),_.children("colgroup").insertBefore(_.children("thead")),S.scroll(),!n.bSorted&&!n.bFiltered||n._drawHold||(b.scrollTop=0)}function Bt(t,e,n){for(var a,r,o=0,i=0,l=e.length;i<l;){for(a=e[i].firstChild,r=n?n[i].firstChild:null;a;)1===a.nodeType&&(n?t(a,r,o):t(a,o),o++),a=a.nextSibling,r=n?r.nextSibling:null;i++}}var Ut=/<.*?>/g;function Vt(t){var e,n,a=t.nTable,r=t.aoColumns,o=t.oScroll,i=o.sY,l=o.sX,s=o.sXInner,u=r.length,c=W(t,"bVisible"),f=j("th",t.nTHead),d=a.getAttribute("width"),h=a.parentNode,p=!1,g=t.oBrowser,b=g.bScrollOversize,S=a.style.width;for(S&&-1!==S.indexOf("%")&&(d=S),y=0;y<c.length;y++)null!==(e=r[c[y]]).sWidth&&(e.sWidth=Jt(e.sWidthOrig,h),p=!0);if(b||!p&&!l&&!i&&u==M(t)&&u==f.length)for(y=0;y<u;y++){var m=k(t,y);null!==m&&(r[m].sWidth=$t(f.eq(y).width()))}else{o=j(a).clone().css("visibility","hidden").removeAttr("id");o.find("tbody tr").remove();var v=j("<tr/>").appendTo(o.find("tbody"));for(o.find("thead, tfoot").remove(),o.append(j(t.nTHead).clone()).append(j(t.nTFoot).clone()),o.find("tfoot th, tfoot td").css("width",""),f=ct(t,o.find("thead")[0]),y=0;y<c.length;y++)e=r[c[y]],f[y].style.width=null!==e.sWidthOrig&&""!==e.sWidthOrig?$t(e.sWidthOrig):"",e.sWidthOrig&&l&&j(f[y]).append(j("<div/>").css({width:e.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(t.aoData.length)for(y=0;y<c.length;y++)e=r[n=c[y]],j(qt(t,n)).clone(!1).append(e.sContentPadding).appendTo(v);j("[name]",o).removeAttr("name");S=j("<div/>").css(l||i?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(o).appendTo(h);l&&s?o.width(s):l?(o.css("width","auto"),o.removeAttr("width"),o.width()<h.clientWidth&&d&&o.width(h.clientWidth)):i?o.width(h.clientWidth):d&&o.width(d);for(var D=0,y=0;y<c.length;y++){var _=j(f[y]),C=_.outerWidth()-_.width(),_=g.bBounding?Math.ceil(f[y].getBoundingClientRect().width):_.outerWidth();D+=_,r[c[y]].sWidth=$t(_-C)}a.style.width=$t(D),S.remove()}d&&(a.style.width=$t(d)),!d&&!l||t._reszEvt||(d=function(){j(T).on("resize.DT-"+t.sInstance,Xt(function(){O(t)}))},b?setTimeout(d,1e3):d(),t._reszEvt=!0)}var Xt=w.util.throttle;function Jt(t,e){if(!t)return 0;t=j("<div/>").css("width",$t(t)).appendTo(e||m.body),e=t[0].offsetWidth;return t.remove(),e}function qt(t,e){var n=Gt(t,e);if(n<0)return null;var a=t.aoData[n];return a.nTr?a.anCells[e]:j("<td/>").html(X(t,n,e,"display"))[0]}function Gt(t,e){for(var n,a=-1,r=-1,o=0,i=t.aoData.length;o<i;o++)(n=(n=(n=X(t,o,e,"display")+"").replace(Ut,"")).replace(/&nbsp;/g," ")).length>a&&(a=n.length,r=o);return r}function $t(t){return null===t?"0px":"number"==typeof t?t<0?"0px":t+"px":t.match(/\d$/)?t+"px":t}function zt(t){function e(t){t.length&&!j.isArray(t[0])?h.push(t):j.merge(h,t)}var n,a,r,o,i,l,s,u=[],c=t.aoColumns,f=t.aaSortingFixed,d=j.isPlainObject(f),h=[];for(j.isArray(f)&&e(f),d&&f.pre&&e(f.pre),e(t.aaSorting),d&&f.post&&e(f.post),n=0;n<h.length;n++)for(a=0,r=(o=c[s=h[n][0]].aDataSort).length;a<r;a++)l=c[i=o[a]].sType||"string",h[n]._idx===N&&(h[n]._idx=j.inArray(h[n][1],c[i].asSorting)),u.push({src:s,col:i,dir:h[n][1],index:h[n]._idx,type:l,formatter:w.ext.type.order[l+"-pre"]});return u}function Yt(t){var e,n,a,r,c,f=[],u=w.ext.type.order,d=t.aoData,o=(t.aoColumns,0),i=t.aiDisplayMaster;for(E(t),e=0,n=(c=zt(t)).length;e<n;e++)(r=c[e]).formatter&&o++,ee(t,r.col);if("ssp"!=he(t)&&0!==c.length){for(e=0,a=i.length;e<a;e++)f[i[e]]=e;o===c.length?i.sort(function(t,e){for(var n,a,r,o,i=c.length,l=d[t]._aSortData,s=d[e]._aSortData,u=0;u<i;u++)if(0!=(r=(n=l[(o=c[u]).col])<(a=s[o.col])?-1:a<n?1:0))return"asc"===o.dir?r:-r;return(n=f[t])<(a=f[e])?-1:a<n?1:0}):i.sort(function(t,e){for(var n,a,r,o=c.length,i=d[t]._aSortData,l=d[e]._aSortData,s=0;s<o;s++)if(n=i[(r=c[s]).col],a=l[r.col],0!==(r=(u[r.type+"-"+r.dir]||u["string-"+r.dir])(n,a)))return r;return(n=f[t])<(a=f[e])?-1:a<n?1:0})}t.bSorted=!0}function Zt(t){for(var e=t.aoColumns,n=zt(t),a=t.oLanguage.oAria,r=0,o=e.length;r<o;r++){var i=e[r],l=i.asSorting,s=i.sTitle.replace(/<.*?>/g,""),u=i.nTh;u.removeAttribute("aria-sort"),s=i.bSortable?s+("asc"===(0<n.length&&n[0].col==r?(u.setAttribute("aria-sort","asc"==n[0].dir?"ascending":"descending"),l[n[0].index+1]||l[0]):l[0])?a.sSortAscending:a.sSortDescending):s,u.setAttribute("aria-label",s)}}function Kt(t,e,n,a){var r,o=t.aoColumns[e],i=t.aaSorting,l=o.asSorting,o=function(t,e){var n=t._idx;return n===N&&(n=j.inArray(t[1],l)),n+1<l.length?n+1:e?null:0};"number"==typeof i[0]&&(i=t.aaSorting=[i]),n&&t.oFeatures.bSortMulti?-1!==(n=j.inArray(e,H(i,"0")))?(null===(r=o(i[n],!0))&&1===i.length&&(r=0),null===r?i.splice(n,1):(i[n][1]=l[r],i[n]._idx=r)):(i.push([e,l[0],0]),i[i.length-1]._idx=0):i.length&&i[0][0]==e?(r=o(i[0]),i.length=1,i[0][1]=l[r],i[0]._idx=r):(i.length=0,i.push([e,l[0]]),i[0]._idx=0),lt(t),"function"==typeof a&&a(t)}function Qt(e,t,n,a){var r=e.aoColumns[n];se(t,{},function(t){!1!==r.bSortable&&(e.oFeatures.bProcessing?(Mt(e,!0),setTimeout(function(){Kt(e,n,t.shiftKey,a),"ssp"!==he(e)&&Mt(e,!1)},0)):Kt(e,n,t.shiftKey,a))})}function te(t){var e,n,a,r=t.aLastSort,o=t.oClasses.sSortColumn,i=zt(t),l=t.oFeatures;if(l.bSort&&l.bSortClasses){for(e=0,n=r.length;e<n;e++)a=r[e].src,j(H(t.aoData,"anCells",a)).removeClass(o+(e<2?e+1:3));for(e=0,n=i.length;e<n;e++)a=i[e].src,j(H(t.aoData,"anCells",a)).addClass(o+(e<2?e+1:3))}t.aLastSort=i}function ee(t,e){var n,a,r,o=t.aoColumns[e],i=w.ext.order[o.sSortDataType];i&&(n=i.call(t.oInstance,t,e,C(t,e)));for(var l=w.ext.type.order[o.sType+"-pre"],s=0,u=t.aoData.length;s<u;s++)(a=t.aoData[s])._aSortData||(a._aSortData=[]),a._aSortData[e]&&!i||(r=i?n[s]:X(t,s,e,"sort"),a._aSortData[e]=l?l(r):r)}function ne(n){var t;n.oFeatures.bStateSave&&!n.bDestroying&&(t={time:+new Date,start:n._iDisplayStart,length:n._iDisplayLength,order:j.extend(!0,[],n.aaSorting),search:xt(n.oPreviousSearch),columns:j.map(n.aoColumns,function(t,e){return{visible:t.bVisible,search:xt(n.aoPreSearchCols[e])}})},ce(n,"aoStateSaveParams","stateSaveParams",[n,t]),n.oSavedState=t,n.fnStateSaveCallback.call(n.oInstance,n,t))}function ae(a,t,r){function e(t){if(t&&t.time){var e=ce(a,"aoStateLoadParams","stateLoadParams",[a,t]);if(-1===j.inArray(!1,e)){e=a.iStateDuration;if(0<e&&t.time<+new Date-1e3*e)r();else if(t.columns&&l.length!==t.columns.length)r();else{if(a.oLoadedState=j.extend(!0,{},t),t.start!==N&&(a._iDisplayStart=t.start,a.iInitDisplayStart=t.start),t.length!==N&&(a._iDisplayLength=t.length),t.order!==N&&(a.aaSorting=[],j.each(t.order,function(t,e){a.aaSorting.push(e[0]>=l.length?[0,e[1]]:e)})),t.search!==N&&j.extend(a.oPreviousSearch,It(t.search)),t.columns)for(o=0,i=t.columns.length;o<i;o++){var n=t.columns[o];n.visible!==N&&(l[o].bVisible=n.visible),n.search!==N&&j.extend(a.aoPreSearchCols[o],It(n.search))}ce(a,"aoStateLoaded","stateLoaded",[a,t]),r()}}else r()}else r()}var o,i,n,l=a.aoColumns;a.oFeatures.bStateSave?(n=a.fnStateLoadCallback.call(a.oInstance,a,e))!==N&&e(n):r()}function re(t){var e=w.settings,t=j.inArray(t,H(e,"nTable"));return-1!==t?e[t]:null}function oe(t,e,n,a){if(n="DataTables warning: "+(t?"table id="+t.sTableId+" - ":"")+n,a&&(n+=". For more information about this error, please see http://datatables.net/tn/"+a),e)T.console&&console.log&&console.log(n);else{e=w.ext,e=e.sErrMode||e.errMode;if(t&&ce(t,null,"error",[t,a,n]),"alert"==e)alert(n);else{if("throw"==e)throw new Error(n);"function"==typeof e&&e(t,a,n)}}}function ie(n,a,t,e){j.isArray(t)?j.each(t,function(t,e){j.isArray(e)?ie(n,a,e[0],e[1]):ie(n,a,e)}):(e===N&&(e=t),a[t]!==N&&(n[e]=a[t]))}function le(t,e,n){var a,r;for(r in e)e.hasOwnProperty(r)&&(a=e[r],j.isPlainObject(a)?(j.isPlainObject(t[r])||(t[r]={}),j.extend(!0,t[r],a)):n&&"data"!==r&&"aaData"!==r&&j.isArray(a)?t[r]=a.slice():t[r]=a);return t}function se(e,t,n){j(e).on("click.DT",t,function(t){j(e).blur(),n(t)}).on("keypress.DT",t,function(t){13===t.which&&(t.preventDefault(),n(t))}).on("selectstart.DT",function(){return!1})}function ue(t,e,n,a){n&&t[e].push({fn:n,sName:a})}function ce(n,t,e,a){var r=[];return t&&(r=j.map(n[t].slice().reverse(),function(t,e){return t.fn.apply(n.oInstance,a)})),null!==e&&(e=j.Event(e+".dt"),j(n.nTable).trigger(e,a),r.push(e.result)),r}function fe(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),a=t._iDisplayLength;n<=e&&(e=n-a),e-=e%a,(-1===a||e<0)&&(e=0),t._iDisplayStart=e}function de(t,e){var n=t.renderer,t=w.ext.renderer[e];return j.isPlainObject(n)&&n[e]?t[n[e]]||t._:"string"==typeof n&&t[n]||t._}function he(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}var pe=[],ge=Array.prototype,be=function(t,e){if(!(this instanceof be))return new be(t,e);function n(t){var e,n,a,r=(t=t,n=w.settings,a=j.map(n,function(t,e){return t.nTable}),t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?-1!==(e=j.inArray(t,a))?[n[e]]:null:t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?r=j(t):t instanceof j&&(r=t),r?r.map(function(t){return-1!==(e=j.inArray(this,a))?n[e]:null}).toArray():void 0):[]);r&&(o=o.concat(r))}var o=[];if(j.isArray(t))for(var a=0,r=t.length;a<r;a++)n(t[a]);else n(t);this.context=b(o),e&&j.merge(this,e),this.selector={rows:null,cols:null,opts:null},be.extend(this,this,pe)};w.Api=be,j.extend(be.prototype,{any:function(){return 0!==this.count()},concat:ge.concat,context:[],count:function(){return this.flatten().length},each:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new be(e[t],this[t]):null},filter:function(t){var e=[];if(ge.filter)e=ge.filter.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new be(this.context,e)},flatten:function(){var t=[];return new be(this.context,t.concat.apply(t,this.toArray()))},join:ge.join,indexOf:ge.indexOf||function(t,e){for(var n=e||0,a=this.length;n<a;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,n,a){var r,o,i,l,s,u,c,f,d=[],h=this.context,p=this.selector;for("string"==typeof t&&(a=n,n=e,e=t,t=!1),o=0,i=h.length;o<i;o++){var g=new be(h[o]);if("table"===e)(r=n.call(g,h[o],o))!==N&&d.push(r);else if("columns"===e||"rows"===e)(r=n.call(g,h[o],this[o],o))!==N&&d.push(r);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(c=this[o],"column-rows"===e&&(u=ye(h[o],p.opts)),l=0,s=c.length;l<s;l++)f=c[l],(r="cell"===e?n.call(g,h[o],f.row,f.column,o,l):n.call(g,h[o],f,o,l,u))!==N&&d.push(r)}if(d.length||a){a=new be(h,t?d.concat.apply([],d):d),t=a.selector;return t.rows=p.rows,t.cols=p.cols,t.opts=p.opts,a}return this},lastIndexOf:ge.lastIndexOf||function(t,e){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(ge.map)e=ge.map.call(this,t,this);else for(var n=0,a=this.length;n<a;n++)e.push(t.call(this,this[n],n));return new be(this.context,e)},pluck:function(e){return this.map(function(t){return t[e]})},pop:ge.pop,push:ge.push,reduce:ge.reduce||function(t,e){return _(this,t,e,0,this.length,1)},reduceRight:ge.reduceRight||function(t,e){return _(this,t,e,this.length-1,-1,-1)},reverse:ge.reverse,selector:null,shift:ge.shift,slice:function(){return new be(this.context,this)},sort:ge.sort,splice:ge.splice,toArray:function(){return ge.slice.call(this)},to$:function(){return j(this)},toJQuery:function(){return j(this)},unique:function(){return new be(this.context,b(this))},unshift:ge.unshift}),be.extend=function(t,e,n){if(n.length&&e&&(e instanceof be||e.__dt_wrapper))for(var a,r=0,o=n.length;r<o;r++)e[(a=n[r]).name]="function"==typeof a.val?function(e,n,a){return function(){var t=n.apply(e,arguments);return be.extend(t,t,a.methodExt),t}}(t,a.val,a):j.isPlainObject(a.val)?{}:a.val,e[a.name].__dt_wrapper=!0,be.extend(t,e[a.name],a.propExt)},be.register=e=function(t,e){if(j.isArray(t))for(var n=0,a=t.length;n<a;n++)be.register(t[n],e);else for(var r,o,i=t.split("."),l=pe,s=0,u=i.length;s<u;s++){var c=function(t,e){for(var n=0,a=t.length;n<a;n++)if(t[n].name===e)return t[n];return null}(l,r=(o=-1!==i[s].indexOf("()"))?i[s].replace("()",""):i[s]);c||(c={name:r,val:{},methodExt:[],propExt:[]},l.push(c)),s===u-1?c.val=e:l=o?c.methodExt:c.propExt}},be.registerPlural=t=function(t,e,n){be.register(t,n),be.register(e,function(){var t=n.apply(this,arguments);return t===this?this:t instanceof be?t.length?j.isArray(t[0])?new be(t.context,t[0]):t[0]:N:t})};e("tables()",function(t){return t?new be(function(t,n){if("number"==typeof t)return[n[t]];var a=j.map(n,function(t,e){return t.nTable});return j(a).filter(t).map(function(t){var e=j.inArray(this,a);return n[e]}).toArray()}(t,this.context)):this}),e("table()",function(t){var e=this.tables(t),t=e.context;return t.length?new be(t[0]):e}),t("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable},1)}),t("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody},1)}),t("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead},1)}),t("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot},1)}),t("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper},1)}),e("draw()",function(e){return this.iterator("table",function(t){"page"===e?it(t):("string"==typeof e&&(e="full-hold"!==e),lt(t,!1===e))})}),e("page()",function(e){return e===N?this.page.info().page:this.iterator("table",function(t){Ot(t,e)})}),e("page.info()",function(t){if(0===this.context.length)return N;var e=this.context[0],n=e._iDisplayStart,a=e.oFeatures.bPaginate?e._iDisplayLength:-1,r=e.fnRecordsDisplay(),o=-1===a;return{page:o?0:Math.floor(n/a),pages:o?1:Math.ceil(r/a),start:n,end:e.fnDisplayEnd(),length:a,recordsTotal:e.fnRecordsTotal(),recordsDisplay:r,serverSide:"ssp"===he(e)}}),e("page.len()",function(e){return e===N?0!==this.context.length?this.context[0]._iDisplayLength:N:this.iterator("table",function(t){jt(t,e)})});function Se(r,o,t){var e,n;t&&(e=new be(r)).one("draw",function(){t(e.ajax.json())}),"ssp"==he(r)?lt(r,o):(Mt(r,!0),(n=r.jqXHR)&&4!==n.readyState&&n.abort(),ft(r,[],function(t){K(r);for(var e=gt(r,t),n=0,a=e.length;n<a;n++)U(r,e[n]);lt(r,o),Mt(r,!1)}))}e("ajax.json()",function(){var t=this.context;if(0<t.length)return t[0].json}),e("ajax.params()",function(){var t=this.context;if(0<t.length)return t[0].oAjaxData}),e("ajax.reload()",function(e,n){return this.iterator("table",function(t){Se(t,!1===n,e)})}),e("ajax.url()",function(e){var t=this.context;return e===N?0===t.length?N:(t=t[0]).ajax?j.isPlainObject(t.ajax)?t.ajax.url:t.ajax:t.sAjaxSource:this.iterator("table",function(t){j.isPlainObject(t.ajax)?t.ajax.url=e:t.ajax=e})}),e("ajax.url().load()",function(e,n){return this.iterator("table",function(t){Se(t,!1===n,e)})});function me(t,e,n,a,r){var o,i,l,s,u,c,f=[],d=typeof e;for(e&&"string"!=d&&"function"!=d&&e.length!==N||(e=[e]),l=0,s=e.length;l<s;l++)for(u=0,c=(i=e[l]&&e[l].split&&!e[l].match(/[\[\(:]/)?e[l].split(","):[e[l]]).length;u<c;u++)(o=n("string"==typeof i[u]?j.trim(i[u]):i[u]))&&o.length&&(f=f.concat(o));var h=p.selector[t];if(h.length)for(l=0,s=h.length;l<s;l++)f=h[l](a,r,f);return b(f)}function ve(t){return(t=t||{}).filter&&t.search===N&&(t.search=t.filter),j.extend({search:"none",order:"current",page:"all"},t)}function De(t){for(var e=0,n=t.length;e<n;e++)if(0<t[e].length)return t[0]=t[e],t[0].length=1,t.length=1,t.context=[t.context[e]],t;return t.length=0,t}var ye=function(t,e){var n,a=[],r=t.aiDisplay,o=t.aiDisplayMaster,i=e.search,l=e.order,e=e.page;if("ssp"==he(t))return"removed"===i?[]:d(0,o.length);if("current"==e)for(u=t._iDisplayStart,c=t.fnDisplayEnd();u<c;u++)a.push(r[u]);else if("current"==l||"applied"==l){if("none"==i)a=o.slice();else if("applied"==i)a=r.slice();else if("removed"==i){for(var s={},u=0,c=r.length;u<c;u++)s[r[u]]=null;a=j.map(o,function(t){return s.hasOwnProperty(t)?null:t})}}else if("index"==l||"original"==l)for(u=0,c=t.aoData.length;u<c;u++)("none"==i||-1===(n=j.inArray(u,r))&&"removed"==i||0<=n&&"applied"==i)&&a.push(u);return a};e("rows()",function(e,n){e===N?e="":j.isPlainObject(e)&&(n=e,e=""),n=ve(n);var t=this.iterator("table",function(t){return me("row",e,function(n){var t=f(n),a=o.aoData;if(null!==t&&!i)return[t];if(l=l||ye(o,i),null!==t&&-1!==j.inArray(t,l))return[t];if(null===n||n===N||""===n)return l;if("function"==typeof n)return j.map(l,function(t){var e=a[t];return n(t,e._aData,e.nTr)?t:null});if(n.nodeName){var e=n._DT_RowIndex,t=n._DT_CellIndex;if(e!==N)return a[e]&&a[e].nTr===n?[e]:[];if(t)return a[t.row]&&a[t.row].nTr===n?[t.row]:[];t=j(n).closest("*[data-dt-row]");return t.length?[t.data("dt-row")]:[]}if("string"==typeof n&&"#"===n.charAt(0)){var r=o.aIds[n.replace(/^#/,"")];if(r!==N)return[r.idx]}r=v(S(o.aoData,l,"nTr"));return j(r).filter(n).map(function(){return this._DT_RowIndex}).toArray()},o=t,i=n);var o,i,l},1);return t.selector.rows=e,t.selector.opts=n,t}),e("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||N},1)}),e("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return S(t.aoData,e,"_aData")},1)}),t("rows().cache()","row().cache()",function(n){return this.iterator("row",function(t,e){e=t.aoData[e];return"search"===n?e._aFilterData:e._aSortData},1)}),t("rows().invalidate()","row().invalidate()",function(n){return this.iterator("row",function(t,e){tt(t,e,n)})}),t("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e},1)}),t("rows().ids()","row().id()",function(t){for(var e=[],n=this.context,a=0,r=n.length;a<r;a++)for(var o=0,i=this[a].length;o<i;o++){var l=n[a].rowIdFn(n[a].aoData[this[a][o]]._aData);e.push((!0===t?"#":"")+l)}return new be(n,e)}),t("rows().remove()","row().remove()",function(){var f=this;return this.iterator("row",function(t,e,n){var a,r,o,i,l,s,u=t.aoData,c=u[e];for(u.splice(e,1),a=0,r=u.length;a<r;a++)if(s=(l=u[a]).anCells,null!==l.nTr&&(l.nTr._DT_RowIndex=a),null!==s)for(o=0,i=s.length;o<i;o++)s[o]._DT_CellIndex.row=a;Q(t.aiDisplayMaster,e),Q(t.aiDisplay,e),Q(f[n],e,!1),0<t._iRecordsDisplay&&t._iRecordsDisplay--,fe(t);c=t.rowIdFn(c._aData);c!==N&&delete t.aIds[c]}),this.iterator("table",function(t){for(var e=0,n=t.aoData.length;e<n;e++)t.aoData[e].idx=e}),this}),e("rows.add()",function(o){var t=this.iterator("table",function(t){for(var e,n=[],a=0,r=o.length;a<r;a++)(e=o[a]).nodeName&&"TR"===e.nodeName.toUpperCase()?n.push(V(t,e)[0]):n.push(U(t,e));return n},1),e=this.rows(-1);return e.pop(),j.merge(e,t),e}),e("row()",function(t,e){return De(this.rows(t,e))}),e("row().data()",function(t){var e=this.context;if(t===N)return e.length&&this.length?e[0].aoData[this[0]]._aData:N;var n=e[0].aoData[this[0]];return n._aData=t,j.isArray(t)&&n.nTr.id&&Y(e[0].rowId)(t,n.nTr.id),tt(e[0],this[0],"data"),this}),e("row().node()",function(){var t=this.context;return t.length&&this.length&&t[0].aoData[this[0]].nTr||null}),e("row.add()",function(e){e instanceof j&&e.length&&(e=e[0]);var t=this.iterator("table",function(t){return e.nodeName&&"TR"===e.nodeName.toUpperCase()?V(t,e)[0]:U(t,e)});return this.row(t[0])});function _e(t,e){var n=t.context;!n.length||(t=n[0].aoData[e!==N?e:t[0]])&&t._details&&(t._details.remove(),t._detailsShow=N,t._details=N)}function Ce(t,e){var n=t.context;n.length&&t.length&&((t=n[0].aoData[t[0]])._details&&((t._detailsShow=e)?t._details.insertAfter(t.nTr):t._details.detach(),Te(n[0])))}var Te=function(s){var r=new be(s),t=".dt.DT_details",e="draw"+t,n="column-visibility"+t,t="destroy"+t,u=s.aoData;r.off(e+" "+n+" "+t),0<H(u,"_details").length&&(r.on(e,function(t,e){s===e&&r.rows({page:"current"}).eq(0).each(function(t){t=u[t];t._detailsShow&&t._details.insertAfter(t.nTr)})}),r.on(n,function(t,e,n,a){if(s===e)for(var r,o=M(e),i=0,l=u.length;i<l;i++)(r=u[i])._details&&r._details.children("td[colspan]").attr("colspan",o)}),r.on(t,function(t,e){if(s===e)for(var n=0,a=u.length;n<a;n++)u[n]._details&&_e(r,n)}))},we="row().child",xe=we+"()";e(xe,function(t,e){var o,i,l,n=this.context;return t===N?n.length&&this.length?n[0].aoData[this[0]]._details:N:(!0===t?this.child.show():!1===t?_e(this):n.length&&this.length&&(o=n[0],n=n[0].aoData[this[0]],i=[],(l=function(t,e){var n;if(j.isArray(t)||t instanceof j)for(var a=0,r=t.length;a<r;a++)l(t[a],e);else t.nodeName&&"tr"===t.nodeName.toLowerCase()?i.push(t):(n=j("<tr><td/></tr>").addClass(e),j("td",n).addClass(e).html(t)[0].colSpan=M(o),i.push(n[0]))})(t,e),n._details&&n._details.detach(),n._details=j(i),n._detailsShow&&n._details.insertAfter(n.nTr)),this)}),e([we+".show()",xe+".show()"],function(t){return Ce(this,!0),this}),e([we+".hide()",xe+".hide()"],function(){return Ce(this,!1),this}),e([we+".remove()",xe+".remove()"],function(){return _e(this),this}),e(we+".isShown()",function(){var t=this.context;return t.length&&this.length&&t[0].aoData[this[0]]._detailsShow||!1});function Ie(t,e,n,a,r){for(var o=[],i=0,l=r.length;i<l;i++)o.push(X(t,r[i],e));return o}var Ae=/^([^:]+):(name|visIdx|visible)$/;e("columns()",function(n,a){n===N?n="":j.isPlainObject(n)&&(a=n,n=""),a=ve(a);var t=this.iterator("table",function(t){return e=n,l=a,s=(i=t).aoColumns,u=H(s,"sName"),c=H(s,"nTh"),me("column",e,function(n){var t=f(n);if(""===n)return d(s.length);if(null!==t)return[0<=t?t:s.length+t];if("function"==typeof n){var a=ye(i,l);return j.map(s,function(t,e){return n(e,Ie(i,e,0,0,a),c[e])?e:null})}var r="string"==typeof n?n.match(Ae):"";if(r)switch(r[2]){case"visIdx":case"visible":var e=parseInt(r[1],10);if(e<0){var o=j.map(s,function(t,e){return t.bVisible?e:null});return[o[o.length+e]]}return[k(i,e)];case"name":return j.map(u,function(t,e){return t===r[1]?e:null});default:return[]}if(n.nodeName&&n._DT_CellIndex)return[n._DT_CellIndex.column];t=j(c).filter(n).map(function(){return j.inArray(this,c)}).toArray();if(t.length||!n.nodeName)return t;t=j(n).closest("*[data-dt-column]");return t.length?[t.data("dt-column")]:[]},i,l);var i,e,l,s,u,c},1);return t.selector.cols=n,t.selector.opts=a,t}),t("columns().header()","column().header()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh},1)}),t("columns().footer()","column().footer()",function(t,e){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf},1)}),t("columns().data()","column().data()",function(){return this.iterator("column-rows",Ie,1)}),t("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].mData},1)}),t("columns().cache()","column().cache()",function(o){return this.iterator("column-rows",function(t,e,n,a,r){return S(t.aoData,r,"search"===o?"_aFilterData":"_aSortData",e)},1)}),t("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,a,r){return S(t.aoData,r,"anCells",e)},1)}),t("columns().visible()","column().visible()",function(n,a){var t=this.iterator("column",function(t,e){return n===N?t.aoColumns[e].bVisible:void function(t,e,n){var a,r,o=t.aoColumns,i=o[e],l=t.aoData;if(n===N)return i.bVisible;if(i.bVisible!==n){if(n)for(var s=j.inArray(!0,H(o,"bVisible"),e+1),u=0,c=l.length;u<c;u++)r=l[u].nTr,a=l[u].anCells,r&&r.insertBefore(a[e],a[s]||null);else j(H(t.aoData,"anCells",e)).detach();i.bVisible=n,ot(t,t.aoHeader),ot(t,t.aoFooter),t.aiDisplay.length||j(t.nTBody).find("td[colspan]").attr("colspan",M(t)),ne(t)}}(t,e,n)});return n!==N&&(this.iterator("column",function(t,e){ce(t,null,"column-visibility",[t,e,n,a])}),a!==N&&!a||this.columns.adjust()),t}),t("columns().indexes()","column().index()",function(n){return this.iterator("column",function(t,e){return"visible"===n?C(t,e):e},1)}),e("columns.adjust()",function(){return this.iterator("table",function(t){O(t)},1)}),e("column.index()",function(t,e){if(0!==this.context.length){var n=this.context[0];return"fromVisible"===t||"toData"===t?k(n,e):"fromData"===t||"toVisible"===t?C(n,e):void 0}}),e("column()",function(t,e){return De(this.columns(t,e))});e("cells()",function(g,t,b){if(j.isPlainObject(g)&&(g.row===N?(b=g,g=null):(b=t,t=null)),j.isPlainObject(t)&&(b=t,t=null),null===t||t===N)return this.iterator("table",function(t){return a=t,e=g,n=ve(b),f=a.aoData,d=ye(a,n),t=v(S(f,d,"anCells")),h=j([].concat.apply([],t)),p=a.aoColumns.length,me("cell",e,function(t){var e="function"==typeof t;if(null===t||t===N||e){for(o=[],i=0,l=d.length;i<l;i++)for(r=d[i],s=0;s<p;s++)u={row:r,column:s},e?(c=f[r],t(u,X(a,r,s),c.anCells?c.anCells[s]:null)&&o.push(u)):o.push(u);return o}if(j.isPlainObject(t))return t.column!==N&&t.row!==N&&-1!==j.inArray(t.row,d)?[t]:[];var n=h.filter(t).map(function(t,e){return{row:e._DT_CellIndex.row,column:e._DT_CellIndex.column}}).toArray();return n.length||!t.nodeName?n:(c=j(t).closest("*[data-dt-row]")).length?[{row:c.data("dt-row"),column:c.data("dt-column")}]:[]},a,n);var a,e,n,r,o,i,l,s,u,c,f,d,h,p});var n,a,r,o,i,l=this.columns(t),s=this.rows(g);this.iterator("table",function(t,e){for(n=[],a=0,r=s[e].length;a<r;a++)for(o=0,i=l[e].length;o<i;o++)n.push({row:s[e][a],column:l[e][o]})},1);var e=this.cells(n,b);return j.extend(e.selector,{cols:t,rows:g,opts:b}),e}),t("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){e=t.aoData[e];return e&&e.anCells?e.anCells[n]:N},1)}),e("cells().data()",function(){return this.iterator("cell",function(t,e,n){return X(t,e,n)},1)}),t("cells().cache()","cell().cache()",function(a){return a="search"===a?"_aFilterData":"_aSortData",this.iterator("cell",function(t,e,n){return t.aoData[e][a][n]},1)}),t("cells().render()","cell().render()",function(a){return this.iterator("cell",function(t,e,n){return X(t,e,n,a)},1)}),t("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:C(t,n)}},1)}),t("cells().invalidate()","cell().invalidate()",function(a){return this.iterator("cell",function(t,e,n){tt(t,e,a,n)})}),e("cell()",function(t,e,n){return De(this.cells(t,e,n))}),e("cell().data()",function(t){var e=this.context,n=this[0];return t===N?e.length&&n.length?X(e[0],n[0].row,n[0].column):N:(J(e[0],n[0].row,n[0].column,t),tt(e[0],n[0].row,"data",n[0].column),this)}),e("order()",function(e,t){var n=this.context;return e===N?0!==n.length?n[0].aaSorting:N:("number"==typeof e?e=[[e,t]]:e.length&&!j.isArray(e[0])&&(e=Array.prototype.slice.call(arguments)),this.iterator("table",function(t){t.aaSorting=e.slice()}))}),e("order.listener()",function(e,n,a){return this.iterator("table",function(t){Qt(t,e,n,a)})}),e("order.fixed()",function(e){if(e)return this.iterator("table",function(t){t.aaSortingFixed=j.extend(!0,{},e)});var t=this.context,t=t.length?t[0].aaSortingFixed:N;return j.isArray(t)?{pre:t}:t}),e(["columns().order()","column().order()"],function(a){var r=this;return this.iterator("table",function(t,e){var n=[];j.each(r[e],function(t,e){n.push([e,a])}),t.aaSorting=n})}),e("search()",function(e,n,a,r){var t=this.context;return e===N?0!==t.length?t[0].oPreviousSearch.sSearch:N:this.iterator("table",function(t){t.oFeatures.bFilter&&St(t,j.extend({},t.oPreviousSearch,{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===a||a,bCaseInsensitive:null===r||r}),1)})}),t("columns().search()","column().search()",function(a,r,o,i){return this.iterator("column",function(t,e){var n=t.aoPreSearchCols;if(a===N)return n[e].sSearch;t.oFeatures.bFilter&&(j.extend(n[e],{sSearch:a+"",bRegex:null!==r&&r,bSmart:null===o||o,bCaseInsensitive:null===i||i}),St(t,t.oPreviousSearch,1))})}),e("state()",function(){return this.context.length?this.context[0].oSavedState:null}),e("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),e("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),e("state.save()",function(){return this.iterator("table",function(t){ne(t)})}),w.versionCheck=w.fnVersionCheck=function(t){for(var e,n,a=w.version.split("."),r=t.split("."),o=0,i=r.length;o<i;o++)if((e=parseInt(a[o],10)||0)!==(n=parseInt(r[o],10)||0))return n<e;return!0},w.isDataTable=w.fnIsDataTable=function(t){var r=j(t).get(0),o=!1;return t instanceof w.Api||(j.each(w.settings,function(t,e){var n=e.nScrollHead?j("table",e.nScrollHead)[0]:null,a=e.nScrollFoot?j("table",e.nScrollFoot)[0]:null;e.nTable!==r&&n!==r&&a!==r||(o=!0)}),o)},w.tables=w.fnTables=function(e){var t=!1;j.isPlainObject(e)&&(t=e.api,e=e.visible);var n=j.map(w.settings,function(t){if(!e||e&&j(t.nTable).is(":visible"))return t.nTable});return t?new be(n):n},w.camelToHungarian=x,e("$()",function(t,e){e=this.rows(e).nodes(),e=j(e);return j([].concat(e.filter(t).toArray(),e.find(t).toArray()))}),j.each(["on","one","off"],function(t,n){e(n+"()",function(){var t=Array.prototype.slice.call(arguments);t[0]=j.map(t[0].split(/\s/),function(t){return t.match(/\.dt\b/)?t:t+".dt"}).join(" ");var e=j(this.tables().nodes());return e[n].apply(e,t),this})}),e("clear()",function(){return this.iterator("table",function(t){K(t)})}),e("settings()",function(){return new be(this.context,this.context)}),e("init()",function(){var t=this.context;return t.length?t[0].oInit:null}),e("data()",function(){return this.iterator("table",function(t){return H(t.aoData,"_aData")}).flatten()}),e("destroy()",function(f){return f=f||!1,this.iterator("table",function(e){var n,t=e.nTableWrapper.parentNode,a=e.oClasses,r=e.nTable,o=e.nTBody,i=e.nTHead,l=e.nTFoot,s=j(r),u=j(o),c=j(e.nTableWrapper),o=j.map(e.aoData,function(t){return t.nTr});e.bDestroying=!0,ce(e,"aoDestroyCallback","destroy",[e]),f||new be(e).columns().visible(!0),c.off(".DT").find(":not(tbody *)").off(".DT"),j(T).off(".DT-"+e.sInstance),r!=i.parentNode&&(s.children("thead").detach(),s.append(i)),l&&r!=l.parentNode&&(s.children("tfoot").detach(),s.append(l)),e.aaSorting=[],e.aaSortingFixed=[],te(e),j(o).removeClass(e.asStripeClasses.join(" ")),j("th, td",i).removeClass(a.sSortable+" "+a.sSortableAsc+" "+a.sSortableDesc+" "+a.sSortableNone),u.children().detach(),u.append(o);o=f?"remove":"detach";s[o](),c[o](),!f&&t&&(t.insertBefore(r,e.nTableReinsertBefore),s.css("width",e.sDestroyWidth).removeClass(a.sTable),(n=e.asDestroyStripes.length)&&u.children().each(function(t){j(this).addClass(e.asDestroyStripes[t%n])}));u=j.inArray(e,w.settings);-1!==u&&w.settings.splice(u,1)})}),j.each(["column","row","cell"],function(t,s){e(s+"s().every()",function(o){var i=this.selector.opts,l=this;return this.iterator(s,function(t,e,n,a,r){o.call(l[s](e,"cell"===s?n:i,"cell"===s?i:N),e,n,a,r)})})}),e("i18n()",function(t,e,n){var a=this.context[0],a=z(t)(a.oLanguage);return a===N&&(a=e),n!==N&&j.isPlainObject(a)&&(a=a[n]!==N?a[n]:a._),a.replace("%d",n)}),w.version="1.10.18",w.settings=[],w.models={},w.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},w.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},w.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},w.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(-1===t.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(t){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:j.extend({},w.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},D(w.defaults),w.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},D(w.defaults.column),w.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:N,oAjaxData:N,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==he(this)?+this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==he(this)?+this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,a=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?!1===o||-1===t?e+a:Math.min(e+t,this._iRecordsDisplay):!o||a<n||-1===t?a:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},w.ext=p={buttons:{},classes:{},builder:"-source-",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:w.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:w.version},j.extend(p,{afnFiltering:p.search,aTypes:p.type.detect,ofnSearch:p.type.search,oSort:p.type.order,afnSortData:p.order,aoFeatures:p.feature,oApi:p.internal,oStdClasses:p.classes,oPagination:p.pager}),j.extend(w.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var Fe=w.ext.pager;function Le(t,e){var n=[],a=Fe.numbers_length,r=Math.floor(a/2);return e<=a?n=d(0,e):t<=r?((n=d(0,a-2)).push("ellipsis"),n.push(e-1)):(e-1-r<=t?(n=d(e-(a-2),e)).splice(0,0,"ellipsis"):((n=d(t-r+2,t+r-1)).push("ellipsis"),n.push(e-1),n.splice(0,0,"ellipsis")),n.splice(0,0,0)),n.DT_el="span",n}j.extend(Fe,{simple:function(t,e){return["previous","next"]},full:function(t,e){return["first","previous","next","last"]},numbers:function(t,e){return[Le(t,e)]},simple_numbers:function(t,e){return["previous",Le(t,e),"next"]},full_numbers:function(t,e){return["first","previous",Le(t,e),"next","last"]},first_last_numbers:function(t,e){return["first",Le(t,e),"last"]},_numbers:Le,numbers_length:7}),j.extend(!0,w.ext.renderer,{pageButton:{_:function(l,t,s,e,u,c){var f,d,n,h=l.oClasses,p=l.oLanguage.oPaginate,g=l.oLanguage.oAria.paginate||{},b=0,S=function(t,e){for(var n,a=function(t){Ot(l,t.data.action,!0)},r=0,o=e.length;r<o;r++)if(n=e[r],j.isArray(n)){var i=j("<"+(n.DT_el||"div")+"/>").appendTo(t);S(i,n)}else{switch(f=null,d="",n){case"ellipsis":t.append('<span class="ellipsis">&#x2026;</span>');break;case"first":f=p.sFirst,d=n+(0<u?"":" "+h.sPageButtonDisabled);break;case"previous":f=p.sPrevious,d=n+(0<u?"":" "+h.sPageButtonDisabled);break;case"next":f=p.sNext,d=n+(u<c-1?"":" "+h.sPageButtonDisabled);break;case"last":f=p.sLast,d=n+(u<c-1?"":" "+h.sPageButtonDisabled);break;default:f=n+1,d=u===n?h.sPageButtonActive:""}null!==f&&(se(j("<a>",{class:h.sPageButton+" "+d,"aria-controls":l.sTableId,"aria-label":g[n],"data-dt-idx":b,tabindex:l.iTabIndex,id:0===s&&"string"==typeof n?l.sTableId+"_"+n:null}).html(f).appendTo(t),{action:n},a),b++)}};try{n=j(t).find(m.activeElement).data("dt-idx")}catch(t){}S(j(t).empty(),e),n!==N&&j(t).find("[data-dt-idx="+n+"]").focus()}}}),j.extend(w.ext.type.detect,[function(t,e){e=e.oLanguage.sDecimal;return i(t,e)?"num"+e:null},function(t,e){if(t&&!(t instanceof Date)&&!u.test(t))return null;var n=Date.parse(t);return null!==n&&!isNaN(n)||r(t)?"date":null},function(t,e){e=e.oLanguage.sDecimal;return i(t,e,!0)?"num-fmt"+e:null},function(t,e){e=e.oLanguage.sDecimal;return n(t,e)?"html-num"+e:null},function(t,e){e=e.oLanguage.sDecimal;return n(t,e,!0)?"html-num-fmt"+e:null},function(t,e){return r(t)||"string"==typeof t&&-1!==t.indexOf("<")?"html":null}]),j.extend(w.ext.type.search,{html:function(t){return r(t)?t:"string"==typeof t?t.replace(l," ").replace(s,""):""},string:function(t){return!r(t)&&"string"==typeof t?t.replace(l," "):t}});var Pe=function(t,e,n,a){return 0===t||t&&"-"!==t?(e&&(t=o(t,e)),t.replace&&(n&&(t=t.replace(n,"")),a&&(t=t.replace(a,""))),+t):-1/0};function Re(n){j.each({num:function(t){return Pe(t,n)},"num-fmt":function(t){return Pe(t,n,h)},"html-num":function(t){return Pe(t,n,s)},"html-num-fmt":function(t){return Pe(t,n,s,h)}},function(t,e){p.type.order[t+n+"-pre"]=e,t.match(/^html\-/)&&(p.type.search[t+n]=p.type.search.html)})}j.extend(p.type.order,{"date-pre":function(t){t=Date.parse(t);return isNaN(t)?-1/0:t},"html-pre":function(t){return r(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return r(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return t<e?-1:e<t?1:0},"string-desc":function(t,e){return t<e?1:e<t?-1:0}}),Re(""),j.extend(!0,w.ext.renderer,{header:{_:function(r,o,i,l){j(r.nTable).on("order.dt.DT",function(t,e,n,a){r===e&&(e=i.idx,o.removeClass(i.sSortingClass+" "+l.sSortAsc+" "+l.sSortDesc).addClass("asc"==a[e]?l.sSortAsc:"desc"==a[e]?l.sSortDesc:i.sSortingClass))})},jqueryui:function(r,o,i,l){j("<div/>").addClass(l.sSortJUIWrapper).append(o.contents()).append(j("<span/>").addClass(l.sSortIcon+" "+i.sSortingClassJUI)).appendTo(o),j(r.nTable).on("order.dt.DT",function(t,e,n,a){r===e&&(e=i.idx,o.removeClass(l.sSortAsc+" "+l.sSortDesc).addClass("asc"==a[e]?l.sSortAsc:"desc"==a[e]?l.sSortDesc:i.sSortingClass),o.find("span."+l.sSortIcon).removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed).addClass("asc"==a[e]?l.sSortJUIAsc:"desc"==a[e]?l.sSortJUIDesc:i.sSortingClassJUI))})}}});function je(t){return"string"==typeof t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t}function Ne(e){return function(){var t=[re(this[w.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return w.ext.internal[e].apply(this,t)}}return w.render={number:function(a,r,o,i,l){return{display:function(t){if("number"!=typeof t&&"string"!=typeof t)return t;var e=t<0?"-":"",n=parseFloat(t);if(isNaN(n))return je(t);n=n.toFixed(o),t=Math.abs(n);n=parseInt(t,10),t=o?r+(t-n).toFixed(o).substring(2):"";return e+(i||"")+n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,a)+t+(l||"")}}},text:function(){return{display:je}}},j.extend(w.ext.internal,{_fnExternApiFunc:Ne,_fnBuildAjax:ft,_fnAjaxUpdate:dt,_fnAjaxParameters:ht,_fnAjaxUpdateDraw:pt,_fnAjaxDataSrc:gt,_fnAddColumn:P,_fnColumnOptions:R,_fnAdjustColumnSizing:O,_fnVisibleToColumnIndex:k,_fnColumnIndexToVisible:C,_fnVisbleColumns:M,_fnGetColumns:W,_fnColumnTypes:E,_fnApplyColumnDefs:B,_fnHungarianMap:D,_fnCamelToHungarian:x,_fnLanguageCompat:I,_fnBrowserDetect:L,_fnAddData:U,_fnAddTr:V,_fnNodeToDataIndex:function(t,e){return e._DT_RowIndex!==N?e._DT_RowIndex:null},_fnNodeToColumnIndex:function(t,e,n){return j.inArray(n,t.aoData[e].anCells)},_fnGetCellData:X,_fnSetCellData:J,_fnSplitObjNotation:$,_fnGetObjectDataFn:z,_fnSetObjectDataFn:Y,_fnGetDataMaster:Z,_fnClearTable:K,_fnDeleteIndex:Q,_fnInvalidate:tt,_fnGetRowElements:et,_fnCreateTr:nt,_fnBuildHead:rt,_fnDrawHead:ot,_fnDraw:it,_fnReDraw:lt,_fnAddOptionsHtml:st,_fnDetectHeader:ut,_fnGetUniqueThs:ct,_fnFeatureHtmlFilter:bt,_fnFilterComplete:St,_fnFilterCustom:mt,_fnFilterColumn:vt,_fnFilter:Dt,_fnFilterCreateSearch:yt,_fnEscapeRegex:_t,_fnFilterData:wt,_fnFeatureHtmlInfo:At,_fnUpdateInfo:Ft,_fnInfoMacros:Lt,_fnInitialise:Pt,_fnInitComplete:Rt,_fnLengthChange:jt,_fnFeatureHtmlLength:Nt,_fnFeatureHtmlPaginate:Ht,_fnPageChange:Ot,_fnFeatureHtmlProcessing:kt,_fnProcessingDisplay:Mt,_fnFeatureHtmlTable:Wt,_fnScrollDraw:Et,_fnApplyToChildren:Bt,_fnCalculateColumnWidths:Vt,_fnThrottle:Xt,_fnConvertToWidth:Jt,_fnGetWidestNode:qt,_fnGetMaxLenString:Gt,_fnStringToCss:$t,_fnSortFlatten:zt,_fnSort:Yt,_fnSortAria:Zt,_fnSortListener:Kt,_fnSortAttachListener:Qt,_fnSortingClasses:te,_fnSortData:ee,_fnSaveState:ne,_fnLoadState:ae,_fnSettingsFromNode:re,_fnLog:oe,_fnMap:ie,_fnBindAction:se,_fnCallbackReg:ue,_fnCallbackFire:ce,_fnLengthOverflow:fe,_fnRenderer:de,_fnDataSource:he,_fnRowAttributes:at,_fnExtend:le,_fnCalculateEnd:function(){}}),((j.fn.dataTable=w).$=j).fn.dataTableSettings=w.settings,j.fn.dataTableExt=w.ext,j.fn.DataTable=function(t){return j(this).dataTable(t).api()},j.each(w,function(t,e){j.fn.DataTable[t]=e}),j.fn.dataTable});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.geoDataExchange=t.geoDataExchange||{})}(this,function(t){"use strict";var e={};t.internal=e;var r={segments:200,minSegmentDistance:200,interpolateElevation:!1};function g(t,e){for(var n=[],a=[],r=0;r<t.length;r++){var i=t[r];if(a.push(i),void 0!==i.alt)break}var o=0;for(r+=1;r<t.length;r++){i=t[r];a.push(i),e<=(o+=a[a.length-1].distanceTo(a[a.length-2]))&&void 0!==i.alt&&(n.push(a),a=[a[a.length-1]],o=0)}if(0<a.length)if(0===n.length)n.push(a);else for(var l=n[n.length-1],f=1;f<a.length;f++)l.push(a[f]);return n}function u(t){for(var e=0,n=1;n<t.length;n++)e+=t[n].distanceTo(t[n-1]);return e}function c(t){if(t.length<2)return o(0);for(var e=-1,n=0;n<t.length;n++)if(void 0!==t[n].alt){e=n;break}if(-1==e)return o(0);for(var a=-1,n=t.length-1;e<n;n--)if(void 0!==t[n].alt){a=n;break}if(-1==a)return o(0);var r=t[a].alt-t[e].alt,i=u(t.slice(e,a+1));return o(0==i?0:100*r/i)}function s(t,e){if(!0!==e||0===t.length)return t;var n=t.slice();!function(t){if(0!=t.length&&void 0===t[0].alt){for(var e=0,n=0;e<t.length;e++)if(void 0!==t[e].alt){n=t[e].alt;break}for(var a=0;a<e;a++){var r=t[a];t[a]=L.latLng(r.lat,r.lng,n)}}}(n),function(t){if(0!=t.length&&void 0===t[t.length-1].alt){for(var e=t.length-1,n=0;0<=e;e--)if(void 0!==t[e].alt){n=t[e].alt;break}for(var a=e+1;a<t.length;a++){var r=t[a];t[a]=L.latLng(r.lat,r.lng,n)}}}(n);for(var a=-1,r=0;r<n.length;r++)if(void 0===n[r].alt){if(-1!=a){for(var i=r+1;i<n.length&&void 0===n[i].alt;i++);i!=n.length&&(function(t,e,n){for(var a=e-1,r=n+1,i=u(t.slice(a,r+1)),a=t[r].alt-t[a].alt,o=0==i?0:100*a/i,l=e;l<=n;l++){var f=t[l].distanceTo(t[l-1]),g=o*f/100+t[l-1].alt,f=t[l];t[l]=L.latLng(f.lat,f.lng,Number(g.toFixed(1)))}}(n,a+1,i-1),r=i-1)}}else a=r;return n}function o(t){return t<=-16?-5:-16<t&&t<=-10?-4:-10<t&&t<=-7?-3:-7<t&&t<=-4?-2:-4<t&&t<=-1?-1:-1<t&&t<1?0:1<=t&&t<4?1:4<=t&&t<7?2:7<=t&&t<10?3:10<=t&&t<16?4:16<=t?5:(console.log("Unknown gradientPercentage: ",t,"; cannot map"),0)}t.defaultOptions=r,t.buildGeojsonFeatures=function(t,e){var n=(a=void 0===e?r:e).segmentsCount||r.segments;n<10&&(n=10),(e=a.minSegmentDistance||r.minSegmentDistance)<50&&(e=50);var i,o,l=(void 0===a.interpolateElevation?r:a).interpolateElevation,a=u(t),e=g(t,Math.max(a/n,e)),f=[];return e.forEach(function(t){var e,n,a,r=c(t);r==o?(a=i,s(t.slice(1),l).forEach(function(t){t=[t.lng,t.lat,t.alt];a.geometry.coordinates.push(t)})):(e=r,t=s(t,t=l),n=[],t.forEach(function(t){n.push([t.lng,t.lat,t.alt])}),i={type:"Feature",geometry:{type:"LineString",coordinates:n},properties:{attributeType:e}},f.push(i)),o=r}),[{type:"FeatureCollection",features:f,properties:{Creator:"github.com/alexcojocaru/geo-data-exchange",records:f.length,summary:"gradient"}}]},e._partitionByMinDistance=g,e._calculateDistance=u,e._calculateGradient=c,e._interpolateElevation=s,e._mapGradient=o});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).i18next=t()}(this,function(){"use strict";function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n;t=o,e=i[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e})}return o}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function e(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?a(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}var i={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}};function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r(this,s),this.init(e,t)}var c=new(e(s,[{key:"init",value:function(e,t){t=1<arguments.length&&void 0!==t?t:{};this.prefix=t.prefix||"i18next:",this.logger=e||i,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,o){return o&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(e){return new s(this.logger,N({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),s),p=(e(g,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach(function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)}),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter(function(e){return e!==t}):delete this.observers[e])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.observers[t]&&[].concat(this.observers[t]).forEach(function(e){e.apply(void 0,n)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(function(e){e.apply(e,[t].concat(n))})}}]),g);function g(){r(this,g),this.observers={}}function f(){var n,o,e=new Promise(function(e,t){n=e,o=t});return e.resolve=n,e.reject=o,e}function h(e){return null==e?"":""+e}function d(e,t,n){function o(e){return e&&-1<e.indexOf("###")?e.replace(/###/g,"."):e}function i(){return!e||"string"==typeof e}for(var s="string"!=typeof t?[].concat(t):t.split(".");1<s.length;){if(i())return{};var r=o(s.shift());!e[r]&&n&&(e[r]=new n),e=e[r]}return i()?{}:{obj:e,k:o(s.shift())}}function v(e,t,n){t=d(e,t,Object);t.obj[t.k]=n}function y(e,t){e=d(e,t),t=e.obj,e=e.k;if(t)return t[e]}function m(e,t,n){e=y(e,n);return void 0!==e?e:y(t,n)}function b(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function x(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return k[e]}):e}var w="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&-1<window.navigator.userAgent.indexOf("MSIE"),S=(t(L,p),e(L,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){e=this.options.ns.indexOf(e);-1<e&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(e,t,n,o){o=3<arguments.length&&void 0!==o?o:{},o=(void 0!==o.keySeparator?o:this.options).keySeparator,t=[e,t];return n&&"string"!=typeof n&&(t=t.concat(n)),n&&"string"==typeof n&&(t=t.concat(o?n.split(o):n)),-1<e.indexOf(".")&&(t=e.split(".")),y(this.data,t)}},{key:"addResource",value:function(e,t,n,o,i){var s=4<arguments.length&&void 0!==i?i:{silent:!1},r=this.options.keySeparator;void 0===r&&(r=".");i=[e,t];n&&(i=i.concat(r?n.split(r):n)),-1<e.indexOf(".")&&(o=t,t=(i=e.split("."))[1]),this.addNamespaces(t),v(this.data,i,o),s.silent||this.emit("added",e,t,n,o)}},{key:"addResources",value:function(e,t,n,o){var i,o=3<arguments.length&&void 0!==o?o:{silent:!1};for(i in n)"string"!=typeof n[i]&&"[object Array]"!==Object.prototype.toString.apply(n[i])||this.addResource(e,t,i,n[i],{silent:!0});o.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,o,i,s){var r=5<arguments.length&&void 0!==s?s:{silent:!1},a=[e,t];-1<e.indexOf(".")&&(o=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t);s=y(this.data,a)||{};o?function e(t,n,o){for(var i in n)"__proto__"!==i&&"constructor"!==i&&(i in t?"string"==typeof t[i]||t[i]instanceof String||"string"==typeof n[i]||n[i]instanceof String?o&&(t[i]=n[i]):e(t[i],n[i],o):t[i]=n[i]);return t}(s,n,i):s=N({},s,n),v(this.data,a,s),r.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t=t||this.options.defaultNS,"v1"===this.options.compatibilityAPI?N({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),L);function L(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return r(this,L),t=u(this,l(L).call(this)),w&&p.call(a(t)),t.data=e||{},t.options=n,void 0===t.options.keySeparator&&(t.options.keySeparator="."),t}var O={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,o,i){var s=this;return e.forEach(function(e){s.processors[e]&&(t=s.processors[e].process(t,n,o,i))}),t}},R={},j=(t(E,p),e(E,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e,t){t=1<arguments.length&&void 0!==t?t:{interpolation:{}},t=this.resolve(e,t);return t&&void 0!==t.res}},{key:"extractFromKey",value:function(e,t){var n=(void 0!==t.nsSeparator?t:this.options).nsSeparator;void 0===n&&(n=":");var o=(void 0!==t.keySeparator?t:this.options).keySeparator,i=t.ns||this.options.defaultNS;if(n&&-1<e.indexOf(n)){t=e.match(this.interpolator.nestingRegexp);if(t&&0<t.length)return{key:e,namespaces:i};t=e.split(n);(n!==o||n===o&&-1<this.options.ns.indexOf(t[0]))&&(i=t.shift()),e=t.join(o)}return"string"==typeof i&&(i=[i]),{key:e,namespaces:i}}},{key:"translate",value:function(e,n,t){var o=this;if("object"!==C(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n=n||{},null==e)return"";Array.isArray(e)||(e=[String(e)]);var i=(void 0!==n.keySeparator?n:this.options).keySeparator,s=this.extractFromKey(e[e.length-1],n),r=s.key,a=s.namespaces,u=a[a.length-1],l=n.lng||this.language,c=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(c){var p=n.nsSeparator||this.options.nsSeparator;return u+p+r}return r}var g=this.resolve(e,n),f=g&&g.res,h=g&&g.usedKey||r,d=g&&g.exactUsedKey||r,v=Object.prototype.toString.apply(f),s=(void 0!==n.joinArrays?n:this.options).joinArrays,c=!this.i18nFormat||this.i18nFormat.handleAsObject;if(c&&f&&("string"!=typeof f&&"boolean"!=typeof f&&"number"!=typeof f)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(v)<0&&("string"!=typeof s||"[object Array]"!==v)){if(!n.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,f,n):"key '".concat(r," (").concat(this.language,")' returned an object instead of string.");if(i){var y,m,p="[object Array]"===v,b=p?[]:{},k=p?d:h;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&(m="".concat(k).concat(i).concat(y),b[y]=this.translate(m,N({},n,{joinArrays:!1,ns:a})),b[y]===m&&(b[y]=f[y]));f=b}}else if(c&&"string"==typeof s&&"[object Array]"===v)f=(f=f.join(s))&&this.extendTranslation(f,e,n,t);else{c=!1,v=!1;this.isValidLookup(f)||void 0===n.defaultValue||(c=!0,void 0!==n.count&&(s=this.pluralResolver.getSuffix(l,n.count),f=n["defaultValue".concat(s)]),f=f||n.defaultValue),this.isValidLookup(f)||(v=!0,f=r);var x=n.defaultValue&&n.defaultValue!==f&&this.options.updateMissing;if(v||c||x){this.logger.log(x?"updateKey":"missingKey",l,u,r,x?n.defaultValue:f),!i||(O=this.resolve(r,N({},n,{keySeparator:!1})))&&O.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.");var w=[],S=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&S&&S[0])for(var L=0;L<S.length;L++)w.push(S[L]);else"all"===this.options.saveMissingTo?w=this.languageUtils.toResolveHierarchy(n.lng||this.language):w.push(n.lng||this.language);var O,R=function(e,t){o.options.missingKeyHandler?o.options.missingKeyHandler(e,u,t,x?n.defaultValue:f,x,n):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,u,t,x?n.defaultValue:f,x,n),o.emit("missingKey",e,u,t,f)};this.options.saveMissing&&(O=void 0!==n.count&&"string"!=typeof n.count,this.options.saveMissingPlurals&&O?w.forEach(function(t){o.pluralResolver.getPluralFormsOfKey(t,r).forEach(function(e){return R([t],e)})}):R(w,r))}f=this.extendTranslation(f,e,n,g,t),v&&f===r&&this.options.appendNamespaceToMissingKey&&(f="".concat(u,":").concat(r)),v&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(f))}return f}},{key:"extendTranslation",value:function(e,o,i,t,s){var n,r,a,u=this;this.i18nFormat&&this.i18nFormat.parse?e=this.i18nFormat.parse(e,i,t.usedLng,t.usedNS,t.usedKey,{resolved:t}):i.skipInterpolation||(i.interpolation&&this.interpolator.init(N({},i,{interpolation:N({},this.options.interpolation,i.interpolation)})),(n=i.interpolation&&i.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables)&&(r=(a=e.match(this.interpolator.nestingRegexp))&&a.length),a=i.replace&&"string"!=typeof i.replace?i.replace:i,this.options.interpolation.defaultVariables&&(a=N({},this.options.interpolation.defaultVariables,a)),e=this.interpolator.interpolate(e,a,i.lng||this.language,i),!n||r<((l=e.match(this.interpolator.nestingRegexp))&&l.length)&&(i.nest=!1),!1!==i.nest&&(e=this.interpolator.nest(e,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s&&s[0]===t[0]&&!i.context?(u.logger.warn("It seems you are nesting recursively key: ".concat(t[0]," in key: ").concat(o[0])),null):u.translate.apply(u,t.concat([o]))},i)),i.interpolation&&this.interpolator.reset());var l=i.postProcess||this.options.postProcess,l="string"==typeof l?[l]:l;return null!=e&&l&&l.length&&!1!==i.applyPostProcessor&&(e=O.handle(l,e,o,this.options&&this.options.postProcessPassResolved?N({i18nResolved:t},i):i,this)),e}},{key:"resolve",value:function(e,t){var l,n,c,p,o,g=this,f=1<arguments.length&&void 0!==t?t:{};return"string"==typeof e&&(e=[e]),e.forEach(function(e){var r,a,u,t;g.isValidLookup(l)||(e=g.extractFromKey(e,f),r=e.key,n=r,e=e.namespaces,g.options.fallbackNS&&(e=e.concat(g.options.fallbackNS)),a=void 0!==f.count&&"string"!=typeof f.count,u=void 0!==f.context&&"string"==typeof f.context&&""!==f.context,t=f.lngs||g.languageUtils.toResolveHierarchy(f.lng||g.language,f.fallbackLng),e.forEach(function(s){g.isValidLookup(l)||(o=s,!R["".concat(t[0],"-").concat(s)]&&g.utils&&g.utils.hasLoadedNamespace&&!g.utils.hasLoadedNamespace(o)&&(R["".concat(t[0],"-").concat(s)]=!0,g.logger.warn('key "'.concat(n,'" for languages "').concat(t.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),t.forEach(function(e){if(!g.isValidLookup(l)){p=e;var t,n,o=r,i=[o];for(g.i18nFormat&&g.i18nFormat.addLookupKeys?g.i18nFormat.addLookupKeys(i,r,e,s,f):(a&&(t=g.pluralResolver.getSuffix(e,f.count)),a&&u&&i.push(o+t),u&&i.push(o+="".concat(g.options.contextSeparator).concat(f.context)),a&&i.push(o+=t));n=i.pop();)g.isValidLookup(l)||(c=n,l=g.getResource(e,s,n,f))}}))}))}),{res:l,usedKey:n,exactUsedKey:c,usedLng:p,usedNS:o}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n,o){o=3<arguments.length&&void 0!==o?o:{};return(this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat:this.resourceStore).getResource(e,t,n,o)}}]),E);function E(e){var t,n,o,i,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r(this,E),t=u(this,l(E).call(this)),w&&p.call(a(t)),n=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],o=e,i=a(t),n.forEach(function(e){o[e]&&(i[e]=o[e])}),t.options=s,void 0===t.options.keySeparator&&(t.options.keySeparator="."),t.logger=c.create("translator"),t}function P(e){return e.charAt(0).toUpperCase()+e.slice(1)}var F=(e(V,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;e=e.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;e=e.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&-1<e.indexOf("-")){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map(function(e){return e.toLowerCase()}):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),-1<t.indexOf(n[1].toLowerCase())&&(n[1]=P(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),-1<t.indexOf(n[1].toLowerCase())&&(n[1]=P(n[1].toLowerCase())),-1<t.indexOf(n[2].toLowerCase())&&(n[2]=P(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return"languageOnly"!==this.options.load&&!this.options.nonExplicitSupportedLngs||(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||-1<this.supportedLngs.indexOf(e)}},{key:"getBestMatchFromCodes",value:function(e){var n,o=this;return e?(e.forEach(function(e){n||(e=o.formatLanguageCode(e),o.options.supportedLngs&&!o.isSupportedCode(e)||(n=e))}),!n&&this.options.supportedLngs&&e.forEach(function(e){if(!n){var t=o.getLanguagePartFromCode(e);if(o.isSupportedCode(t))return n=t;n=o.options.supportedLngs.find(function(e){if(0===e.indexOf(t))return e})}}),n=n||this.getFallbackCodes(this.options.fallbackLng)[0]):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return(n=(n=(n=(n=n||e[this.getScriptPartFromCode(t)])||e[this.formatLanguageCode(t)])||e[this.getLanguagePartFromCode(t)])||e.default)||[]}},{key:"toResolveHierarchy",value:function(e,t){function n(e){e&&(o.isSupportedCode(e)?i.push(e):o.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))}var o=this,t=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[];return"string"==typeof e&&-1<e.indexOf("-")?("languageOnly"!==this.options.load&&n(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&n(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&n(this.getLanguagePartFromCode(e))):"string"==typeof e&&n(this.formatLanguageCode(e)),t.forEach(function(e){i.indexOf(e)<0&&n(o.formatLanguageCode(e))}),i}}]),V);function V(e){r(this,V),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=c.create("languageUtils")}var T=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],A={1:function(e){return Number(1<e)},2:function(e){return Number(1!=e)},3:function(){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:3<=e%100&&e%100<=10?3:11<=e%100?4:5)},6:function(e){return Number(1==e?0:2<=e&&e<=4?1:2)},7:function(e){return Number(1==e?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(2<=e)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:2<e&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:2<=e%10&&(e%100<10||20<=e%100)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||1<e%100&&e%100<11?1:10<e%100&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||0<e%100&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||10<e)&&e%10==0?2:3)}};var U=(e(D,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){e=this.getRule(e);return e&&1<e.numbers.length}},{key:"getPluralFormsOfKey",value:function(t,n){var o=this,i=[],e=this.getRule(t);return e&&e.numbers.forEach(function(e){e=o.getSuffix(t,e);i.push("".concat(n).concat(e))}),i}},{key:"getSuffix",value:function(e,t){var n=this,o=this.getRule(e);if(o){var i=o.noAbs?o.plurals(t):o.plurals(Math.abs(t)),s=o.numbers[i];this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]&&(2===s?s="plural":1===s&&(s=""));t=function(){return n.options.prepend&&s.toString()?n.options.prepend+s.toString():s.toString()};return"v1"===this.options.compatibilityJSON?1===s?"":"number"==typeof s?"_plural_".concat(s.toString()):t():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]?t():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}return this.logger.warn("no plural rule found for: ".concat(e)),""}}]),D);function D(e){var n,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r(this,D),this.languageUtils=e,this.options=t,this.logger=c.create("pluralResolver"),this.rules=(n={},T.forEach(function(t){t.lngs.forEach(function(e){n[e]={numbers:t.nr,plurals:A[t.fc]}})}),n)}var M=(e(H,[{key:"init",value:function(e){e=0<arguments.length&&void 0!==e?e:{};e.interpolation||(e.interpolation={escapeValue:!0});e=e.interpolation;this.escape=void 0!==e.escape?e.escape:x,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?b(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?b(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator||e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=!this.unescapePrefix&&e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?b(e.nestingPrefix):e.nestingPrefixEscaped||b("$t("),this.nestingSuffix=e.nestingSuffix?b(e.nestingSuffix):e.nestingSuffixEscaped||b(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator||e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces||1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");e="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(e,"g")}},{key:"interpolate",value:function(n,o,i,s){var r,a,u,l=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function t(e){return e.replace(/\$/g,"$$$$")}this.resetRegExp();var p=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,g=s&&s.interpolation&&s.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t},{regex:this.regexp,safeValue:function(e){return l.escapeValue?t(l.escape(e)):t(e)}}].forEach(function(e){for(u=0;r=e.regex.exec(n);){if(void 0===(a=function(e){if(e.indexOf(l.formatSeparator)<0){var t=m(o,c,e);return l.alwaysFormat?l.format(t,void 0,i):t}t=e.split(l.formatSeparator),e=t.shift().trim(),t=t.join(l.formatSeparator).trim();return l.format(m(o,c,e),t,i,s)}(r[1].trim())))if("function"==typeof p){var t=p(n,r,s);a="string"==typeof t?t:""}else{if(g){a=r[0];continue}l.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(n)),a=""}else"string"==typeof a||l.useRawValueToEscape||(a=h(a));if(n=n.replace(r[0],e.safeValue(a)),e.regex.lastIndex=0,++u>=l.maxReplaces)break}}),n}},{key:"nest",value:function(e,t,n){var o,i=this,s=2<arguments.length&&void 0!==n?n:{},r=N({},s);function a(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var o=t.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(o[1]);t=o[0],i=(i=this.interpolate(i,r)).replace(/'/g,'"');try{r=JSON.parse(i),e&&(r=N({},e,r))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(i)}return delete r.defaultValue,t}for(r.applyPostProcessor=!1,delete r.defaultValue;o=this.nestingRegexp.exec(e);){var u,l=[],c=!1;if(o[0].includes(this.formatSeparator)&&!/{.*}/.test(o[1])&&(u=o[1].split(this.formatSeparator).map(function(e){return e.trim()}),o[1]=u.shift(),l=u,c=!0),(u=t(a.call(this,o[1].trim(),r),r))&&o[0]===e&&"string"!=typeof u)return u;"string"!=typeof u&&(u=h(u)),u||(this.logger.warn("missed to resolve ".concat(o[1]," for nesting ").concat(e)),u=""),c&&(u=l.reduce(function(e,t){return i.format(e,t,s.lng,s)},u.trim())),e=e.replace(o[0],u),this.regexp.lastIndex=0}return e}}]),H);function H(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,H),this.logger=c.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(e){return e},this.init(e)}var I=(t(K,p),e(K,[{key:"queueLoad",value:function(e,t,i,n){var s=this,r=[],a=[],u=[],l=[];return e.forEach(function(n){var o=!0;t.forEach(function(e){var t="".concat(n,"|").concat(e);!i.reload&&s.store.hasResourceBundle(n,e)?s.state[t]=2:s.state[t]<0||(1===s.state[t]?a.indexOf(t)<0&&a.push(t):(s.state[t]=1,o=!1,a.indexOf(t)<0&&a.push(t),r.indexOf(t)<0&&r.push(t),l.indexOf(e)<0&&l.push(e)))}),o||u.push(n)}),(r.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:n}),{toLoad:r,pending:a,toLoadLanguages:u,toLoadNamespaces:l}}},{key:"loaded",value:function(s,r,e){var t=s.split("|"),a=t[0],u=t[1];r&&this.emit("failedLoading",a,u,r),e&&this.store.addResourceBundle(a,u,e),this.state[s]=r?-1:2;var l={};this.queue.forEach(function(e){var t,n,o,i;t=e.loaded,o=u,n=(t=d(t,n=[a],Object)).obj,t=t.k,n[t]=n[t]||[],i&&(n[t]=n[t].concat(o)),i||n[t].push(o),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(e.pending,s),r&&e.errors.push(r),0!==e.pending.length||e.done||(Object.keys(e.loaded).forEach(function(t){l[t]||(l[t]=[]),e.loaded[t].length&&e.loaded[t].forEach(function(e){l[t].indexOf(e)<0&&l[t].push(e)})}),e.done=!0,e.errors.length?e.callback(e.errors):e.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(function(e){return!e.done})}},{key:"read",value:function(n,o,i,e,t,s){var r=this,a=3<arguments.length&&void 0!==e?e:0,u=4<arguments.length&&void 0!==t?t:350,l=5<arguments.length?s:void 0;return n.length?this.backend[i](n,o,function(e,t){e&&t&&a<5?setTimeout(function(){r.read.call(r,n,o,i,a+1,2*u,l)},u):l(e,t)}):l(null,{})}},{key:"prepareLoading",value:function(e,t,n,o){var i=this,n=2<arguments.length&&void 0!==n?n:{},o=3<arguments.length?o:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);n=this.queueLoad(e,t,n,o);if(!n.toLoad.length)return n.pending.length||o(),null;n.toLoad.forEach(function(e){i.loadOne(e)})}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(n,e){var o=this,i=1<arguments.length&&void 0!==e?e:"",e=n.split("|"),s=e[0],r=e[1];this.read(s,r,"read",void 0,void 0,function(e,t){e&&o.logger.warn("".concat(i,"loading namespace ").concat(r," for language ").concat(s," failed"),e),!e&&t&&o.logger.log("".concat(i,"loaded namespace ").concat(r," for language ").concat(s),t),o.loaded(n,e,t)})}},{key:"saveMissing",value:function(e,t,n,o,i,s){s=5<arguments.length&&void 0!==s?s:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,o,null,N({},s,{isUpdate:i})),e&&e[0]&&this.store.addResource(e[0],t,n,o))}}]),K);function K(e,t,n){var o,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};return r(this,K),o=u(this,l(K).call(this)),w&&p.call(a(o)),o.backend=e,o.store=t,o.services=n,o.languageUtils=n.languageUtils,o.options=i,o.logger=c.create("backendConnector"),o.state={},o.queue=[],o.backend&&o.backend.init&&o.backend.init(n,i.backend,i),o}function B(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function _(){}function W(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;if(r(this,W),e=u(this,l(W).call(this)),w&&p.call(a(e)),e.options=B(t),e.services={},e.logger=c,e.modules={external:[]},n&&!e.isInitialized&&!t.isClone){if(!e.options.initImmediate)return e.init(t,n),u(e,a(e));setTimeout(function(){e.init(t,n)},0)}return e}return new(t(W,p),e(W,[{key:"init",value:function(e,t){var i=this,e=0<arguments.length&&void 0!==e?e:{},n=1<arguments.length?t:void 0;function o(e){return e?"function"==typeof e?new e:e:null}"function"==typeof e&&(n=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=N({},{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t,n={};return"object"===C(e[1])&&(n=e[1]),"string"==typeof e[1]&&(n.defaultValue=e[1]),"string"==typeof e[2]&&(n.tDescription=e[2]),"object"!==C(e[2])&&"object"!==C(e[3])||(t=e[3]||e[2],Object.keys(t).forEach(function(e){n[e]=t[e]})),n},interpolation:{escapeValue:!0,format:function(e){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}},this.options,B(e)),this.format=this.options.interpolation.format,n=n||_,this.options.isClone||(this.modules.logger?c.init(o(this.modules.logger),this.options):c.init(null,this.options),e=new F(this.options),this.store=new S(this.options.resources,this.options),(r=this.services).logger=c,r.resourceStore=this.store,r.languageUtils=e,r.pluralResolver=new U(e,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),r.interpolator=new M(this.options),r.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},r.backendConnector=new I(o(this.modules.backend),r.resourceStore,r,this.options),r.backendConnector.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),this.modules.languageDetector&&(r.languageDetector=o(this.modules.languageDetector),r.languageDetector.init(r,this.options.detection,this.options)),this.modules.i18nFormat&&(r.i18nFormat=o(this.modules.i18nFormat),r.i18nFormat.init&&r.i18nFormat.init(this)),this.translator=new j(this.services,this.options),this.translator.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),this.modules.external.forEach(function(e){e.init&&e.init(i)})),this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(function(t){i[t]=function(){var e;return(e=i.store)[t].apply(e,arguments)}});["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(function(t){i[t]=function(){var e;return(e=i.store)[t].apply(e,arguments),i}});var s=f(),r=function(){i.changeLanguage(i.options.lng,function(e,t){i.isInitialized=!0,i.options.isClone||i.logger.log("initialized",i.options),i.emit("initialized",i.options),s.resolve(t),n(e,t)})};return this.options.resources||!this.options.initImmediate?r():setTimeout(r,0),s}},{key:"loadResources",value:function(e,t){var n=this,o=1<arguments.length&&void 0!==t?t:_,t="string"==typeof e?e:this.language;if("function"==typeof e&&(o=e),!this.options.resources||this.options.partialBundledLanguages){if(t&&"cimode"===t.toLowerCase())return o();var i=[],e=function(e){e&&n.services.languageUtils.toResolveHierarchy(e).forEach(function(e){i.indexOf(e)<0&&i.push(e)})};t?e(t):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e),this.options.preload&&this.options.preload.forEach(e),this.services.backendConnector.load(i,this.options.ns,o)}else o(null)}},{key:"reloadResources",value:function(e,t,n){var o=f();return e=e||this.languages,t=t||this.options.ns,n=n||_,this.services.backendConnector.reload(e,t,function(e){o.resolve(),n(e)}),o}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&O.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,o){var i=this;this.isLanguageChangingTo=e;var s=f();this.emit("languageChanging",e);function t(e){var n="string"==typeof e?e:i.services.languageUtils.getBestMatchFromCodes(e);n&&(i.language||(i.language=n,i.languages=i.services.languageUtils.toResolveHierarchy(n)),i.translator.language||i.translator.changeLanguage(n),i.services.languageDetector&&i.services.languageDetector.cacheUserLanguage(n)),i.loadResources(n,function(e){var t;t=e,(e=n)?(i.language=e,i.languages=i.services.languageUtils.toResolveHierarchy(e),i.translator.changeLanguage(e),i.isLanguageChangingTo=void 0,i.emit("languageChanged",e),i.logger.log("languageChanged",e)):i.isLanguageChangingTo=void 0,s.resolve(function(){return i.t.apply(i,arguments)}),o&&o(t,function(){return i.t.apply(i,arguments)})})}return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(t):t(e):t(this.services.languageDetector.detect()),s}},{key:"getFixedT",value:function(e,t){function r(e,t){var n;if("object"!==C(t)){for(var o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];n=a.options.overloadTranslationOptionHandler([e,t].concat(i))}else n=N({},t);return n.lng=n.lng||r.lng,n.lngs=n.lngs||r.lngs,n.ns=n.ns||r.ns,a.t(e,n)}var a=this;return"string"==typeof e?r.lng=e:r.lngs=e,r.ns=t,r}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e,t){var n=this,o=1<arguments.length&&void 0!==t?t:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var i=this.languages[0],s=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;t=function(e,t){t=n.services.backendConnector.state["".concat(e,"|").concat(t)];return-1===t||2===t};if(o.precheck){o=o.precheck(this,t);if(void 0!==o)return o}return!!this.hasResourceBundle(i,e)||(!this.services.backendConnector.backend||!(!t(i,e)||s&&!t(r,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,o=f();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach(function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)}),this.loadResources(function(e){o.resolve(),t&&t(e)}),o):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=f();"string"==typeof e&&(e=[e]);var o=this.options.preload||[],e=e.filter(function(e){return o.indexOf(e)<0});return e.length?(this.options.preload=o.concat(e),this.loadResources(function(e){n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(!(e=e||(this.languages&&0<this.languages.length?this.languages[0]:this.language)))return"rtl";return 0<=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))?"rtl":"ltr"}},{key:"createInstance",value:function(e,t){return new W(0<arguments.length&&void 0!==e?e:{},1<arguments.length?t:void 0)}},{key:"cloneInstance",value:function(e,t){var n=this,e=0<arguments.length&&void 0!==e?e:{},t=1<arguments.length&&void 0!==t?t:_,e=N({},this.options,e,{isClone:!0}),i=new W(e);return["store","services","language"].forEach(function(e){i[e]=n[e]}),i.services=N({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new j(i.services,i.options),i.translator.on("*",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))}),i.init(e,t),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}}]),W)});
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e=e||self).i18nextBrowserLanguageDetector=o()}(this,function(){"use strict";function i(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var e=[],a=e.forEach,r=e.slice;function t(){if(null!==o)return o;try{o="undefined"!==window&&null!==window.localStorage;var e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){o=!1}return o}function n(){if(null!==p)return p;try{p="undefined"!==window&&null!==window.sessionStorage;var e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){p=!1}return p}var s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,u=function(e,o,t,n,i){i=4<arguments.length&&void 0!==i?i:{path:"/",sameSite:"strict"};t&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*t*1e3)),n&&(i.domain=n),document.cookie=function(e,o,t){t=t||{};t.path=t.path||"/";var n=e+"="+encodeURIComponent(o);if(0<t.maxAge){o=+t.maxAge;if(isNaN(o))throw new Error("maxAge should be a Number");n+="; Max-Age="+Math.floor(o)}if(t.domain){if(!s.test(t.domain))throw new TypeError("option domain is invalid");n+="; Domain="+t.domain}if(t.path){if(!s.test(t.path))throw new TypeError("option path is invalid");n+="; Path="+t.path}if(t.expires){if("function"!=typeof t.expires.toUTCString)throw new TypeError("option expires is invalid");n+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(n+="; HttpOnly"),t.secure&&(n+="; Secure"),t.sameSite)switch("string"==typeof t.sameSite?t.sameSite.toLowerCase():t.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n}(e,encodeURIComponent(o),i)},c=function(e){for(var o=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(o))return i.substring(o.length,i.length)}return null},l={name:"cookie",lookup:function(e){var o;return!e.lookupCookie||"undefined"==typeof document||(e=c(e.lookupCookie))&&(o=e),o},cacheUserLanguage:function(e,o){o.lookupCookie&&"undefined"!=typeof document&&u(o.lookupCookie,e,o.cookieMinutes,o.cookieDomain,o.cookieOptions)}},d={name:"querystring",lookup:function(e){var o;if("undefined"!=typeof window)for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var i=t[n].indexOf("=");0<i&&t[n].substring(0,i)===e.lookupQuerystring&&(o=t[n].substring(i+1))}return o}},o=null,g={name:"localStorage",lookup:function(e){var o;return e.lookupLocalStorage&&t()&&((e=window.localStorage.getItem(e.lookupLocalStorage))&&(o=e)),o},cacheUserLanguage:function(e,o){o.lookupLocalStorage&&t()&&window.localStorage.setItem(o.lookupLocalStorage,e)}},p=null,f={name:"sessionStorage",lookup:function(e){var o;return e.lookupSessionStorage&&n()&&((e=window.sessionStorage.getItem(e.lookupSessionStorage))&&(o=e)),o},cacheUserLanguage:function(e,o){o.lookupSessionStorage&&n()&&window.sessionStorage.setItem(o.lookupSessionStorage,e)}},h={name:"navigator",lookup:function(){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var o=0;o<navigator.languages.length;o++)e.push(navigator.languages[o]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return 0<e.length?e:void 0}},m={name:"htmlTag",lookup:function(e){var o,e=e.htmlTag||("undefined"!=typeof document?document.documentElement:null);return e&&"function"==typeof e.getAttribute&&(o=e.getAttribute("lang")),o}},v={name:"path",lookup:function(e){var o;if("undefined"!=typeof window){var t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(t instanceof Array)if("number"==typeof e.lookupFromPathIndex){if("string"!=typeof t[e.lookupFromPathIndex])return;o=t[e.lookupFromPathIndex].replace("/","")}else o=t[0].replace("/","")}return o}},k={name:"subdomain",lookup:function(e){var o,t;return"undefined"==typeof window||(t=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi))instanceof Array&&(o=("number"==typeof e.lookupFromSubdomainIndex?t[e.lookupFromSubdomainIndex]:t[0]).replace("http://","").replace("https://","").replace(".","")),o}};e=function(){function t(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.type="languageDetector",this.detectors={},this.init(e,o)}var e,o,n;return e=t,(o=[{key:"init",value:function(e,o,t){o=1<arguments.length&&void 0!==o?o:{},t=2<arguments.length&&void 0!==t?t:{};this.services=e,this.options=function(t){return a.call(r.call(arguments,1),function(e){if(e)for(var o in e)void 0===t[o]&&(t[o]=e[o])}),t}(o,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=t,this.addDetector(l),this.addDetector(d),this.addDetector(g),this.addDetector(f),this.addDetector(h),this.addDetector(m),this.addDetector(v),this.addDetector(k)}},{key:"addDetector",value:function(e){this.detectors[e.name]=e}},{key:"detect",value:function(e){var o=this;e=e||this.options.order;var t=[];return e.forEach(function(e){o.detectors[e]&&((e=o.detectors[e].lookup(o.options))&&"string"==typeof e&&(e=[e]),e&&(t=t.concat(e)))}),this.services.languageUtils.getBestMatchFromCodes?t:0<t.length?t[0]:null}},{key:"cacheUserLanguage",value:function(o,e){var t=this;(e=e||this.options.caches)&&(this.options.excludeCacheFor&&-1<this.options.excludeCacheFor.indexOf(o)||e.forEach(function(e){t.detectors[e]&&t.detectors[e].cacheUserLanguage(o,t.options)}))}}])&&i(e.prototype,o),n&&i(e,n),t}();return e.type="languageDetector",e});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).i18nextXHRBackend=e()}(this,function(){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var t=[],r=t.forEach,a=t.slice;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l="function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)})(t)}function u(t,e){if(e&&"object"===l(e)){var n,o="",i=encodeURIComponent;for(n in e)o+="&"+i(n)+"="+i(e[n]);if(!o)return t;t=t+(-1!==t.indexOf("?")?"&":"?")+o.slice(1)}return t}function n(t,e,n,o,i){o&&"object"===l(o)&&(i||(o._t=new Date),o=u("",o).slice(1)),e.queryStringParams&&(t=u(t,e.queryStringParams));try{var r=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");r.open(o?"POST":"GET",t,1),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!e.withCredentials,o&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var a=e.customHeaders;if(a="function"==typeof a?a():a)for(var s in a)r.setRequestHeader(s,a[s]);r.onreadystatechange=function(){3<r.readyState&&n&&n(r.responseText,r)},r.send(o)}catch(t){console&&console.log(t)}}function s(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:JSON.parse,parsePayload:function(t,e,n){return o=n||"",(n=e)in(e={})?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e;var o},crossDomain:!1,ajax:n}}t=function(){function n(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.init(t,e),this.type="backend"}var t,e,o;return t=n,(e=[{key:"init",value:function(t,e){e=1<arguments.length&&void 0!==e?e:{};this.services=t,this.options=function(n){return r.call(a.call(arguments,1),function(t){if(t)for(var e in t)void 0===n[e]&&(n[e]=t[e])}),n}(e,this.options||{},s())}},{key:"readMulti",value:function(t,e,n){var o=this.options.loadPath;"function"==typeof this.options.loadPath&&(o=this.options.loadPath(t,e));e=this.services.interpolator.interpolate(o,{lng:t.join("+"),ns:e.join("+")});this.loadUrl(e,n)}},{key:"read",value:function(t,e,n){var o=this.options.loadPath;"function"==typeof this.options.loadPath&&(o=this.options.loadPath([t],[e]));e=this.services.interpolator.interpolate(o,{lng:t,ns:e});this.loadUrl(e,n)}},{key:"loadUrl",value:function(i,r){var a=this;this.options.ajax(i,this.options,function(t,e){if(500<=e.status&&e.status<600)return r("failed loading "+i,!0);if(400<=e.status&&e.status<500)return r("failed loading "+i,!1);var n,o;try{n=a.options.parse(t,i)}catch(t){o="failed parsing "+i+" to json"}if(o)return r(o,!1);r(null,n)})}},{key:"create",value:function(t,e,n,o){var i=this;"string"==typeof t&&(t=[t]);var r=this.options.parsePayload(e,n,o);t.forEach(function(t){t=i.services.interpolator.interpolate(i.options.addPath,{lng:t,ns:e});i.options.ajax(t,i.options,function(t,e){},r)})}}])&&i(t.prototype,e),o&&i(t,o),n}();return t.type="backend",t});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jqueryI18next=e()}(this,function(){"use strict";var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,a=arguments[e];for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},t={tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"i18n-target",optionsAttr:"i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0};return{init:function(l,i){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};function o(t,e,n){var a,r,i;function o(t,e){return s.parseDefaultValueFromContent?d({},t,{defaultValue:e}):t}0!==e.length&&(a="text",0===e.indexOf("[")&&(e=(i=e.split("]"))[1],a=i[0].substr(1,i[0].length-1)),e.indexOf(";")===e.length-1&&(e=e.substr(0,e.length-2)),"html"===a?t.html(l.t(e,o(n,t.html()))):"text"===a?t.text(l.t(e,o(n,t.text()))):"prepend"===a?t.prepend(l.t(e,o(n,t.html()))):"append"===a?t.append(l.t(e,o(n,t.html()))):0===a.indexOf("data-")?(r=a.substr("data-".length),i=l.t(e,o(n,t.data(r))),t.data(r,i),t.attr(a,i)):t.attr(a,l.t(e,o(n,t.attr(a)))))}function e(t,n){var a,e,r=t.attr(s.selectorAttr);r||void 0===r||!1===r||(r=t.text()||t.val()),r&&((e=(a=t).data(s.targetAttr))&&(a=t.find(e)||t),n||!0!==s.useOptionsAttr||(n=t.data(s.optionsAttr)),n=n||{},0<=r.indexOf(";")?(e=r.split(";"),i.each(e,function(t,e){""!==e&&o(a,e.trim(),n)})):o(a,r,n),!0===s.useOptionsAttr&&(delete(r=d({clone:r={}},n)).lng,t.data(s.optionsAttr,r)))}s=d({},t,s),i[s.tName]=l.t.bind(l),i[s.i18nName]=l,i.fn[s.handleName]=function(t){return this.each(function(){e(i(this),t),i(this).find("["+s.selectorAttr+"]").each(function(){e(i(this),t)})})}}}});
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(S,E){"use strict";if(!S.jstree){var s=0,a=!1,n=!1,o=!1,r=[],e=S("script:last").attr("src"),y=window.document;S.jstree={version:"3.3.8",defaults:{plugins:[]},plugins:{},path:e&&-1!==e.indexOf("/")?e.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},S.jstree.create=function(e,r){var i=new S.jstree.core(++s),t=r;return r=S.extend(!0,{},S.jstree.defaults,r),t&&t.plugins&&(r.plugins=t.plugins),S.each(r.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,r[t]))}),S(e).data("jstree",i),i.init(e,r),i},S.jstree.destroy=function(){S(".jstree:jstree").jstree("destroy"),S(y).off(".jstree")},S.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},S.jstree.reference=function(t){var r=null,e=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!e||!e.length)try{e=S(t)}catch(e){}if(!e||!e.length)try{e=S("#"+t.replace(S.jstree.idregex,"\\$&"))}catch(e){}return e&&e.length&&(e=e.closest(".jstree")).length&&(e=e.data("jstree"))?r=e:S(".jstree").each(function(){var e=S(this).data("jstree");if(e&&e._model.data[t])return r=e,!1}),r},S.fn.jstree=function(r){var i="string"==typeof r,s=Array.prototype.slice.call(arguments,1),a=null;return!(!0===r&&!this.length)&&(this.each(function(){var e=S.jstree.reference(this),t=i&&e?e[r]:null;if(a=i&&t?t.apply(e,s):null,e||i||r!==E&&!S.isPlainObject(r)||S.jstree.create(this,r),(e&&!i||!0===r)&&(a=e||!1),null!==a&&a!==E)return!1}),null!==a&&a!==E?a:this)},S.expr.pseudos.jstree=S.expr.createPseudo(function(e){return function(e){return S(e).hasClass("jstree")&&S(e).data("jstree")!==E}}),S.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:S.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,keyboard:{"ctrl-space":function(e){e.type="click",S(e.currentTarget).trigger(e)},enter:function(e){e.type="click",S(e.currentTarget).trigger(e)},left:function(e){e.preventDefault(),this.is_open(e.currentTarget)?this.close_node(e.currentTarget):(e=this.get_parent(e.currentTarget))&&e.id!==S.jstree.root&&this.get_node(e,!0).children(".jstree-anchor").focus()},up:function(e){e.preventDefault();e=this.get_prev_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},right:function(e){e.preventDefault(),this.is_closed(e.currentTarget)?this.open_node(e.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):!this.is_open(e.currentTarget)||(e=this.get_node(e.currentTarget,!0).children(".jstree-children")[0])&&S(this._firstChild(e)).children(".jstree-anchor").focus()},down:function(e){e.preventDefault();e=this.get_next_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},"*":function(e){this.open_all()},home:function(e){e.preventDefault();e=this._firstChild(this.get_container_ul()[0]);e&&S(e).children(".jstree-anchor").filter(":visible").focus()},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},S.jstree.core.prototype={plugin:function(e,t){var r=S.jstree.plugins[e];return r?(this._data[e]={},r.prototype=this,new r(t,this)):this},init:function(e,t){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[S.jstree.root]={id:S.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=S(e).addClass("jstree jstree-"+this._id),this.settings=t,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(S.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,r=y.createElement("LI");return r.setAttribute("role","treeitem"),(e=y.createElement("I")).className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),r.appendChild(e),(e=y.createElement("A")).className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),(t=y.createElement("I")).className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),r.appendChild(e),e=t=null,r},_kbevent_to_func:function(e){var t=[];e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),t.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[e.which]||e.which),t=t.sort().join("-").toLowerCase();var r,i,s=this.settings.core.keyboard;for(r in s)if(s.hasOwnProperty(r)&&("-"!==(i=r)&&"+"!==i&&(i=(i=i.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),i===t))return s[r];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var s="",a=null,t=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(y.selection&&y.selection.empty)y.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",S.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),t=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",S.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",S.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",S.proxy(function(e){e.preventDefault(),e.currentTarget!==y.activeElement&&S(e.currentTarget).focus(),this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",S.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){e=t.call(this,e);if(!1===e||!0===e)return e}},this)).on("load_node.jstree",S.proxy(function(e,t){t.status&&(t.node.id!==S.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(S.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var e=[],t=0,r=this._data.core.selected.length;t<r;t++)e=e.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,r=(e=S.vakata.array_unique(e)).length;t<r;t++)this.open_node(e[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",S.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;a&&clearTimeout(a),a=setTimeout(function(){s=""},500);var r=String.fromCharCode(e.which).toLowerCase(),t=this.element.find(".jstree-anchor").filter(":visible"),e=t.index(y.activeElement)||0,i=!1;if(1<(s+=r).length){if(t.slice(e).each(S.proxy(function(e,t){if(0===S(t).text().toLowerCase().indexOf(s))return S(t).focus(),!(i=!0)},this)),i)return;if(t.slice(0,e).each(S.proxy(function(e,t){if(0===S(t).text().toLowerCase().indexOf(s))return S(t).focus(),!(i=!0)},this)),i)return}new RegExp("^"+r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(s)&&(t.slice(e+1).each(S.proxy(function(e,t){if(S(t).text().toLowerCase().charAt(0)===r)return S(t).focus(),!(i=!0)},this)),i||t.slice(0,e+1).each(S.proxy(function(e,t){if(S(t).text().toLowerCase().charAt(0)===r)return S(t).focus(),!(i=!0)},this)))},this)).on("init.jstree",S.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",S.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",S.proxy(function(e){this._data.core.focused=null,S(e.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",S.proxy(function(e){var t=this.get_node(e.currentTarget);t&&t.id&&(this._data.core.focused=t.id),this.element.find(".jstree-hovered").not(e.currentTarget).trigger("mouseleave"),S(e.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")},this)).on("focus.jstree",S.proxy(function(){var e;500<+new Date-t&&!this._data.core.focused&&this.settings.core.restore_focus&&(t=0,(e=this.get_node(this.element.attr("aria-activedescendant"),!0))&&e.find("> .jstree-anchor").focus())},this)).on("mouseenter.jstree",".jstree-anchor",S.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",S.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),S(y).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var t=this.settings.core.strings;return S.isFunction(t)?t.call(this,e):t&&t[e]?t[e]:e},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(e,t){var r;e&&e.id&&(e=e.id),e instanceof S&&e.length&&e[0].id&&(e=e[0].id);try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(r=S("#"+e.replace(S.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])e=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=this.element.find(e)).length&&this._model.data[r.closest(".jstree-node").attr("id")])e=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=this.element.find(e)).length||!r.hasClass("jstree"))return!1;e=this._model.data[S.jstree.root]}return t&&(e=e.id===S.jstree.root?this.element:S("#"+e.id.replace(S.jstree.idregex,"\\$&"),this.element)),e}catch(e){return!1}},get_path:function(e,t,r){if(!(e=e.parents?e:this.get_node(e))||e.id===S.jstree.root||!e.parents)return!1;var i,s,a=[];for(a.push(r?e.id:e.text),i=0,s=e.parents.length;i<s;i++)a.push(r?e.parents[i]:this.get_text(e.parents[i]));return a=a.reverse().slice(1),t?a.join(t):a},get_next_dom:function(e,t){var r;if((e=this.get_node(e,!0))[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);return!!r&&S(r)}if(!e||!e.length)return!1;if(t){for(r=e[0];r=this._nextSibling(r),r&&0===r.offsetHeight;);return!!r&&S(r)}if(e.hasClass("jstree-open")){for(r=this._firstChild(e.children(".jstree-children")[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);if(null!==r)return S(r)}for(r=e[0];r=this._nextSibling(r),r&&0===r.offsetHeight;);return null!==r?S(r):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,t){var r;if((e=this.get_node(e,!0))[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&0===r.offsetHeight;)r=this._previousSibling(r);return!!r&&S(r)}if(!e||!e.length)return!1;if(t){for(r=e[0];r=this._previousSibling(r),r&&0===r.offsetHeight;);return!!r&&S(r)}for(r=e[0];r=this._previousSibling(r),r&&0===r.offsetHeight;);if(null===r)return!(!(r=e[0].parentNode.parentNode)||!r.className||-1===r.className.indexOf("jstree-node"))&&S(r);for(e=S(r);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e},get_parent:function(e){return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&e.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(n,o){var e,t,r,i,s;if(S.isArray(n))return this._load_nodes(n.slice(),o),!0;if(!(n=this.get_node(n)))return o&&o.call(this,n,!1),!1;if(n.state.loaded){for(n.state.loaded=!1,r=0,i=n.parents.length;r<i;r++)this._model.data[n.parents[r]].children_d=S.vakata.array_filter(this._model.data[n.parents[r]].children_d,function(e){return-1===S.inArray(e,n.children_d)});for(e=0,t=n.children_d.length;e<t;e++)this._model.data[n.children_d[e]].state.selected&&(s=!0),delete this._model.data[n.children_d[e]];s&&(this._data.core.selected=S.vakata.array_filter(this._data.core.selected,function(e){return-1===S.inArray(e,n.children_d)})),n.children=[],n.children_d=[],s&&this.trigger("changed",{action:"load_node",node:n,selected:this._data.core.selected})}return n.state.failed=!1,n.state.loading=!0,this.get_node(n,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(n,S.proxy(function(e){(n=this._model.data[n.id]).state.loading=!1,n.state.loaded=e,n.state.failed=!n.state.loaded;for(var t=this.get_node(n,!0),r=0,i=this._model.data,s=!1,r=0,a=n.children.length;r<a;r++)if(i[n.children[r]]&&!i[n.children[r]].state.hidden){s=!0;break}n.state.loaded&&t&&t.length&&(t.removeClass("jstree-closed jstree-open jstree-leaf"),s?"#"!==n.id&&t.addClass(n.state.opened?"jstree-open":"jstree-closed"):t.addClass("jstree-leaf")),t.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:n,status:e}),o&&o.call(this,n,e)},this)),!0},_load_nodes:function(e,t,r,i){for(var s=!0,a=function(){this._load_nodes(e,t,!0)},n=this._model.data,o=[],d=0,c=e.length;d<c;d++)n[e[d]]&&(!n[e[d]].state.loaded&&!n[e[d]].state.failed||!r&&i)&&(this.is_loading(e[d])||this.load_node(e[d],a),s=!1);if(s){for(d=0,c=e.length;d<c;d++)n[e[d]]&&n[e[d]].state.loaded&&o.push(e[d]);t&&!t.done&&(t.call(this,o),t.done=!0)}},load_all:function(e,t){if(e=e||S.jstree.root,!(e=this.get_node(e)))return!1;var r,i,s=[],a=this._model.data,n=a[e.id].children_d;for(e.state&&!e.state.loaded&&s.push(e.id),r=0,i=n.length;r<i;r++)a[n[r]]&&a[n[r]].state&&!a[n[r]].state.loaded&&s.push(n[r]);s.length?this._load_nodes(s,function(){this.load_all(e,t)}):(t&&t.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(s,a){function n(){return 3!==this.nodeType&&8!==this.nodeType}var e,t=this.settings.core.data;return t?S.isFunction(t)?t.call(this,s,S.proxy(function(e){!1===e?a.call(this,!1):this["string"==typeof e?"_append_html_data":"_append_json_data"](s,"string"==typeof e?S(S.parseHTML(e)).filter(n):e,function(e){a.call(this,e)})},this)):"object"==typeof t?t.url?(t=S.extend(!0,{},t),S.isFunction(t.url)&&(t.url=t.url.call(this,s)),S.isFunction(t.data)&&(t.data=t.data.call(this,s)),S.ajax(t).done(S.proxy(function(e,t,r){var i=r.getResponseHeader("Content-Type");return i&&-1!==i.indexOf("json")||"object"==typeof e?this._append_json_data(s,e,function(e){a.call(this,e)}):i&&-1!==i.indexOf("html")||"string"==typeof e?this._append_html_data(s,S(S.parseHTML(e)).filter(n),function(e){a.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:r})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))},this)).fail(S.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:s.id,xhr:e})},a.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(e=S.isArray(t)?S.extend(!0,[],t):S.isPlainObject(t)?S.extend(!0,{},t):t,s.id===S.jstree.root?this._append_json_data(s,e,function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))):"string"==typeof t?s.id===S.jstree.root?this._append_html_data(s,S(S.parseHTML(t)).filter(n),function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:s.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1)):a.call(this,!1):s.id===S.jstree.root?this._append_html_data(s,this._data.core.original_container_html.clone(!0),function(e){a.call(this,e)}):a.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&-1===S.inArray(e.id,this._model.changed)&&this._model.changed.push(e.id)},_append_html_data:function(e,t,r){(e=this.get_node(e)).children=[],e.children_d=[];var i,s,a,t=t.is("ul")?t.children():t,n=e.id,o=[],d=[],c=this._model.data,l=c[n],e=this._data.core.selected.length;for(t.each(S.proxy(function(e,t){(i=this._parse_model_from_html(S(t),n,l.parents.concat()))&&(o.push(i),d.push(i),c[i].children_d.length&&(d=d.concat(c[i].children_d)))},this)),l.children=o,l.children_d=d,s=0,a=l.parents.length;s<a;s++)c[l.parents[s]].children_d=c[l.parents[s]].children_d.concat(d);this.trigger("model",{nodes:d,parent:n}),n!==S.jstree.root?(this._node_changed(n),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==e&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)},_append_json_data:function(e,t,d,r){if(null!==this.element){(e=this.get_node(e)).children=[],e.children_d=[],t.d&&"string"==typeof(t=t.d)&&(t=JSON.parse(t)),S.isArray(t)||(t=[t]);var i=null,s={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},v=this,a=function(e,c){e.data&&(e=e.data);var t,r,i,s,a=e.dat,n=e.par,o=[],d=[],l=[],h=e.df,_=e.t_id,u=e.t_cnt,g=e.m,f=g[n],e=e.sel,p=function(e,t,r){r=r?r.concat():[],t&&r.unshift(t);var i,s,a,n,o=e.id.toString(),d={id:o,text:e.text||"",icon:e.icon===c||e.icon,parent:t,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(d.state[i]=h[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==c&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(d.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(d.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(d.li_attr[i]=e.li_attr[i]);if(d.li_attr.id||(d.li_attr.id=o),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(d.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),i=0,s=(g[d.id]=d).children.length;i<s;i++)a=p(g[d.children[i]],d.id,r),n=g[a],d.children_d.push(a),n.children_d.length&&(d.children_d=d.children_d.concat(n.children_d));return delete e.data,delete e.children,g[d.id].original=e,d.state.selected&&l.push(d.id),d.id},m=function(e,t,r){r=r?r.concat():[],t&&r.unshift(t);for(var i,s,a,n,o,d=!1;d="j"+_+"_"+ ++u,g[d];);for(i in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===c||e.icon,parent:t,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(i)&&(o.state[i]=h[i]);if(e&&e.id&&(o.id=e.id.toString()),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==c&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(o.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(o.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(o.li_attr[i]=e.li_attr[i]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(o.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,s=e.children.length;i<s;i++)a=m(e.children[i],o.id,r),n=g[a],o.children.push(a),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children_d.concat(o.children)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(g[o.id]=o).state.selected&&l.push(o.id),o.id};if(a.length&&a[0].id!==c&&a[0].parent!==c){for(r=0,i=a.length;r<i;r++)a[r].children||(a[r].children=[]),a[r].state||(a[r].state={}),g[a[r].id.toString()]=a[r];for(r=0,i=a.length;r<i;r++)g[a[r].parent.toString()]?(g[a[r].parent.toString()].children.push(a[r].id.toString()),f.children_d.push(a[r].id.toString())):void 0!==v&&(v._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:a[r].id.toString(),parent:a[r].parent.toString()})},v.settings.core.error.call(v,v._data.core.last_error));for(r=0,i=f.children.length;r<i;r++)t=p(g[f.children[r]],n,f.parents.concat()),d.push(t),g[t].children_d.length&&(d=d.concat(g[t].children_d));for(r=0,i=f.parents.length;r<i;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(d);s={cnt:u,mod:g,sel:e,par:n,dpc:d,add:l}}else{for(r=0,i=a.length;r<i;r++)(t=m(a[r],n,f.parents.concat()))&&(o.push(t),d.push(t),g[t].children_d.length&&(d=d.concat(g[t].children_d)));for(f.children=o,f.children_d=d,r=0,i=f.parents.length;r<i;r++)g[f.parents[r]].children_d=g[f.parents[r]].children_d.concat(d);s={cnt:u,mod:g,sel:e,par:n,dpc:d,add:l}}if("undefined"!=typeof window&&void 0!==window.document)return s;postMessage(s)},n=function(e,t){if(null!==this.element){for(var r in this._cnt=e.cnt,o=this._model.data)o.hasOwnProperty(r)&&o[r].state&&o[r].state.loading&&e.mod[r]&&(e.mod[r].state.loading=!0);if(this._model.data=e.mod,t){var i,s=e.add,a=e.sel,n=this._data.core.selected.slice(),o=this._model.data;if(a.length!==n.length||S.vakata.array_unique(a.concat(n)).length!==a.length){for(r=0,i=a.length;r<i;r++)-1===S.inArray(a[r],s)&&-1===S.inArray(a[r],n)&&(o[a[r]].state.selected=!1);for(r=0,i=n.length;r<i;r++)-1===S.inArray(n[r],a)&&(o[n[r]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),e.par!==S.jstree.root?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),d.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+a.toString()],{type:"text/javascript"}))),!this._data.core.working||r?(this._data.core.working=!0,(i=new window.Worker(this._wrk)).onmessage=S.proxy(function(e){n.call(this,e.data,!0);try{i.terminate(),i=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),s.par?i.postMessage(s):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,t,d,!0])}catch(e){n.call(this,a(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else n.call(this,a(s),!1)}},_parse_model_from_html:function(e,t,r){r=r?[].concat(r):[],t&&r.unshift(t);var i,s,a,n,o=this._model.data,d={id:!1,text:!1,icon:!0,parent:t,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in this._model.default_state)this._model.default_state.hasOwnProperty(a)&&(d.state[a]=this._model.default_state[a]);if(t=S.vakata.attributes(e,!0),S.each(t,function(e,t){return!(t=S.trim(t)).length||(d.li_attr[e]=t,void("id"===e&&(d.id=t.toString())))}),(t=e.children("a").first()).length&&(t=S.vakata.attributes(t,!0),S.each(t,function(e,t){(t=S.trim(t)).length&&(d.a_attr[e]=t)})),(t=(e.children("a").first().length?e.children("a").first():e).clone()).children("ins, i, ul").remove(),t=t.html(),t=S("<div />").html(t),d.text=this.settings.core.force_text?t.text():t.html(),t=e.data(),d.data=t?S.extend(!0,{},t):null,d.state.opened=e.hasClass("jstree-open"),d.state.selected=e.children("a").hasClass("jstree-clicked"),d.state.disabled=e.children("a").hasClass("jstree-disabled"),d.data&&d.data.jstree)for(a in d.data.jstree)d.data.jstree.hasOwnProperty(a)&&(d.state[a]=d.data.jstree[a]);for(t=e.children("a").children(".jstree-themeicon"),t.length&&(d.icon=!t.hasClass("jstree-themeicon-hidden")&&t.attr("rel")),d.state.icon!==E&&(d.icon=d.state.icon),d.icon!==E&&null!==d.icon&&""!==d.icon||(d.icon=!0),t=e.children("ul").children("li");n="j"+this._id+"_"+ ++this._cnt,o[n];);return d.id=d.li_attr.id?d.li_attr.id.toString():n,t.length?(t.each(S.proxy(function(e,t){i=this._parse_model_from_html(S(t),d.id,r),s=this._model.data[i],d.children.push(i),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d))},this)),d.children_d=d.children_d.concat(d.children)):e.hasClass("jstree-closed")&&(d.state.loaded=!1),d.li_attr.class&&(d.li_attr.class=d.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),d.a_attr.class&&(d.a_attr.class=d.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(o[d.id]=d).state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_flat_json:function(e,t,r){r=r?r.concat():[],t&&r.unshift(t);var i,s,a,n,o=e.id.toString(),d=this._model.data,c=this._model.default_state,l={id:o,text:e.text||"",icon:e.icon===E||e.icon,parent:t,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in c)c.hasOwnProperty(i)&&(l.state[i]=c[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==E&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id||(l.li_attr.id=o),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),i=0,s=(d[l.id]=l).children.length;i<s;i++)n=d[a=this._parse_model_from_flat_json(d[l.children[i]],l.id,r)],l.children_d.push(a),n.children_d.length&&(l.children_d=l.children_d.concat(n.children_d));return delete e.data,delete e.children,d[l.id].original=e,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(e,t,r){r=r?r.concat():[],t&&r.unshift(t);for(var i,s,a,n,o,d=!1,c=this._model.data,l=this._model.default_state;d="j"+this._id+"_"+ ++this._cnt,c[d];);for(i in o={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===E||e.icon,parent:t,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},l)l.hasOwnProperty(i)&&(o.state[i]=l[i]);if(e&&e.id&&(o.id=e.id.toString()),e&&e.text&&(o.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(o.icon=e.data.jstree.icon),o.icon!==E&&null!==o.icon&&""!==o.icon||(o.icon=!0),e&&e.data&&(o.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(o.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(o.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(o.li_attr[i]=e.li_attr[i]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=d),o.li_attr.id||(o.li_attr.id=o.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(o.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,s=e.children.length;i<s;i++)n=c[a=this._parse_model_from_json(e.children[i],o.id,r)],o.children.push(a),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children.concat(o.children_d)}return e&&e.children&&!0===e.children&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete e.data,delete e.children,o.original=e,(c[o.id]=o).state.selected&&this._data.core.selected.push(o.id),o.id},_redraw:function(){for(var e,t=(this._model.force_full_redraw?this._model.data[S.jstree.root].children:this._model.changed).concat([]),r=y.createElement("UL"),i=this._data.core.focused,s=0,a=t.length;s<a;s++)(e=this.redraw_node(t[s],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&r.appendChild(e);this._model.force_full_redraw&&(r.className=this.get_container_ul()[0].className,r.setAttribute("role","group"),this.element.empty().append(r)),null!==i&&this.settings.core.restore_focus&&((e=this.get_node(i,!0))&&e.length&&e.children(".jstree-anchor")[0]!==y.activeElement?e.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:t})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var t,r=this.get_node(e),i=!1,s=!1,a=y;if(!r)return!1;if(r.id===S.jstree.root)return this.redraw(!0);if(!(e=this.get_node(e,!0))||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],r.children.length&&r.state.loaded){for((s=a.createElement("UL")).setAttribute("role","group"),s.className="jstree-children",i=0,t=r.children.length;i<t;i++)s.appendChild(this.redraw_node(r.children[i],!0,!0));e.appendChild(s)}},redraw_node:function(e,t,r,i){var s,a,n=this.get_node(e),o=!1,d=!1,c=!1,l=!1,h=!1,_=!1,u="",g=y,f=this._model.data,p=!1,m=null,v=!1,j=!1;if(!n)return!1;if(n.id===S.jstree.root)return this.redraw(!0);if(t=t||0===n.children.length,e=y.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(n.id[0])?"\\3"+n.id[0]+" "+n.id.substr(1).replace(S.jstree.idregex,"\\$&"):n.id.replace(S.jstree.idregex,"\\$&"))):y.getElementById(n.id))e=S(e),r||((o=e.parent().parent()[0])===this.element[0]&&(o=null),d=e.index()),t||!n.children.length||e.children(".jstree-children").length||(t=!0),t||(c=e.children(".jstree-children")[0]),p=e.children(".jstree-anchor")[0]===y.activeElement,e.remove();else if(t=!0,!r){if(!(null===(o=n.parent!==S.jstree.root?S("#"+n.parent.replace(S.jstree.idregex,"\\$&"),this.element)[0]:null)||o&&f[n.parent].state.opened))return!1;d=S.inArray(n.id,(null===o?f[S.jstree.root]:f[n.parent]).children)}for(l in e=this._data.core.node.cloneNode(!0),u="jstree-node ",n.li_attr)n.li_attr.hasOwnProperty(l)&&"id"!==l&&("class"!==l?e.setAttribute(l,n.li_attr[l]):u+=n.li_attr[l]);for(n.a_attr.id||(n.a_attr.id=n.id+"_anchor"),e.setAttribute("aria-selected",!!n.state.selected),e.setAttribute("aria-level",n.parents.length),e.setAttribute("aria-labelledby",n.a_attr.id),n.state.disabled&&e.setAttribute("aria-disabled",!0),l=0,h=n.children.length;l<h;l++)if(!f[n.children[l]].state.hidden){v=!0;break}if(null!==n.parent&&f[n.parent]&&!n.state.hidden&&(l=S.inArray(n.id,f[n.parent].children),j=n.id,-1!==l))for(l++,h=f[n.parent].children.length;l<h&&(f[f[n.parent].children[l]].state.hidden||(j=f[n.parent].children[l]),j===n.id);l++);for(h in n.state.hidden&&(u+=" jstree-hidden"),n.state.loading&&(u+=" jstree-loading"),n.state.loaded&&!v?u+=" jstree-leaf":(u+=n.state.opened&&n.state.loaded?" jstree-open":" jstree-closed",e.setAttribute("aria-expanded",n.state.opened&&n.state.loaded)),j===n.id&&(u+=" jstree-last"),e.id=n.id,e.className=u,u=(n.state.selected?" jstree-clicked":"")+(n.state.disabled?" jstree-disabled":""),n.a_attr)n.a_attr.hasOwnProperty(h)&&("href"===h&&"#"===n.a_attr[h]||("class"!==h?e.childNodes[1].setAttribute(h,n.a_attr[h]):u+=" "+n.a_attr[h]));if(u.length&&(e.childNodes[1].className="jstree-anchor "+u),(n.icon&&!0!==n.icon||!1===n.icon)&&(!1===n.icon?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===n.icon.indexOf("/")&&-1===n.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+n.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+n.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(g.createTextNode(n.text)):e.childNodes[1].innerHTML+=n.text,t&&n.children.length&&(n.state.opened||i)&&n.state.loaded){for((_=g.createElement("UL")).setAttribute("role","group"),_.className="jstree-children",l=0,h=n.children.length;l<h;l++)_.appendChild(this.redraw_node(n.children[l],t,!0));e.appendChild(_)}if(c&&e.appendChild(c),!r){for(l=0,h=(o=o||this.element[0]).childNodes.length;l<h;l++)if(o.childNodes[l]&&o.childNodes[l].className&&-1!==o.childNodes[l].className.indexOf("jstree-children")){m=o.childNodes[l];break}m||((m=g.createElement("UL")).setAttribute("role","group"),m.className="jstree-children",o.appendChild(m)),d<(o=m).childNodes.length?o.insertBefore(e,o.childNodes[d]):o.appendChild(e),p&&(s=this.element[0].scrollTop,a=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=s,this.element[0].scrollLeft=a)}return n.state.opened&&!n.state.loaded&&(n.state.opened=!1,setTimeout(S.proxy(function(){this.open_node(n.id,!1,0)},this),0)),e},open_node:function(e,r,i){var t,s,a,n;if(S.isArray(e)){for(t=0,s=(e=e.slice()).length;t<s;t++)this.open_node(e[t],r,i);return!0}return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&(i=i===E?this.settings.core.animation:i,this.is_closed(e)?this.is_loaded(e)?(a=this.get_node(e,!0),n=this,a.length&&(i&&a.children(".jstree-children").length&&a.children(".jstree-children").stop(!0,!0),e.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&this.draw_children(e),i?(this.trigger("before_open",{node:e}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(i,function(){this.style.display="",n.element&&n.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].setAttribute("aria-expanded",!0))),e.state.opened=!0,r&&r.call(this,e,!0),a.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),i&&a.length||this.trigger("after_open",{node:e}),!0):this.is_loading(e)?setTimeout(S.proxy(function(){this.open_node(e,r,i)},this),500):void this.load_node(e,function(e,t){return t?this.open_node(e,r,i):!!r&&r.call(this,e,!1)}):(r&&r.call(this,e,!1),!1))},_open_to:function(e){if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;for(var t=e.parents,r=0,i=t.length;r<i;r+=1)r!==S.jstree.root&&this.open_node(t[r],!1,0);return S("#"+e.id.replace(S.jstree.idregex,"\\$&"),this.element)},close_node:function(e,t){var r,i,s,a;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.close_node(e[r],t);return!0}return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&(!this.is_closed(e)&&(t=t===E?this.settings.core.animation:t,a=(s=this).get_node(e,!0),e.state.opened=!1,this.trigger("close_node",{node:e}),void(a.length?t?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(t,function(){this.style.display="",a.children(".jstree-children").remove(),s.element&&s.trigger("after_close",{node:e})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:e})):this.trigger("after_close",{node:e}))))},toggle_node:function(e){var t,r;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.toggle_node(e[t]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):void 0},open_all:function(e,r,i){if(e=e||S.jstree.root,!(e=this.get_node(e)))return!1;var t,s,a,n=e.id===S.jstree.root?this.get_container_ul():this.get_node(e,!0);if(!n.length){for(t=0,s=e.children_d.length;t<s;t++)this.is_closed(this._model.data[e.children_d[t]])&&(this._model.data[e.children_d[t]].state.opened=!0);return this.trigger("open_all",{node:e})}i=i||n,(n=(a=this).is_closed(e)?n.find(".jstree-closed").addBack():n.find(".jstree-closed")).each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,i)},r||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(e,t){if(e=e||S.jstree.root,!(e=this.get_node(e)))return!1;var r,i,s=e.id===S.jstree.root?this.get_container_ul():this.get_node(e,!0),a=this;for(s.length&&(s=this.is_open(e)?s.find(".jstree-open").addBack():s.find(".jstree-open"),S(s.get().reverse()).each(function(){a.close_node(this,t||0)})),r=0,i=e.children_d.length;r<i;r++)this._model.data[e.children_d[r]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(e){var t,r;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.enable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:e})},disable_node:function(e){var t,r;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.disable_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:e})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(e,t){var r,i;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.hide_node(e[r],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),t||this.redraw(),this.trigger("hide_node",{node:e}))},show_node:function(e,t){var r,i;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.show_node(e[r],!0);return t||this.redraw(),!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),t||this.redraw(),this.trigger("show_node",{node:e}))},hide_all:function(e){var t,r=this._model.data,i=[];for(t in r)r.hasOwnProperty(t)&&t!==S.jstree.root&&!r[t].state.hidden&&(r[t].state.hidden=!0,i.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:i}),i},show_all:function(e){var t,r=this._model.data,i=[];for(t in r)r.hasOwnProperty(t)&&t!==S.jstree.root&&r[t].state.hidden&&(r[t].state.hidden=!1,i.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:i}),i},activate_node:function(e,t){if(this.is_disabled(e))return!1;if(t&&"object"==typeof t||(t={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==E?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(t.shiftKey){for(var r=this.get_node(e).id,i=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,a=!1,n=0,o=s.length;n<o;n+=1)s[n]===r&&(a=!a),s[n]===i&&(a=!a),this.is_disabled(s[n])||!a&&s[n]!==r&&s[n]!==i?this.deselect_node(s[n],!0,t):this.is_hidden(s[n])||this.select_node(s[n],!0,!1,t);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:t})}else this.is_selected(e)?this.deselect_node(e,!1,t):this.select_node(e,!1,!1,t);else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,t):(this.deselect_all(!0),this.select_node(e,!1,!1,t),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:t})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(e,t,r,i){var s,a,n;if(S.isArray(e)){for(a=0,n=(e=e.slice()).length;a<n;a++)this.select_node(e[a],t,r,i);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;s=this.get_node(e,!0),e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),r||(s=this._open_to(e)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:i}))},deselect_node:function(e,t,r){var i,s,a;if(S.isArray(e)){for(i=0,s=(e=e.slice()).length;i<s;i++)this.deselect_node(e[i],t,r);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;a=this.get_node(e,!0),e.state.selected&&(e.state.selected=!1,this._data.core.selected=S.vakata.array_remove_item(this._data.core.selected,e.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:r}),t||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:r}))},select_all:function(e){var t,r,i=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[S.jstree.root].children_d.concat(),t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),r=0,i=this._data.core.selected.length;r<i;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&e.state.selected},get_selected:function(e){return e?S.map(this._data.core.selected,S.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(e){for(var t,r,i=this.get_selected(!0),s={},a=0,n=i.length;a<n;a++)s[i[a].id]=i[a];for(a=0,n=i.length;a<n;a++)for(t=0,r=i[a].children_d.length;t<r;t++)s[i[a].children_d[t]]&&delete s[i[a].children_d[t]];for(a in i=[],s)s.hasOwnProperty(a)&&i.push(a);return e?S.map(i,S.proxy(function(e){return this.get_node(e)},this)):i},get_bottom_selected:function(e){for(var t=this.get_selected(!0),r=[],i=0,s=t.length;i<s;i++)t[i].children.length||r.push(t[i].id);return e?S.map(r,S.proxy(function(e){return this.get_node(e)},this)):r},get_state:function(){var e,t={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&e!==S.jstree.root&&(this._model.data[e].state.loaded&&this.settings.core.loaded_state&&t.core.loaded.push(e),this._model.data[e].state.opened&&t.core.open.push(e),this._model.data[e].state.selected&&t.core.selected.push(e));return t},set_state:function(t,r){if(t){if(t.core&&t.core.selected&&t.core.initial_selection===E&&(t.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),t.core){var i,e;if(t.core.loaded)return this.settings.core.loaded_state&&S.isArray(t.core.loaded)&&t.core.loaded.length?this._load_nodes(t.core.loaded,function(e){delete t.core.loaded,this.set_state(t,r)}):(delete t.core.loaded,this.set_state(t,r)),!1;if(t.core.open)return S.isArray(t.core.open)&&t.core.open.length?this._load_nodes(t.core.open,function(e){this.open_node(e,!1,0),delete t.core.open,this.set_state(t,r)}):(delete t.core.open,this.set_state(t,r)),!1;if(t.core.scroll)return t.core.scroll&&t.core.scroll.left!==E&&this.element.scrollLeft(t.core.scroll.left),t.core.scroll&&t.core.scroll.top!==E&&this.element.scrollTop(t.core.scroll.top),delete t.core.scroll,this.set_state(t,r),!1;if(t.core.selected)return i=this,t.core.initial_selection!==E&&t.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),S.each(t.core.selected,function(e,t){i.select_node(t,!1,!0)})),delete t.core.initial_selection,delete t.core.selected,this.set_state(t,r),!1;for(e in t)t.hasOwnProperty(e)&&"core"!==e&&-1===S.inArray(e,this.settings.plugins)&&delete t[e];if(S.isEmptyObject(t.core))return delete t.core,this.set_state(t,r),!1}return S.isEmptyObject(t)?(t=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(e,t){this._data.core.state=!0===t?{}:this.get_state(),t&&S.isFunction(t)&&(this._data.core.state=t.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[S.jstree.root]={id:S.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var r=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(S.jstree.root,function(e,t){t&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(S.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===S.jstree.root)return!1;var r=[],e=[],i=this._data.core.selected.concat([]);e.push(t.id),!0===t.state.opened&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){e.push(this.id),r.push(this.id)}),this._load_nodes(e,S.proxy(function(e){this.open_node(r,!1,0),this.select_node(i),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(e,t){if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;var r,i,s=this._model.data,a=e.id;for(t=t.toString(),s[e.parent].children[S.inArray(e.id,s[e.parent].children)]=t,r=0,i=e.parents.length;r<i;r++)s[e.parents[r]].children_d[S.inArray(e.id,s[e.parents[r]].children_d)]=t;for(r=0,i=e.children.length;r<i;r++)s[e.children[r]].parent=t;for(r=0,i=e.children_d.length;r<i;r++)s[e.children_d[r]].parents[S.inArray(e.id,s[e.children_d[r]].parents)]=t;return-1!==(r=S.inArray(e.id,this._data.core.selected))&&(this._data.core.selected[r]=t),(r=this.get_node(e.id,!0))&&(r.attr("id",t),this.element.attr("aria-activedescendant")===e.id&&this.element.attr("aria-activedescendant",t)),delete s[e.id],e.id=t,s[e.li_attr.id=t]=e,this.trigger("set_id",{node:e,new:e.id,old:a}),!0},get_text:function(e){return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&e.text},set_text:function(e,t){var r,i;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.set_text(e[r],t);return!0}return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&(e.text=t,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:t}),!0)},get_json:function(e,t,r){if(!(e=this.get_node(e||S.jstree.root)))return!1;t&&t.flat&&!r&&(r=[]);var i,s,a={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:S.extend(!0,{},e.li_attr),a_attr:S.extend(!0,{},e.a_attr),state:{},data:(!t||!t.no_data)&&S.extend(!0,S.isArray(e.data)?[]:{},e.data)};if(t&&t.flat?a.parent=e.parent:a.children=[],t&&t.no_state)delete a.state;else for(i in e.state)e.state.hasOwnProperty(i)&&(a.state[i]=e.state[i]);if(t&&t.no_li_attr&&delete a.li_attr,t&&t.no_a_attr&&delete a.a_attr,t&&t.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),t&&t.flat&&e.id!==S.jstree.root&&r.push(a),!t||!t.no_children)for(i=0,s=e.children.length;i<s;i++)t&&t.flat?this.get_json(e.children[i],t,r):a.children.push(this.get_json(e.children[i],t));return t&&t.flat?r:e.id===S.jstree.root?a.children:a},create_node:function(e,t,r,i,s){if(null===e&&(e=S.jstree.root),!(e=this.get_node(e)))return!1;if(!(r=r===E?"last":r).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,r,i,!0)});var a,n,o,d;switch((t="string"==typeof(t=t||{text:this.get_string("New node")})?{text:t}:S.extend(!0,{},t)).text===E&&(t.text=this.get_string("New node")),e.id===S.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":a=this.get_node(e.parent),r=S.inArray(e.id,a.children),e=a;break;case"after":a=this.get_node(e.parent),r=S.inArray(e.id,a.children)+1,e=a;break;case"inside":case"first":r=0;break;case"last":r=e.children.length;break;default:r=r||0}if(r>e.children.length&&(r=e.children.length),t.id||(t.id=!0),!this.check("create_node",t,e,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===t.id&&delete t.id,!(t=this._parse_model_from_json(t,e.id,e.parents.concat())))return!1;for(a=this.get_node(t),(n=[]).push(t),n=n.concat(a.children_d),this.trigger("model",{nodes:n,parent:e.id}),e.children_d=e.children_d.concat(n),o=0,d=e.parents.length;o<d;o++)this._model.data[e.parents[o]].children_d=this._model.data[e.parents[o]].children_d.concat(n);for(t=a,a=[],o=0,d=e.children.length;o<d;o++)a[r<=o?o+1:o]=e.children[o];return a[r]=t.id,e.children=a,this.redraw_node(e,!0),this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:r}),i&&i.call(this,this.get_node(t)),t.id},rename_node:function(e,t){var r,i,s;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.rename_node(e[r],t);return!0}return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&(s=e.text,this.check("rename_node",e,this.get_parent(e),t)?(this.set_text(e,t),this.trigger("rename_node",{node:e,text:t,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var t,r,i,s,a,n,o,d,c,l,h;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.delete_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;if(i=this.get_node(e.parent),h=S.inArray(e.id,i.children),c=!1,!this.check("delete_node",e,i,h))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==h&&(i.children=S.vakata.array_remove(i.children,h)),(s=e.children_d.concat([])).push(e.id),a=0,n=e.parents.length;a<n;a++)this._model.data[e.parents[a]].children_d=S.vakata.array_filter(this._model.data[e.parents[a]].children_d,function(e){return-1===S.inArray(e,s)});for(o=0,d=s.length;o<d;o++)if(this._model.data[s[o]].state.selected){c=!0;break}for(c&&(this._data.core.selected=S.vakata.array_filter(this._data.core.selected,function(e){return-1===S.inArray(e,s)})),this.trigger("delete_node",{node:e,parent:i.id}),c&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:i.id}),o=0,d=s.length;o<d;o++)delete this._model.data[s[o]];return-1!==S.inArray(this._data.core.focused,s)&&(this._data.core.focused=null,l=this.element[0].scrollTop,h=this.element[0].scrollLeft,i.id===S.jstree.root?this._model.data[S.jstree.root].children[0]&&this.get_node(this._model.data[S.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(i,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=l,this.element[0].scrollLeft=h),this.redraw_node(i,!0),!0},check:function(e,t,r,i,s){t=t&&t.id?t:this.get_node(t),r=r&&r.id?r:this.get_node(r);var a=e.match(/^move_node|copy_node|create_node$/i)?r:t,n=this.settings.core.check_callback;if("move_node"===e||"copy_node"===e){if(!(s&&s.is_multi||"move_node"!==e||S.inArray(t.id,r.children)!==i))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})});if(!(s&&s.is_multi||t.id!==r.id&&("move_node"!==e||S.inArray(t.id,r.children)!==i)&&-1===S.inArray(r.id,t.children_d)))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})})}return a&&a.data&&(a=a.data),a&&a.functions&&(!1===a.functions[e]||!0===a.functions[e])?(!1===a.functions[e]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})}),a.functions[e]):!(!1===n||S.isFunction(n)&&!1===n.call(this,e,t,r,i,s)||n&&!1===n[e])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})})},last_error:function(){return this._data.core.last_error},move_node:function(e,t,r,i,s,a,n){var o,d,c,l,h,_,u,g,f,p,m,v,j,y;if(t=this.get_node(t),r=r===E?0:r,!t)return!1;if(!r.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(e,t,r,i,!0,!1,n)});if(S.isArray(e)){if(1!==e.length){for(o=0,d=e.length;o<d;o++)(f=this.move_node(e[o],t,r,i,s,!1,n))&&(t=f,r="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===S.jstree.root)return!1;if(c=(e.parent||S.jstree.root).toString(),h=r.toString().match(/^(before|after)$/)&&t.id!==S.jstree.root?this.get_node(t.parent):t,u=!(_=n||(this._model.data[e.id]?this:S.jstree.reference(e.id)))||!_._id||this._id!==_._id,l=_&&_._id&&c&&_._model.data[c]&&_._model.data[c].children?S.inArray(e.id,_._model.data[c].children):-1,_&&_._id&&(e=_._model.data[e.id]),u)return!!(f=this.copy_node(e,t,r,i,s,!1,n))&&(_&&_.delete_node(e),f);switch(t.id===S.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=S.inArray(t.id,h.children);break;case"after":r=S.inArray(t.id,h.children)+1;break;case"inside":case"first":r=0;break;case"last":r=h.children.length;break;default:r=r||0}if(r>h.children.length&&(r=h.children.length),!this.check("move_node",e,h,r,{core:!0,origin:n,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===h.id){for(g=h.children.concat(),-1!==(f=S.inArray(e.id,g))&&(g=S.vakata.array_remove(g,f),f<r&&r--),f=[],p=0,m=g.length;p<m;p++)f[r<=p?p+1:p]=g[p];f[r]=e.id,h.children=f,this._node_changed(h.id),this.redraw(h.id===S.jstree.root)}else{for((f=e.children_d.concat()).push(e.id),p=0,m=e.parents.length;p<m;p++){for(g=[],v=0,j=(y=_._model.data[e.parents[p]].children_d).length;v<j;v++)-1===S.inArray(y[v],f)&&g.push(y[v]);_._model.data[e.parents[p]].children_d=g}for(_._model.data[c].children=S.vakata.array_remove_item(_._model.data[c].children,e.id),p=0,m=h.parents.length;p<m;p++)this._model.data[h.parents[p]].children_d=this._model.data[h.parents[p]].children_d.concat(f);for(g=[],p=0,m=h.children.length;p<m;p++)g[r<=p?p+1:p]=h.children[p];for(g[r]=e.id,h.children=g,h.children_d.push(e.id),h.children_d=h.children_d.concat(e.children_d),e.parent=h.id,(f=h.parents.concat()).unshift(h.id),y=e.parents.length,f=(e.parents=f).concat(),p=0,m=e.children_d.length;p<m;p++)this._model.data[e.children_d[p]].parents=this._model.data[e.children_d[p]].parents.slice(0,-1*y),Array.prototype.push.apply(this._model.data[e.children_d[p]].parents,f);c!==S.jstree.root&&h.id!==S.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(c),this._node_changed(h.id)),a||this.redraw()}return i&&i.call(this,e,h,r),this.trigger("move_node",{node:e,parent:h.id,position:r,old_parent:c,old_position:l,is_multi:_&&_._id&&_._id!==this._id,is_foreign:!_||!_._id,old_instance:_,new_instance:this}),e.id},copy_node:function(e,t,r,i,s,a,n){var o,d,c,l,h,_,u,g,f,p;if(t=this.get_node(t),r=r===E?0:r,!t)return!1;if(!r.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(e,t,r,i,!0,!1,n)});if(S.isArray(e)){if(1!==e.length){for(o=0,d=e.length;o<d;o++)(l=this.copy_node(e[o],t,r,i,s,!0,n))&&(t=l,r="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===S.jstree.root)return!1;switch(g=(e.parent||S.jstree.root).toString(),f=r.toString().match(/^(before|after)$/)&&t.id!==S.jstree.root?this.get_node(t.parent):t,(p=n||(this._model.data[e.id]?this:S.jstree.reference(e.id)))&&p._id&&(this._id,p._id),p&&p._id&&(e=p._model.data[e.id]),t.id===S.jstree.root&&("before"===r&&(r="first"),"after"===r&&(r="last")),r){case"before":r=S.inArray(t.id,f.children);break;case"after":r=S.inArray(t.id,f.children)+1;break;case"inside":case"first":r=0;break;case"last":r=f.children.length;break;default:r=r||0}if(r>f.children.length&&(r=f.children.length),!this.check("copy_node",e,f,r,{core:!0,origin:n,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(u=p?p.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e))return!1;if(!0===u.id&&delete u.id,!(u=this._parse_model_from_json(u,f.id,f.parents.concat())))return!1;for(l=this.get_node(u),e&&e.state&&!1===e.state.loaded&&(l.state.loaded=!1),(c=[]).push(u),c=c.concat(l.children_d),this.trigger("model",{nodes:c,parent:f.id}),h=0,_=f.parents.length;h<_;h++)this._model.data[f.parents[h]].children_d=this._model.data[f.parents[h]].children_d.concat(c);for(c=[],h=0,_=f.children.length;h<_;h++)c[r<=h?h+1:h]=f.children[h];return c[r]=l.id,f.children=c,f.children_d.push(l.id),f.children_d=f.children_d.concat(l.children_d),f.id===S.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(f.id),a||this.redraw(f.id===S.jstree.root),i&&i.call(this,l,f,r),this.trigger("copy_node",{node:l,original:e,parent:f.id,position:r,old_parent:g,old_position:p&&p._id&&g&&p._model.data[g]&&p._model.data[g].children?S.inArray(e.id,p._model.data[g].children):-1,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),l.id},cut:function(e){if(e=e||this._data.core.selected.concat(),S.isArray(e)||(e=[e]),!e.length)return!1;for(var t,r=[],i=0,s=e.length;i<s;i++)(t=this.get_node(e[i]))&&t.id&&t.id!==S.jstree.root&&r.push(t);if(!r.length)return!1;a=r,n="move_node",(o=this).trigger("cut",{node:e})},copy:function(e){if(e=e||this._data.core.selected.concat(),S.isArray(e)||(e=[e]),!e.length)return!1;for(var t,r=[],i=0,s=e.length;i<s;i++)(t=this.get_node(e[i]))&&t.id&&t.id!==S.jstree.root&&r.push(t);if(!r.length)return!1;a=r,n="copy_node",(o=this).trigger("copy",{node:e})},get_buffer:function(){return{mode:n,node:a,inst:o}},can_paste:function(){return!1!==n&&!1!==a},paste:function(e,t){if(!((e=this.get_node(e))&&n&&n.match(/^(copy_node|move_node)$/)&&a))return!1;this[n](a,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:a,mode:n}),o=n=a=!1},clear_buffer:function(){o=n=a=!1,this.trigger("clear_buffer")},edit:function(r,e,i){var t,s,a,n,o,d,c,l,h=!1;return!!(r=this.get_node(r))&&(this.check("edit",r,this.get_parent(r))?(l=r,e="string"==typeof e?e:r.text,this.set_text(r,""),r=this._open_to(r),l.text=e,c=this._data.core.rtl,t=this.element.width(),this._data.core.focused=l.id,s=r.children(".jstree-anchor").focus(),a=S("<span>"),n=e,o=S("<div />",{css:{position:"absolute",top:"-200px",left:c?"0px":"-1000px",visibility:"hidden"}}).appendTo(y.body),d=S("<input />",{value:n,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:S.proxy(function(e){e.stopImmediatePropagation(),e.preventDefault();var t=a.children(".jstree-rename-input").val(),e=this.settings.core.force_text;""===t&&(t=n),o.remove(),a.replaceWith(s),a.remove(),n=e?n:S("<div></div>").append(S.parseHTML(n)).html(),r=this.get_node(r),this.set_text(r,n),(t=!!this.rename_node(r,e?S("<div></div>").text(t).text():S("<div></div>").append(S.parseHTML(t)).html()))||this.set_text(r,n),this._data.core.focused=l.id,setTimeout(S.proxy(function(){var e=this.get_node(l.id,!0);e.length&&(this._data.core.focused=l.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,l,t,h),d=null},this),keydown:function(e){var t=e.which;27===t&&(h=!0,this.value=n),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){d.width(Math.min(o.text("pW"+this.value).width(),t))},keypress:function(e){if(13===e.which)return!1}}),c={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""},a.attr("class",s.attr("class")).append(s.contents().clone()).append(d),s.replaceWith(a),o.css(c),d.css(c).width(Math.min(o.text("pW"+d[0].value).width(),t))[0].select(),void S(y).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){d&&e.target!==d&&S(d).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(e,t){if(!e)return!1;!0===t&&(t=(this.settings.core.themes.dir||S.jstree.path+"/themes")+"/"+e+"/style.css"),t&&-1===S.inArray(t,r)&&(S("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),r.push(t)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(e,t){var r,i,s,a;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.set_icon(e[r],t);return!0}return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&(a=e.icon,e.icon=!0===t||null===t||t===E||""===t||t,s=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===t?(s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),this.hide_icon(e)):(!0===t||null===t||t===E||""===t?s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"):-1===t.indexOf("/")&&-1===t.indexOf(".")?(s.removeClass(a).css("background",""),s.addClass(t+" jstree-themeicon-custom").attr("rel",t)):(s.removeClass(a).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t)),!1===a&&this.show_icon(e)),!0)},get_icon:function(e){return!(!(e=this.get_node(e))||e.id===S.jstree.root)&&e.icon},hide_icon:function(e){var t,r;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.hide_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===S.jstree.root)&&(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var t,r,i;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.show_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===S.jstree.root)&&(i=this.get_node(e,!0),e.icon=!i.length||i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},S.vakata={},S.vakata.attributes=function(e,r){e=S(e)[0];var i=r?{}:[];return e&&e.attributes&&S.each(e.attributes,function(e,t){-1===S.inArray(t.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==t.value&&""!==S.trim(t.value)&&(r?i[t.name]=t.value:i.push(t.name))}),i},S.vakata.array_unique=function(e){for(var t=[],r={},i=0,s=e.length;i<s;i++)r[e[i]]===E&&(t.push(e[i]),r[e[i]]=!0);return t},S.vakata.array_remove=function(e,t){return e.splice(t,1),e},S.vakata.array_remove_item=function(e,t){t=S.inArray(t,e);return-1!==t?S.vakata.array_remove(e,t):e},S.vakata.array_filter=function(e,t,r,i,s){if(e.filter)return e.filter(t,r);for(s in i=[],e)~~s+""==s+""&&0<=s&&t.call(r,e[s],+s,e)&&i.push(e[s]);return i},S.jstree.plugins.changed=function(e,a){var n=[];this.trigger=function(e,t){if(t=t||{},"changed"===e.replace(".jstree","")){t.changed={selected:[],deselected:[]};for(var r={},i=0,s=n.length;i<s;i++)r[n[i]]=1;for(i=0,s=t.selected.length;i<s;i++)r[t.selected[i]]?r[t.selected[i]]=2:t.changed.selected.push(t.selected[i]);for(i=0,s=n.length;i<s;i++)1===r[n[i]]&&t.changed.deselected.push(n[i]);n=t.selected.slice()}a.trigger.call(this,e,t)},this.refresh=function(e,t){return n=[],a.refresh.apply(this,arguments)}};var l,h,_,d,c,u,g,i,f=y.createElement("I");f.className="jstree-icon jstree-checkbox",f.setAttribute("role","presentation"),S.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},S.jstree.plugins.checkbox=function(e,d){this.bind=function(){d.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",S.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",S.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",S.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(S.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",S.proxy(function(e,t){for(var r=this._model.data,i=(r[t.parent],t.nodes),s=0,a=i.length;s<a;s++)r[i[s]].state.checked=r[i[s]].state.checked||r[i[s]].original&&r[i[s]].original.state&&r[i[s]].original.state.checked,r[i[s]].state.checked&&this._data.checkbox.selected.push(i[s])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",S.proxy(function(e,t){var r,i,s,a,n,o,d=this._model.data,c=d[t.parent],l=t.nodes,h=[],t=this.settings.checkbox.cascade,_=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))if(c.state[_?"selected":"checked"]){for(i=0,s=l.length;i<s;i++)d[l[i]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(l)}else for(i=0,s=l.length;i<s;i++)if(d[l[i]].state[_?"selected":"checked"]){for(a=0,n=d[l[i]].children_d.length;a<n;a++)d[d[l[i]].children_d[a]].state[_?"selected":"checked"]=!0;this._data[_?"core":"checkbox"].selected=this._data[_?"core":"checkbox"].selected.concat(d[l[i]].children_d)}if(-1!==t.indexOf("up")){for(i=0,s=c.children_d.length;i<s;i++)d[c.children_d[i]].children.length||h.push(d[c.children_d[i]].parent);for(a=0,n=(h=S.vakata.array_unique(h)).length;a<n;a++)for(c=d[h[a]];c&&c.id!==S.jstree.root;){for(i=r=0,s=c.children.length;i<s;i++)r+=d[c.children[i]].state[_?"selected":"checked"];if(r!==s)break;c.state[_?"selected":"checked"]=!0,this._data[_?"core":"checkbox"].selected.push(c.id),(o=this.get_node(c,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(_?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[_?"core":"checkbox"].selected=S.vakata.array_unique(this._data[_?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",S.proxy(function(e,t){var r,i,s=t.node,a=this._model.data,n=this.get_node(s.parent),t=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection,d={},c=this._data[o?"core":"checkbox"].selected;for(_=0,u=c.length;_<u;_++)d[c[_]]=!0;if(-1!==t.indexOf("down"))for(var l=this._cascade_new_checked_state(s.id,!0),h=s.children_d.concat(s.id),_=0,u=h.length;_<u;_++)-1<l.indexOf(h[_])?d[h[_]]=!0:delete d[h[_]];if(-1!==t.indexOf("up"))for(;n&&n.id!==S.jstree.root;){for(_=r=0,u=n.children.length;_<u;_++)r+=a[n.children[_]].state[o?"selected":"checked"];if(r!==u)break;n.state[o?"selected":"checked"]=!0,d[n.id]=!0,(i=this.get_node(n,!0))&&i.length&&i.attr("aria-selected",!0).children(".jstree-anchor").addClass(o?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(_ in c=[],d)d.hasOwnProperty(_)&&c.push(_);this._data[o?"core":"checkbox"].selected=c},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",S.proxy(function(e,t){for(var r,i=this.get_node(S.jstree.root),s=this._model.data,a=0,n=i.children_d.length;a<n;a++)(r=s[i.children_d[a]])&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",S.proxy(function(e,t){var r,i,s,a,n=t.node,o=(this.get_node(n,!0),this.settings.checkbox.cascade),d=this.settings.checkbox.tie_selection,t=this._data[d?"core":"checkbox"].selected,c=n.children_d.concat(n.id);if(-1!==o.indexOf("down")&&(a=this._cascade_new_checked_state(n.id,!1),t=S.vakata.array_filter(t,function(e){return-1===c.indexOf(e)||-1<a.indexOf(e)})),-1!==o.indexOf("up")&&-1===t.indexOf(n.id)){for(r=0,i=n.parents.length;r<i;r++)(s=this._model.data[n.parents[r]]).state[d?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),(s=this.get_node(n.parents[r],!0))&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked");t=S.vakata.array_filter(t,function(e){return-1===n.parents.indexOf(e)})}this._data[d?"core":"checkbox"].selected=t},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",S.proxy(function(e,t){for(var r,i,s,a,n=this.get_node(t.parent),o=this._model.data,d=this.settings.checkbox.tie_selection;n&&n.id!==S.jstree.root&&!n.state[d?"selected":"checked"];){for(r=s=0,i=n.children.length;r<i;r++)s+=o[n.children[r]].state[d?"selected":"checked"];if(!(0<i&&s===i))break;n.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(n.id),(a=this.get_node(n,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}},this)).on("move_node.jstree",S.proxy(function(e,t){var r,i,s,a,n,o=t.is_multi,d=t.old_parent,t=this.get_node(t.parent),c=this._model.data,l=this.settings.checkbox.tie_selection;if(!o)for(r=this.get_node(d);r&&r.id!==S.jstree.root&&!r.state[l?"selected":"checked"];){for(s=i=0,a=r.children.length;s<a;s++)i+=c[r.children[s]].state[l?"selected":"checked"];if(!(0<a&&i===a))break;r.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(r.id),(n=this.get_node(r,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),r=this.get_node(r.parent)}for(r=t;r&&r.id!==S.jstree.root;){for(s=i=0,a=r.children.length;s<a;s++)i+=c[r.children[s]].state[l?"selected":"checked"];if(i===a)r.state[l?"selected":"checked"]||(r.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(r.id),(n=this.get_node(r,!0))&&n.length&&n.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"));else{if(!r.state[l?"selected":"checked"])break;r.state[l?"selected":"checked"]=!1,this._data[l?"core":"checkbox"].selected=S.vakata.array_remove_item(this._data[l?"core":"checkbox"].selected,r.id),(n=this.get_node(r,!0))&&n.length&&n.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked")}r=this.get_node(r.parent)}},this))},this.get_undetermined=function(e){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var r,i,s={},a=this._model.data,t=this.settings.checkbox.tie_selection,n=this._data[t?"core":"checkbox"].selected,o=[],d=this,c=[],l=0,h=n.length;l<h;l++)if(a[n[l]]&&a[n[l]].parents)for(r=0,i=a[n[l]].parents.length;r<i&&s[a[n[l]].parents[r]]===E;r++)a[n[l]].parents[r]!==S.jstree.root&&(s[a[n[l]].parents[r]]=!0,o.push(a[n[l]].parents[r]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,t=d.get_node(this);if(t)if(t.state.loaded){for(l=0,h=t.children_d.length;l<h;l++)if(!(e=a[t.children_d[l]]).state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined)for(s[e.id]===E&&e.id!==S.jstree.root&&(s[e.id]=!0,o.push(e.id)),r=0,i=e.parents.length;r<i;r++)s[e.parents[r]]===E&&e.parents[r]!==S.jstree.root&&(s[e.parents[r]]=!0,o.push(e.parents[r]))}else if(t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined)for(s[t.id]===E&&t.id!==S.jstree.root&&(s[t.id]=!0,o.push(t.id)),r=0,i=t.parents.length;r<i;r++)s[t.parents[r]]===E&&t.parents[r]!==S.jstree.root&&(s[t.parents[r]]=!0,o.push(t.parents[r]))}),l=0,h=o.length;l<h;l++)a[o[l]].state[t?"selected":"checked"]||c.push(e?a[o[l]]:o[l]);return c},this._undetermined=function(){if(null!==this.element){var e,t,r,i=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=i.length;e<t;e++)(r=this.get_node(i[e],!0))&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,t,r,i){if(e=d.redraw_node.apply(this,arguments)){for(var s=null,a=null,n=0,o=e.childNodes.length;n<o;n++)if(e.childNodes[n]&&e.childNodes[n].className&&-1!==e.childNodes[n].className.indexOf("jstree-anchor")){s=e.childNodes[n];break}s&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(s.className+=" jstree-checked"),a=f.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(a.className+=" jstree-checkbox-disabled"),s.insertBefore(a,s.childNodes[0]))}return r||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(S.proxy(this._undetermined,this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var t,r,i=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,a=this._data[s?"core":"checkbox"].selected,n=this._model.data;if(!e||!0===e.state[s?"selected":"checked"]||-1===i.indexOf("undetermined")||-1===i.indexOf("down")&&-1===i.indexOf("up"))return!1;if(!e.state.loaded&&!0===e.original.state.undetermined)return!0;for(t=0,r=e.children_d.length;t<r;t++)if(-1!==S.inArray(e.children_d[t],a)||!n[e.children_d[t]].state.loaded&&n[e.children_d[t]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(e){var t,r,i;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.disable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;i=this.get_node(e,!0),e.state.checkbox_disabled||(e.state.checkbox_disabled=!0,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:e}))},this.enable_checkbox=function(e){var t,r,i;if(S.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.enable_checkbox(e[t]);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;i=this.get_node(e,!0),e.state.checkbox_disabled&&(e.state.checkbox_disabled=!1,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:e}))},this.activate_node=function(e,t){return!S(t.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||S(t.target).hasClass("jstree-checkbox"))&&(t.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!S(t.target).hasClass("jstree-checkbox")?d.activate_node.call(this,e,t):!this.is_disabled(e)&&(this.is_checked(e)?this.uncheck_node(e,t):this.check_node(e,t),void this.trigger("activate_node",{node:this.get_node(e)})))},this._cascade_new_checked_state=function(e,t){var r,i,s=this.settings.checkbox.tie_selection,a=this._model.data[e],n=[],o=[];if(!this.settings.checkbox.cascade_to_disabled&&a.state.disabled||!this.settings.checkbox.cascade_to_hidden&&a.state.hidden)c=this.get_checked_descendants(e),a.state[s?"selected":"checked"]&&c.push(a.id),n=n.concat(c);else{if(a.children)for(r=0,i=a.children.length;r<i;r++){var d=a.children[r],c=this._cascade_new_checked_state(d,t),n=n.concat(c);-1<c.indexOf(d)&&o.push(d)}var l=this.get_node(a,!0),e=0<o.length&&o.length<a.children.length;a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=e),!e&&t&&o.length===a.children.length?(a.state[s?"selected":"checked"]=t,n.push(a.id),l.attr("aria-selected",!0).children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")):(a.state[s?"selected":"checked"]=!1,l.attr("aria-selected",!1).children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked"))}return n},this.get_checked_descendants=function(e){var t=this,r=t.settings.checkbox.tie_selection,e=t._model.data[e];return S.vakata.array_filter(e.children_d,function(e){return t._model.data[e].state[r?"selected":"checked"]})},this.check_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,t);var r,i,s;if(S.isArray(e)){for(i=0,s=(e=e.slice()).length;i<s;i++)this.check_node(e[i],t);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;r=this.get_node(e,!0),e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.uncheck_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,t);var r,i,s;if(S.isArray(e)){for(r=0,i=(e=e.slice()).length;r<i;r++)this.uncheck_node(e[r],t);return!0}if(!(e=this.get_node(e))||e.id===S.jstree.root)return!1;s=this.get_node(e,!0),e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=S.vakata.array_remove_item(this._data.checkbox.selected,e.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:t}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e,t;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[S.jstree.root].children_d.concat(),e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):!(!(e=this.get_node(e))||e.id===S.jstree.root)&&e.state.checked},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?S.map(this._data.checkbox.selected,S.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);for(var t,r,i=this.get_checked(!0),s={},a=0,n=i.length;a<n;a++)s[i[a].id]=i[a];for(a=0,n=i.length;a<n;a++)for(t=0,r=i[a].children_d.length;t<r;t++)s[i[a].children_d[t]]&&delete s[i[a].children_d[t]];for(a in i=[],s)s.hasOwnProperty(a)&&i.push(a);return e?S.map(i,S.proxy(function(e){return this.get_node(e)},this)):i},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);for(var t=this.get_checked(!0),r=[],i=0,s=t.length;i<s;i++)t[i].children.length||r.push(t[i].id);return e?S.map(r,S.proxy(function(e){return this.get_node(e)},this)):r},this.load_node=function(e,t){var r,i,s;if(!S.isArray(e)&&!this.settings.checkbox.tie_selection&&(s=this.get_node(e))&&s.state.loaded)for(r=0,i=s.children_d.length;r<i;r++)this._model.data[s.children_d[r]].state.checked&&(this._data.checkbox.selected=S.vakata.array_remove_item(this._data.checkbox.selected,s.children_d[r]));return d.load_node.apply(this,arguments)},this.get_state=function(){var e=d.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(e.checkbox=this._data.checkbox.selected.slice()),e},this.set_state=function(e,t){var r,i=d.set_state.apply(this,arguments);return i&&e.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),r=this,S.each(e.checkbox,function(e,t){r.check_node(t)})),delete e.checkbox,this.set_state(e,t),!1):i},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),d.refresh.apply(this,arguments)}},S.jstree.defaults.conditionalselect=function(){return!0},S.jstree.plugins.conditionalselect=function(e,r){this.activate_node=function(e,t){if(this.settings.conditionalselect.call(this,this.get_node(e),t))return r.activate_node.call(this,e,t)}},S.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,t){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(e){var r=S.jstree.reference(e.reference),e=r.get_node(e.reference);r.create_node(e,{},"last",function(t){try{r.edit(t)}catch(e){setTimeout(function(){r.edit(t)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(e){var t=S.jstree.reference(e.reference),e=t.get_node(e.reference);t.edit(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(e){var t=S.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.delete_node(t.get_selected()):t.delete_node(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){var t=S.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.cut(t.get_top_selected()):t.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){var t=S.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.copy(t.get_top_selected()):t.copy(e)}},paste:{separator_before:!1,icon:!1,_disabled:function(e){return!S.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function(e){var t=S.jstree.reference(e.reference),e=t.get_node(e.reference);t.paste(e)}}}}}}},S.jstree.plugins.contextmenu=function(e,a){this.bind=function(){a.bind.call(this);var t,r,i=0,s=null;this.element.on("init.jstree loading.jstree ready.jstree",S.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",S.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),i=e.ctrlKey?+new Date:0,(t||s)&&(i=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",S.proxy(function(e){this._data.contextmenu.visible&&(!i||250<+new Date-i)&&S.vakata.context.hide(),i=0},this)).on("touchstart.jstree",".jstree-anchor",function(e){e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(t=e.originalEvent.changedTouches[0].clientX,r=e.originalEvent.changedTouches[0].clientY,s=setTimeout(function(){S(e.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(10<Math.abs(t-e.originalEvent.changedTouches[0].clientX)||10<Math.abs(r-e.originalEvent.changedTouches[0].clientY))&&(clearTimeout(s),S.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),S(y).on("context_hide.vakata.jstree",S.proxy(function(e,t){this._data.contextmenu.visible=!1,S(t.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&S.vakata.context.hide(),a.teardown.call(this)},this.show_contextmenu=function(t,r,i,e){if(!(t=this.get_node(t))||t.id===S.jstree.root)return!1;var s,a=this.settings.contextmenu,n=this.get_node(t,!0).children(".jstree-anchor"),o=!1;!a.show_at_node&&r!==E&&i!==E||(s=n.offset(),r=s.left,i=s.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(t)&&this.activate_node(t,e),o=a.items,S.isFunction(o)&&(o=o.call(this,t,S.proxy(function(e){this._show_contextmenu(t,r,i,e)},this))),S.isPlainObject(o)&&this._show_contextmenu(t,r,i,o)},this._show_contextmenu=function(e,t,r,i){var s=this.get_node(e,!0).children(".jstree-anchor");S(y).one("context_show.vakata.jstree",S.proxy(function(e,t){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";S(t.element).addClass(r),s.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,S.vakata.context.show(s,{x:t,y:r},i),this.trigger("show_contextmenu",{node:e,x:t,y:r})}},_={element:h=!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1},(l=S).vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){l(y).triggerHandler("context_"+e+".vakata",{reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_execute:function(e){return!(!(e=_.items[e])||e._disabled&&(!l.isFunction(e._disabled)||e._disabled({item:e,reference:_.reference,element:_.element}))||!e.action)&&e.action.call(null,{item:e,reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_parse:function(e,t){if(!e)return!1;t||(_.html="",_.items=[]);var r,i="",s=!1;return t&&(i+="<ul>"),l.each(e,function(e,t){return!t||(_.items.push(t),!s&&t.separator_before&&(i+="<li class='vakata-context-separator'><a href='#' "+(l.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),s=!1,i+="<li class='"+(t._class||"")+(!0===t._disabled||l.isFunction(t._disabled)&&t._disabled({item:t,reference:_.reference,element:_.element})?" vakata-contextmenu-disabled ":"")+"' "+(t.shortcut?" data-shortcut='"+t.shortcut+"' ":"")+">",i+="<a href='#' rel='"+(_.items.length-1)+"' "+(t.title?"title='"+t.title+"'":"")+">",l.vakata.context.settings.icons&&(i+="<i ",t.icon&&(-1!==t.icon.indexOf("/")||-1!==t.icon.indexOf(".")?i+=" style='background:url(\""+t.icon+"\") center center no-repeat' ":i+=" class='"+t.icon+"' "),i+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),i+=(l.isFunction(t.label)?t.label({item:e,reference:_.reference,element:_.element}):t.label)+(t.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+t.shortcut+'">'+(t.shortcut_label||"")+"</span>":"")+"</a>",t.submenu&&(r=l.vakata.context._parse(t.submenu,!0))&&(i+=r),i+="</li>",void(t.separator_after&&(i+="<li class='vakata-context-separator'><a href='#' "+(l.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",s=!0)))}),i=i.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),t&&(i+="</ul>"),t||(_.html=i,l.vakata.context._trigger("parse")),10<i.length&&i},_show_submenu:function(e){var t,r,i,s,a,n,o,d;(e=l(e)).length&&e.children("ul").length&&(t=e.children("ul"),i=(r=e.offset().left)+e.outerWidth(),s=e.offset().top,a=t.width(),n=t.height(),o=l(window).width()+l(window).scrollLeft(),d=l(window).height()+l(window).scrollTop(),h?e[i-(a+10+e.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):e[o<i+a&&o-i<r?"addClass":"removeClass"]("vakata-context-right"),d<s+n+10&&t.css("bottom","-1px"),e.hasClass("vakata-context-right")?r<a&&t.css("margin-right",r-a):o-i<a&&t.css("margin-left",o-i-a),t.show())},show:function(e,t,r){var i,s,a,n,o,d,c;switch(_.element&&_.element.length&&_.element.width(""),!0){case!t&&!e:return!1;case!!t&&!!e:_.reference=e,_.position_x=t.x,_.position_y=t.y;break;case!t&&!!e:i=(_.reference=e).offset(),_.position_x=i.left+e.outerHeight(),_.position_y=i.top;break;case!!t&&!e:_.position_x=t.x,_.position_y=t.y}e&&!r&&l(e).data("vakata_contextmenu")&&(r=l(e).data("vakata_contextmenu")),l.vakata.context._parse(r)&&_.element.html(_.html),_.items.length&&(_.element.appendTo(y.body),s=_.element,a=_.position_x,n=_.position_y,o=s.width(),d=s.height(),c=l(window).width()+l(window).scrollLeft(),r=l(window).height()+l(window).scrollTop(),h&&(a-=s.outerWidth()-l(e).outerWidth())<l(window).scrollLeft()+20&&(a=l(window).scrollLeft()+20),c<a+o+20&&(a=c-(o+20)),r<n+d+20&&(n=r-(d+20)),_.element.css({left:a,top:n}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),_.is_visible=!0,l.vakata.context._trigger("show"))},hide:function(){_.is_visible&&(_.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),_.is_visible=!1,l.vakata.context._trigger("hide"))}},l(function(){h="rtl"===l(y.body).css("direction");var t=!1;_.element=l("<ul class='vakata-context'></ul>"),_.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),l.contains(this,e.relatedTarget)||(t&&clearTimeout(t),_.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),l(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),l.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){l.contains(this,e.relatedTarget)||l(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){l(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),l.vakata.context.settings.hide_onmouseleave&&(t=setTimeout(function(){l.vakata.context.hide()},l.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),l(this).blur().parent().hasClass("vakata-context-disabled")||!1===l.vakata.context._execute(l(this).attr("rel"))||l.vakata.context.hide()}).on("keydown","a",function(e){var t=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),l(e.currentTarget).trigger(e);break;case 37:_.is_visible&&(_.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 38:_.is_visible&&((t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(t=_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 39:_.is_visible&&(_.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 40:_.is_visible&&((t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(t=_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 27:l.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();e=_.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();e.parent().not(".vakata-context-disabled")&&e.click()}),l(y).on("mousedown.vakata.jstree",function(e){_.is_visible&&_.element[0]!==e.target&&!l.contains(_.element[0],e.target)&&l.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,t){_.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),h&&_.element.addClass("vakata-context-rtl").css("direction","rtl"),_.element.find("ul").hide().end()})}),S.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},S.jstree.plugins.dnd=function(e,o){this.init=function(e,t){o.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in y.createElement("span")},this.bind=function(){o.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",S.proxy(function(e){if(this.settings.dnd.large_drag_target&&S(e.target).closest(".jstree-node")[0]!==e.currentTarget)return!0;if("touchstart"===e.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!S(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var t=this.get_node(e.target),r=this.is_selected(t)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,i=1<r?r+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text&&(i=S.vakata.html.escape(i)),t&&t.id&&t.id!==S.jstree.root&&(1===e.which||"touchstart"===e.type||"dragstart"===e.type)&&(!0===this.settings.dnd.is_draggable||S.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<r?this.get_top_selected(!0):[t],e))){if(d={jstree:!0,origin:this,obj:this.get_node(t,!0),nodes:1<r?this.get_top_selected():[t.id]},c=e.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),S.vakata.dnd.start(e,d,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+i+'<ins class="jstree-copy" style="display:none;">+</ins></div>');S.vakata.dnd._trigger("start",e,{helper:S(),element:c,data:d})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(e){return e.preventDefault(),S.vakata.dnd._trigger("move",e,{helper:S(),element:c,data:d}),!1}).on("drop.jstree",S.proxy(function(e){return e.preventDefault(),S.vakata.dnd._trigger("stop",e,{helper:S(),element:c,data:d}),!1},this))},this.redraw_node=function(e,t,r,i){if((e=o.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{for(var s=null,a=0,n=e.childNodes.length;a<n;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&s.setAttribute("draggable",!0)}return e}},S(function(){var C=!1,A=!1,T=!1,N=!1,O=S('<div id="jstree-marker">&#160;</div>').hide();S(y).on("dragover.vakata.jstree",function(e){c&&S.vakata.dnd._trigger("move",e,{helper:S(),element:c,data:d})}).on("drop.vakata.jstree",function(e){c&&(S.vakata.dnd._trigger("stop",e,{helper:S(),element:c,data:d}),d=c=null)}).on("dnd_start.vakata.jstree",function(e,t){T=C=!1,t&&t.data&&t.data.jstree&&O.appendTo(y.body)}).on("dnd_move.vakata.jstree",function(e,s){var a=s.event.target!==T.target;if(N&&(s.event&&"dragover"===s.event.type&&!a||clearTimeout(N)),s&&s.data&&s.data.jstree&&(!s.event.target.id||"jstree-marker"!==s.event.target.id)){T=s.event;var n,t,o,d,c,l,h,_,u,g,f,p,m,v,j,y,k,x,b=S.jstree.reference(s.event.target),w=!1;if(b&&b._data&&b._data.dnd)if(O.attr("class","jstree-"+b.get_theme()+(b.settings.core.themes.responsive?" jstree-dnd-responsive":"")),k=s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey)),s.helper.children().attr("class","jstree-"+b.get_theme()+" jstree-"+b.get_theme()+"-"+b.get_theme_variant()+" "+(b.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[k?"show":"hide"](),s.event.target!==b.element[0]&&s.event.target!==b.get_container_ul()[0]||0!==b.get_container_ul().children().length){if(w=b.settings.dnd.large_drop_target?S(s.event.target).closest(".jstree-node").children(".jstree-anchor"):S(s.event.target).closest(".jstree-anchor"),w&&w.length&&w.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(n=w.offset(),t=(s.event.pageY!==E?s.event:s.event.originalEvent).pageY-n.top,c=w.outerHeight(),_=t<c/3?["b","i","a"]:c-c/3<t?["a","i","b"]:c/2<t?["i","a","b"]:["i","b","a"],S.each(_,function(e,t){switch(t){case"b":o=n.left-6,d=n.top,l=b.get_parent(w),h=w.parent().index();break;case"i":j=b.settings.dnd.inside_pos,y=b.get_node(w.parent()),o=n.left-2,d=n.top+c/2+1,l=y.id,h="first"===j?0:"last"===j?y.children.length:Math.min(j,y.children.length);break;case"a":o=n.left-6,d=n.top+c,l=b.get_parent(w),h=w.parent().index()+1}for(u=!0,g=0,f=s.data.nodes.length;g<f;g++)if(p=s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",m=h,"move_node"==p&&"a"===t&&s.data.origin&&s.data.origin===b&&l===b.get_parent(s.data.nodes[g])&&(v=b.get_node(l),m>S.inArray(s.data.nodes[g],v.children)&&--m),!(u=u&&(b&&b.settings&&b.settings.dnd&&!1===b.settings.dnd.check_while_dragging||b.check(p,s.data.origin&&s.data.origin!==b?s.data.origin.get_node(s.data.nodes[g]):s.data.nodes[g],l,m,{dnd:!0,ref:b.get_node(w.parent()),pos:t,origin:s.data.origin,is_multi:s.data.origin&&s.data.origin!==b,is_foreign:!s.data.origin})))){b&&b.last_error&&(A=b.last_error());break}var r,i;if("i"===t&&w.parent().is(".jstree-closed")&&b.settings.dnd.open_timeout&&(s.event&&"dragover"===s.event.type&&!a||(N&&clearTimeout(N),N=setTimeout((i=w,function(){r.open_node(i)}),(r=b).settings.dnd.open_timeout))),u)return(x=b.get_node(l,!0)).hasClass(".jstree-dnd-parent")||(S(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),x.addClass("jstree-dnd-parent")),C={ins:b,par:l,pos:"i"!==t||"last"!==j||0!==h||b.is_loaded(y)?h:"last"},O.css({left:o+"px",top:d+"px"}).show(),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),s.event.originalEvent&&s.event.originalEvent.dataTransfer&&(s.event.originalEvent.dataTransfer.dropEffect=k?"copy":"move"),A={},!(_=!0)}),!0===_))return}else{for(u=!0,g=0,f=s.data.nodes.length;g<f&&(u=u&&b.check(s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node",s.data.origin&&s.data.origin!==b?s.data.origin.get_node(s.data.nodes[g]):s.data.nodes[g],S.jstree.root,"last",{dnd:!0,ref:b.get_node(S.jstree.root),pos:"i",origin:s.data.origin,is_multi:s.data.origin&&s.data.origin!==b,is_foreign:!s.data.origin}));g++);if(u)return C={ins:b,par:S.jstree.root,pos:"last"},O.hide(),s.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(s.event.originalEvent&&s.event.originalEvent.dataTransfer&&(s.event.originalEvent.dataTransfer.dropEffect=k?"copy":"move"))}S(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),C=!1,s.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),s.event.originalEvent&&s.event.originalEvent.dataTransfer,O.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(O.hide(),T=C=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,t){if(S(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),N&&clearTimeout(N),t&&t.data&&t.data.jstree){O.hide().detach();var r,i,s=[];if(C){for(r=0,i=t.data.nodes.length;r<i;r++)s[r]=t.data.origin?t.data.origin.get_node(t.data.nodes[r]):t.data.nodes[r];C.ins[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(t.event.metaKey||t.event.ctrlKey))?"copy_node":"move_node"](s,C.par,C.pos,!1,!1,!1,t.data.origin)}else(r=S(t.event.target).closest(".jstree")).length&&A&&A.error&&"check"===A.error&&(r=r.jstree(!0))&&r.settings.core.error.call(this,A);C=T=!1}}).on("keyup.jstree keydown.jstree",function(e,t){(t=S.vakata.dnd._get())&&t.data&&t.data.jstree&&("keyup"===e.type&&27===e.which?(N&&clearTimeout(N),N=T=A=C=!1,O.hide().detach(),S.vakata.dnd._clean()):(t.helper.find(".jstree-copy").first()[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"](),T&&(T.metaKey=e.metaKey,T.ctrlKey=e.ctrlKey,S.vakata.dnd._trigger("move",T))))})}),g={element:!((u=S).vakata.html={div:u("<div />"),escape:function(e){return u.vakata.html.div.text(e).html()},strip:function(e){return u.vakata.html.div.empty().append(u.parseHTML(e)).text()}}),target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},u.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(e,t,r){r===E&&(r=u.vakata.dnd._get()),r.event=t,u(y).triggerHandler("dnd_"+e+".vakata",r)},_get:function(){return{data:g.data,element:g.element,helper:g.helper}},_clean:function(){g.helper&&g.helper.remove(),g.scroll_i&&(clearInterval(g.scroll_i),g.scroll_i=!1),g={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},u(y).off("mousemove.vakata.jstree touchmove.vakata.jstree",u.vakata.dnd.drag),u(y).off("mouseup.vakata.jstree touchend.vakata.jstree",u.vakata.dnd.stop)},_scroll:function(e){if(!g.scroll_e||!g.scroll_l&&!g.scroll_t)return g.scroll_i&&(clearInterval(g.scroll_i),g.scroll_i=!1),!1;if(!g.scroll_i)return g.scroll_i=setInterval(u.vakata.dnd._scroll,100),!1;if(!0===e)return!1;var t=g.scroll_e.scrollTop(),e=g.scroll_e.scrollLeft();g.scroll_e.scrollTop(t+g.scroll_t*u.vakata.dnd.settings.scroll_speed),g.scroll_e.scrollLeft(e+g.scroll_l*u.vakata.dnd.settings.scroll_speed),t===g.scroll_e.scrollTop()&&e===g.scroll_e.scrollLeft()||u.vakata.dnd._trigger("scroll",g.scroll_e)},start:function(e,t,r){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=y.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),g.is_drag&&u.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(e){}return g.init_x=e.pageX,g.init_y=e.pageY,g.data=t,g.is_down=!0,g.element=e.currentTarget,g.target=e.target,g.is_touch="touchstart"===e.type,!1!==r&&(g.helper=u("<div id='vakata-dnd'></div>").html(r).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),u(y).on("mousemove.vakata.jstree touchmove.vakata.jstree",u.vakata.dnd.drag),u(y).on("mouseup.vakata.jstree touchend.vakata.jstree",u.vakata.dnd.stop),!1},drag:function(r){if("touchmove"===r.type&&r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(r.pageX=r.originalEvent.changedTouches[0].pageX,r.pageY=r.originalEvent.changedTouches[0].pageY,r.target=y.elementFromPoint(r.originalEvent.changedTouches[0].pageX-window.pageXOffset,r.originalEvent.changedTouches[0].pageY-window.pageYOffset)),g.is_down){if(!g.is_drag){if(!(Math.abs(r.pageX-g.init_x)>(g.is_touch?u.vakata.dnd.settings.threshold_touch:u.vakata.dnd.settings.threshold)||Math.abs(r.pageY-g.init_y)>(g.is_touch?u.vakata.dnd.settings.threshold_touch:u.vakata.dnd.settings.threshold)))return;g.helper&&(g.helper.appendTo(y.body),g.helper_w=g.helper.outerWidth()),g.is_drag=!0,u(g.target).one("click.vakata",!1),u.vakata.dnd._trigger("start",r)}var e,t,i,s,a=!1,n=!1,o=!1,d=!1,c=!1,l=!1;return g.scroll_t=0,g.scroll_l=0,g.scroll_e=!1,u(u(r.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(u(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var e=u(this),t=e.offset();if(this.scrollHeight>this.offsetHeight&&(t.top+e.height()-r.pageY<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_t=1),r.pageY-t.top<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(t.left+e.width()-r.pageX<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_l=1),r.pageX-t.left<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_l=-1)),g.scroll_t||g.scroll_l)return g.scroll_e=u(this),!1}),g.scroll_e||(a=u(y),n=u(window),o=a.height(),e=n.height(),d=a.width(),t=n.width(),i=a.scrollTop(),s=a.scrollLeft(),e<o&&r.pageY-i<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_t=-1),e<o&&e-(r.pageY-i)<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_t=1),t<d&&r.pageX-s<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_l=-1),t<d&&t-(r.pageX-s)<u.vakata.dnd.settings.scroll_proximity&&(g.scroll_l=1),(g.scroll_t||g.scroll_l)&&(g.scroll_e=a)),g.scroll_e&&u.vakata.dnd._scroll(!0),g.helper&&(c=parseInt(r.pageY+u.vakata.dnd.settings.helper_top,10),l=parseInt(r.pageX+u.vakata.dnd.settings.helper_left,10),o&&o<c+25&&(c=o-50),d&&l+g.helper_w>d&&(l=d-(g.helper_w+2)),g.helper.css({left:l+"px",top:c+"px"})),u.vakata.dnd._trigger("move",r),!1}},stop:function(e){var t;return"touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=y.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),g.is_drag?(e.target!==g.target&&u(g.target).off("click.vakata"),u.vakata.dnd._trigger("stop",e)):"touchend"===e.type&&e.target===g.target&&(t=setTimeout(function(){u(e.target).click()},100),u(e.target).one("click",function(){t&&clearTimeout(t)})),u.vakata.dnd._clean(),!1}},S.jstree.defaults.massload=null,S.jstree.plugins.massload=function(e,l){this.init=function(e,t){this._data.massload={},l.init.call(this,e,t)},this._load_nodes=function(a,n,o,d){var e,t,c,r=this.settings.massload,i=(JSON.stringify(a),[]),s=this._model.data;if(!o){for(e=0,t=a.length;e<t;e++)s[a[e]]&&(s[a[e]].state.loaded||s[a[e]].state.failed)&&!d||(i.push(a[e]),(c=this.get_node(a[e],!0))&&c.length&&c.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},i.length){if(S.isFunction(r))return r.call(this,i,S.proxy(function(e){var t,r;if(e)for(t in e)e.hasOwnProperty(t)&&(this._data.massload[t]=e[t]);for(t=0,r=a.length;t<r;t++)(c=this.get_node(a[t],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,a,n,o,d)},this));if("object"==typeof r&&r&&r.url)return r=S.extend(!0,{},r),S.isFunction(r.url)&&(r.url=r.url.call(this,i)),S.isFunction(r.data)&&(r.data=r.data.call(this,i)),S.ajax(r).done(S.proxy(function(e,t,r){var i,s;if(e)for(i in e)e.hasOwnProperty(i)&&(this._data.massload[i]=e[i]);for(i=0,s=a.length;i<s;i++)(c=this.get_node(a[i],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);l._load_nodes.call(this,a,n,o,d)},this)).fail(S.proxy(function(e){l._load_nodes.call(this,a,n,o,d)},this))}}return l._load_nodes.call(this,a,n,o,d)},this._load_node=function(e,t){var r,i=this._data.massload[e.id];return i?(r=this["string"==typeof i?"_append_html_data":"_append_json_data"](e,"string"==typeof i?S(S.parseHTML(i)).filter(function(){return 3!==this.nodeType}):i,function(e){t.call(this,e)}),(i=this.get_node(e.id,!0))&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[e.id],r):l._load_node.call(this,e,t)}},S.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},S.jstree.plugins.search=function(e,o){this.bind=function(){o.bind.call(this),this._data.search.str="",this._data.search.dom=S(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",S.proxy(function(e,t){if(this._data.search.som&&t.res.length){for(var r,i,s=this._model.data,a=[],n=0,o=t.res.length;n<o;n++)if(s[t.res[n]]&&!s[t.res[n]].state.hidden&&(a.push(t.res[n]),a=a.concat(s[t.res[n]].parents),this._data.search.smc))for(r=0,i=s[t.res[n]].children_d.length;r<i;r++)s[s[t.res[n]].children_d[r]]&&!s[s[t.res[n]].children_d[r]].state.hidden&&a.push(s[t.res[n]].children_d[r]);a=S.vakata.array_remove_item(S.vakata.array_unique(a),S.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(a,!0),this.redraw(!0)}},this)).on("clear_search.jstree",S.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(i,e,t,r,s,a){if(!1===i||""===S.trim(i.toString()))return this.clear_search();r=(r=this.get_node(r))&&r.id?r.id:null,i=i.toString();var n,o,d=this.settings.search,c=d.ajax||!1,l=this._model.data,h=null,_=[],u=[];if(this._data.search.res.length&&!s&&this.clear_search(),t===E&&(t=d.show_only_matches),a===E&&(a=d.show_only_matches_children),!e&&!1!==c)return S.isFunction(c)?c.call(this,i,S.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(S.isArray(e)?S.vakata.array_unique(e):[],function(){this.search(i,!0,t,r,s,a)})},this),r):((c=S.extend({},c)).data||(c.data={}),c.data.str=i,r&&(c.data.inside=r),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=S.ajax(c).fail(S.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(c)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(S.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(S.isArray(e)?S.vakata.array_unique(e):[],function(){this.search(i,!0,t,r,s,a)})},this)),this._data.search.lastRequest);if(s||(this._data.search.str=i,this._data.search.dom=S(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=t,this._data.search.smc=a),h=new S.vakata.search(i,!0,{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy}),S.each(l[r||S.jstree.root].children_d,function(e,t){var r=l[t];r.text&&!r.state.hidden&&(!d.search_leaves_only||r.state.loaded&&0===r.children.length)&&(d.search_callback&&d.search_callback.call(this,i,r)||!d.search_callback&&h.search(r.text).isMatch)&&(_.push(t),u=u.concat(r.parents))}),_.length){for(n=0,o=(u=S.vakata.array_unique(u)).length;n<o;n++)u[n]!==S.jstree.root&&l[u[n]]&&!0===this.open_node(u[n],null,0)&&this._data.search.opn.push(u[n]);s?(this._data.search.dom=this._data.search.dom.add(S(this.element[0].querySelectorAll("#"+S.map(_,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(S.jstree.idregex,"\\$&"):e.replace(S.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=S.vakata.array_unique(this._data.search.res.concat(_))):(this._data.search.dom=S(this.element[0].querySelectorAll("#"+S.map(_,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(S.jstree.idregex,"\\$&"):e.replace(S.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=_),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:t})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=S(this.element[0].querySelectorAll("#"+S.map(this._data.search.res,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(S.jstree.idregex,"\\$&"):e.replace(S.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=S()},this.redraw_node=function(e,t,r,i){if(e=o.redraw_node.apply(this,arguments),e&&-1!==S.inArray(e.id,this._data.search.res)){for(var s=null,a=0,n=e.childNodes.length;a<n;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&(s.className+=" jstree-search")}return e}},(i=S).vakata.search=function(p,e,m){m=m||{},!1!==(m=i.extend({},i.vakata.search.defaults,m)).fuzzy&&(m.fuzzy=!0),p=m.caseSensitive?p:p.toLowerCase();var v,j,y,t,k=m.location,r=m.distance,x=m.threshold,b=p.length;return 32<b&&(m.fuzzy=!1),m.fuzzy&&(v=1<<b-1,j=function(){for(var e={},t=0,t=0;t<b;t++)e[p.charAt(t)]=0;for(t=0;t<b;t++)e[p.charAt(t)]|=1<<b-t-1;return e}(),y=function(e,t){e/=b,t=Math.abs(k-t);return r?e+t/r:t?1:e}),t=function(e){if(e=m.caseSensitive?e:e.toLowerCase(),p===e||-1!==e.indexOf(p))return{isMatch:!0,score:0};if(!m.fuzzy)return{isMatch:!1,score:1};var t,r,i,s,a,n,o,d,c,l=e.length,h=x,_=e.indexOf(p,k),u=b+l,g=1,f=[];for(-1!==_&&(h=Math.min(y(0,_),h),-1!==(_=e.lastIndexOf(p,k+b))&&(h=Math.min(y(0,_),h))),_=-1,t=0;t<b;t++){for(i=0,s=u;i<s;)y(t,k+s)<=h?i=s:u=s,s=Math.floor((u-i)/2+i);for(u=s,n=Math.max(1,k-s+1),o=Math.min(k+s,l)+b,(d=new Array(o+2))[o+1]=(1<<t)-1,r=o;n<=r;r--)if(c=j[e.charAt(r-1)],d[r]=0===t?(d[r+1]<<1|1)&c:(d[r+1]<<1|1)&c|(a[r+1]|a[r])<<1|1|a[r+1],d[r]&v&&(g=y(t,r-1))<=h){if(h=g,_=r-1,f.push(_),!(k<_))break;n=Math.max(1,2*k-_)}if(y(t+1,k)>h)break;a=d}return{isMatch:0<=_,score:g}},!0===e?{search:t}:t(e)},i.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1},S.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};var p=!(S.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("model.jstree",S.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",S.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",S.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(e,t){var r,i;if(e=this.get_node(e),e&&e.children&&e.children.length&&(e.children.sort(S.proxy(this.settings.sort,this)),t))for(r=0,i=e.children_d.length;r<i;r++)this.sort(e.children_d[r],!1)}});S.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},S.jstree.plugins.state=function(e,t){this.bind=function(){t.bind.call(this);var r=S.proxy(function(){this.element.on(this.settings.state.events,S.proxy(function(){p&&clearTimeout(p),p=setTimeout(S.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",S.proxy(function(e,t){this.element.one("restore_state.jstree",r),this.restore_state()||r()},this))},this.save_state=function(){var e=this.get_state();this.settings.state.preserve_loaded||delete e.core.loaded;e={state:e,ttl:this.settings.state.ttl,sec:+new Date};S.vakata.storage.set(this.settings.state.key,JSON.stringify(e))},this.restore_state=function(){var r=S.vakata.storage.get(this.settings.state.key);if(r)try{r=JSON.parse(r)}catch(e){return!1}return!(r&&r.ttl&&r.sec&&+new Date-r.sec>r.ttl)&&(r&&r.state&&(r=r.state),r&&S.isFunction(this.settings.state.filter)&&(r=this.settings.state.filter.call(this,r)),!!r&&(this.settings.state.preserve_loaded||delete r.core.loaded,this.element.one("set_state.jstree",function(e,t){t.instance.trigger("restore_state",{state:S.extend(!0,{},r)})}),this.set_state(r),!0))},this.clear_state=function(){return S.vakata.storage.del(this.settings.state.key)}},S.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},S.jstree.defaults.types={default:{}},S.jstree.defaults.types[S.jstree.root]={},S.jstree.plugins.types=function(e,l){this.init=function(e,t){var r,i;if(t&&t.types&&t.types.default)for(r in t.types)if("default"!==r&&r!==S.jstree.root&&t.types.hasOwnProperty(r))for(i in t.types.default)t.types.default.hasOwnProperty(i)&&t.types[r][i]===E&&(t.types[r][i]=t.types.default[i]);l.init.call(this,e,t),this._model.data[S.jstree.root].type=S.jstree.root},this.refresh=function(e,t){l.refresh.call(this,e,t),this._model.data[S.jstree.root].type=S.jstree.root},this.bind=function(){this.element.on("model.jstree",S.proxy(function(e,t){for(var r,i=this._model.data,s=t.nodes,a=this.settings.types,n="default",o=0,d=s.length;o<d;o++){if(n="default",i[s[o]].original&&i[s[o]].original.type&&a[i[s[o]].original.type]&&(n=i[s[o]].original.type),i[s[o]].data&&i[s[o]].data.jstree&&i[s[o]].data.jstree.type&&a[i[s[o]].data.jstree.type]&&(n=i[s[o]].data.jstree.type),i[s[o]].type=n,!0===i[s[o]].icon&&a[n].icon!==E&&(i[s[o]].icon=a[n].icon),a[n].li_attr!==E&&"object"==typeof a[n].li_attr)for(r in a[n].li_attr)a[n].li_attr.hasOwnProperty(r)&&"id"!==r&&(i[s[o]].li_attr[r]===E?i[s[o]].li_attr[r]=a[n].li_attr[r]:"class"===r&&(i[s[o]].li_attr.class=a[n].li_attr.class+" "+i[s[o]].li_attr.class));if(a[n].a_attr!==E&&"object"==typeof a[n].a_attr)for(r in a[n].a_attr)a[n].a_attr.hasOwnProperty(r)&&"id"!==r&&(i[s[o]].a_attr[r]===E?i[s[o]].a_attr[r]=a[n].a_attr[r]:"href"===r&&"#"===i[s[o]].a_attr[r]?i[s[o]].a_attr.href=a[n].a_attr.href:"class"===r&&(i[s[o]].a_attr.class=a[n].a_attr.class+" "+i[s[o]].a_attr.class))}i[S.jstree.root].type=S.jstree.root},this)),l.bind.call(this)},this.get_json=function(e,t,r){var i,s,a=this._model.data,n=t?S.extend(!0,{},t,{no_id:!1}):{},o=l.get_json.call(this,e,n,r);if(!1===o)return!1;if(S.isArray(o))for(i=0,s=o.length;i<s;i++)o[i].type=o[i].id&&a[o[i].id]&&a[o[i].id].type?a[o[i].id].type:"default",t&&t.no_id&&(delete o[i].id,o[i].li_attr&&o[i].li_attr.id&&delete o[i].li_attr.id,o[i].a_attr&&o[i].a_attr.id&&delete o[i].a_attr.id);else o.type=o.id&&a[o.id]&&a[o.id].type?a[o.id].type:"default",t&&t.no_id&&(o=this._delete_ids(o));return o},this._delete_ids=function(e){if(S.isArray(e)){for(var t=0,r=e.length;t<r;t++)e[t]=this._delete_ids(e[t]);return e}return delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&S.isArray(e.children)&&(e.children=this._delete_ids(e.children)),e},this.check=function(e,t,r,i,s){if(!1===l.check.call(this,e,t,r,i,s))return!1;t=t&&t.id?t:this.get_node(t),r=r&&r.id?r:this.get_node(r);var a,n,o,d,c=(c=t&&t.id?s&&s.origin?s.origin:S.jstree.reference(t.id):null)&&c._model&&c._model.data?c._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===S.inArray(t.id,r.children)){if((a=this.get_rules(r)).max_children!==E&&-1!==a.max_children&&a.max_children===r.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})});if(a.valid_children!==E&&-1!==a.valid_children&&-1===S.inArray(t.type||"default",a.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})});if(c&&t.children_d&&t.parents){for(o=n=0,d=t.children_d.length;o<d;o++)n=Math.max(n,c[t.children_d[o]].parents.length);n=n-t.parents.length+1}(n<=0||n===E)&&(n=1);do{if(a.max_depth!==E&&-1!==a.max_depth&&a.max_depth<n)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})})}while(r=this.get_node(r.parent),a=this.get_rules(r),n++,r)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;e=this.get_type(e,!0);return e.max_depth===E&&(e.max_depth=-1),e.max_children===E&&(e.max_children=-1),e.valid_children===E&&(e.valid_children=-1),e},this.get_type=function(e,t){return!!(e=this.get_node(e))&&(t?S.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(e,t){var r,i,s,a,n,o,d,c,l=this._model.data;if(S.isArray(e)){for(i=0,s=(e=e.slice()).length;i<s;i++)this.set_type(e[i],t);return!0}if(r=this.settings.types,e=this.get_node(e),!r[t]||!e)return!1;if((d=this.get_node(e,!0))&&d.length&&(c=d.children(".jstree-anchor")),a=e.type,n=this.get_icon(e),e.type=t,!0!==n&&r[a]&&(r[a].icon===E||n!==r[a].icon)||this.set_icon(e,r[t].icon===E||r[t].icon),r[a]&&r[a].li_attr!==E&&"object"==typeof r[a].li_attr)for(o in r[a].li_attr)r[a].li_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(l[e.id].li_attr.class=(l[e.id].li_attr.class||"").replace(r[a].li_attr[o],""),d&&d.removeClass(r[a].li_attr[o])):l[e.id].li_attr[o]===r[a].li_attr[o]&&(l[e.id].li_attr[o]=null,d&&d.removeAttr(o)));if(r[a]&&r[a].a_attr!==E&&"object"==typeof r[a].a_attr)for(o in r[a].a_attr)r[a].a_attr.hasOwnProperty(o)&&"id"!==o&&("class"===o?(l[e.id].a_attr.class=(l[e.id].a_attr.class||"").replace(r[a].a_attr[o],""),c&&c.removeClass(r[a].a_attr[o])):l[e.id].a_attr[o]===r[a].a_attr[o]&&("href"===o?(l[e.id].a_attr[o]="#",c&&c.attr("href","#")):(delete l[e.id].a_attr[o],c&&c.removeAttr(o))));if(r[t].li_attr!==E&&"object"==typeof r[t].li_attr)for(o in r[t].li_attr)r[t].li_attr.hasOwnProperty(o)&&"id"!==o&&(l[e.id].li_attr[o]===E?(l[e.id].li_attr[o]=r[t].li_attr[o],d&&("class"===o?d.addClass(r[t].li_attr[o]):d.attr(o,r[t].li_attr[o]))):"class"===o&&(l[e.id].li_attr.class=r[t].li_attr[o]+" "+l[e.id].li_attr.class,d&&d.addClass(r[t].li_attr[o])));if(r[t].a_attr!==E&&"object"==typeof r[t].a_attr)for(o in r[t].a_attr)r[t].a_attr.hasOwnProperty(o)&&"id"!==o&&(l[e.id].a_attr[o]===E?(l[e.id].a_attr[o]=r[t].a_attr[o],c&&("class"===o?c.addClass(r[t].a_attr[o]):c.attr(o,r[t].a_attr[o]))):"href"===o&&"#"===l[e.id].a_attr[o]?(l[e.id].a_attr.href=r[t].a_attr.href,c&&c.attr("href",r[t].a_attr.href)):"class"===o&&(l[e.id].a_attr.class=r[t].a_attr.class+" "+l[e.id].a_attr.class,c&&c.addClass(r[t].a_attr[o])));return!0}},S.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},S.jstree.plugins.unique=function(e,f){this.check=function(e,t,r,i,s){if(!1===f.check.call(this,e,t,r,i,s))return!1;if(t=t&&t.id?t:this.get_node(t),!(r=r&&r.id?r:this.get_node(r))||!r.children)return!0;for(var a,n="rename_node"===e?i:t.text,o=[],d=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,l=this._model.data,h=0,_=r.children.length;h<_;h++)a=l[r.children[h]].text,d||(a=a.toLowerCase()),c&&(a=a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),o.push(a);switch(d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),e){case"delete_node":return!0;case"rename_node":return a=t.text||"",d||(a=a.toLowerCase()),c&&(a=a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(h=-1===S.inArray(n,o)||t.text&&a===n)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})}),h;case"create_node":return(h=-1===S.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})}),h;case"copy_node":return(h=-1===S.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})}),h;case"move_node":return(h=t.parent===r.id&&(!s||!s.is_multi)||-1===S.inArray(n,o))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+n+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!r||!r.id)&&r.id})}),h}return!0},this.create_node=function(e,t,r,i,s){if(!t||t.text===E){if(null===e&&(e=S.jstree.root),!(e=this.get_node(e)))return f.create_node.call(this,e,t,r,i,s);if(!(r=r===E?"last":r).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(e))return f.create_node.call(this,e,t,r,i,s);t=t||{};for(var a,n,o=this._model.data,d=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,l=this.settings.unique.duplicate,h=a=this.get_string("New node"),_=[],u=0,g=e.children.length;u<g;u++)n=o[e.children[u]].text,d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),_.push(n);for(u=1,n=h,d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==S.inArray(n,_);)n=h=l.call(this,a,++u).toString(),d||(n=n.toLowerCase()),c&&(n=n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));t.text=h}return f.create_node.call(this,e,t,r,i,s)}};var m=y.createElement("DIV");if(m.setAttribute("unselectable","on"),m.setAttribute("role","presentation"),m.className="jstree-wholerow",m.innerHTML="&#160;",S.jstree.plugins.wholerow=function(e,a){this.bind=function(){a.bind.call(this),this.element.on("ready.jstree set_state.jstree",S.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",S.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",S.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",S.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var r=!1,i=0,s=t.selected.length;i<s;i++)(r=this.get_node(t.selected[i],!0))&&r.length&&r.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",S.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",S.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",S.proxy(function(e){var t;this._data.contextmenu&&(e.preventDefault(),t=S.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY}),S(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t))},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=S.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});S(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()}).on("dblclick.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=S.Event("dblclick",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});S(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",S.proxy(function(e){e.stopImmediatePropagation();var t=S.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});S(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",S.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",S.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),a.teardown.call(this)},this.redraw_node=function(e,t,r,i){var s;return(e=a.redraw_node.apply(this,arguments))&&(s=m.cloneNode(!0),-1!==S.inArray(e.id,this._data.core.selected)&&(s.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===e.id&&(s.className+=" jstree-wholerow-hovered"),e.insertBefore(s,e.childNodes[0])),e}},window.customElements&&Object&&Object.create){var t=Object.create(HTMLElement.prototype);t.createdCallback=function(){var e,t={core:{},plugins:[]};for(e in S.jstree.plugins)S.jstree.plugins.hasOwnProperty(e)&&this.attributes[e]&&(t.plugins.push(e),this.getAttribute(e)&&JSON.parse(this.getAttribute(e))&&(t[e]=JSON.parse(this.getAttribute(e))));for(e in S.jstree.defaults.core)S.jstree.defaults.core.hasOwnProperty(e)&&this.attributes[e]&&(t.core[e]=JSON.parse(this.getAttribute(e))||this.getAttribute(e));S(this).jstree(t)};try{window.customElements.define("vakata-jstree",function(){},{prototype:t})}catch(e){}}}});
var leafletControlGeocoder=function(c){function n(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function p(t,e){return c.Util.extend(e,t.geocodingQueryParams)}function u(t,e){return c.Util.extend(e,t.reverseQueryParams)}var r=0,s=/[&<>"'`]/g,i=/[&<>"'`]/,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function a(t){return e[t]}function l(t,e,o,n,s){var i="_l_geocoder_"+r++;e[s||"callback"]=i,window[i]=c.Util.bind(o,n);n=document.createElement("script");n.type="text/javascript",n.src=t+g(e),n.id=i,document.getElementsByTagName("head")[0].appendChild(n)}function d(t,e,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){var e;if(200!==n.status&&304!==n.status)e="";else if("string"==typeof n.response)try{e=JSON.parse(n.response)}catch(t){e=n.response}else e=n.response;o(e)}},n.open("GET",t+g(e),!0),n.responseType="json",n.setRequestHeader("Accept","application/json"),n.send(null)}function h(t,o){return t.replace(/\{ *([\w_]+) *\}/g,function(t,e){e=o[e];return void 0===e?e="":"function"==typeof e&&(e=e(o)),null==(e=e)?"":e?(e=""+e,i.test(e)?e.replace(s,a):e):e+""})}function g(t,e,o){var n,s=[];for(n in t){var i=encodeURIComponent(o?n.toUpperCase():n),r=t[n];if(Array.isArray(r))for(var a=0;a<r.length;a++)s.push(i+"="+encodeURIComponent(r[a]));else s.push(i+"="+encodeURIComponent(String(r)))}return(e&&-1!==e.indexOf("?")?"&":"?")+s.join("&")}var o=function(){function t(t){this.options={serviceUrl:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",apiKey:""},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=p(this.options,{token:this.options.apiKey,SingleLine:t,outFields:"Addr_Type",forStorage:!1,maxLocations:10,f:"json"});d(this.options.serviceUrl+"/findAddressCandidates",t,function(t){var e=[];if(t.candidates&&t.candidates.length)for(var o=0;o<=t.candidates.length-1;o++){var n=t.candidates[o],s=c.latLng(n.location.y,n.location.x),i=c.latLngBounds(c.latLng(n.extent.ymax,n.extent.xmax),c.latLng(n.extent.ymin,n.extent.xmin));e[o]={name:n.address,bbox:i,center:s}}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,s,i){t=u(this.options,{location:t.lng+","+t.lat,distance:100,f:"json"});d(this.options.serviceUrl+"/reverseGeocode",t,function(t){var e,o,n=[];t&&!t.error&&(e=c.latLng(t.location.y,t.location.x),o=c.latLngBounds(e,e),n.push({name:t.address.Match_addr,center:e,bbox:o})),s.call(i,n)})},t}();var m=function(){function t(t){this.options={serviceUrl:"https://dev.virtualearth.net/REST/v1/Locations"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,i,r){t=p(this.options,{query:t,key:this.options.apiKey});l(this.options.apiKey,t,function(t){var e=[];if(0<t.resourceSets.length)for(var o=t.resourceSets[0].resources.length-1;0<=o;o--){var n=t.resourceSets[0].resources[o],s=n.bbox;e[o]={name:n.name,bbox:c.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:c.latLng(n.point.coordinates)}}i.call(r,e)},this,"jsonp")},e.reverse=function(t,e,i,r){var o=u(this.options,{key:this.options.apiKey});l(this.options.serviceUrl+t.lat+","+t.lng,o,function(t){for(var e=[],o=t.resourceSets[0].resources.length-1;0<=o;o--){var n=t.resourceSets[0].resources[o],s=n.bbox;e[o]={name:n.name,bbox:c.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:c.latLng(n.point.coordinates)}}i.call(r,e)},this,"jsonp")},t}();var f=function(){function t(t){this.options={serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=p(this.options,{key:this.options.apiKey,address:t});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<=t.results.length-1;o++){var n=t.results[o],s=c.latLng(n.geometry.location),i=c.latLngBounds(c.latLng(n.geometry.viewport.northeast),c.latLng(n.geometry.viewport.southwest));e[o]={name:n.formatted_address,bbox:i,center:s,properties:n.address_components}}r.call(a,e)})},e.reverse=function(t,e,r,a){t=u(this.options,{key:this.options.apiKey,latlng:t.lat+","+t.lng});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<=t.results.length-1;o++){var n=t.results[o],s=c.latLng(n.geometry.location),i=c.latLngBounds(c.latLng(n.geometry.viewport.northeast),c.latLng(n.geometry.viewport.southwest));e[o]={name:n.formatted_address,bbox:i,center:s,properties:n.address_components}}r.call(a,e)})},t}();var v=function(){function t(t){if(this.options={serviceUrl:"https://geocoder.api.here.com/6.2/",app_id:"",app_code:"",apiKey:"",maxResults:5},c.Util.setOptions(this,t),t.apiKey)throw Error("apiKey is not supported, use app_id/app_code instead!")}var e=t.prototype;return e.geocode=function(t,e,o){t=p(this.options,{searchtext:t,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"geocode.json",t,e,o)},e.reverse=function(t,e,o,n){t=t.lat+","+t.lng;this.options.reverseGeocodeProxRadius&&(t+=","+this.options.reverseGeocodeProxRadius);t=u(this.options,{prox:t,mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1,maxresults:this.options.maxResults});this.getJSON(this.options.serviceUrl+"reversegeocode.json",t,o,n)},e.getJSON=function(t,e,r,a){d(t,e,function(t){var e=[];if(t.response.view&&t.response.view.length)for(var o=0;o<=t.response.view[0].result.length-1;o++){var n=t.response.view[0].result[o].location,s=c.latLng(n.displayPosition.latitude,n.displayPosition.longitude),i=c.latLngBounds(c.latLng(n.mapView.topLeft.latitude,n.mapView.topLeft.longitude),c.latLng(n.mapView.bottomRight.latitude,n.mapView.bottomRight.longitude));e[o]={name:n.address.label,properties:n.address,bbox:i,center:s}}r.call(a,e)})},t}(),_=function(){function t(t){this.options={serviceUrl:"https://geocode.search.hereapi.com/v1",apiKey:"",app_id:"",app_code:"",maxResults:10},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){t=p(this.options,{q:t,apiKey:this.options.apiKey,limit:this.options.maxResults});if(!t.at&&!t.in)throw Error("at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.");this.getJSON(this.options.serviceUrl+"/discover",t,e,o)},e.reverse=function(t,e,o,n){t=u(this.options,{at:t.lat+","+t.lng,limit:this.options.reverseGeocodeProxRadius,apiKey:this.options.apiKey});this.getJSON(this.options.serviceUrl+"/revgeocode",t,o,n)},e.getJSON=function(t,e,r,a){d(t,e,function(t){var e=[];if(t.items&&t.items.length)for(var o=0;o<=t.items.length-1;o++){var n=t.items[o],s=c.latLng(n.position.lat,n.position.lng),i=void 0,i=n.mapView?c.latLngBounds(c.latLng(n.mapView.south,n.mapView.west),c.latLng(n.mapView.north,n.mapView.east)):c.latLngBounds(c.latLng(n.position.lat,n.position.lng),c.latLng(n.position.lat,n.position.lng));e[o]={name:n.address.label,properties:n.address,bbox:i,center:s}}r.call(a,e)})},t}();function b(t){var e;return(e=t.match(/^([NS])\s*(\d{1,3}(?:\.\d*)?)\W*([EW])\s*(\d{1,3}(?:\.\d*)?)$/))?c.latLng((/N/i.test(e[1])?1:-1)*+e[2],(/E/i.test(e[3])?1:-1)*+e[4]):(e=t.match(/^(\d{1,3}(?:\.\d*)?)\s*([NS])\W*(\d{1,3}(?:\.\d*)?)\s*([EW])$/))?c.latLng((/N/i.test(e[2])?1:-1)*+e[1],(/E/i.test(e[4])?1:-1)*+e[3]):(e=t.match(/^([NS])\s*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\W*([EW])\s*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?$/))?c.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60),(/E/i.test(e[4])?1:-1)*(+e[5]+ +e[6]/60)):(e=t.match(/^(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\s*([NS])\W*(\d{1,3})Â°?\s*(\d{1,3}(?:\.\d*)?)?['â²]?\s*([EW])$/))?c.latLng((/N/i.test(e[3])?1:-1)*(+e[1]+ +e[2]/60),(/E/i.test(e[6])?1:-1)*(+e[4]+ +e[5]/60)):(e=t.match(/^([NS])\s*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?\W*([EW])\s*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?$/))?c.latLng((/N/i.test(e[1])?1:-1)*(+e[2]+ +e[3]/60+ +e[4]/3600),(/E/i.test(e[5])?1:-1)*(+e[6]+ +e[7]/60+ +e[8]/3600)):(e=t.match(/^(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]\s*([NS])\W*(\d{1,3})Â°?\s*(\d{1,2})['â²]?\s*(\d{1,3}(?:\.\d*)?)?["â³]?\s*([EW])$/))?c.latLng((/N/i.test(e[4])?1:-1)*(+e[1]+ +e[2]/60+ +e[3]/3600),(/E/i.test(e[8])?1:-1)*(+e[5]+ +e[6]/60+ +e[7]/3600)):(e=t.match(/^\s*([+-]?\d+(?:\.\d*)?)\s*[\s,]\s*([+-]?\d+(?:\.\d*)?)\s*$/))?c.latLng(+e[1],+e[2]):void 0}var y=function(){function t(t){this.options={next:void 0,sizeInMeters:1e4},c.Util.setOptions(this,t)}return t.prototype.geocode=function(t,e,o){var n=b(t);n?(n=[{name:t,center:n,bbox:n.toBounds(this.options.sizeInMeters)}],e.call(o,n)):this.options.next&&this.options.next.geocode(t,e,o)},t}();var L=function(){function t(t){this.options={serviceUrl:"https://api.mapbox.com/geocoding/v5/mapbox.places/"},c.Util.setOptions(this,t)}var e=t.prototype;return e._getProperties=function(t){for(var e={text:t.text,address:t.address},o=0;o<(t.context||[]).length;o++)e[t.context[o].id.split(".")[0]]=t.context[o].text,t.context[o].short_code&&(e.countryShortCode=t.context[o].short_code);return e},e.geocode=function(t,r,a){var l=this,e=p(this.options,{access_token:this.options.apiKey});void 0!==e.proximity&&void 0!==e.proximity.lat&&void 0!==e.proximity.lng&&(e.proximity=e.proximity.lng+","+e.proximity.lat),d(this.options.serviceUrl+encodeURIComponent(t)+".json",e,function(t){var e=[];if(t.features&&t.features.length)for(var o=0;o<=t.features.length-1;o++){var n=t.features[o],s=c.latLng(n.center.reverse()),i=void 0,i=n.bbox?c.latLngBounds(c.latLng(n.bbox.slice(0,2).reverse()),c.latLng(n.bbox.slice(2,4).reverse())):c.latLngBounds(s,s);e[o]={name:n.place_name,bbox:i,center:s,properties:l._getProperties(n)}}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,r,a){var l=this;d(this.options.serviceUrl+t.lng+","+t.lat+".json",u(this.options,{access_token:this.options.apiKey}),function(t){var e=[];if(t.features&&t.features.length)for(var o=0;o<=t.features.length-1;o++){var n=t.features[o],s=c.latLng(n.center.reverse()),i=void 0,i=n.bbox?c.latLngBounds(c.latLng(n.bbox.slice(0,2).reverse()),c.latLng(n.bbox.slice(2,4).reverse())):c.latLngBounds(s,s);e[o]={name:n.place_name,bbox:i,center:s,properties:l._getProperties(n)}}r.call(a,e)})},t}();var x=function(){function t(t){this.options={serviceUrl:"https://www.mapquestapi.com/geocoding/v1"},c.Util.setOptions(this,t),this.options.apiKey=decodeURIComponent(this.options.apiKey)}var e=t.prototype;return e._formatName=function(){return[].slice.call(arguments).filter(function(t){return!!t}).join(", ")},e.geocode=function(t,i,r){t=p(this.options,{key:this.options.apiKey,location:t,limit:5,outFormat:"json"});d(this.options.serviceUrl+"/address",t,c.Util.bind(function(t){var e=[];if(t.results&&t.results[0].locations)for(var o=t.results[0].locations.length-1;0<=o;o--){var n=t.results[0].locations[o],s=c.latLng(n.latLng);e[o]={name:this._formatName(n.street,n.adminArea4,n.adminArea3,n.adminArea1),bbox:c.latLngBounds(s,s),center:s}}i.call(r,e)},this))},e.reverse=function(t,e,i,r){t=u(this.options,{key:this.options.apiKey,location:t.lat+","+t.lng,outputFormat:"json"});d(this.options.serviceUrl+"/reverse",t,c.Util.bind(function(t){var e=[];if(t.results&&t.results[0].locations)for(var o=t.results[0].locations.length-1;0<=o;o--){var n=t.results[0].locations[o],s=c.latLng(n.latLng);e[o]={name:this._formatName(n.street,n.adminArea4,n.adminArea3,n.adminArea1),bbox:c.latLngBounds(s,s),center:s}}i.call(r,e)},this))},t}();var U=function(){function t(t){this.options={userId:void 0,apiKey:void 0,serviceUrl:"https://neutrinoapi.com/"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,s,i){t=p(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,address:t.split(/\s+/).join(".")});d(this.options.serviceUrl+"geocode-address",t,function(t){var e,o,n=[];t.locations&&(t.geometry=t.locations[0],e=c.latLng(t.geometry.latitude,t.geometry.longitude),o=c.latLngBounds(e,e),n[0]={name:t.geometry.address,bbox:o,center:e}),s.call(i,n)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(s,t,i,r){var e=u(this.options,{apiKey:this.options.apiKey,userId:this.options.userId,latitude:s.lat,longitude:s.lng});d(this.options.serviceUrl+"geocode-reverse",e,function(t){var e,o,n=[];200==t.status.status&&t.found&&(e=c.latLng(s.lat,s.lng),o=c.latLngBounds(e,e),n[0]={name:t.address,bbox:o,center:e}),i.call(r,n)})},t}();var w=function(){function t(t){this.options={serviceUrl:"https://nominatim.openstreetmap.org/",htmlTemplate:function(t){var e,o=t.address,t=[];return(o.road||o.building)&&t.push("{building} {road} {house_number}"),(o.city||o.town||o.village||o.hamlet)&&(e=0<t.length?"leaflet-control-geocoder-address-detail":"",t.push('<span class="'+e+'">{postcode} {city} {town} {village} {hamlet}</span>')),(o.state||o.country)&&(e=0<t.length?"leaflet-control-geocoder-address-context":"",t.push('<span class="'+e+'">{state} {country}</span>')),h(t.join("<br/>"),o)}},c.Util.setOptions(this,t||{})}var e=t.prototype;return e.geocode=function(t,i,r){var a=this,t=p(this.options,{q:t,limit:5,format:"json",addressdetails:1});d(this.options.serviceUrl+"search",t,function(t){for(var e=[],o=t.length-1;0<=o;o--){for(var n=t[o].boundingbox,s=0;s<4;s++)n[s]=+n[s];e[o]={icon:t[o].icon,name:t[o].display_name,html:a.options.htmlTemplate?a.options.htmlTemplate(t[o]):void 0,bbox:c.latLngBounds([n[0],n[2]],[n[1],n[3]]),center:c.latLng(t[o].lat,t[o].lon),properties:t[o]}}i.call(r,e)})},e.reverse=function(t,e,s,i){var r=this,e=u(this.options,{lat:t.lat,lon:t.lng,zoom:Math.round(Math.log(e/256)/Math.log(2)),addressdetails:1,format:"json"});d(this.options.serviceUrl+"reverse",e,function(t){var e,o,n=[];t&&t.lat&&t.lon&&(e=c.latLng(t.lat,t.lon),o=c.latLngBounds(e,e),n.push({name:t.display_name,html:r.options.htmlTemplate?r.options.htmlTemplate(t):void 0,center:e,bbox:o,properties:t})),s.call(i,n)})},t}();var C=function(){function t(t){c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){try{var n=this.options.OpenLocationCode.decode(t),n={name:t,center:c.latLng(n.latitudeCenter,n.longitudeCenter),bbox:c.latLngBounds(c.latLng(n.latitudeLo,n.longitudeLo),c.latLng(n.latitudeHi,n.longitudeHi))};e.call(o,[n])}catch(t){console.warn(t),e.call(o,[])}},e.reverse=function(t,e,o,n){try{var s={name:this.options.OpenLocationCode.encode(t.lat,t.lng,this.options.codeLength),center:c.latLng(t.lat,t.lng),bbox:c.latLngBounds(c.latLng(t.lat,t.lng),c.latLng(t.lat,t.lng))};o.call(n,[s])}catch(t){console.warn(t),o.call(n,[])}},t}();var E=function(){function t(t){this.options={serviceUrl:"https://api.opencagedata.com/geocode/v1/json"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,r,a){t=p(this.options,{key:this.options.apiKey,q:t});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<t.results.length;o++){var n=t.results[o],s=c.latLng(n.geometry),i=void 0,i=n.annotations&&n.annotations.bounds?c.latLngBounds(c.latLng(n.annotations.bounds.northeast),c.latLng(n.annotations.bounds.southwest)):c.latLngBounds(s,s);e.push({name:n.formatted,bbox:i,center:s})}r.call(a,e)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,r,a){t=u(this.options,{key:this.options.apiKey,q:[t.lat,t.lng].join(",")});d(this.options.serviceUrl,t,function(t){var e=[];if(t.results&&t.results.length)for(var o=0;o<t.results.length;o++){var n=t.results[o],s=c.latLng(n.geometry),i=void 0,i=n.annotations&&n.annotations.bounds?c.latLngBounds(c.latLng(n.annotations.bounds.northeast),c.latLng(n.annotations.bounds.southwest)):c.latLngBounds(s,s);e.push({name:n.formatted,bbox:i,center:s})}r.call(a,e)})},t}();var D=function(){function t(t){this.options={serviceUrl:"https://api.geocode.earth/v1"},this._lastSuggest=0,c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){var n=this,t=p(this.options,{api_key:this.options.apiKey,text:t});d(this.options.serviceUrl+"/search",t,function(t){e.call(o,n._parseResults(t,"bbox"))})},e.suggest=function(t,e,o){var n=this,t=p(this.options,{api_key:this.options.apiKey,text:t});d(this.options.serviceUrl+"/autocomplete",t,function(t){t.geocoding.timestamp>n._lastSuggest&&(n._lastSuggest=t.geocoding.timestamp,e.call(o,n._parseResults(t,"bbox")))})},e.reverse=function(t,e,o,n){var s=this,t=u(this.options,{api_key:this.options.apiKey,"point.lat":t.lat,"point.lon":t.lng});d(this.options.serviceUrl+"/reverse",t,function(t){o.call(n,s._parseResults(t,"bounds"))})},e._parseResults=function(t,i){var r=[];return c.geoJSON(t,{pointToLayer:function(t,e){return c.circleMarker(e)},onEachFeature:function(t,e){var o,n,s={};e.getBounds?n=(o=e.getBounds()).getCenter():o=e.feature.bbox?(n=e.getLatLng(),c.latLngBounds(c.GeoJSON.coordsToLatLng(e.feature.bbox.slice(0,2)),c.GeoJSON.coordsToLatLng(e.feature.bbox.slice(2,4)))):(n=e.getLatLng(),c.latLngBounds(n,n)),s.name=e.feature.properties.label,s.center=n,s[i]=o,s.properties=e.feature.properties,r.push(s)}}),r},t}();function t(t){return new D(t)}var k=D,B=t,R=D,S=t,K=function(e){function t(t){return e.call(this,c.Util.extend({serviceUrl:"https://api.openrouteservice.org/geocode"},t))||this}return n(t,e),t}(D);var T=function(){function t(t){this.options={serviceUrl:"https://photon.komoot.io/api/",reverseUrl:"https://photon.komoot.io/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,e,o){t=p(this.options,{q:t});d(this.options.serviceUrl,t,c.Util.bind(function(t){e.call(o,this._decodeFeatures(t))},this))},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,o,n){t=u(this.options,{lat:t.lat,lon:t.lng});d(this.options.reverseUrl,t,c.Util.bind(function(t){o.call(n,this._decodeFeatures(t))},this))},e._decodeFeatures=function(t){var e=[];if(t&&t.features)for(var o=0;o<t.features.length;o++){var n=t.features[o],s=n.geometry.coordinates,i=c.latLng(s[1],s[0]),s=n.properties.extent,s=s?c.latLngBounds([s[1],s[0]],[s[3],s[2]]):c.latLngBounds(i,i);e.push({name:this._decodeFeatureName(n),html:this.options.htmlTemplate?this.options.htmlTemplate(n):void 0,center:i,bbox:s,properties:n.properties})}return e},e._decodeFeatureName=function(e){return(this.options.nameProperties||[]).map(function(t){return e.properties[t]}).filter(function(t){return!!t}).join(", ")},t}();var O=function(){function t(t){this.options={serviceUrl:"https://api.what3words.com/v2/"},c.Util.setOptions(this,t)}var e=t.prototype;return e.geocode=function(t,s,i){d(this.options.serviceUrl+"forward",p(this.options,{key:this.options.apiKey,addr:t.split(/\s+/).join(".")}),function(t){var e,o,n=[];t.geometry&&(e=c.latLng(t.geometry.lat,t.geometry.lng),o=c.latLngBounds(e,e),n[0]={name:t.words,bbox:o,center:e}),s.call(i,n)})},e.suggest=function(t,e,o){return this.geocode(t,e,o)},e.reverse=function(t,e,s,i){d(this.options.serviceUrl+"reverse",u(this.options,{key:this.options.apiKey,coords:[t.lat,t.lng].join(",")}),function(t){var e,o,n=[];200==t.status.status&&(e=c.latLng(t.geometry.lat,t.geometry.lng),o=c.latLngBounds(e,e),n[0]={name:t.words,bbox:o,center:e}),s.call(i,n)})},t}();R={__proto__:null,geocodingParams:p,reverseParams:u,ArcGis:o,arcgis:function(t){return new o(t)},Bing:m,bing:function(t){return new m(t)},Google:f,google:function(t){return new f(t)},HERE:v,HEREv2:_,here:function(t){return new(t.apiKey?_:v)(t)},parseLatLng:b,LatLng:y,latLng:function(t){return new y(t)},Mapbox:L,mapbox:function(t){return new L(t)},MapQuest:x,mapQuest:function(t){return new x(t)},Neutrino:U,neutrino:function(t){return new U(t)},Nominatim:w,nominatim:function(t){return new w(t)},OpenLocationCode:C,openLocationCode:function(t){return new C(t)},OpenCage:E,opencage:function(t){return new E(t)},Pelias:D,pelias:t,GeocodeEarth:k,geocodeEarth:B,Mapzen:R,mapzen:S,Openrouteservice:K,openrouteservice:function(t){return new K(t)},Photon:T,photon:function(t){return new T(t)},What3Words:O,what3words:function(t){return new O(t)}},S=function(){};c.Util.extend(S.prototype,c.Control.prototype),c.Util.extend(S.prototype,c.Evented.prototype);var N=function(o){function t(t){var e=o.call(this,t)||this;return e.options={showUniqueResult:!0,showResultIcons:!1,collapsed:!0,expand:"touch",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",iconLabel:"Initiate a new search",query:"",queryMinLength:1,suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:!0},e._requestCount=0,c.Util.setOptions(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e),t),e.options.geocoder||(e.options.geocoder=new w),e}n(t,o);var e=t.prototype;return e.addThrobberClass=function(){c.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber")},e.removeThrobberClass=function(){c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber")},e.onAdd=function(t){var e=this,o="leaflet-control-geocoder",n=c.DomUtil.create("div",o+" leaflet-bar"),s=c.DomUtil.create("button",o+"-icon",n),i=this._form=c.DomUtil.create("div",o+"-form",n);this._map=t,this._container=n,s.innerHTML="&nbsp;",s.type="button",s.setAttribute("aria-label",this.options.iconLabel);i=this._input=c.DomUtil.create("input","",i);return i.type="text",i.value=this.options.query,i.placeholder=this.options.placeholder,c.DomEvent.disableClickPropagation(i),this._errorElement=c.DomUtil.create("div",o+"-form-no-error",n),this._errorElement.innerHTML=this.options.errorMessage,this._alts=c.DomUtil.create("ul",o+"-alternatives leaflet-control-geocoder-alternatives-minimized",n),c.DomEvent.disableClickPropagation(this._alts),c.DomEvent.addListener(i,"keydown",this._keydown,this),this.options.geocoder.suggest&&c.DomEvent.addListener(i,"input",this._change,this),c.DomEvent.addListener(i,"blur",function(){e.options.collapsed&&!e._preventBlurCollapse&&e._collapse(),e._preventBlurCollapse=!1}),this.options.collapsed?"click"===this.options.expand?c.DomEvent.addListener(n,"click",function(t){0===t.button&&2!==t.detail&&e._toggle()}):"touch"===this.options.expand?c.DomEvent.addListener(n,c.Browser.touch?"touchstart mousedown":"mousedown",function(t){e._toggle(),t.preventDefault(),t.stopPropagation()},this):(c.DomEvent.addListener(n,"mouseover",this._expand,this),c.DomEvent.addListener(n,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):(this._expand(),c.Browser.touch?c.DomEvent.addListener(n,"touchstart",function(){return e._geocode()}):c.DomEvent.addListener(n,"click",function(){return e._geocode()})),this.options.defaultMarkGeocode&&this.on("markgeocode",this.markGeocode,this),this.on("startgeocode",this.addThrobberClass,this),this.on("finishgeocode",this.removeThrobberClass,this),this.on("startsuggest",this.addThrobberClass,this),this.on("finishsuggest",this.removeThrobberClass,this),c.DomEvent.disableClickPropagation(n),n},e.setQuery=function(t){return this._input.value=t,this},e._geocodeResult=function(t,e){if(!e&&this.options.showUniqueResult&&1===t.length)this._geocodeResultSelected(t[0]);else if(0<t.length){this._alts.innerHTML="",this._results=t,c.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),c.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-open");for(var o=0;o<t.length;o++)this._alts.appendChild(this._createAlt(t[o],o))}else c.DomUtil.addClass(this._container,"leaflet-control-geocoder-options-error"),c.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},e.markGeocode=function(t){t=t.geocode;return this._map.fitBounds(t.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new c.Marker(t.center).bindPopup(t.html||t.name).addTo(this._map).openPopup(),this},e._geocode=function(o){var n,t,e,s=this,i=this._input.value;!o&&i.length<this.options.queryMinLength||(n=++this._requestCount,t=function(t){var e;n===s._requestCount&&(e={input:i,results:t},s.fire(o?"finishsuggest":"finishgeocode",e),s._geocodeResult(t,o))},this._lastGeocode=i,o||this._clearResults(),e={input:i},this.fire(o?"startsuggest":"startgeocode",e),o?this.options.geocoder.suggest(i,t):this.options.geocoder.geocode(i,t))},e._geocodeResultSelected=function(t){t={geocode:t};this.fire("markgeocode",t)},e._toggle=function(){c.DomUtil.hasClass(this._container,"leaflet-control-geocoder-expanded")?this._collapse():this._expand()},e._expand=function(){c.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select(),this.fire("expand")},e._collapse=function(){c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-expanded"),c.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),c.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error"),this._input.blur(),this.fire("collapse")},e._clearResults=function(){c.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,c.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-open"),c.DomUtil.removeClass(this._container,"leaflet-control-geocoder-options-error")},e._createAlt=function(e,t){var o=this,n=c.DomUtil.create("li",""),s=c.DomUtil.create("a","",n),i=this.options.showResultIcons&&e.icon?c.DomUtil.create("img","",s):null,r=e.html?void 0:document.createTextNode(e.name);return i&&(i.src=e.icon),n.setAttribute("data-result-index",String(t)),e.html?s.innerHTML=s.innerHTML+e.html:r&&s.appendChild(r),c.DomEvent.addListener(n,"mousedown touchstart",function(t){o._preventBlurCollapse=!0,c.DomEvent.stop(t),o._geocodeResultSelected(e),c.DomEvent.on(n,"click touchend",function(){o.options.collapsed?o._collapse():o._clearResults()})},this),n},e._keydown=function(t){function e(t){n._selection&&(c.DomUtil.removeClass(n._selection,"leaflet-control-geocoder-selected"),n._selection=n._selection[0<t?"nextSibling":"previousSibling"]),n._selection||(n._selection=n._alts[0<t?"firstChild":"lastChild"]),n._selection&&c.DomUtil.addClass(n._selection,"leaflet-control-geocoder-selected")}var o,n=this;switch(t.keyCode){case 27:this.options.collapsed?this._collapse():this._clearResults();break;case 38:e(-1);break;case 40:e(1);break;case 13:this._selection?(o=parseInt(this._selection.getAttribute("data-result-index"),10),this._geocodeResultSelected(this._results[o]),this._clearResults()):this._geocode();break;default:return}c.DomEvent.preventDefault(t)},e._change=function(){var t=this,e=this._input.value;e!==this._lastGeocode&&(clearTimeout(this._suggestTimeout),e.length>=this.options.suggestMinLength?this._suggestTimeout=setTimeout(function(){return t._geocode(!0)},this.options.suggestTimeout):this._clearResults())},t}(S);return c.Util.extend(N,R),c.Util.extend(c.Control,{Geocoder:N,geocoder:function(t){return new N(t)}}),N}(L);
!function(){function o(t,i){this.title=t.title,this.stateName=t.stateName||"unnamed-state",this.icon=L.DomUtil.create("span",""),L.DomUtil.addClass(this.icon,"button-state state-"+this.stateName.replace(/(^\s*|\s*$)/g,"")),this.icon.innerHTML=function(t){var i;i=t.match(/[&;=<>"']/)?t:(t=t.replace(/(^\s*|\s*$)/g,""),i=L.DomUtil.create("span",""),0===t.indexOf("fa-")?L.DomUtil.addClass(i,"fa "+t):0===t.indexOf("glyphicon-")?L.DomUtil.addClass(i,"glyphicon "+t):L.DomUtil.addClass(i,t),i.outerHTML);return i}(t.icon),this.onClick=L.Util.bind(t.onClick||function(){},i)}L.Control.EasyBar=L.Control.extend({options:{position:"topleft",id:null,leafletClasses:!0},initialize:function(t,i){i&&L.Util.setOptions(this,i),this._buildContainer(),this._buttons=[];for(var e=0;e<t.length;e++)t[e]._bar=this,t[e]._container=t[e].button,this._buttons.push(t[e]),this.container.appendChild(t[e].button)},_buildContainer:function(){this._container=this.container=L.DomUtil.create("div",""),this.options.leafletClasses&&L.DomUtil.addClass(this.container,"leaflet-bar easy-button-container leaflet-control"),this.options.id&&(this.container.id=this.options.id)},enable:function(){return L.DomUtil.addClass(this.container,"enabled"),L.DomUtil.removeClass(this.container,"disabled"),this.container.setAttribute("aria-hidden","false"),this},disable:function(){return L.DomUtil.addClass(this.container,"disabled"),L.DomUtil.removeClass(this.container,"enabled"),this.container.setAttribute("aria-hidden","true"),this},onAdd:function(){return this.container},addTo:function(t){this._map=t;for(var i=0;i<this._buttons.length;i++)this._buttons[i]._map=t;var e=this._container=this.onAdd(t),s=this.getPosition(),n=t._controlCorners[s];return L.DomUtil.addClass(e,"leaflet-control"),-1!==s.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this}}),L.easyBar=function(){for(var t=[L.Control.EasyBar],i=0;i<arguments.length;i++)t.push(arguments[i]);return new(Function.prototype.bind.apply(L.Control.EasyBar,t))},L.Control.EasyButton=L.Control.extend({options:{position:"topleft",id:null,type:"replace",states:[],leafletClasses:!0,tagName:"button"},initialize:function(t,i,e,s){this.options.states=[],null!=s&&(this.options.id=s),this.storage={},"object"==typeof arguments[arguments.length-1]&&L.Util.setOptions(this,arguments[arguments.length-1]),0===this.options.states.length&&"string"==typeof t&&"function"==typeof i&&this.options.states.push({icon:t,onClick:i,title:"string"==typeof e?e:""}),this._states=[];for(var n=0;n<this.options.states.length;n++)this._states.push(new o(this.options.states[n],this));this._buildButton(),this._activateState(this._states[0])},_buildButton:function(){if(this.button=L.DomUtil.create(this.options.tagName,""),"button"===this.options.tagName&&this.button.setAttribute("type","button"),this.options.id&&(this.button.id=this.options.id),this.options.leafletClasses&&L.DomUtil.addClass(this.button,"easy-button-button leaflet-bar-part leaflet-interactive"),L.DomEvent.addListener(this.button,"dblclick",L.DomEvent.stop),L.DomEvent.addListener(this.button,"mousedown",L.DomEvent.stop),L.DomEvent.addListener(this.button,"mouseup",L.DomEvent.stop),L.DomEvent.addListener(this.button,"click",function(t){L.DomEvent.stop(t),this._currentState.onClick(this,this._map||null),this._map&&this._map.getContainer().focus()},this),"replace"==this.options.type)this.button.appendChild(this._currentState.icon);else for(var t=0;t<this._states.length;t++)this.button.appendChild(this._states[t].icon)},_currentState:{stateName:"unnamed",icon:document.createElement("span")},_states:null,state:function(t){return 0===arguments.length?this._currentState.stateName:("string"==typeof t?this._activateStateNamed(t):"number"==typeof t&&this._activateState(this._states[t]),this)},_activateStateNamed:function(t){for(var i=0;i<this._states.length;i++)this._states[i].stateName==t&&this._activateState(this._states[i])},_activateState:function(t){if(t!==this._currentState){"replace"==this.options.type&&(this.button.appendChild(t.icon),this.button.removeChild(this._currentState.icon)),t.title?this.button.title=t.title:this.button.removeAttribute("title");for(var i=0;i<this._states.length;i++)L.DomUtil.removeClass(this._states[i].icon,this._currentState.stateName+"-active"),L.DomUtil.addClass(this._states[i].icon,t.stateName+"-active");L.DomUtil.removeClass(this.button,this._currentState.stateName+"-active"),L.DomUtil.addClass(this.button,t.stateName+"-active"),this._currentState=t}},enable:function(){return L.DomUtil.addClass(this.button,"enabled"),L.DomUtil.removeClass(this.button,"disabled"),this.button.setAttribute("aria-hidden","false"),this},disable:function(){return L.DomUtil.addClass(this.button,"disabled"),L.DomUtil.removeClass(this.button,"enabled"),this.button.setAttribute("aria-hidden","true"),this},onAdd:function(t){var i=L.easyBar([this],{position:this.options.position,leafletClasses:this.options.leafletClasses});return this._anonymousBar=i,this._container=i.container,this._anonymousBar.container},removeFrom:function(t){return this._map===t&&this.remove(),this}}),L.easyButton=function(){var t=Array.prototype.concat.apply([L.Control.EasyButton],arguments);return new(Function.prototype.bind.apply(L.Control.EasyButton,t))}}();
"use strict";!function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),void 0!==e&&e.L&&t(e.L)}(function(d){d.Editable=d.Evented.extend({statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:d.Polygon,polylineClass:d.Polyline,markerClass:d.Marker,rectangleClass:d.Rectangle,circleClass:d.Circle,drawingCSSClass:"leaflet-editable-drawing",drawingCursor:"crosshair",editLayer:void 0,featuresLayer:void 0,polylineEditorClass:void 0,polygonEditorClass:void 0,markerEditorClass:void 0,rectangleEditorClass:void 0,circleEditorClass:void 0,lineGuideOptions:{},skipMiddleMarkers:!1},initialize:function(t,e){d.setOptions(this,e),this._lastZIndex=this.options.zIndex,this.map=t,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(t,e){((e=e||{}).editTools=this).fire(t,e),this.map.fire(t,e)},createLineGuide:function(){var t=d.extend({dashArray:"5,10",weight:1,interactive:!1},this.options.lineGuideOptions);return d.polyline([],t)},createVertexIcon:function(t){return new(d.Browser.mobile&&d.Browser.touch?d.Editable.TouchVertexIcon:d.Editable.VertexIcon)(t)},createEditLayer:function(){return this.options.editLayer||(new d.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new d.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(t){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(t){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(t){this.forwardLineGuide._latlngs[0]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(t){this.backwardLineGuide._latlngs[0]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.backwardLineGuide)},blockEvents:function(){this._oldTargets||(this._oldTargets=this.map._targets,this.map._targets={})},unblockEvents:function(){this._oldTargets&&(this.map._targets=d.extend(this.map._targets,this._oldTargets),delete this._oldTargets)},registerForDrawing:function(t){this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this.blockEvents(),t.reset(),this._drawingEditor=t,this.map.on("mousemove touchmove",t.onDrawingMouseMove,t),this.map.on("mousedown",this.onMousedown,this),this.map.on("mouseup",this.onMouseup,this),d.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.defaultMapCursor=this.map._container.style.cursor,this.map._container.style.cursor=this.options.drawingCursor},unregisterForDrawing:function(t){this.unblockEvents(),d.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass),this.map._container.style.cursor=this.defaultMapCursor,(t=t||this._drawingEditor)&&(this.map.off("mousemove touchmove",t.onDrawingMouseMove,t),this.map.off("mousedown",this.onMousedown,this),this.map.off("mouseup",this.onMouseup,this),t===this._drawingEditor&&(delete this._drawingEditor,t._drawing&&t.cancelDrawing()))},onMousedown:function(t){1==t.originalEvent.which&&(this._mouseDown=t,this._drawingEditor.onDrawingMouseDown(t))},onMouseup:function(t){var e,i;this._mouseDown&&(e=this._drawingEditor,i=this._mouseDown,this._mouseDown=null,e.onDrawingMouseUp(t),this._drawingEditor===e&&(i=d.point(i.originalEvent.clientX,i.originalEvent.clientY),i=d.point(t.originalEvent.clientX,t.originalEvent.clientY).distanceTo(i),Math.abs(i)<9*(window.devicePixelRatio||1)&&this._drawingEditor.onDrawingClick(t)))},drawing:function(){return this._drawingEditor&&this._drawingEditor.drawing()},stopDrawing:function(){this.unregisterForDrawing()},commitDrawing:function(t){this._drawingEditor&&this._drawingEditor.commitDrawing(t)},connectCreatedToMap:function(t){return this.featuresLayer.addLayer(t)},startPolyline:function(t,e){e=this.createPolyline([],e);return e.enableEdit(this.map).newShape(t),e},startPolygon:function(t,e){e=this.createPolygon([],e);return e.enableEdit(this.map).newShape(t),e},startMarker:function(t,e){t=t||this.map.getCenter().clone();e=this.createMarker(t,e);return e.enableEdit(this.map).startDrawing(),e},startRectangle:function(t,e){t=t||d.latLng([0,0]),t=new d.LatLngBounds(t,t),e=this.createRectangle(t,e);return e.enableEdit(this.map).startDrawing(),e},startCircle:function(t,e){t=t||this.map.getCenter().clone();e=this.createCircle(t,e);return e.enableEdit(this.map).startDrawing(),e},startHole:function(t,e){t.newHole(e)},createLayer:function(t,e,i){i=new t(e,i=d.Util.extend({editOptions:{editTools:this}},i));return this.fireAndForward("editable:created",{layer:i}),i},createPolyline:function(t,e){return this.createLayer(e&&e.polylineClass||this.options.polylineClass,t,e)},createPolygon:function(t,e){return this.createLayer(e&&e.polygonClass||this.options.polygonClass,t,e)},createMarker:function(t,e){return this.createLayer(e&&e.markerClass||this.options.markerClass,t,e)},createRectangle:function(t,e){return this.createLayer(e&&e.rectangleClass||this.options.rectangleClass,t,e)},createCircle:function(t,e){return this.createLayer(e&&e.circleClass||this.options.circleClass,t,e)}}),d.extend(d.Editable,{makeCancellable:function(t){t.cancel=function(){t._cancelled=!0}}}),d.Map.mergeOptions({editToolsClass:d.Editable,editable:!1,editOptions:{}}),d.Map.addInitHook(function(){this.whenReady(function(){this.options.editable&&(this.editTools=new this.options.editToolsClass(this,this.options.editOptions))})}),d.Editable.VertexIcon=d.DivIcon.extend({options:{iconSize:new d.Point(8,8)}}),d.Editable.TouchVertexIcon=d.Editable.VertexIcon.extend({options:{iconSize:new d.Point(20,20)}}),d.Editable.VertexMarker=d.Marker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(t,e,i,n){this.latlng=t,this.latlngs=e,this.editor=i,d.Marker.prototype.initialize.call(this,t,n),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),(this.latlng.__vertex=this).editor.editLayer.addLayer(this),this.setZIndexOffset(i.tools._lastZIndex+1)},onAdd:function(t){d.Marker.prototype.onAdd.call(this,t),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("mouseup",this.onMouseup),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.on("mouseover",this.onMouseOver),this.on("mouseout",this.onMouseOut),this.addMiddleMarkers()},onRemove:function(t){this.middleMarker&&this.middleMarker.delete(),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("mouseup",this.onMouseup),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),this.off("mouseover",this.onMouseOver),this.off("mouseout",this.onMouseOut),d.Marker.prototype.onRemove.call(this,t)},onDrag:function(t){(t.vertex=this).editor.onVertexMarkerDrag(t);t=d.DomUtil.getPosition(this._icon),t=this._map.layerPointToLatLng(t);this.latlng.update(t),this._latlng=this.latlng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();t=this.getNext();t&&t.middleMarker&&t.middleMarker.updateLatLng()},onDragStart:function(t){(t.vertex=this).editor.onVertexMarkerDragStart(t)},onDragEnd:function(t){(t.vertex=this).editor.onVertexMarkerDragEnd(t)},onClick:function(t){(t.vertex=this).editor.onVertexMarkerClick(t)},onMouseup:function(t){d.DomEvent.stop(t),(t.vertex=this).editor.map.fire("mouseup",t)},onContextMenu:function(t){(t.vertex=this).editor.onVertexMarkerContextMenu(t)},onMouseDown:function(t){(t.vertex=this).editor.onVertexMarkerMouseDown(t)},onMouseOver:function(t){(t.vertex=this).editor.onVertexMarkerMouseOver(t)},onMouseOut:function(t){(t.vertex=this).editor.onVertexMarkerMouseOut(t)},delete:function(){var t=this.getNext();this.latlngs.splice(this.getIndex(),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),this.latlngs.length||this.editor.deleteShape(this.latlngs),t&&t.resetMiddleMarker(),this.editor.refresh()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t-1;0===t&&this.editor.CLOSED&&(e=this.getLastIndex());e=this.latlngs[e];return e?e.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t+1;t===this.getLastIndex()&&this.editor.CLOSED&&(e=0);e=this.latlngs[e];return e?e.__vertex:void 0}},addMiddleMarker:function(t){this.editor.hasMiddleMarkers()&&(t=t||this.getPrevious())&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(t,this,this.latlngs,this.editor))},addMiddleMarkers:function(){var t;this.editor.hasMiddleMarkers()&&((t=this.getPrevious())&&this.addMiddleMarker(t),(t=this.getNext())&&t.resetMiddleMarker())},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker.delete(),this.addMiddleMarker()},split:function(){this.editor.splitShape&&this.editor.splitShape(this.latlngs,this.getIndex())},continue:function(){var t;this.editor.continueBackward&&(0===(t=this.getIndex())?this.editor.continueBackward(this.latlngs):t===this.getLastIndex()&&this.editor.continueForward(this.latlngs))}}),d.Editable.mergeOptions({vertexMarkerClass:d.Editable.VertexMarker}),d.Editable.MiddleMarker=d.Marker.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon",draggable:!0},initialize:function(t,e,i,n,r){this.left=t,this.right=e,this.editor=n,this.latlngs=i,d.Marker.prototype.initialize.call(this,this.computeLatLng(),r),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this),this.setVisibility()},setVisibility:function(){var t=this._map.latLngToContainerPoint(this.left.latlng),e=this._map.latLngToContainerPoint(this.right.latlng),i=d.point(this.options.icon.options.iconSize);t.distanceTo(e)<3*i.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var t=this.editor.map.latLngToContainerPoint(this.left.latlng),e=this.editor.map.latLngToContainerPoint(this.right.latlng),i=(t.y+e.y)/2,e=(t.x+e.x)/2;return this.editor.map.containerPointToLatLng([e,i])},onAdd:function(t){d.Marker.prototype.onAdd.call(this,t),d.DomEvent.on(this._icon,"mousedown touchstart",this.onMouseDown,this),t.on("zoomend",this.setVisibility,this)},onRemove:function(t){delete this.right.middleMarker,d.DomEvent.off(this._icon,"mousedown touchstart",this.onMouseDown,this),t.off("zoomend",this.setVisibility,this),d.Marker.prototype.onRemove.call(this,t)},onMouseDown:function(t){var e,i,n=d.DomUtil.getPosition(this._icon);t={originalEvent:t,latlng:this.editor.map.layerPointToLatLng(n)},0!==this.options.opacity&&(d.Editable.makeCancellable(t),this.editor.onMiddleMarkerMouseDown(t),t._cancelled||(this.latlngs.splice(this.index(),0,t.latlng),this.editor.refresh(),e=this._icon,i=this.editor.addVertexMarker(t.latlng,this.latlngs),this.editor.onNewVertex(i),(n=i._icon.parentNode).removeChild(i._icon),i._icon=e,n.appendChild(i._icon),i._initIcon(),i._initInteraction(),i.setOpacity(1),d.Draggable._dragging=!1,i.dragging._draggable._onDown(t.originalEvent),this.delete()))},delete:function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)}}),d.Editable.mergeOptions({middleMarkerClass:d.Editable.MiddleMarker}),d.Editable.BaseEditor=d.Handler.extend({initialize:function(t,e,i){d.setOptions(this,i),this.map=t,this.feature=e,(this.feature.editor=this).editLayer=new d.LayerGroup,this.tools=this.options.editTools||t.editTools},addHooks:function(){this.isConnected()?this.onFeatureAdd():this.feature.once("add",this.onFeatureAdd,this),this.onEnable(),this.feature.on(this._getEvents(),this)},removeHooks:function(){this.feature.off(this._getEvents(),this),this.feature.dragging&&this.feature.dragging.disable(),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),this._drawing&&this.cancelDrawing()},drawing:function(){return!!this._drawing},reset:function(){},onFeatureAdd:function(){this.tools.editLayer.addLayer(this.editLayer),this.feature.dragging&&this.feature.dragging.enable()},hasMiddleMarkers:function(){return!this.options.skipMiddleMarkers&&!this.tools.options.skipMiddleMarkers},fireAndForward:function(t,e){(e=e||{}).layer=this.feature,this.feature.fire(t,e),this.tools.fireAndForward(t,e)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(t){this.fireAndForward("editable:drawing:commit",t)},onDrawingMouseDown:function(t){this.fireAndForward("editable:drawing:mousedown",t)},onDrawingMouseUp:function(t){this.fireAndForward("editable:drawing:mouseup",t)},startDrawing:function(){this._drawing||(this._drawing=d.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(t){this.onCommitDrawing(t),this.endDrawing()},cancelDrawing:function(){d.Draggable._dragging=!1,this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this._drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onDrawingClick:function(t){this.drawing()&&(d.Editable.makeCancellable(t),this.fireAndForward("editable:drawing:click",t),t._cancelled||(this.isConnected()||this.connect(t),this.processDrawingClick(t)))},isConnected:function(){return this.map.hasLayer(this.feature)},connect:function(){this.tools.connectCreatedToMap(this.feature),this.tools.editLayer.addLayer(this.editLayer)},onMove:function(t){this.fireAndForward("editable:drawing:move",t)},onDrawingMouseMove:function(t){this.onMove(t)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(t){this.onEditing(),this.fireAndForward("editable:dragstart",t)},onDrag:function(t){this.onMove(t),this.fireAndForward("editable:drag",t)},onDragEnd:function(t){this.fireAndForward("editable:dragend",t)}}),d.Editable.MarkerEditor=d.Editable.BaseEditor.extend({onDrawingMouseMove:function(t){d.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&this.feature.setLatLng(t.latlng)},processDrawingClick:function(t){this.fireAndForward("editable:drawing:clicked",t),this.commitDrawing(t)},connect:function(t){t&&(this.feature._latlng=t.latlng),d.Editable.BaseEditor.prototype.connect.call(this,t)}}),d.Editable.PathEditor=d.Editable.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,addHooks:function(){return d.Editable.BaseEditor.prototype.addHooks.call(this),this.feature&&this.initVertexMarkers(),this},initVertexMarkers:function(t){if(this.enabled())if(t=t||this.getLatLngs(),o(t))this.addVertexMarkers(t);else for(var e=0;e<t.length;e++)this.initVertexMarkers(t[e])},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(t,e){return new this.tools.options.vertexMarkerClass(t,e,this)},onNewVertex:function(t){this.fireAndForward("editable:vertex:new",{latlng:t.latlng,vertex:t})},addVertexMarkers:function(t){for(var e=0;e<t.length;e++)this.addVertexMarker(t[e],t)},refreshVertexMarkers:function(t){t=t||this.getDefaultLatLngs();for(var e=0;e<t.length;e++)t[e].__vertex.update()},addMiddleMarker:function(t,e,i){return new this.tools.options.middleMarkerClass(t,e,i,this)},onVertexMarkerClick:function(t){var e,i;d.Editable.makeCancellable(t),this.fireAndForward("editable:vertex:click",t),t._cancelled||this.tools.drawing()&&this.tools._drawingEditor!==this||(e=t.vertex.getIndex(),t.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(t):t.originalEvent.altKey?this.onVertexMarkerAltClick(t):t.originalEvent.shiftKey?this.onVertexMarkerShiftClick(t):t.originalEvent.metaKey?this.onVertexMarkerMetaKeyClick(t):e===t.vertex.getLastIndex()&&this._drawing===d.Editable.FORWARD?e>=this.MIN_VERTEX-1&&(i=!0):0===e&&this._drawing===d.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX||0===e&&this._drawing===d.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?i=!0:this.onVertexRawMarkerClick(t),this.fireAndForward("editable:vertex:clicked",t),i&&this.commitDrawing(t))},onVertexRawMarkerClick:function(t){this.fireAndForward("editable:vertex:rawclick",t),t._cancelled||this.vertexCanBeDeleted(t.vertex)&&t.vertex.delete()},vertexCanBeDeleted:function(t){return t.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(t){this.fireAndForward("editable:vertex:deleted",t)},onVertexMarkerCtrlClick:function(t){this.fireAndForward("editable:vertex:ctrlclick",t)},onVertexMarkerShiftClick:function(t){this.fireAndForward("editable:vertex:shiftclick",t)},onVertexMarkerMetaKeyClick:function(t){this.fireAndForward("editable:vertex:metakeyclick",t)},onVertexMarkerAltClick:function(t){this.fireAndForward("editable:vertex:altclick",t)},onVertexMarkerContextMenu:function(t){this.fireAndForward("editable:vertex:contextmenu",t)},onVertexMarkerMouseDown:function(t){this.fireAndForward("editable:vertex:mousedown",t)},onVertexMarkerMouseOver:function(t){this.fireAndForward("editable:vertex:mouseover",t)},onVertexMarkerMouseOut:function(t){this.fireAndForward("editable:vertex:mouseout",t)},onMiddleMarkerMouseDown:function(t){this.fireAndForward("editable:middlemarker:mousedown",t)},onVertexMarkerDrag:function(t){this.onMove(t),this.feature._bounds&&this.extendBounds(t),this.fireAndForward("editable:vertex:drag",t)},onVertexMarkerDragStart:function(t){this.fireAndForward("editable:vertex:dragstart",t)},onVertexMarkerDragEnd:function(t){this.fireAndForward("editable:vertex:dragend",t)},setDrawnLatLngs:function(t){this._drawnLatLngs=t||this.getDefaultLatLngs()},startDrawing:function(){this._drawnLatLngs||this.setDrawnLatLngs(),d.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing()},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),d.Editable.BaseEditor.prototype.endDrawing.call(this),delete this._drawnLatLngs},addLatLng:function(t){this._drawing===d.Editable.FORWARD?this._drawnLatLngs.push(t):this._drawnLatLngs.unshift(t),this.feature._bounds.extend(t);t=this.addVertexMarker(t,this._drawnLatLngs);this.onNewVertex(t),this.refresh()},newPointForward:function(t){this.addLatLng(t),this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t)},newPointBackward:function(t){this.addLatLng(t),this.tools.anchorBackwardLineGuide(t)},push:function(t){if(!t)return console.error("L.Editable.PathEditor.push expect a valid latlng as parameter");this._drawing===d.Editable.FORWARD?this.newPointForward(t):this.newPointBackward(t)},removeLatLng:function(t){t.__vertex.delete(),this.refresh()},pop:function(){if(!(this._drawnLatLngs.length<=1)){var t=this._drawing===d.Editable.FORWARD?this._drawnLatLngs[this._drawnLatLngs.length-1]:this._drawnLatLngs[0];return this.removeLatLng(t),this._drawing===d.Editable.FORWARD?this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length-1]):this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]),t}},processDrawingClick:function(t){t.vertex&&t.vertex.editor===this||(this._drawing===d.Editable.FORWARD?this.newPointForward(t.latlng):this.newPointBackward(t.latlng),this.fireAndForward("editable:drawing:clicked",t))},onDrawingMouseMove:function(t){d.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&(this.tools.moveForwardLineGuide(t.latlng),this.tools.moveBackwardLineGuide(t.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},newShape:function(t){var e=this.addNewEmptyShape();e&&(this.setDrawnLatLngs(e[0]||e),this.startDrawingForward(),this.fireAndForward("editable:shape:new",{shape:e}),t&&this.newPointForward(t))},deleteShape:function(t,e){var i={shape:t};if(d.Editable.makeCancellable(i),this.fireAndForward("editable:shape:delete",i),!i._cancelled)return t=this._deleteShape(t,e),this.ensureNotFlat&&this.ensureNotFlat(),this.feature.setLatLngs(this.getLatLngs()),this.refresh(),this.reset(),this.fireAndForward("editable:shape:deleted",{shape:t}),t},_deleteShape:function(t,e){if((e=e||this.getLatLngs()).length){var i=this,n=function(t,e){return t.splice(t.indexOf(e),1),t.length||i._deleteShape(t),e};if(e===t)return e.splice(0,Number.MAX_VALUE);for(var r=0;r<e.length;r++){if(e[r]===t)return n(e,t);if(-1!==e[r].indexOf(t))return n(e[r],t)}}},deleteShapeAt:function(t){t=this.feature.shapeAt(t);if(t)return this.deleteShape(t)},appendShape:function(t){this.insertShape(t)},prependShape:function(t){this.insertShape(t,0)},insertShape:function(t,e){this.ensureMulti(),t=this.formatShape(t),void 0===e&&(e=this.feature._latlngs.length),this.feature._latlngs.splice(e,0,t),this.feature.redraw(),this._enabled&&this.reset()},extendBounds:function(t){this.feature._bounds.extend(t.vertex.latlng)},onDragStart:function(t){this.editLayer.clearLayers(),d.Editable.BaseEditor.prototype.onDragStart.call(this,t)},onDragEnd:function(t){this.initVertexMarkers(),d.Editable.BaseEditor.prototype.onDragEnd.call(this,t)}}),d.Editable.PolylineEditor=d.Editable.PathEditor.extend({startDrawingBackward:function(){this._drawing=d.Editable.BACKWARD,this.startDrawing()},continueBackward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),0<t.length&&(this.tools.attachBackwardLineGuide(),this.tools.anchorBackwardLineGuide(t[0])),this.startDrawingBackward())},continueForward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),0<t.length&&(this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t[t.length-1])),this.startDrawingForward())},getDefaultLatLngs:function(t){return!(t=t||this.feature._latlngs).length||t[0]instanceof d.LatLng?t:this.getDefaultLatLngs(t[0])},ensureMulti:function(){this.feature._latlngs.length&&o(this.feature._latlngs)&&(this.feature._latlngs=[this.feature._latlngs])},addNewEmptyShape:function(){if(this.feature._latlngs.length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},formatShape:function(t){return o(t)?t:t[0]?this.formatShape(t[0]):void 0},splitShape:function(t,e){var i,n;!e||e>=t.length-1||(this.ensureMulti(),-1!==(i=this.feature._latlngs.indexOf(t))&&(n=t.slice(0,e+1),(e=t.slice(e))[0]=d.latLng(e[0].lat,e[0].lng,e[0].alt),this.feature._latlngs.splice(i,1,n,e),this.refresh(),this.reset()))}}),d.Editable.PolygonEditor=d.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,newPointForward:function(t){d.Editable.PathEditor.prototype.newPointForward.call(this,t),this.tools.backwardLineGuide._latlngs.length||this.tools.anchorBackwardLineGuide(t),2===this._drawnLatLngs.length&&this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(t){this.ensureNotFlat();var e=this.feature.shapeAt(t);if(e){t=[];return e.push(t),t}},newHole:function(t){var e=this.addNewEmptyHole(t);e&&(this.setDrawnLatLngs(e),this.startDrawingForward(),t&&this.newPointForward(t))},addNewEmptyShape:function(){if(this.feature._latlngs.length&&this.feature._latlngs[0].length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},ensureMulti:function(){this.feature._latlngs.length&&o(this.feature._latlngs[0])&&(this.feature._latlngs=[this.feature._latlngs])},ensureNotFlat:function(){this.feature._latlngs.length&&!o(this.feature._latlngs)||(this.feature._latlngs=[this.feature._latlngs])},vertexCanBeDeleted:function(t){var e=this.feature.parentShape(t.latlngs);return 0<d.Util.indexOf(e,t.latlngs)||d.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,t)},getDefaultLatLngs:function(){return this.feature._latlngs.length||this.feature._latlngs.push([]),this.feature._latlngs[0]},formatShape:function(t){return!o(t)||t[0]&&0===t[0].length?t:[t]}}),d.Editable.RectangleEditor=d.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:4,options:{skipMiddleMarkers:!0},extendBounds:function(t){var e=t.vertex.getIndex(),i=t.vertex.getNext(),n=t.vertex.getPrevious(),r=(e+2)%4,e=t.vertex.latlngs[r],r=new d.LatLngBounds(t.latlng,e);n.latlng.update([t.latlng.lat,e.lng]),i.latlng.update([e.lat,t.latlng.lng]),this.updateBounds(r),this.refreshVertexMarkers()},onDrawingMouseDown:function(t){d.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,t),this.connect();var e=this.getDefaultLatLngs();3===e.length&&e.push(t.latlng);var i=new d.LatLngBounds(t.latlng,t.latlng);this.updateBounds(i),this.updateLatLngs(i),this.refresh(),this.reset(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),e[3].__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,t)},getDefaultLatLngs:function(t){return t||this.feature._latlngs[0]},updateBounds:function(t){this.feature._bounds=t},updateLatLngs:function(t){for(var e=this.getDefaultLatLngs(),i=this.feature._boundsToLatLngs(t),n=0;n<e.length;n++)e[n].update(i[n])}}),d.Editable.CircleEditor=d.Editable.PathEditor.extend({MIN_VERTEX:2,options:{skipMiddleMarkers:!0},initialize:function(t,e,i){d.Editable.PathEditor.prototype.initialize.call(this,t,e,i),this._resizeLatLng=this.computeResizeLatLng()},computeResizeLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x+t,e.y-t])},updateResizeLatLng:function(){this._resizeLatLng.update(this.computeResizeLatLng()),this._resizeLatLng.__vertex.update()},getLatLngs:function(){return[this.feature._latlng,this._resizeLatLng]},getDefaultLatLngs:function(){return this.getLatLngs()},onVertexMarkerDrag:function(t){1===t.vertex.getIndex()?this.resize(t):this.updateResizeLatLng(t),d.Editable.PathEditor.prototype.onVertexMarkerDrag.call(this,t)},resize:function(t){t=this.feature._latlng.distanceTo(t.latlng);this.feature.setRadius(t)},onDrawingMouseDown:function(t){d.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,t),this._resizeLatLng.update(t.latlng),this.feature._latlng.update(t.latlng),this.connect(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),this._resizeLatLng.__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,d.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,t)},onDrag:function(t){d.Editable.PathEditor.prototype.onDrag.call(this,t),this.feature.dragging.updateLatLng(this._resizeLatLng)}});function t(){this.on("add",this._onEditableAdd)}var e={createEditor:function(t){t=t||this._map;var e=(this.options.editOptions||{}).editTools||t.editTools;if(!e)throw Error("Unable to detect Editable instance.");return new(this.options.editorClass||this.getEditorClass(e))(t,this,this.options.editOptions)},enableEdit:function(t){return this.editor||this.createEditor(t),this.editor.enable(),this.editor},editEnabled:function(){return this.editor&&this.editor.enabled()},disableEdit:function(){this.editor&&(this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()},_onEditableAdd:function(){this.editor&&this.enableEdit()}},i={getEditorClass:function(t){return t&&t.options.polylineEditorClass?t.options.polylineEditorClass:d.Editable.PolylineEditor},shapeAt:function(t,e){var i=null;if(!(e=e||this._latlngs).length)return i;if(o(e)&&this.isInLatLngs(t,e))i=e;else for(var n=0;n<e.length;n++)if(this.isInLatLngs(t,e[n]))return e[n];return i},isInLatLngs:function(t,e){if(!e)return!1;var i,n,r,a,s=[],o=this._clickTolerance();if(this._projectLatlngs(e,s,this._pxBounds),s=s[0],a=this._map.latLngToLayerPoint(t),!this._pxBounds.contains(a))return!1;for(i=1,r=s.length,n=0;i<r;n=i++)if(d.LineUtil.pointToSegmentDistance(a,s[n],s[i])<=o)return!0;return!1}},n={getEditorClass:function(t){return t&&t.options.polygonEditorClass?t.options.polygonEditorClass:d.Editable.PolygonEditor},shapeAt:function(t,e){var i=null;if(!(e=e||this._latlngs).length)return i;if(o(e)&&this.isInLatLngs(t,e))i=e;else if(o(e[0])&&this.isInLatLngs(t,e[0]))i=e;else for(var n=0;n<e.length;n++)if(this.isInLatLngs(t,e[n][0]))return e[n];return i},isInLatLngs:function(t,e){for(var i,n,r=!1,a=0,s=e.length,o=s-1;a<s;o=a++)i=e[a],n=e[o],i.lat>t.lat!=n.lat>t.lat&&t.lng<(n.lng-i.lng)*(t.lat-i.lat)/(n.lat-i.lat)+i.lng&&(r=!r);return r},parentShape:function(t,e){if(e=e||this._latlngs){var i=d.Util.indexOf(e,t);if(-1!==i)return e;for(var n=0;n<e.length;n++)if(-1!==d.Util.indexOf(e[n],t))return e[n]}}},r={getEditorClass:function(t){return t&&t.options.markerEditorClass?t.options.markerEditorClass:d.Editable.MarkerEditor}},a={getEditorClass:function(t){return t&&t.options.rectangleEditorClass?t.options.rectangleEditorClass:d.Editable.RectangleEditor}},s={getEditorClass:function(t){return t&&t.options.circleEditorClass?t.options.circleEditorClass:d.Editable.CircleEditor}},o=d.LineUtil.isFlat||d.LineUtil._flat||d.Polyline._flat;d.Polyline&&(d.Polyline.include(e),d.Polyline.include(i),d.Polyline.addInitHook(t)),d.Polygon&&(d.Polygon.include(e),d.Polygon.include(n)),d.Marker&&(d.Marker.include(e),d.Marker.include(r),d.Marker.addInitHook(t)),d.Rectangle&&(d.Rectangle.include(e),d.Rectangle.include(a)),d.Circle&&(d.Circle.include(e),d.Circle.include(s)),d.LatLng.prototype.update=function(t){t=d.latLng(t),this.lat=t.lat,this.lng=t.lng}},window);
!function(o,r){"function"==typeof define&&define.amd&&r.toGeoJSON?define(["leaflet"],function(e){o(e,r.toGeoJSON)}):"object"==typeof module&&module.exports?module.exports=function(e,t,i){return void 0===t&&(t=void 0!==r?require("leaflet"):require("leaflet")(e)),void 0===i&&(i=void 0!==r?require("togeojson"):require("togeojson")(e)),o(t,i),t}:void 0!==r&&r.L&&r.toGeoJSON&&o(r.L,r.toGeoJSON)}(function(r,i){var e=r.Layer.extend({options:{layer:r.geoJson,layerOptions:{},fileSizeLimit:1024},initialize:function(e,t){this._map=e,r.Util.setOptions(this,t),this._parsers={geojson:this._loadGeoJSON,json:this._loadGeoJSON,gpx:this._convertToGeoJSON,kml:this._convertToGeoJSON}},load:function(i,e){var o;return!this._isParameterMissing(i,"file")&&(!!this._isFileSizeOk(i.size)&&(!!(o=this._getParser(i.name,e))&&((e=new FileReader).onload=r.Util.bind(function(e){var t;try{this.fire("data:loading",{filename:i.name,format:o.ext}),t=o.processor.call(this,e.target.result,o.ext),this.fire("data:loaded",{layer:t,filename:i.name,format:o.ext})}catch(e){this.fire("data:error",{error:e})}},this),i.testing||e.readAsText(i),e)))},loadMultiple:function(e,t){var i=[];if(e[0])for(e=Array.prototype.slice.apply(e);0<e.length;)i.push(this.load(e.shift(),t));return i},loadData:function(e,t,i){var o,r;if(!this._isParameterMissing(e,"data")&&!this._isParameterMissing(t,"name")&&this._isFileSizeOk(e.length)&&(o=this._getParser(t,i)))try{this.fire("data:loading",{filename:t,format:o.ext}),r=o.processor.call(this,e,o.ext),this.fire("data:loaded",{layer:r,filename:t,format:o.ext})}catch(e){this.fire("data:error",{error:e})}},_isParameterMissing:function(e,t){return void 0===e&&(this.fire("data:error",{error:new Error("Missing parameter: "+t)}),!0)},_getParser:function(e,t){if(t=t||e.split(".").pop(),e=this._parsers[t])return{processor:e,ext:t};this.fire("data:error",{error:new Error("Unsupported file type ("+t+")")})},_isFileSizeOk:function(e){e=(e/1024).toFixed(4);return!(e>this.options.fileSizeLimit)||(this.fire("data:error",{error:new Error("File size exceeds limit ("+e+" > "+this.options.fileSizeLimit+"kb)")}),!1)},_loadGeoJSON:function(e){if("string"==typeof e&&(e=JSON.parse(e)),0===(e=this.options.layer(e,this.options.layerOptions)).getLayers().length)throw new Error("GeoJSON has no valid layers.");return this.options.addToMap&&e.addTo(this._map),e},_convertToGeoJSON:function(e,t){return"string"==typeof e&&(e=(new window.DOMParser).parseFromString(e,"text/xml")),e=i[t](e),this._loadGeoJSON(e)}}),t=r.Control.extend({statics:{TITLE:"Load local file (GPX, KML, GeoJSON)",LABEL:"&#8965;"},options:{position:"topleft",fitBounds:!0,layerOptions:{},addToMap:!0,fileSizeLimit:1024},initialize:function(e){r.Util.setOptions(this,e),this.loader=null},onAdd:function(t){return this.loader=r.FileLayer.fileLoader(t,this.options),this.loader.on("data:loaded",function(e){this.options.fitBounds&&window.setTimeout(function(){t.fitBounds(e.layer.getBounds())},500)},this),this._initDragAndDrop(t),this._initContainer()},_initDragAndDrop:function(t){var e,i=this.loader,o=t._container,r={dragenter:function(){t.scrollWheelZoom.disable()},dragleave:function(){t.scrollWheelZoom.enable()},dragover:function(e){e.stopPropagation(),e.preventDefault()},drop:function(e){e.stopPropagation(),e.preventDefault(),i.loadMultiple(e.dataTransfer.files),t.scrollWheelZoom.enable()}};for(e in r)r.hasOwnProperty(e)&&o.addEventListener(e,r[e],!1)},_initContainer:function(){var t,e=this.loader,i="leaflet-control-filelayer leaflet-control-zoom",o="leaflet-bar",o=r.DomUtil.create("div",i+" "+o),i=r.DomUtil.create("a",i+"-in leaflet-bar-part",o);return i.innerHTML=r.Control.FileLayerLoad.LABEL,i.href="#",i.title=r.Control.FileLayerLoad.TITLE,(t=r.DomUtil.create("input","hidden",o)).type="file",t.multiple="multiple",this.options.formats?t.accept=this.options.formats.join(","):t.accept=".gpx,.kml,.json,.geojson",t.style.display="none",t.addEventListener("change",function(){e.loadMultiple(this.files),this.value=""},!1),r.DomEvent.disableClickPropagation(i),r.DomEvent.on(i,"click",function(e){t.click(),e.preventDefault()}),o}});r.FileLayer={},r.FileLayer.FileLoader=e,r.FileLayer.fileLoader=function(e,t){return new r.FileLayer.FileLoader(e,t)},r.Control.FileLayerLoad=t,r.Control.fileLayerLoad=function(e){return new r.Control.FileLayerLoad(e)}},window);
!function(t){var e;if("function"==typeof define&&define.amd)define(["leaflet"],t);else if("undefined"!=typeof module)e=require("leaflet"),module.exports=t(e);else{if(void 0===window.L)throw"Leaflet must be loaded first";t(window.L)}}(function(h){"use strict";return h.Polyline._flat=h.LineUtil.isFlat||h.Polyline._flat||function(t){return!h.Util.isArray(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]},h.GeometryUtil=h.extend(h.GeometryUtil||{},{distance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))},distanceSegment:function(t,e,n,r){e=t.latLngToLayerPoint(e),n=t.latLngToLayerPoint(n),r=t.latLngToLayerPoint(r);return h.LineUtil.pointToSegmentDistance(e,n,r)},readableDistance:function(t,e){t="imperial"!==e?1e3<t?(t/1e3).toFixed(2)+" km":t.toFixed(1)+" m":1760<(t*=1.09361)?(t/1760).toFixed(2)+" miles":t.toFixed(1)+" yd";return t},belongsSegment:function(t,e,n,r){r=void 0===r?.2:r;var o=e.distanceTo(n);return(e.distanceTo(t)+t.distanceTo(n)-o)/o<r},length:function(t){t=h.GeometryUtil.accumulatedLengths(t);return 0<t.length?t[t.length-1]:0},accumulatedLengths:function(t){if("function"==typeof t.getLatLngs&&(t=t.getLatLngs()),0===t.length)return[];for(var e=0,n=[0],r=0,o=t.length-1;r<o;r++)e+=t[r].distanceTo(t[r+1]),n.push(e);return n},closestOnSegment:function(t,e,n,r){var o=t.getMaxZoom();o===1/0&&(o=t.getZoom());e=t.project(e,o),n=t.project(n,o),r=t.project(r,o),r=h.LineUtil.closestPointOnSegment(e,n,r);return t.unproject(r,o)},closest:function(t,e,n,r){var o,a,i,l,s,c=1/0,u=null;if(e instanceof Array){if(e[0]instanceof Array&&"number"!=typeof e[0][0]){for(a=0;a<e.length;a++)(l=h.GeometryUtil.closest(t,e[a],n,r))&&l.distance<c&&(c=l.distance,u=l);return u}if(!(e[0]instanceof h.LatLng||"number"==typeof e[0][0]||"number"==typeof e[0].lat))return u;e=h.polyline(e)}if(!(e instanceof h.Polyline))return u;if(o=JSON.parse(JSON.stringify(e.getLatLngs().slice(0))),e instanceof h.Polygon&&(s=function(t){if(h.Polyline._flat(t))t.push(t[0]);else for(var e=0;e<t.length;e++)s(t[e])})(o),h.Polyline._flat(o)){if(r){for(a=0,i=o.length;a<i;a++){var g,f=o[a];(g=h.GeometryUtil.distance(t,n,f))<c&&(c=g,(u=f).distance=g)}return u}for(a=0,i=o.length;a<i-1;a++){var y=o[a],L=o[a+1];(g=h.GeometryUtil.distanceSegment(t,n,y,L))<=c&&(c=g,(u=h.GeometryUtil.closestOnSegment(t,n,y,L)).distance=g)}return u}for(a=0;a<o.length;a++)(l=h.GeometryUtil.closest(t,o[a],n,r)).distance<c&&(c=l.distance,u=l);return u},closestLayer:function(t,e,n){for(var r=1/0,o=null,a=null,i=1/0,l=0,s=e.length;l<s;l++){var c,u=e[l];u instanceof h.LayerGroup?(c=h.GeometryUtil.closestLayer(t,u.getLayers(),n)).distance<r&&(r=c.distance,o=c):("function"==typeof u.getLatLng?(a=u.getLatLng(),i=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,u,n))&&(i=a.distance),i<r&&(o={layer:u,latlng:a,distance:r=i}))}return o},nClosestLayers:function(t,e,n,r){if((r="number"==typeof r?r:e.length)<1||e.length<1)return null;for(var o,a,i=[],l=0,s=e.length;l<s;l++){var c,u=e[l];u instanceof h.LayerGroup?(c=h.GeometryUtil.closestLayer(t,u.getLayers(),n),i.push(c)):("function"==typeof u.getLatLng?(a=u.getLatLng(),o=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,u,n))&&(o=a.distance),i.push({layer:u,latlng:a,distance:o}))}return i.sort(function(t,e){return t.distance-e.distance}),i.length>r?i.slice(0,r):i},layersWithin:function(t,e,n,r){r="number"==typeof r?r:1/0;for(var o=[],a=null,i=0,l=0,s=e.length;l<s;l++){var c=e[l];"function"==typeof c.getLatLng?(a=c.getLatLng(),i=h.GeometryUtil.distance(t,n,a)):(a=h.GeometryUtil.closest(t,c,n))&&(i=a.distance),a&&i<r&&o.push({layer:c,latlng:a,distance:i})}return o.sort(function(t,e){return t.distance-e.distance})},closestLayerSnap:function(t,e,n,r,o){r="number"==typeof r?r:1/0,o="boolean"!=typeof o||o;e=h.GeometryUtil.closestLayer(t,e,n);return!e||e.distance>r?null:(!o||"function"!=typeof e.layer.getLatLngs||(o=h.GeometryUtil.closest(t,e.layer,e.latlng,!0)).distance<r&&(e.latlng=o,e.distance=h.GeometryUtil.distance(t,o,n)),e)},interpolateOnPointSegment:function(t,e,n){return h.point(t.x*(1-n)+n*e.x,t.y*(1-n)+n*e.y)},interpolateOnLine:function(t,e,n){var r=(e=e instanceof h.Polyline?e.getLatLngs():e).length;if(r<2)return null;if(0===(n=Math.max(Math.min(n,1),0)))return{latLng:e[0]instanceof h.LatLng?e[0]:h.latLng(e[0]),predecessor:-1};if(1==n)return{latLng:e[e.length-1]instanceof h.LatLng?e[e.length-1]:h.latLng(e[e.length-1]),predecessor:e.length-2};var o=t.getMaxZoom();o===1/0&&(o=t.getZoom());for(var a=[],i=0,l=0;l<r;l++)a[l]=t.project(e[l],o),0<l&&(i+=a[l-1].distanceTo(a[l]));for(var s=i*n,c=0,u=0,l=0;u<s;l++){var g=a[l],f=a[l+1],c=u;u+=g.distanceTo(f)}null==g&&null==f&&(g=a[0],f=a[1],l=1);n=u-c!=0?(s-c)/(u-c):0,n=h.GeometryUtil.interpolateOnPointSegment(g,f,n);return{latLng:t.unproject(n,o),predecessor:l-1}},locateOnLine:function(t,e,n){var r=e.getLatLngs();if(n.equals(r[0]))return 0;if(n.equals(r[r.length-1]))return 1;for(var o=h.GeometryUtil.closest(t,e,n,!1),a=h.GeometryUtil.accumulatedLengths(r),t=a[a.length-1],i=0,l=!1,s=0,c=r.length-1;s<c;s++){var u=r[s],g=r[s+1],i=a[s];if(h.GeometryUtil.belongsSegment(o,u,g,.001)){i+=u.distanceTo(o),l=!0;break}}if(!l)throw"Could not interpolate "+n.toString()+" within "+e.toString();return i/t},reverse:function(t){return h.polyline(t.getLatLngs().slice(0).reverse())},extract:function(t,e,n,r){if(r<n)return h.GeometryUtil.extract(t,h.GeometryUtil.reverse(e),1-n,1-r);n=Math.max(Math.min(n,1),0),r=Math.max(Math.min(r,1),0);var o=e.getLatLngs(),a=h.GeometryUtil.interpolateOnLine(t,e,n),i=h.GeometryUtil.interpolateOnLine(t,e,r);if(n==r)return[h.GeometryUtil.interpolateOnLine(t,e,r).latLng];-1==a.predecessor&&(a.predecessor=0),-1==i.predecessor&&(i.predecessor=0);o=o.slice(a.predecessor+1,i.predecessor+1);return o.unshift(a.latLng),o.push(i.latLng),o},isBefore:function(t,e){if(!e)return!1;t=t.getLatLngs(),e=e.getLatLngs();return t[t.length-1].equals(e[0])},isAfter:function(t,e){if(!e)return!1;t=t.getLatLngs(),e=e.getLatLngs();return t[0].equals(e[e.length-1])},startsAtExtremity:function(t,e){if(!e)return!1;t=t.getLatLngs(),e=e.getLatLngs(),t=t[0];return t.equals(e[0])||t.equals(e[e.length-1])},computeAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},computeSlope:function(t,e){e=(e.y-t.y)/(e.x-t.x);return{a:e,b:t.y-e*t.x}},rotatePoint:function(t,e,n,r){var o=t.getMaxZoom();o===1/0&&(o=t.getZoom());var a=n*Math.PI/180,n=t.project(e,o),e=t.project(r,o),r=Math.cos(a)*(n.x-e.x)-Math.sin(a)*(n.y-e.y)+e.x,e=Math.sin(a)*(n.x-e.x)+Math.cos(a)*(n.y-e.y)+e.y;return t.unproject(new h.Point(r,e),o)},bearing:function(t,e){var n=Math.PI/180,r=t.lat*n,o=e.lat*n,t=t.lng*n,e=e.lng*n,n=Math.sin(e-t)*Math.cos(o),t=Math.cos(r)*Math.sin(o)-Math.sin(r)*Math.cos(o)*Math.cos(e-t),t=(180*Math.atan2(n,t)/Math.PI+360)%360;return 180<=t?t-360:t},destination:function(t,e,n){e=(e+360)%360;var r=Math.PI/180,o=180/Math.PI,a=t.lng*r,i=t.lat*r,l=e*r,t=Math.sin(i),e=Math.cos(i),r=Math.cos(n/6378137),i=Math.sin(n/6378137),n=Math.asin(t*r+e*i*Math.cos(l)),t=a+Math.atan2(Math.sin(l)*i*e,r-t*Math.sin(n)),t=180<(t*=o)?t-360:t<-180?t+360:t;return h.latLng([n*o,t])},angle:function(t,e,n){e=t.latLngToContainerPoint(e),n=t.latLngToContainerPoint(n),e=180*Math.atan2(n.y-e.y,n.x-e.x)/Math.PI+90;return e+=e<0?360:0},destinationOnSegment:function(t,e,n,r){var o=h.GeometryUtil.angle(t,e,n),r=h.GeometryUtil.destination(e,o,r);return h.GeometryUtil.closestOnSegment(t,r,e,n)}}),h.GeometryUtil});
!function(t,i){"function"==typeof define&&define.amd?define(["leaflet"],i):"object"==typeof exports?module.exports=i:i(t.L)}(this,function(u){if(u.Hotline)return u;var i=function(t){if(!(this instanceof i))return new i(t);this._canvas=t="string"==typeof t?document.getElementById(t):t,this._ctx=t.getContext("2d"),this._width=t.width,this._height=t.height,this._weight=5,this._outlineWidth=1,this._outlineColor="black",this._min=0,this._max=1,this._data=[],this.palette({0:"green",.5:"yellow",1:"red"})};i.prototype={width:function(t){return this._width=t,this},height:function(t){return this._height=t,this},weight:function(t){return this._weight=t,this},outlineWidth:function(t){return this._outlineWidth=t,this},outlineColor:function(t){return this._outlineColor=t,this},palette:function(t){var i,e=document.createElement("canvas"),n=e.getContext("2d"),o=n.createLinearGradient(0,0,0,256);for(i in e.width=1,e.height=256,t)o.addColorStop(i,t[i]);return n.fillStyle=o,n.fillRect(0,0,1,256),this._palette=n.getImageData(0,0,1,256).data,this},min:function(t){return this._min=t,this},max:function(t){return this._max=t,this},data:function(t){return this._data=t,this},add:function(t){return this._data.push(t),this},draw:function(){var t=this._ctx;return t.globalCompositeOperation="source-over",t.lineCap="round",this._drawOutline(t),this._drawHotline(t),this},getRGBForValue:function(t){t=Math.min(Math.max((t-this._min)/(this._max-this._min),0),.999),t=4*Math.floor(256*t);return[this._palette[t],this._palette[1+t],this._palette[2+t]]},_drawOutline:function(t){var i,e,n,o,h,r,s;if(this._outlineWidth)for(i=0,n=this._data.length;i<n;i++)for(o=this._data[i],t.lineWidth=this._weight+2*this._outlineWidth,e=1,h=o.length;e<h;e++)r=o[e-1],s=o[e],t.strokeStyle=this._outlineColor,t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.stroke()},_drawHotline:function(t){var i,e,n,o,h,r,s,l,a,u;for(t.lineWidth=this._weight,i=0,n=this._data.length;i<n;i++)for(e=1,h=(o=this._data[i]).length;e<h;e++)r=o[e-1],s=o[e],l=t.createLinearGradient(r.x,r.y,s.x,s.y),a=this.getRGBForValue(r.z),u=this.getRGBForValue(s.z),l.addColorStop(0,"rgb("+a.join(",")+")"),l.addColorStop(1,"rgb("+u.join(",")+")"),t.strokeStyle=l,t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.stroke()}};function t(t){return u.Browser.canvas?new e(t):null}var e=u.Canvas.extend({_initContainer:function(){u.Canvas.prototype._initContainer.call(this),this._hotline=new i(this._container)},_update:function(){u.Canvas.prototype._update.call(this),this._hotline.width(this._container.width),this._hotline.height(this._container.height)},_updatePoly:function(t){var i;!this._drawing||(i=t._parts).length&&(this._updateOptions(t),this._hotline.data(i).draw())},_updateOptions:function(t){null!=t.options.min&&this._hotline.min(t.options.min),null!=t.options.max&&this._hotline.max(t.options.max),null!=t.options.weight&&this._hotline.weight(t.options.weight),null!=t.options.outlineWidth&&this._hotline.outlineWidth(t.options.outlineWidth),null!=t.options.outlineColor&&this._hotline.outlineColor(t.options.outlineColor),t.options.palette&&this._hotline.palette(t.options.palette)}}),a={clipSegment:function(t,i,e,n,o){var h,r,s,l=n?this._lastCode:u.LineUtil._getBitCode(t,e),a=u.LineUtil._getBitCode(i,e);for(this._lastCode=a;;){if(!(l|a))return[t,i];if(l&a)return!1;h=l||a,r=u.LineUtil._getEdgeIntersection(t,i,h,e,o),s=u.LineUtil._getBitCode(r,e),h===l?(r.z=t.z,t=r,l=s):(r.z=i.z,i=r,a=s)}}};return u.Hotline=u.Polyline.extend({statics:{Renderer:e,renderer:t},options:{renderer:t(),min:0,max:1,palette:{0:"green",.5:"yellow",1:"red"},weight:5,outlineColor:"black",outlineWidth:1},getRGBForValue:function(t){return this._renderer._hotline.getRGBForValue(t)},_projectLatlngs:function(t,i,e){var n,o,h=t[0]instanceof u.LatLng,r=t.length;if(h){for(o=[],n=0;n<r;n++)o[n]=this._map.latLngToLayerPoint(t[n]),o[n].z=t[n].alt,e.extend(o[n]);i.push(o)}else for(n=0;n<r;n++)this._projectLatlngs(t[n],i,e)},_clipPoints:function(){if(this.options.noClip)this._parts=this._rings;else{this._parts=[];for(var t,i,e,n,o=this._parts,h=this._renderer._bounds,r=0,s=0,l=this._rings.length;r<l;r++)for(t=0,i=(n=this._rings[r]).length;t<i-1;t++)(e=a.clipSegment(n[t],n[t+1],h,t,!0))&&(o[s]=o[s]||[],o[s].push(e[0]),e[1]===n[t+1]&&t!==i-2||(o[s].push(e[1]),s++))}},_clickTolerance:function(){return this.options.weight/2+this.options.outlineWidth+(u.Browser.touch?10:0)}}),u.hotline=function(t,i){return new u.Hotline(t,i)},u});
!function(e){"function"==typeof bootstrap?bootstrap("leafletosmnotes",e):"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof ses?ses.ok()&&(ses.makeLeafletOsmNotes=e):"undefined"!=typeof window?window.leafletOsmNotes=e():global.leafletOsmNotes=e()}(function(){var define,ses,bootstrap,module,exports;return function(r,s,e){function a(n,e){if(!s[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}t=s[n]={exports:{}};r[n][0].call(t.exports,function(e){var t=r[n][1][e];return a(t||e)},t,t.exports)}return s[n].exports}for(var i="function"==typeof require&&require,t=0;t<e.length;t++)a(e[t]);return a}({1:[function(e,t,n){var r=e("reqwest"),s=e("moment");t.exports=window.L.LayerGroup.extend({API:"https://api.openstreetmap.org/api/0.6/notes.json",_loadedIds:{},onAdd:function(e){this._map=e,this._loadSuccess=L.bind(function(e){for(var t=0;t<e.features.length;t++)this._loadedIds[e.features[t].properties.id]||(e.features[t].properties=this._template(e.features[t].properties),this._loadedIds[e.features[t].properties.id]=!0,this.notesLayer.addData(e.features[t]))},this),this._pointToLayer=L.bind(function(e){return L.marker([e.geometry.coordinates[1],e.geometry.coordinates[0]],{icon:this._icon(e.properties)}).bindPopup("<h1>"+e.properties.title+"</h1><div>"+e.properties.description+"</div>")},this),this.notesLayer=L.geoJson({type:"FeatureCollection",features:[]},{pointToLayer:this._pointToLayer}).addTo(this),e.on("viewreset",this._load,this).on("moveend",this._load,this),this._load()},_icon:function(e){var t={small:[20,50],medium:[30,70],large:[35,90]},n=(e=e||{})["marker-size"]||"medium",r=e["marker-symbol"]?"-"+e["marker-symbol"]:"",e=(e["marker-color"]||"7e7e7e").replace("#","");return L.icon({iconUrl:"https://a.tiles.mapbox.com/v3/marker/pin-"+n.charAt(0)+r+"+"+e+(L.Browser.retina?"@2x":"")+".png",iconSize:t[n],iconAnchor:[t[n][0]/2,t[n][1]/2],popupAnchor:[0,-t[n][1]/2]})},_template:function(e){e.title='<a href="https://www.openstreetmap.org/browse/note/'+e.id+'">Note #'+e.id+"</a>",e.description="",e["marker-color"]={closed:"11f",open:"f11"}[e.status],e["marker-symbol"]={closed:"circle-stroked",open:"circle"}[e.status];for(var t=0;t<e.comments.length;t++){var n=e.comments[t].user?'<a target="_blank" href="'+e.comments[t].user_url+'">'+e.comments[t].user+"</a>":"Anonymous";e.description+='<div class="comment-meta">'+n+" - "+s(e.comments[t].date).calendar()+' </div> <div class="comment-text">'+e.comments[t].html+"</div>"}return e},_load:function(e){var t,n;r({url:this.API+"?bbox="+(t=this._map,n=t.getBounds().getSouthWest(),t=t.getBounds().getNorthEast(),[n.lng,n.lat,t.lng,t.lat]),type:"json",success:this._loadSuccess,error:function(){}})}})},{reqwest:2,moment:3}],2:[function(require,module,exports){!function(){var P,Q;P=this,Q=function(){var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,(twoHundo.test(e.request.status)?t:n)(e.request))}}function setHeaders(e,t){var n,r=t.headers||{};for(n in r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"],t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||(r[contentType]=t.contentType||defaultHeaders.contentType),r)r.hasOwnProperty(n)&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){void 0!==t.withCredentials&&void 0!==e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var s=uniqid++,a=e.jsonpCallback||"callback",i=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),o=new RegExp("((^|\\?|&)"+a+")=([^&]+)"),u=r.match(o),l=doc.createElement("script"),c=0,d=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?r=r.replace(o,"$1="+i):i=u[3]:r=urlappend(r,a+"="+i),win[i]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,void 0===l.onreadystatechange||d||(l.event="onclick",l.htmlFor=l.id="_reqwest_"+s),l.onload=l.onreadystatechange=function(){if(l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||c)return!1;l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),e.success&&e.success(lastValue),lastValue=void 0,head.removeChild(l),c=1},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,e.error&&e.error({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),c=1}}}function getRequest(e,t){var n,r=this.o,s=(r.method||"GET").toUpperCase(),a="string"==typeof r?r:r.url,i=!1!==r.processData&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null;return"jsonp"!=r.type&&"GET"!=s||!i||(a=urlappend(a,i),i=null),"jsonp"==r.type?handleJsonp(r,e,t,a):((n=xhr()).open(s,a,!0),setHeaders(n,r),setCredentials(n,r),n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),n.send(i),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){e=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return e?e[1]:"js"}function init(o,fn){this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this,type=o.type||setType(this.url);function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;0<self._completeHandlers.length;)self._completeHandlers.shift()(e)}function success(resp){var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=resp.responseText=filteredResponse;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp);0<self._fulfillmentHandlers.length;)self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,n){for(self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;0<self._errorHandlers.length;)self._errorHandlers.shift()(e,t,n);complete(e)}fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&this._fulfillmentHandlers.push(function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){function n(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))}var r,s,a,i,o=e.name,u=e.tagName.toLowerCase();if(!e.disabled&&o)switch(u){case"input":/reset|button|image|file/i.test(e.type)||(r=/checkbox/i.test(e.type),s=/radio/i.test(e.type),a=e.value,(r||s)&&!e.checked||t(o,normalize(r&&""===a?"on":a)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())n(0<=e.selectedIndex?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&n(e.options[i])}}function eachFormElement(){for(var e,a=this,t=0;t<arguments.length;t++)/input|select|textarea/i.test((e=arguments[t]).tagName)&&serial(e,a),function(e,t){for(var n,r,s=0;s<t.length;s++)for(r=e[byTag](t[s]),n=0;n<r.length;n++)serial(r[n],a)}(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var n={};return eachFormElement.apply(function(e,t){e in n?(n[e]&&!isArray(n[e])&&(n[e]=[n[e]]),n[e].push(t)):n[e]=t},arguments),n}return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return this._fulfilled?e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this}},reqwest.serializeArray=function(){var n=[];return eachFormElement.apply(function(e,t){n.push({name:e,value:t})},arguments),n},reqwest.serialize=function(){if(0===arguments.length)return"";var e=Array.prototype.slice.call(arguments,0),t=e.pop();return t&&t.nodeType&&e.push(t)&&(t=null),("map"==(t=t&&t.type)?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString).apply(null,e)},reqwest.toQueryString=function(e){function t(e,t){a+=i(e)+"="+i(t)+"&"}var n,r,s,a="",i=encodeURIComponent;if(isArray(e))for(n=0;e&&n<e.length;n++)t(e[n].name,e[n].value);else for(r in e)if(Object.hasOwnProperty.call(e,r))if(s=e[r],isArray(s))for(n=0;n<s.length;n++)t(r,s[n]);else t(r,e[r]);return a.replace(/&$/,"").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){for(var t in e=e||{})globalSetupOptions[t]=e[t]},reqwest},void 0!==module&&module.exports?module.exports=Q():"function"==typeof define&&define.amd?define(Q):P.reqwest=Q()}()},{}],3:[function(J,V,e){!function(){(function(r){var i,e,u=Math.round,s={},t=void 0!==V&&V.exports,a=/^\/?Date\((\-?\d+)/i,o=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,l=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,c=/\d\d?/,d=/\d{1,3}/,h=/\d{3}/,f=/\d{1,4}/,p=/[+\-]?\d{1,6}/,m=/[0-9]*[a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF]+\s*?[\u0600-\u06FF]+/i,_=/Z|[\+\-]\d\d:?\d\d/i,y=/T/i,g=/[\+\-]?\d+(\.\d{1,3})?/,w=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,M=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],v=/([\+\-]|\d\d)/gi,n="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),D={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},b={},k="DDD w W M D d".split(" "),Y="M D H h m s w W".split(" "),T={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return C(this.year()%100,2)},YYYY:function(){return C(this.year(),4)},YYYYY:function(){return C(this.year(),5)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return C(~~(this.milliseconds()/10),2)},SSS:function(){return C(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+C(~~(e/60),2)+":"+C(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+C(~~(10*e/6),4)},X:function(){return this.unix()}};function S(t,n){return function(e){return C(t.call(this,e),n)}}for(;k.length;)e=k.pop(),T[e+"o"]=function(t){return function(e){return this.lang().ordinal(t.call(this,e))}}(T[e]);for(;Y.length;)e=Y.pop(),T[e+e]=S(T[e],2);function x(){}function H(e){q(this,e)}function A(e){var t=this._data={},n=e.years||e.year||e.y||0,r=e.months||e.month||e.M||0,s=e.weeks||e.week||e.w||0,a=e.days||e.day||e.d||0,i=e.hours||e.hour||e.h||0,o=e.minutes||e.minute||e.m||0,u=e.seconds||e.second||e.s||0,e=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=e+1e3*u+6e4*o+36e5*i,this._days=a+7*s,this._months=r+12*n,t.milliseconds=e%1e3,u+=L(e/1e3),t.seconds=u%60,o+=L(u/60),t.minutes=o%60,i+=L(o/60),t.hours=i%24,a+=L(i/24),a+=7*s,t.days=a%30,r+=L(a/30),t.months=r%12,n+=L(r/12),t.years=n}function q(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function L(e){return e<0?Math.ceil(e):Math.floor(e)}function C(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function F(e,t,n){var r=t._milliseconds,s=t._days,t=t._months;r&&e._d.setTime(+e+r*n),s&&e.date(e.date()+s*n),t&&(s=e.date(),e.date(1).month(e.month()+t*n).date(Math.min(s,e.daysInMonth())))}function O(e){return"[object Array]"===Object.prototype.toString.call(e)}function z(e,t){for(var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0,a=0;a<n;a++)~~e[a]!=~~t[a]&&s++;return s+r}function j(e){return e?(!s[e]&&t&&J("./lang/"+e),s[e]):i.fn._lang}function P(t,e){var n=5;function r(e){return t.lang().longDateFormat(e)||e}for(;n--&&l.test(e);)e=e.replace(l,r);return b[e]||(b[e]=function(n){for(var e,r=n.match(o),s=0,a=r.length;s<a;s++)T[r[s]]?r[s]=T[r[s]]:r[s]=(e=r[s]).match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){var t="";for(s=0;s<a;s++)t+="function"==typeof r[s].call?r[s].call(e,n):r[s];return t}}(e)),b[e](t)}function W(e){var t,n,r=[];if(!e._d){for(t=0;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];r[3]+=e._tzh||0,r[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}}function R(e){var t,n,r=e._f.match(o),s=e._i;for(e._a=[],t=0;t<r.length;t++)(n=(function(e){switch(e){case"DDDD":return h;case"YYYY":return f;case"YYYYY":return p;case"S":case"SS":case"SSS":case"DDD":return d;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return m;case"X":return g;case"Z":case"ZZ":return _;case"T":return y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return c;default:return new RegExp(e.replace("\\",""))}}(r[t]).exec(s)||[])[0])&&(s=s.slice(s.indexOf(n)+n.length)),T[r[t]]&&function(e,t,n){var r,s=n._a;switch(e){case"M":case"MM":s[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":null!=(r=j(n._l).monthsParse(t))?s[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(s[2]=~~t);break;case"YY":s[0]=~~t+(68<~~t?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,(r=(t+"").match(v))&&r[1]&&(n._tzh=~~r[1]),r&&r[2]&&(n._tzm=~~r[2]),r&&"+"===r[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}(r[t],n,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),!1===e._isPm&&12===e._a[3]&&(e._a[3]=0),W(e)}function U(e){var t=e._i,n=a.exec(t);t===r?e._d=new Date:n?e._d=new Date(+n[1]):"string"==typeof t?function(e){var t,n=e._i;if(w.exec(n)){for(e._f="YYYY-MM-DDT",t=0;t<4;t++)if(M[t][1].exec(n)){e._f+=M[t][0];break}_.exec(n)&&(e._f+=" Z"),R(e)}else e._d=new Date(n)}(e):O(t)?(e._a=t.slice(0),W(e)):e._d=t instanceof Date?new Date(+t):new Date(t)}function E(e,t,n){var r=u(Math.abs(e)/1e3),s=u(r/60),a=u(s/60),i=u(a/24),o=u(i/365),o=(r<45?["s",r]:1===s&&["m"])||s<45&&["mm",s]||1===a&&["h"]||a<22&&["hh",a]||1===i&&["d"]||i<=25&&["dd",i]||i<=45&&["M"]||i<345&&["MM",u(i/30)]||1===o&&["y"]||["yy",o];return o[2]=t,o[3]=0<e,o[4]=n,function(e,t,n,r,s){return s.relativeTime(t||1,!!n,e,r)}.apply({},o)}function N(e,t,n){t=n-t,n-=e.day();return t<n&&(n-=7),n<t-7&&(n+=7),Math.ceil(i(e).add("d",n).dayOfYear()/7)}function Z(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=j().preparse(t)),i.isMoment(t)?(e=q({},t))._d=new Date(+t._d):(n?O(n)?function(e){for(var t,n,r,s=99;e._f.length;){if((r=q({},e))._f=e._f.pop(),R(r),(t=new H(r)).isValid()){n=t;break}(r=z(r._a,t.toArray()))<s&&(s=r,n=t)}q(e,n)}:R:U)(e),new H(e))}function X(e,n){i.fn[e]=i.fn[e+"s"]=function(e){var t=this._isUTC?"UTC":"";return null!=e?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}for(T.DDDD=S(T.DDD,3),x.prototype={set:function(e){var t,n;for(n in e)"function"==typeof(t=e[n])?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=i([2e3,t]),n="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},meridiem:function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){e=this._calendar[e];return"function"==typeof e?e.apply(t):e},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var s=this._relativeTime[n];return"function"==typeof s?s(e,t,n,r):s.replace(/%d/i,e)},pastFuture:function(e,t){e=this._relativeTime[0<e?"future":"past"];return"function"==typeof e?e(t):e.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return N(e,this._week.dow,this._week.doy)},_week:{dow:0,doy:6}},(i=function(e,t,n){return Z({_i:e,_f:t,_l:n,_isUTC:!1})}).utc=function(e,t,n){return Z({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},i.unix=function(e){return i(1e3*e)},i.duration=function(e,t){var n=i.isDuration(e),r="number"==typeof e,s=n?e._data:r?{}:e;return r&&(t?s[t]=e:s.milliseconds=e),s=new A(s),n&&e.hasOwnProperty("_lang")&&(s._lang=e._lang),s},i.version="2.0.0",i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.lang=function(e,t){var n;if(!e)return i.fn._lang._abbr;t?(n=e,(t=t).abbr=n,s[n]||(s[n]=new x),s[n].set(t),s[n]):s[e]||j(e),i.duration.fn._lang=i.fn._lang=j(e)},i.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),j(e)},i.isMoment=function(e){return e instanceof H},i.isDuration=function(e){return e instanceof A},i.fn=H.prototype={clone:function(){return i(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._d},toJSON:function(){return i.utc(this).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!z(this._a,(this._isUTC?i.utc(this._a):i(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){e=P(this,e||i.defaultFormat);return this.lang().postformat(e)},add:function(e,t){t="string"==typeof e?i.duration(+t,e):i.duration(e,t);return F(this,t,1),this},subtract:function(e,t){t="string"==typeof e?i.duration(+t,e):i.duration(e,t);return F(this,t,-1),this},diff:function(e,t,n){var r,s,a=this._isUTC?i(e).utc():i(e).local(),e=6e4*(this.zone()-a.zone());return"year"===(t=t&&t.replace(/s$/,""))||"month"===t?(r=432e5*(this.daysInMonth()+a.daysInMonth()),s=12*(this.year()-a.year())+(this.month()-a.month()),s+=(this-i(this).startOf("month")-(a-i(a).startOf("month")))/r,"year"===t&&(s/=12)):(r=this-a-e,s="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?r/864e5:"week"===t?r/6048e5:r),n?s:L(s)},from:function(e,t){return i.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(i(),e)},calendar:function(){var e=this.diff(i().startOf("day"),"days",!0),e=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(e,this))},isLeapYear:function(){var e=this.year();return e%4==0&&e%100!=0||e%400==0},isDST:function(){return this.zone()<i([this.year()]).zone()||this.zone()<i([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==e?t:this.add({d:e-t})},startOf:function(e){switch(e=e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.day(0),this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},isAfter:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)>+i(e).startOf(t)},isBefore:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)<+i(e).startOf(t)},isSame:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)==+i(e).startOf(t)},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return i.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=u((i(this).startOf("day")-i(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},isoWeek:function(e){var t=N(this,1,4);return null==e?t:this.add("d",7*(e-t))},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},lang:function(e){return e===r?this._lang:(this._lang=j(e),this)}},e=0;e<n.length;e++)X(n[e].toLowerCase().replace(/s$/,""),n[e]);function I(e,t){i.duration.fn["as"+e]=function(){return+this/t}}for(e in X("year","FullYear"),i.fn.days=i.fn.day,i.fn.weeks=i.fn.week,i.fn.isoWeeks=i.fn.isoWeek,i.duration.fn=A.prototype={weeks:function(){return L(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(e){var t=+this,n=E(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},lang:i.fn.lang},D)D.hasOwnProperty(e)&&(I(e,D[e]),function(e){i.duration.fn[e]=function(){return this._data[e]}}(e.toLowerCase()));I("Weeks",6048e5),i.lang("en",{ordinal:function(e){var t=e%10;return e+(1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),t&&(V.exports=i),"undefined"==typeof ender&&(this.moment=i),"function"==typeof define&&define.amd&&define("moment",[],function(){return i})}).call(this)}()},{}]},{},[1])(1)});
L.BingLayer=L.TileLayer.extend({options:{imagerySet:"Aerial",culture:"",style:"",retinaDpi:"d2",attribution:"Bing",minZoom:1,maxZoom:21},initialize:function(t,e){"object"==typeof t&&(e=t,t=!1),L.TileLayer.prototype.initialize.call(this,null,e),(e=this.options).key=e.key||e.bingMapsKey,e.imagerySet=e.imagerySet||e.type,t&&(e.key=t)},tile2quad:function(t,e,i){for(var r="",o=i;0<o;o--){var a=0,n=1<<o-1;0!=(t&n)&&(a+=1),0!=(e&n)&&(a+=2),r+=a}return r},getTileUrl:function(t){t={subdomain:this._getSubdomain(t),quadkey:this.tile2quad(t.x,t.y,this._getZoomForUrl()),culture:this.options.culture};return L.Util.template(this._url,t)},callRestService:function(t,e,i){i=i||this;for(var r="_bing_metadata_"+L.Util.stamp(this);window[r];)r+="_";t+="&jsonp="+r;var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",t),window[r]=function(t){if(delete window[r],o.remove(),t.errorDetails)throw new Error(t.errorDetails);e.call(i,t)},document.body.appendChild(o)},_makeApiUrl:function(t,e,i){e={version:"v1",restApi:t,resourcePath:e};i=L.extend({key:this.options.key},i);return L.Util.template("https://dev.virtualearth.net/REST/{version}/{restApi}/{resourcePath}",e)+L.Util.getParamString(i)},loadMetadata:function(){var i,t;this.metaRequested||(this.metaRequested=!0,i=this.options,t=this._makeApiUrl("Imagery/Metadata",i.imagerySet,{UriScheme:"https",include:"ImageryProviders",culture:i.culture,style:i.style}),this.callRestService(t,function(t){var e=t.resourceSets[0].resources[0];if(!e.imageUrl)throw new Error("imageUrl not found in response");e.imageUrlSubdomains&&(i.subdomains=e.imageUrlSubdomains),this._providers=e.imageryProviders?this._prepAttrBounds(e.imageryProviders):[],this._attributions=[],this._url=e.imageUrl,i.retinaDpi&&i.detectRetina&&i.zoomOffset&&(this._url+="&dpi="+i.retinaDpi),this.fire("load",{meta:t}),this._map&&this._update()}))},_prepAttrBounds:function(t){return t.forEach(function(t){t.coverageAreas.forEach(function(t){t.bounds=L.latLngBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]])})}),t},_update:function(t){this._url&&(L.GridLayer.prototype._update.call(this,t),this._update_attribution())},_update_attribution:function(e){var i,r,t,o=this._map.attributionControl;o?(i=this._map.getBounds(),i=L.latLngBounds(i.getSouthWest().wrap(),i.getNorthEast().wrap()),r=this._getZoomForUrl(),(t=this._providers.map(function(t){return!e&&t.coverageAreas.some(function(t){return r<=t.zoomMax&&r>=t.zoomMin&&i.intersects(t.bounds)})})).forEach(function(t,e){t==this._attributions[e]||(t?o.addAttribution(this._providers[e].attribution):o.removeAttribution(this._providers[e].attribution))},this),this._attributions=t):this._attributions={}},onAdd:function(t){this.loadMetadata(),L.GridLayer.prototype.onAdd.call(this,t)},onRemove:function(t){this._providers&&this._update_attribution(!0),L.GridLayer.prototype.onRemove.call(this,t)}}),L.bingLayer=function(t,e){return new L.BingLayer(t,e)};
!function(a){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof modules&&module.exports?module.exports=a(require("leaflet")):a(L)}(function(n){"use strict";return n.TileLayer.Provider=n.TileLayer.extend({initialize:function(a,t){var e=n.TileLayer.Provider.providers,o=a.split("."),r=o[0],a=o[1];if(!e[r])throw"No such provider ("+r+")";o={url:e[r].url,options:e[r].options};if(a&&"variants"in e[r]){if(!(a in e[r].variants))throw"No such variant of "+r+" ("+a+")";r=e[r].variants[a],a="string"==typeof r?{variant:r}:r.options,o={url:r.url||o.url,options:n.Util.extend({},o.options,a)}}var i=function(a){return-1===a.indexOf("{attribution.")?a:a.replace(/\{attribution.(\w*)\}/g,function(a,t){return i(e[t].options.attribution)})};o.options.attribution=i(o.options.attribution);t=n.Util.extend({},o.options,t);n.TileLayer.prototype.initialize.call(this,o.url,t)}}),n.TileLayer.Provider.providers={OpenStreetMap:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},variants:{Mapnik:{},DE:{url:"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png",options:{maxZoom:18}},CH:{url:"https://tile.osm.ch/switzerland/{z}/{x}/{y}.png",options:{maxZoom:18,bounds:[[45,5],[48,11]]}},France:{url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:"&copy; Openstreetmap France | {attribution.OpenStreetMap}"}},HOT:{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'}},BZH:{url:"https://tile.openstreetmap.bzh/br/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles courtesy of <a href="http://www.openstreetmap.bzh/" target="_blank">Breton OpenStreetMap Team</a>',bounds:[[46.2,-5.5],[50,.7]]}}}},OpenSeaMap:{url:"https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",options:{attribution:'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a> contributors'}},OpenPtMap:{url:"http://openptmap.org/tiles/{z}/{x}/{y}.png",options:{maxZoom:17,attribution:'Map data: &copy; <a href="http://www.openptmap.org">OpenPtMap</a> contributors'}},OpenTopoMap:{url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",options:{maxZoom:17,attribution:'Map data: {attribution.OpenStreetMap}, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenRailwayMap:{url:"https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://www.OpenRailwayMap.org">OpenRailwayMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenFireMap:{url:"http://openfiremap.org/hytiles/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="http://www.openfiremap.org">OpenFireMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},SafeCast:{url:"https://s3.amazonaws.com/te512.safecast.org/{z}/{x}/{y}.png",options:{maxZoom:16,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://blog.safecast.org/about/">SafeCast</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},Stadia:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png",options:{maxZoom:20,attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'},variants:{AlidadeSmooth:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"},AlidadeSmoothDark:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"},OSMBright:{url:"https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png"},Outdoors:{url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png"}}},Thunderforest:{url:"https://{s}.tile.thunderforest.com/{variant}/{z}/{x}/{y}.png?apikey={apikey}",options:{attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, {attribution.OpenStreetMap}',variant:"cycle",apikey:"<insert your api key here>",maxZoom:22},variants:{OpenCycleMap:"cycle",Transport:{options:{variant:"transport"}},TransportDark:{options:{variant:"transport-dark"}},SpinalMap:{options:{variant:"spinal-map"}},Landscape:"landscape",Outdoors:"outdoors",Pioneer:"pioneer",MobileAtlas:"mobile-atlas",Neighbourhood:"neighbourhood"}},CyclOSM:{url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:'<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: {attribution.OpenStreetMap}'}},Hydda:{url:"https://{s}.tile.openstreetmap.se/hydda/{variant}/{z}/{x}/{y}.png",options:{maxZoom:20,variant:"full",attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data {attribution.OpenStreetMap}'},variants:{Full:"full",Base:"base",RoadsAndLabels:"roads_and_labels"}},Jawg:{url:"https://{s}.tile.jawg.io/{variant}/{z}/{x}/{y}{r}.png?access-token={accessToken}",options:{attribution:'<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> {attribution.OpenStreetMap}',minZoom:0,maxZoom:22,subdomains:"abcd",variant:"jawg-terrain",accessToken:"<insert your access token here>"},variants:{Streets:"jawg-streets",Terrain:"jawg-terrain",Sunny:"jawg-sunny",Dark:"jawg-dark",Light:"jawg-light",Matrix:"jawg-matrix"}},MapBox:{url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}{r}?access_token={accessToken}",options:{attribution:'&copy; <a href="https://www.mapbox.com/about/maps/" target="_blank">Mapbox</a> {attribution.OpenStreetMap} <a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"<insert your access token here>"}},MapTiler:{url:"https://api.maptiler.com/maps/{variant}/{z}/{x}/{y}{r}.{ext}?key={key}",options:{attribution:'<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',variant:"streets",ext:"png",key:"<insert your MapTiler Cloud API key here>",tileSize:512,zoomOffset:-1,minZoom:0,maxZoom:21},variants:{Streets:"streets",Basic:"basic",Bright:"bright",Pastel:"pastel",Positron:"positron",Hybrid:{options:{variant:"hybrid",ext:"jpg"}},Toner:"toner",Topo:"topo",Voyager:"voyager"}},Stamen:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}{r}.{ext}",options:{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data {attribution.OpenStreetMap}',subdomains:"abcd",minZoom:0,maxZoom:20,variant:"toner",ext:"png"},variants:{Toner:"toner",TonerBackground:"toner-background",TonerHybrid:"toner-hybrid",TonerLines:"toner-lines",TonerLabels:"toner-labels",TonerLite:"toner-lite",Watercolor:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"watercolor",ext:"jpg",minZoom:1,maxZoom:16}},Terrain:{options:{variant:"terrain",minZoom:0,maxZoom:18}},TerrainBackground:{options:{variant:"terrain-background",minZoom:0,maxZoom:18}},TerrainLabels:{options:{variant:"terrain-labels",minZoom:0,maxZoom:18}},TopOSMRelief:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"toposm-color-relief",ext:"jpg",bounds:[[22,-132],[51,-56]]}},TopOSMFeatures:{options:{variant:"toposm-features",bounds:[[22,-132],[51,-56]],opacity:.9}}}},TomTom:{url:"https://{s}.api.tomtom.com/map/1/tile/{variant}/{style}/{z}/{x}/{y}.{ext}?key={apikey}",options:{variant:"basic",maxZoom:22,attribution:'<a href="https://tomtom.com" target="_blank">&copy;  1992 - '+(new Date).getFullYear()+" TomTom.</a> ",subdomains:"abcd",style:"main",ext:"png",apikey:"<insert your API key here>"},variants:{Basic:"basic",Hybrid:"hybrid",Labels:"labels"}},Esri:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/{variant}/MapServer/tile/{z}/{y}/{x}",options:{variant:"World_Street_Map",attribution:"Tiles &copy; Esri"},variants:{WorldStreetMap:{options:{attribution:"{attribution.Esri} &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012"}},DeLorme:{options:{variant:"Specialty/DeLorme_World_Base_Map",minZoom:1,maxZoom:11,attribution:"{attribution.Esri} &mdash; Copyright: &copy;2012 DeLorme"}},WorldTopoMap:{options:{variant:"World_Topo_Map",attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"}},WorldImagery:{options:{variant:"World_Imagery",attribution:"{attribution.Esri} &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}},WorldTerrain:{options:{variant:"World_Terrain_Base",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS"}},WorldShadedRelief:{options:{variant:"World_Shaded_Relief",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: Esri"}},WorldPhysical:{options:{variant:"World_Physical_Map",maxZoom:8,attribution:"{attribution.Esri} &mdash; Source: US National Park Service"}},OceanBasemap:{options:{variant:"Ocean_Basemap",maxZoom:13,attribution:"{attribution.Esri} &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri"}},NatGeoWorldMap:{options:{variant:"NatGeo_World_Map",maxZoom:16,attribution:"{attribution.Esri} &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC"}},WorldGrayCanvas:{options:{variant:"Canvas/World_Light_Gray_Base",maxZoom:16,attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ"}}}},OpenWeatherMap:{url:"http://{s}.tile.openweathermap.org/map/{variant}/{z}/{x}/{y}.png?appid={apiKey}",options:{maxZoom:19,attribution:'Map data &copy; <a href="http://openweathermap.org">OpenWeatherMap</a>',apiKey:"<insert your api key here>",opacity:.5},variants:{Clouds:"clouds",CloudsClassic:"clouds_cls",Precipitation:"precipitation",PrecipitationClassic:"precipitation_cls",Rain:"rain",RainClassic:"rain_cls",Pressure:"pressure",PressureContour:"pressure_cntr",Wind:"wind",Temperature:"temp",Snow:"snow"}},HERE:{url:"https://{s}.{base}.maps.api.here.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",app_id:"<insert your app_id here>",app_code:"<insert your app_code here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalDayTraffic:{options:{variant:"normal.traffic.day",base:"traffic",type:"traffictile"}},normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},hybridDayTraffic:{options:{variant:"hybrid.traffic.day",base:"traffic",type:"traffictile"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},HEREv3:{url:"https://{s}.{base}.maps.ls.hereapi.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?apiKey={apiKey}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",apiKey:"<insert your apiKey here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},FreeMapSK:{url:"https://{s}.freemap.sk/T/{z}/{x}/{y}.jpeg",options:{minZoom:8,maxZoom:16,subdomains:"abcd",bounds:[[47.204642,15.996093],[49.830896,22.576904]],attribution:'{attribution.OpenStreetMap}, vizualization CC-By-SA 2.0 <a href="http://freemap.sk">Freemap.sk</a>'}},MtbMap:{url:"http://tile.mtbmap.cz/mtbmap_tiles/{z}/{x}/{y}.png",options:{attribution:"{attribution.OpenStreetMap} &amp; USGS"}},CartoDB:{url:"https://{s}.basemaps.cartocdn.com/{variant}/{z}/{x}/{y}{r}.png",options:{attribution:'{attribution.OpenStreetMap} &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19,variant:"light_all"},variants:{Positron:"light_all",PositronNoLabels:"light_nolabels",PositronOnlyLabels:"light_only_labels",DarkMatter:"dark_all",DarkMatterNoLabels:"dark_nolabels",DarkMatterOnlyLabels:"dark_only_labels",Voyager:"rastertiles/voyager",VoyagerNoLabels:"rastertiles/voyager_nolabels",VoyagerOnlyLabels:"rastertiles/voyager_only_labels",VoyagerLabelsUnder:"rastertiles/voyager_labels_under"}},HikeBike:{url:"https://tiles.wmflabs.org/{variant}/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:"{attribution.OpenStreetMap}",variant:"hikebike"},variants:{HikeBike:{},HillShading:{options:{maxZoom:15,variant:"hillshading"}}}},BasemapAT:{url:"https://maps{s}.wien.gv.at/basemap/{variant}/{type}/google3857/{z}/{y}/{x}.{format}",options:{maxZoom:19,attribution:'Datenquelle: <a href="https://www.basemap.at">basemap.at</a>',subdomains:["","1","2","3","4"],type:"normal",format:"png",bounds:[[46.35877,8.782379],[49.037872,17.189532]],variant:"geolandbasemap"},variants:{basemap:{options:{maxZoom:20,variant:"geolandbasemap"}},grau:"bmapgrau",overlay:"bmapoverlay",terrain:{options:{variant:"bmapgelaende",type:"grau",format:"jpeg"}},surface:{options:{variant:"bmapoberflaeche",type:"grau",format:"jpeg"}},highdpi:{options:{variant:"bmaphidpi",format:"jpeg"}},orthofoto:{options:{maxZoom:20,variant:"bmaporthofoto30cm",format:"jpeg"}}}},nlmaps:{url:"https://geodata.nationaalgeoregister.nl/tiles/service/wmts/{variant}/EPSG:3857/{z}/{x}/{y}.png",options:{minZoom:6,maxZoom:19,bounds:[[50.5,3.25],[54,7.6]],attribution:'Kaartgegevens &copy; <a href="kadaster.nl">Kadaster</a>'},variants:{standaard:"brtachtergrondkaart",pastel:"brtachtergrondkaartpastel",grijs:"brtachtergrondkaartgrijs",luchtfoto:{url:"https://geodata.nationaalgeoregister.nl/luchtfoto/rgb/wmts/2018_ortho25/EPSG:3857/{z}/{x}/{y}.png"}}},NASAGIBS:{url:"https://map1.vis.earthdata.nasa.gov/wmts-webmerc/{variant}/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}",options:{attribution:'Imagery provided by services from the Global Imagery Browse Services (GIBS), operated by the NASA/GSFC/Earth Science Data and Information System (<a href="https://earthdata.nasa.gov">ESDIS</a>) with funding provided by NASA/HQ.',bounds:[[-85.0511287776,-179.999999975],[85.0511287776,179.999999975]],minZoom:1,maxZoom:9,format:"jpg",time:"",tilematrixset:"GoogleMapsCompatible_Level"},variants:{ModisTerraTrueColorCR:"MODIS_Terra_CorrectedReflectance_TrueColor",ModisTerraBands367CR:"MODIS_Terra_CorrectedReflectance_Bands367",ViirsEarthAtNight2012:{options:{variant:"VIIRS_CityLights_2012",maxZoom:8}},ModisTerraLSTDay:{options:{variant:"MODIS_Terra_Land_Surface_Temp_Day",format:"png",maxZoom:7,opacity:.75}},ModisTerraSnowCover:{options:{variant:"MODIS_Terra_Snow_Cover",format:"png",maxZoom:8,opacity:.75}},ModisTerraAOD:{options:{variant:"MODIS_Terra_Aerosol",format:"png",maxZoom:6,opacity:.75}},ModisTerraChlorophyll:{options:{variant:"MODIS_Terra_Chlorophyll_A",format:"png",maxZoom:7,opacity:.75}}}},NLS:{url:"https://nls-{s}.tileserver.com/nls/{z}/{x}/{y}.jpg",options:{attribution:'<a href="http://geo.nls.uk/maps/">National Library of Scotland Historic Maps</a>',bounds:[[49.6,-12],[61.7,3]],minZoom:1,maxZoom:18,subdomains:"0123"}},JusticeMap:{url:"http://www.justicemap.org/tile/{size}/{variant}/{z}/{x}/{y}.png",options:{attribution:'<a href="http://www.justicemap.org/terms.php">Justice Map</a>',size:"county",bounds:[[14,-180],[72,-56]]},variants:{income:"income",americanIndian:"indian",asian:"asian",black:"black",hispanic:"hispanic",multi:"multi",nonWhite:"nonwhite",white:"white",plurality:"plural"}},Wikimedia:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",options:{attribution:'<a href="https://wikimediafoundation.org/wiki/Maps_Terms_of_Use">Wikimedia</a>',minZoom:1,maxZoom:19}},GeoportailFrance:{url:"https://wxs.ign.fr/{apikey}/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE={style}&TILEMATRIXSET=PM&FORMAT={format}&LAYER={variant}&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",options:{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',bounds:[[-75,-180],[81,180]],minZoom:2,maxZoom:18,apikey:"choisirgeoportail",format:"image/jpeg",style:"normal",variant:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD"},variants:{parcels:{options:{variant:"CADASTRALPARCELS.PARCELS",maxZoom:20,style:"bdparcellaire",format:"image/png"}},ignMaps:"GEOGRAPHICALGRIDSYSTEMS.MAPS",maps:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD",orthos:{options:{maxZoom:19,variant:"ORTHOIMAGERY.ORTHOPHOTOS"}}}},OneMapSG:{url:"https://maps-{s}.onemap.sg/v3/{variant}/{z}/{x}/{y}.png",options:{variant:"Default",minZoom:11,maxZoom:18,bounds:[[1.56073,104.11475],[1.16,103.502]],attribution:'<img src="https://docs.onemap.sg/maps/images/oneMap64-01.png" style="height:20px;width:20px;"/> New OneMap | Map data &copy; contributors, <a href="http://SLA.gov.sg">Singapore Land Authority</a>'},variants:{Default:"Default",Night:"Night",Original:"Original",Grey:"Grey",LandLot:"LandLot"}}},n.tileLayer.provider=function(a,t){return new n.TileLayer.Provider(a,t)},n});
L.Util.extend(L.LineUtil,{snapToLayers:function(n,t,i){var e,s,o,l,a,r,y=i.sensitivity||10,g=i.vertexonly||!1,u=(i.layers,1/0),m=n;if(m._feature=null,!i||!i.layers||!i.layers.length)return m;for(l=i.layers[0]._map,e=0;e<i.layers.length;e++)for(o=Object.keys(i.layers[e]._layers),s=0;s<o.length;s++)t!==(r=i.layers[e]._layers[o[s]])._leaflet_id&&(a=r._layers?(a=this.snapToLayers(n,t,{sensitivity:y,vertexonly:g,layers:[r]}),{minDist:n.distanceTo(a),minPoint:a}):r instanceof L.Marker?this._snapToLatlngs(n,[r.getLatLng()],l,y,g,u):r instanceof L.Polyline?this._snapToLatlngs(n,r.getLatLngs(),l,y,g,u):r instanceof L.MultiPolyline?(console.error("Snapping to MultiPolyline is currently unsupported",r),{minDist:u,minPoint:m}):r instanceof L.Polygon?this._snapToPolygon(n,r,l,y,g,u):r instanceof L.MultiPolygon?this._snapToMultiPolygon(n,r,l,y,g,u):(console.error("Unsupported snapping feature",r),{minDist:u,minPoint:m})).minDist<u&&(u=a.minDist,(m=a.minPoint)._feature=r);return m},_snapToPolygon:function(n,t,i,e,s,o){var l,a,r,y=null,g=t.getLatLngs();for(g.push(g[0]),(l=this._snapToLatlngs(n,t.getLatLngs(),i,e,s,o)).minDist<o&&(o=l.minDist,y=l.minPoint),a=Object.keys(t._holes),r=0;r<a.length;r++)(g=t._holes[a[r]]).push(g[0]),(l=this._snapToLatlngs(n,t._holes[a[r]],i,e,s,o)).minDist<o&&(o=l.minDist,y=l.minPoint);return{minDist:o,minPoint:y}},_snapToMultiPolygon:function(n,t,i,e,s,o){for(var l,a=null,r=Object.keys(t._layers),y=0;y<r.length;y++)(l=this._snapToPolygon(n,t._layers[r[y]],i,e,s,o)).minDist<o&&(o=l.minDist,a=l.minPoint);return{minDist:o,minPoint:a}},_snapToLatlngs:function(n,t,i,e,s,o){for(var l,a,r,y=i.latLngToLayerPoint(n),g=l=null,u=0;u<t.length;u++)a=i.latLngToLayerPoint(t[u]),s||null===g?(r=y.distanceTo(a))&&r<=e&&r<o&&(o=r,l=t[u]):(r=L.LineUtil.pointToSegmentDistance(y,g,a))<o&&r<=e&&(o=r,l=i.layerPointToLatLng(L.LineUtil.closestPointOnSegment(y,g,a))),g=a;return{minDist:o,minPoint:l}}});
L.Marker.include({snapTo:function(n){return L.LineUtil.snapToLayers(n,this._leaflet_id,this.options.snapping)}});
L.Routing=L.Control.extend({includes:[L.Evented.prototype],statics:{VERSION:"0.1.1-dev"},options:{position:"topleft",tooltips:{waypoint:"Waypoint. Drag to move; Click to remove.",segment:"Drag to create a new waypoint. Click to toggle straight line."},icons:{start:new L.Icon.Default,end:new L.Icon.Default,normal:new L.Icon.Default,draw:new L.Icon.Default},styles:{trailer:{},track:{},nodata:{},beeline:{},beelineTrailer:{}},tolerance:5,toleranceTouch:10,snapSensitivity:10,zIndexOffset:2e3,routing:{router:null},snapping:{layers:[],sensitivity:10,vertexonly:!1},shortcut:{draw:{enable:68,disable:81,beelineMode:66,beelineModifier:16,beelineModifierName:"shiftKey"}}},initialize:function(t){this._editing=!1,this._drawing=!1,this.touch=!window.L_NO_TOUCH&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),L.Util.setOptions(this,t)},onAdd:function(t){return this._map=t,this._container=this._map._container,this._overlayPane=this._map._panes.overlayPane,this._popupPane=this._map._panes.popupPane,this._router=this.options.routing.router,this._segments=(new L.FeatureGroup).addTo(t),this._segmentsTolerance=this.touch?this.options.toleranceTouch:this.options.tolerance,this._segmentsRenderer=L.canvas({tolerance:this._segmentsTolerance}),this._waypoints=(new L.FeatureGroup).addTo(t),this._waypoints._first=null,this._waypoints._last=null,this.options.shortcut&&(L.DomEvent.addListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.addListener(this._container,"keyup",this._keyupListener,this)),this._draw=new L.Routing.Draw(this,this.options),this._edit=new L.Routing.Edit(this,this.options),this._edit.enable(),this.on("waypoint:click",this._waypointClickHandler,this),this.touch?this._segments.on("layeradd",this._fireSegmentEvent,this):this._segments.on("mouseover",this._fireSegmentEvent,this),this._edit.on("segment:mouseout",this._fireSegmentEvent,this),this._edit.on("segment:dragstart",this._fireSegmentEvent,this),this._edit.on("segment:dragend",this._fireSegmentEvent,this),L.DomUtil.create("div","leaflet-routing")},onRemove:function(t){this.off("waypoint:click",this._waypointClickHandler,this),this.touch?this._segments.off("layeradd",this._fireSegmentEvent,this):this._segments.off("mouseover",this._fireSegmentEvent,this),this._edit.off("segment:mouseout",this._fireSegmentEvent,this),this._edit.off("segment:dragstart",this._fireSegmentEvent,this),this._edit.off("segment:dragend",this._fireSegmentEvent,this),this._edit.disable(),this._draw.disable(),L.DomUtil.enableTextSelection(),L.DomEvent.removeListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.removeListener(this._container,"keyup",this._keyupListener,this),delete this._draw,delete this._edit,delete this._map,delete this._router,delete this._segments,delete this._waypoints,delete this.options},_waypointClickHandler:function(t){this.removeWaypoint(t.marker,function(){})},addWaypoint:function(t,e,n,i,o){t instanceof L.LatLng&&(t=new L.Marker(t,{title:this.options.tooltips.waypoint,draggable:!0})),t._routing={prevMarker:n,nextMarker:i,prevLine:null,nextLine:null,timeoutID:null,beeline:e||!1};var r=this.options.icons;n?i?t.setIcon(r.normal):t.setIcon(r.end):t.setIcon(r.start);var s=i&&this.getFirst()&&i._leaflet_id===this.getFirst()._leaflet_id,a=n&&this.getFirst()&&n._leaflet_id===this.getFirst()._leaflet_id,e=n&&this.getLast()&&n._leaflet_id===this.getLast()._leaflet_id;s&&i.setIcon(r.normal),e&&!a&&n.setIcon(r.normal),null===this.getFirst()&&null===this.getLast()?(this._waypoints._first=t,this._waypoints._last=t):null===i?this._waypoints._last=t:null===n&&(this._waypoints._first=t),null!==t._routing.prevMarker&&((t._routing.prevMarker._routing.nextMarker=t)._routing.prevLine=t._routing.prevMarker._routing.nextLine,null!==t._routing.prevLine&&(t._routing.prevLine._routing.nextMarker=t)),null!==t._routing.nextMarker&&((t._routing.nextMarker._routing.prevMarker=t).nextLine=t._routing.nextMarker._routing.prevLine,null!==t._routing.nextLine&&(t._routing.nextLine._routing.prevMarker=t)),t.on("mouseover",this._fireWaypointEvent,this),t.on("mouseout",this._fireWaypointEvent,this),t.on("dragstart",this._fireWaypointEvent,this),t.on("dragend",this._fireWaypointEvent,this),t.on("drag",this._fireWaypointEvent,this),t.on("click",this._fireWaypointEvent,this),n&&i&&n._routing.beeline&&(t._routing.beeline=!0),this.routeWaypoint(t,o),this._waypoints.addLayer(t)},removeWaypoint:function(t,e){t.off("mouseover",this._fireWaypointEvent,this),t.off("mouseout",this._fireWaypointEvent,this),t.off("dragstart",this._fireWaypointEvent,this),t.off("dragend",this._fireWaypointEvent,this),t.off("drag",this._fireWaypointEvent,this),t.off("click",this._fireWaypointEvent,this);var n=t._routing.prevMarker,i=t._routing.nextMarker,o=this.getFirst()&&t._leaflet_id===this.getFirst()._leaflet_id,r=this.getLast()&&t._leaflet_id===this.getLast()._leaflet_id;o&&(this._waypoints._first=i)&&i.setIcon(this.options.icons.start),r&&(this._waypoints._last=n)&&(n._leaflet_id!==this.getFirst()._leaflet_id&&n.setIcon(this.options.icons.end),n._routing.beeline=!1),null!==n&&(n._routing.nextMarker=i,n._routing.nextLine=null),null!==i&&(i._routing.prevMarker=n,i._routing.prevLine=null),null!==t._routing.nextLine&&this._segments.removeLayer(t._routing.nextLine),null!==t._routing.prevLine&&this._segments.removeLayer(t._routing.prevLine),this._waypoints.removeLayer(t),null!==n?this.routeWaypoint(n,e):null!==i?this.routeWaypoint(i,e):(this._draw.enable(),e(null,null))},routeWaypoint:function(n,i){function t(t,e){o=o||t,2===++r&&(s._updateBeelines(),s.fire("routing:routeWaypointEnd",{err:o}),i(o,n))}var o,r=0,s=this;this.fire("routing:routeWaypointStart"),this._routeSegment(n._routing.prevMarker,n,t),this._routeSegment(n,n._routing.nextMarker,t)},rerouteAllSegments:function(n){function i(t,e){o=o||t,r<=++s&&(a._updateBeelines(),a.fire("routing:rerouteAllSegmentsEnd",{err:o}),n&&n(o))}var o,r=this.getWaypoints().length-1,s=0,a=this;if(a.fire("routing:rerouteAllSegmentsStart"),r<1)return i(null);this._eachSegment(function(t,e){this._routeSegment(t,e,i)})},_routeSegment:function(n,i,o){var r=this;if(null===n||null===i)return o(null,!0);if(n._routing.beeline)return o();this._router(n.getLatLng(),i.getLatLng(),function(t,e){return void 0===e?e=new L.Polyline([n.getLatLng(),i.getLatLng()],r.options.styles.nodata):e.setStyle(r.options.styles.track),r._updateLayer(n,i,e),o(t,e)})},_updateBeelines:function(){this._eachSegment(function(t,e,n){var i,o;t._routing.beeline&&(i=(o=t._routing.prevLine?t._routing.prevLine.getLatLngs():null)?o[o.length-1]:t.getLatLng(),o=(o=e._routing.nextLine?e._routing.nextLine.getLatLngs():null)&&!e._routing.beeline?o[0]:e.getLatLng(),o=this.createBeeline(i.clone(),o.clone()),this._updateLayer(t,e,o))})},createBeeline:function(t,e){var n=this.options.styles.beeline;return new L.Polyline([t,e],n)},_updateLayer:function(t,e,n){n._routing={prevMarker:t,nextMarker:e,beeline:t._routing.beeline},n.options.renderer=this._segmentsRenderer,null!==t._routing.nextLine&&this._segments.removeLayer(t._routing.nextLine),this._segments.addLayer(n),t._routing.nextLine=n,e._routing.prevLine=n},_eachSegment:function(t,e){var n=e||this,i=this.getFirst();if(null!==i)for(;null!==i._routing.nextMarker;){var o=i._routing.nextMarker,r=i._routing.nextLine;t.call(n,i,o,r),i=i._routing.nextMarker}},_fireWaypointEvent:function(t){this.fire("waypoint:"+t.type,{marker:t.target})},_fireSegmentEvent:function(t){var e={};t.layer&&(e.layer=t.layer),2===t.type.split(":").length?this.fire(t.type,e):this.fire("segment:"+t.type,e)},getFirst:function(){return this._waypoints._first},getLast:function(){return this._waypoints._last},getWaypoints:function(){var e=[];return this._eachSegment(function(t){e.push(t.getLatLng())}),this.getLast()&&e.push(this.getLast().getLatLng()),e},getBeelineFlags:function(){var e=[];return this._eachSegment(function(t){e.push(t._routing.beeline)}),e},toPolyline:function(){var i=[];return this._eachSegment(function(t,e,n){i=i.concat(n.getLatLngs())}),L.polyline(i)},toGeoJSON:function(t){var e={type:"LineString",properties:{waypoints:[]},coordinates:[]},n=this._waypoints._first;if(null===n)return e;for(e.properties.waypoints.push({coordinates:[n.getLatLng().lng,n.getLatLng().lat],_index:0});n._routing.nextMarker;){for(var i=n._routing.nextMarker,o=n._routing.nextLine.getLatLngs(),r=0;r<o.length;r++)!o[r].alt||void 0!==t&&!1!==t?e.coordinates.push([o[r].lng,o[r].lat]):e.coordinates.push([o[r].lng,o[r].lat,o[r].alt]);e.properties.waypoints.push({coordinates:[i.getLatLng().lng,i.getLatLng().lat],_index:e.coordinates.length-1}),n=n._routing.nextMarker}return e},loadGeoJSON:function(r,t,e){var n,s,a,i=this;if("function"!=typeof t&&void 0!==t||(e=t,t={}),t.waypointDistance=t.waypointDistance||50,t.fitBounds=t.fitBounds||!0,!r.properties||!r.properties.waypoints){r.properties||(r.properties={}),r.properties.waypoints=[];for(var o=0;o<r.coordinates.length;o+=t.waypointDistance)r.properties.waypoints.push({_index:o,coordinates:r.coordinates[o].slice(0,2)});o>r.coordinates.length-1&&r.properties.waypoints.push({_index:r.coordinates.length-1,coordinates:r.coordinates[r.coordinates.length-1].slice(0,2)})}s=0,n=i._router,a=r.properties.waypoints,i._router=function(t,e,n){var i=a[s-1]._index,o=a[s]._index+1;return n(null,L.GeoJSON.geometryToLayer({type:"LineString",coordinates:r.coordinates.slice(i,o)}))},end=function(){i._router=n,setTimeout(function(){t.fitBounds&&i._map.fitBounds(L.polyline(L.GeoJSON.coordsToLatLngs(r.coordinates)).getBounds()),"function"==typeof e&&e(null)},0)},add=function(){if(!a[s])return end();var t=a[s].coordinates,e=i._waypoints._last;i.addWaypoint(L.latLng(t[1],t[0]),null,e,null,function(t,e){add(++s)})},add()},draw:function(t){void 0===t&&(t=!0),t?this._draw.enable():this._draw.disable()},toggleBeelineDrawing:function(){return this._draw.toggleBeelineMode()},routing:function(t){throw new Error("Not implemented")},snapping:function(t){throw new Error("Not implemented")},_keyupListener:function(t){t.keyCode===this.options.shortcut.draw.disable?this._draw.disable():t.keyCode===this.options.shortcut.draw.enable?this._draw.enable():t.keyCode===this.options.shortcut.draw.beelineMode?this.toggleBeelineDrawing():t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!1)},_keydownListener:function(t){t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!0)}});
L.Routing.Draw=L.Handler.extend({includes:[L.Evented.prototype],options:{},initialize:function(t,i){this._parent=t,this._map=t._map,this._enabled=!1,this._beelineMode=!1,L.Util.setOptions(this,i)},enable:function(){this._enabled||(this._enabled=!0,this._hidden=!1,this._dragging=!1,this._addHooks(),this.fire("enabled"),this._map.fire("routing:draw-start"),0===this._parent._segments._layers.length?this._map.fire("routing:draw-new"):this._map.fire("routing:draw-continue"))},disable:function(){this._enabled&&(this._enabled=!1,this._removeHooks(),this.fire("disabled"),this._map.fire("routing:draw-end"))},_addHooks:function(){var t,i;this._map&&(this._marker||(this._marker=new L.Marker(this._map.getCenter(),{icon:this.options.icons.draw||new L.Icon.Default,opacity:this.options.icons.draw?1:0,zIndexOffset:this.options.zIndexOffset,interactive:!1})),this._trailer||(t=this._map.getCenter(),i=this._beelineMode?this.options.styles.beelineTrailer:this.options.styles.trailer,this._trailerOpacity=this.options.styles.trailer.opacity||.2,i=L.extend({},i,{opacity:0,interactive:!1}),this._trailer=new L.Polyline([t,t],i)),this._parent.on("waypoint:mouseover",this._catchWaypointEvent,this),this._parent.on("waypoint:mouseout",this._catchWaypointEvent,this),this._parent.on("waypoint:dragstart",this._catchWaypointEvent,this),this._parent.on("waypoint:dragend",this._catchWaypointEvent,this),this._parent.on("segment:mouseover",this._catchWaypointEvent,this),this._parent.on("segment:mouseout",this._catchWaypointEvent,this),this._parent.on("segment:dragstart",this._catchWaypointEvent,this),this._parent.on("segment:dragend",this._catchWaypointEvent,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onMouseClick,this),L.DomEvent.addListener(window,"blur",this._onblur,this),this._marker.addTo(this._map),this._trailer.addTo(this._map))},_removeHooks:function(){this._map&&(this._parent.off("waypoint:mouseover",this._catchWaypointEvent,this),this._parent.off("waypoint:mouseout",this._catchWaypointEvent,this),this._parent.off("waypoint:dragstart",this._catchWaypointEvent,this),this._parent.off("waypoint:dragend",this._catchWaypointEvent,this),this._parent.off("segment:mouseover",this._catchWaypointEvent,this),this._parent.off("segment:mouseout",this._catchWaypointEvent,this),this._parent.off("segment:dragstart",this._catchWaypointEvent,this),this._parent.off("segment:dragend",this._catchWaypointEvent,this),this._map.off("click",this._onMouseClick,this),this._map.off("mousemove",this._onMouseMove,this),L.DomEvent.removeListener(window,"blur",this._onblur,this),this._map.removeLayer(this._marker),this._map.removeLayer(this._trailer),delete this._marker,delete this._trailer)},_catchWaypointEvent:function(t){t=t.type.split(":")[1];this._hidden?this._dragging?"dragend"===t&&(this._dragging=!1):"mouseout"===t?this._show():"dragstart"===t&&(this._dragging=!0):"mouseover"===t&&this._hide()},_hide:function(){this._hidden=!0,this._marker.setOpacity(0),this._trailer.setStyle({opacity:0})},_show:function(){this._hidden=!1,this._marker.setOpacity(this.options.icons.draw?1:0),this._showTrailer()},_showTrailer:function(){0!==this._trailer.options.opacity||this._parent.touch||this._trailer.setStyle({opacity:this._trailerOpacity})},_setTrailer:function(t,i){this._trailer.setLatLngs([t,i]),this._showTrailer()},_onMouseMove:function(t){var i;this._hidden||(i=t.latlng,t=this._parent.getLast(),this.options.snapping&&(i=L.LineUtil.snapToLayers(i,null,this.options.snapping)),this._marker.setLatLng(i),null!==t&&this._setTrailer(t.getLatLng(),i))},_onMouseClick:function(t){var i,e,s;this._hidden||(s=t.latlng,this.options.snapping&&(s=L.LineUtil.snapToLayers(s,null,this.options.snapping)),(i=this._parent.getLast())&&(e=(e=this.options.shortcut.draw.beelineModifierName)&&t.originalEvent[e],i._routing.beeline=this._isBeelineDrawing(e)),this._setTrailer(s,s),this._parent.addWaypoint(s,null,i,null,function(t,i){}))},toggleBeelineMode:function(){return this._enabled&&(this._beelineMode=!this._beelineMode,this._setTrailerStyle(),this._map.fire(this._beelineMode?"routing:beeline-start":"routing:beeline-end")),this._beelineMode},_setTrailerStyle:function(t){var i;this._enabled&&(i=this._isBeelineDrawing(t)?this.options.styles.beelineTrailer:this.options.styles.trailer,t=this._trailer.options.opacity,this._trailer.setStyle(L.extend({},i,{opacity:t})))},_isBeelineDrawing:function(t){return t?!this._beelineMode:this._beelineMode},_onblur:function(t){this._enabled&&this._setTrailerStyle()}});
L.Routing.Edit=L.Handler.extend({includes:[L.Evented.prototype],options:{},initialize:function(t,e){this._parent=t,this._map=t._map,this._enabled=!1,L.Util.setOptions(this,e)},enable:function(){this._enabled||(this._enabled=!0,this._addHooks(),this.fire("enabled"),this._map.fire("routing:edit-start"))},disable:function(){this._enabled&&(this._enabled=!1,this._removeHooks(),this.fire("disabled"),this._map.fire("routing:edit-end"))},_addHooks:function(){var t,e;this._map&&(this._mouseMarker||(this._mouseMarker=new L.Marker(this._map.getCenter(),{icon:L.divIcon({className:"line-mouse-marker",iconAnchor:[5,5],iconSize:[10,10]}),interactive:!0,draggable:!0,zIndexOffset:this.options.zIndexOffset,title:this.options.tooltips.segment})),this._trailer1||(t=this._map.getCenter(),this._trailerOpacity=this.options.styles.trailer.opacity||.2,e=L.extend({},this.options.styles.trailer,{opacity:0,interactive:!1}),this._trailer1=new L.Polyline([t,t],e),this._trailer2=new L.Polyline([t,t],e)),this._trailer1.addTo(this._map),this._trailer2.addTo(this._map),this._parent.touch?((e=this._parent._segmentsRenderer)instanceof L.Canvas&&(this._map.hasLayer(e)||this._map.addLayer(e),L.DomEvent.on(e._container,"touchstart touchend",e._onTouch,e)),this._parent.on("segment:layeradd",this._segmentOnAdd,this),this.on("segment:dragend",this._hideMouseMarker,this),L.DomEvent.on(this._mouseMarker,"contextmenu",this._segmentOnContextmenu,this),this._parent._segments.on("contextmenu",this._hideMouseMarker,this)):this._parent.on("segment:mouseover",this._segmentOnMouseover,this),this._mouseMarker.on("dragstart",this._segmentOnDragstart,this),this._mouseMarker.on("drag",this._segmentOnDrag,this),this._mouseMarker.on("dragend",this._segmentOnDragend,this),this._mouseMarker.on("click",this._segmentOnClick,this),this._mouseMarker.on("dblclick",L.DomEvent.stop,this),this._parent.on("waypoint:dragstart",this._waypointOnDragstart,this),this._parent.on("waypoint:drag",this._waypointOnDrag,this),this._parent.on("waypoint:dragend",this._waypointOnDragend,this))},_removeHooks:function(){var t;this._map&&(this._parent.touch?((t=this._parent._segmentsRenderer)instanceof L.Canvas&&L.DomEvent.off(t._container,"touchstart touchend",t._onTouch,t),this._parent.off("segment:layeradd",this._segmentOnAdd,this),this.off("segment:dragend",this._hideMouseMarker,this),L.DomEvent.off(this._mouseMarker,"contextmenu",this._segmentOnContextmenu,this),this._parent._segments.off("contextmenu",this._hideMouseMarker,this)):this._parent.off("segment:mouseover",this._segmentOnMouseover,this),this._mouseMarker.off("dragstart",this._segmentOnDragstart,this),this._mouseMarker.off("drag",this._segmentOnDrag,this),this._mouseMarker.off("dragend",this._segmentOnDragend,this),this._mouseMarker.off("click",this._segmentOnClick,this),this._mouseMarker.off("dblclick",L.DomEvent.stop,this),this._parent.off("waypoint:dragstart",this._waypointOnDragstart,this),this._parent.off("waypoint:drag",this._waypointOnDrag,this),this._parent.off("waypoint:dragend",this._waypointOnDragend,this))},_segmentOnMouseover:function(t){this._showMouseMarker(),this._map.on("mousemove",this._segmentOnMousemove,this)},_segmentOnMouseout:function(t){this._dragging||(this._hideMouseMarker(),this._map.off("mousemove",this._segmentOnMousemove,this),this.fire("segment:mouseout"))},_segmentOnMousemove:function(t){var e;this._dragging||(null===(e=L.LineUtil.snapToLayers(t.latlng,null,{layers:[this._parent._segments],sensitivity:this.options.snapSensitivity,vertexonly:!1}))._feature?this._segmentOnMouseout(t):(this._mouseMarker._snapping=e._feature._routing,this._mouseMarker.setLatLng(e)))},_segmentOnAdd:function(t){t.layer.on("touchstart pointerdown",this._segmentOnTouchstart,this),this.on("segment:click",this._hideMouseMarker,this)},_segmentOnTouchstart:function(t){var e=t.target;this._mouseMarker.setLatLng(t.latlng),this._showMouseMarker(),this._mouseMarker._snapping=e._routing;const n=t.originalEvent;this._mouseMarker._icon.dispatchEvent(new n.constructor(n.type,n))},_segmentOnDragstart:function(t){var e=t.target.getLatLng(),n=t.target._snapping.nextMarker,t=t.target._snapping.prevMarker;this._setTrailers(e,n,t,!0),this._dragging=!0,this.fire("segment:dragstart")},_segmentOnDrag:function(t){var e=t.target.getLatLng(),n=t.target._snapping.nextMarker,s=t.target._snapping.prevMarker;this.options.snapping&&(e=L.LineUtil.snapToLayers(e,null,this.options.snapping)),t.target.setLatLng(e),this._setTrailers(e,n,s)},_segmentOnDragend:function(t){var e=this._mouseMarker._snapping.nextMarker,n=this._mouseMarker._snapping.prevMarker,s=this._mouseMarker.getLatLng();this._parent.addWaypoint(s,null,n,e,function(t,e){}),this._dragging=!1,this._setTrailers(null,null,null,!1),this.fire("segment:dragend")},_segmentOnClick:function(t){var n=this,e=this._mouseMarker._snapping.nextMarker,s=this._mouseMarker._snapping.prevMarker;L.DomEvent.stop(t),s._routing.beeline=!s._routing.beeline,this.fire("segment:click"),this._parent.fire("routing:rerouteSegmentStart"),this._parent._routeSegment(s,e,function(t,e){n._parent._updateBeelines(),n._parent.fire("routing:rerouteSegmentEnd",{err:t})})},_segmentOnContextmenu:function(t){this._hideMouseMarker(),this._parent._segments.fire("mousemove",t,!0),this._map.once("click",function(t){this._parent._segments.fire("mouseout",t,!0)},this)},_waypointOnDragstart:function(t){var e=t.marker._routing.nextMarker,n=t.marker._routing.prevMarker;this._setTrailers(t.marker.getLatLng(),e,n,!0)},_waypointOnDrag:function(t){var e=t.marker._latlng,n=t.marker._routing.nextMarker,s=t.marker._routing.prevMarker;this.options.snapping&&(e=L.LineUtil.snapToLayers(e,null,this.options.snapping)),t.marker.setLatLng(e),this._setTrailers(e,n,s)},_waypointOnDragend:function(t){this._setTrailers(null,null,null,!1),this._parent.routeWaypoint(t.marker,function(t,e){})},_waypointOnClick:function(t){this._parent.removeWaypoint(t.layer,function(t,e){})},_setTrailers:function(t,e,n,s){if(void 0!==s){if(!1===s)return this._trailer1.setStyle({opacity:0}),void this._trailer2.setStyle({opacity:0});null!==e&&this._trailer1.setStyle({opacity:this._trailerOpacity}),null!==n&&this._trailer2.setStyle({opacity:this._trailerOpacity})}e&&this._trailer1.setLatLngs([t,e.getLatLng()]),n&&this._trailer2.setLatLngs([t,n.getLatLng()])},_hideMouseMarker:function(){this._mouseMarker.remove()},_showMouseMarker:function(){this._mouseMarker.addTo(this._map)}}),L.Canvas.prototype._onTouch=function(t){var e=t.touches&&0<t.touches.length?t.touches:t.changedTouches;e&&!t.clientX&&(t.clientX=e[0].clientX,t.clientY=e[0].clientY);for(var n,s,i=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(i)&&(s=n);s&&(L.DomEvent.fakeStop(t),this._fireEvent([s],t))};
L.Control.Sidebar=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:{autopan:!1,closeButton:!0,container:"",position:"left"},initialize:function(t,e){return"string"==typeof t&&(console.warn("this syntax is deprecated. please use L.control.sidebar({ container }) now"),t={container:t}),"object"==typeof t&&t.id&&(console.warn("this syntax is deprecated. please use L.control.sidebar({ container }) now"),t.container=t.id),this._tabitems=[],this._panes=[],this._closeButtons=[],this._expandButtons=[],L.setOptions(this,Object.assign({},t,e)),this},onAdd:function(t){var e,i,s,n,a,o="string"==typeof this.options.container?L.DomUtil.get(this.options.container):this.options.container;for(o=o||L.DomUtil.create("div","leaflet-sidebar collapsed"),this._paneContainer=o.querySelector("div.leaflet-sidebar-content"),null===this._paneContainer&&(this._paneContainer=L.DomUtil.create("div","leaflet-sidebar-content",o)),this._tabContainer=this.options.tabContainer?L.DomUtil.get(this.options.tabContainer):o,i=this._tabContainer.querySelectorAll("ul.leaflet-sidebar-tabs, div.leaflet-sidebar-tabs > ul"),this._tabContainerTop=i[0]||null,this._tabContainerBottom=i[1]||null,null===this._tabContainerTop&&((s=L.DomUtil.create("div","leaflet-sidebar-tabs",o)).setAttribute("role","tablist"),this._tabContainerTop=L.DomUtil.create("ul","",s)),null===this._tabContainerBottom&&(s=this._tabContainerTop.parentNode,this._tabContainerBottom=L.DomUtil.create("ul","",s)),e=0;e<this._tabContainerTop.children.length;e++)(a=this._tabContainerTop.children[e])._sidebar=this,a._id=a.querySelector("a").hash.slice(1),this._tabitems.push(a);for(e=0;e<this._tabContainerBottom.children.length;e++)(a=this._tabContainerBottom.children[e])._sidebar=this,a._id=a.querySelector("a").hash.slice(1),this._tabitems.push(a);for(e=0;e<this._paneContainer.children.length;e++)"DIV"===(a=this._paneContainer.children[e]).tagName&&L.DomUtil.hasClass(a,"leaflet-sidebar-pane")&&(this._panes.push(a),(n=a.querySelectorAll(".leaflet-sidebar-close")).length&&(this._closeButtons.push(n[n.length-1]),this._closeClick(n[n.length-1],"on")),(n=a.querySelectorAll(".leaflet-sidebar-expand")).length&&(this._expandButtons.push(n[n.length-1]),this._expandClick(n[n.length-1],"on")));for(e=0;e<this._tabitems.length;e++)this._tabClick(this._tabitems[e],"on");return o},onRemove:function(t){var e;for(this._map=null,this._tabitems=[],this._panes=[],this._closeButtons=[],this._expandButtons=[],e=0;e<this._tabitems.length;e++)this._tabClick(this._tabitems[e],"off");for(e=0;e<this._closeButtons.length;e++)this._closeClick(this._closeButtons[e],"off");for(e=0;e<this._expandButtons.length;e++)this._expandClick(this._expandButtons[e],"off");return this},addTo:function(t){return this.onRemove(),this._map=t,this._container=this.onAdd(t),L.DomUtil.addClass(this._container,"leaflet-sidebar-"+this.getPosition()),L.DomUtil.addClass(this._tabContainer,"leaflet-sidebar-"+this.getPosition()),L.Browser.touch&&(L.DomUtil.addClass(this._container,"leaflet-touch"),L.DomUtil.addClass(this._tabContainer,"leaflet-touch")),L.DomEvent.disableScrollPropagation(this._container),L.DomEvent.disableClickPropagation(this._container),L.DomUtil.hasClass(this._map.getContainer(),"leaflet-sidebar-map")||(L.DomUtil.addClass(this._map.getContainer(),"leaflet-sidebar-map"),this._map.invalidateSize()),this.options.autopan&&this._container.addEventListener("transitionend",L.bind(function(t){this._map.invalidateSize({animate:!1})},this),!0),this},removeFrom:function(t){return console.warn("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon."),this._map._container.removeChild(this._container),this.onRemove(t),this},open:function(t){var e,i,s=this._getTab(t);if(L.DomUtil.hasClass(s,"disabled"))return this;for(e=0;e<this._panes.length;e++)(i=this._panes[e]).id===t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");for(e=0;e<this._tabitems.length;e++)(i=this._tabitems[e]).querySelector("a").hash==="#"+t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");return this.fire("content",{id:t}),L.DomUtil.hasClass(this._container,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._container,"collapsed"),L.DomUtil.removeClass(this._tabContainer,"collapsed")),this._map.invalidateSize(),this},close:function(){for(var t=0;t<this._tabitems.length;t++){var e=this._tabitems[t];L.DomUtil.hasClass(e,"active")&&L.DomUtil.removeClass(e,"active")}return L.DomUtil.hasClass(this._container,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._container,"collapsed"),L.DomUtil.addClass(this._tabContainer,"collapsed"),this._map.invalidateSize()),this},toggleExpand:function(t){var e=L.DomUtil.hasClass(this._map.getContainer(),"sidebar-expanded");if(e)for(L.DomUtil.removeClass(this._map.getContainer(),"sidebar-expanded"),i=0;i<this._expandButtons.length;i++)L.DomUtil.removeClass(this._expandButtons[i],"active");else for(L.DomUtil.addClass(this._map.getContainer(),"sidebar-expanded"),i=0;i<this._expandButtons.length;i++)L.DomUtil.addClass(this._expandButtons[i],"active");return this._map.invalidateSize(),this.fire("toggleExpand",{expanded:!e}),this},addPanel:function(t){var e,i=L.DomUtil.create("li",t.disabled?"disabled":""),s=L.DomUtil.create("a","",i);return s.href="#"+t.id,s.setAttribute("role","tab"),s.innerHTML=t.tab,i._sidebar=this,i._id=t.id,i._button=t.button,t.title&&"<"!==t.title[0]&&(i.title=t.title),("bottom"===t.position?this._tabContainerBottom:this._tabContainerTop).appendChild(i),this._tabitems.push(i),t.pane&&("string"==typeof t.pane?(e=L.DomUtil.create("DIV","leaflet-sidebar-pane",this._paneContainer),s="",t.title&&(s+='<h1 class="leaflet-sidebar-header">'+t.title),this.options.closeButton&&(s+='<span class="leaflet-sidebar-close"><i class="fa fa-caret-left"></i></span>'),t.title&&(s+="</h1>"),e.innerHTML=s+t.pane):(e=t.pane,this._paneContainer.appendChild(e)),e.id=t.id,this._panes.push(e),(e=e.querySelectorAll(".leaflet-sidebar-close")).length&&(this._closeButtons.push(e[e.length-1]),this._closeClick(e[e.length-1],"on"))),this._tabClick(i,"on"),this},removePanel:function(t){for(var e,i,s,n,a=0;a<this._tabitems.length;a++)if(this._tabitems[a]._id===t){i=this._tabitems[a],this._tabClick(i,"off"),i.remove(),this._tabitems.slice(a,1);break}for(a=0;a<this._panes.length;a++)if(this._panes[a].id===t){for(n=(s=this._panes[a]).querySelectorAll(".leaflet-sidebar-close"),e=0;a<n.length;e++)this._closeClick(n[e],"off");s.remove(),this._panes.slice(a,1);break}return this},enablePanel:function(t){t=this._getTab(t);return L.DomUtil.removeClass(t,"disabled"),this},disablePanel:function(t){t=this._getTab(t);return L.DomUtil.addClass(t,"disabled"),this},_tabClick:function(t,e){var i=t.querySelector("a");i.hasAttribute("href")&&"#"===i.getAttribute("href")[0]&&(i=function(t){L.DomUtil.hasClass(this,"active")?this._sidebar.close():L.DomUtil.hasClass(this,"disabled")||("string"==typeof this._button?window.location.href=this._button:"function"==typeof this._button?this._button(t):this._sidebar.open(this.querySelector("a").hash.slice(1)))},"on"===e?L.DomEvent.on(t.querySelector("a"),"click",L.DomEvent.preventDefault).on(t.querySelector("a"),"click",i,t):L.DomEvent.off(t.querySelector("a"),"click",i))},onCloseClick:function(){this.close()},_closeClick:function(t,e){"on"===e?L.DomEvent.on(t,"click",this.onCloseClick,this):L.DomEvent.off(t,"click",this.onCloseClick)},onExpandClick:function(t){t=t.target||t.srcElement;this.toggleExpand(t)},_expandClick:function(t,e){"on"===e?L.DomEvent.on(t,"click",this.onExpandClick,this):L.DomEvent.off(t,"click",this.onExpandClick)},_getTab:function(t){for(var e=0;e<this._tabitems.length;e++)if(this._tabitems[e]._id===t)return this._tabitems[e];return null},_panMap:function(t){var e=Number.parseInt(L.DomUtil.getStyle(this._container,"max-width"))/2;("open"===t&&"left"===this.options.position||"close"===t&&"right"===this.options.position)&&(e*=-1),this._map.panBy([e,0],{duration:.25})}}),L.control.sidebar=function(t,e){return new L.Control.Sidebar(t,e)};
L.Canvas.prototype._updateTriangle=function(t){var i,n;if(!this._drawing||t._empty())return null;i=t._point,n=this._ctx,wh=t._width/2,hh=t._height/2,r=0!==t._rotation?t._rotation*(2*Math.PI)/360:0,n.save(),n.translate(i.x,i.y),n.rotate(r),n.beginPath(),n.moveTo(0,-hh),n.lineTo(wh,2*hh),n.lineTo(-wh,2*hh),n.closePath(),n.restore(),this._fillStroke(n,t)},L.TriangleMarker=L.Path.extend({options:{fill:!0,width:12,height:12,rotation:0,renderer:L.canvas()},initialize:function(t,i){L.setOptions(this,i),this._latlng=L.latLng(t),this._width=this.options.width,this._height=this.options.height,this._rotation=this.options.rotation,this._renderer=this.options.renderer},setLatLng:function(t){return this._latlng=L.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setWidth:function(t){return this.options.width=this._width=t,this.redraw()},setHeight:function(t){return this.options.height=this._height=t,this.redraw()},setRotation:function(t){return this.options.rotation=this._rotation=t,this.redraw()},getWidth:function(){return this._width},getHeight:function(){return this._height},getRotation:function(){return this._rotation},setStyle:function(t){var i=t&&t.width||this._width,n=t&&t.height||this._height;return L.Path.prototype.setStyle.call(this,t),this.setWidth(i),this.setHeight(n),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._width/2,i=this._height/2,n=this._clickTolerance(),n=[t+n,i+n];this._pxBounds=new L.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateTriangle(this)},_empty:function(){return this._width&&this._height&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return this._pxBounds&&this._pxBounds.contains(t)}}),L.triangleMarker=function(t,i){return new L.TriangleMarker(t,i)};
!function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(n,t){var e,i=Object.keys(n);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(n),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),i.push.apply(i,e)),i}function i(i){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e(Object(r),!0).forEach(function(t){var n,e;n=i,t=r[e=t],e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(r,t))})}return i}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function h(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return o=t.done,t},e:function(t){a=!0,r=t},f:function(){try{o||null==e.return||e.return()}finally{if(a)throw r}}}}var r="http://www.w3.org/1999/xhtml",o={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(t){var n=t+="",e=n.indexOf(":");return 0<=e&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),o.hasOwnProperty(n)?{space:o[n],local:t}:t}function u(t){t=a(t);return(t.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}})(t)}function l(){}function d(t){return null==t?l:function(){return this.querySelector(t)}}function c(){return[]}function m(t){return null==t?c:function(){return this.querySelectorAll(t)}}function f(t){return function(){return this.matches(t)}}function t(t){return new Array(t.length)}function p(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var g="$";function b(t,n,e,i,r,o){for(var a,s=0,u=n.length,l=o.length;s<l;++s)(a=n[s])?(a.__data__=o[s],i[s]=a):e[s]=new p(t,o[s]);for(;s<u;++s)(a=n[s])&&(r[s]=a)}function M(t,n,e,i,r,o,a){for(var s,u,l={},h=n.length,c=o.length,f=new Array(h),d=0;d<h;++d)(s=n[d])&&(f[d]=u=g+a.call(s,s.__data__,d,n),u in l?r[d]=s:l[u]=s);for(d=0;d<c;++d)(s=l[u=g+a.call(t,o[d],d,o)])?((i[d]=s).__data__=o[d],l[u]=null):e[d]=new p(t,o[d]);for(d=0;d<h;++d)(s=n[d])&&l[f[d]]===s&&(r[d]=s)}function _(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function y(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function C(t,n){return t.style.getPropertyValue(n)||y(t).getComputedStyle(t,null).getPropertyValue(n)}function v(t){return t.trim().split(/^|\s+/)}function x(t){return t.classList||new w(t)}function w(t){this._node=t,this._names=v(t.getAttribute("class")||"")}function k(t,n){for(var e=x(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function A(t,n){for(var e=x(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function S(){this.textContent=""}function T(){this.innerHTML=""}function N(){this.nextSibling&&this.parentNode.appendChild(this)}function E(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function H(){return null}function D(){var t=this.parentNode;t&&t.removeChild(this)}function F(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function P(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}w.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var B={},O=null;function z(e,t,n){return e=I(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function I(e,i,r){return function(t){var n=O;O=t;try{e.call(this,this.__data__,i,r)}finally{O=n}}}function j(o){return function(){var t=this.__on;if(t){for(var n,e=0,i=-1,r=t.length;e<r;++e)n=t[e],o.type&&n.type!==o.type||n.name!==o.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function R(u,l,h){var c=B.hasOwnProperty(u.type)?z:I;return function(t,n,e){var i,r=this.__on,o=c(l,n,e);if(r)for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===u.type&&i.name===u.name)return this.removeEventListener(i.type,i.listener,i.capture),this.addEventListener(i.type,i.listener=o,i.capture=h),void(i.value=l);this.addEventListener(u.type,o,h),i={type:u.type,name:u.name,value:l,listener:o,capture:h},r?r.push(i):this.__on=[i]}}function q(t,n,e,i){var r=O;t.sourceEvent=O,O=t;try{return n.apply(e,i)}finally{O=r}}function X(t,n,e){var i=y(t),r=i.CustomEvent;"function"==typeof r?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(B={mouseenter:"mouseover",mouseleave:"mouseout"}));var G=[null];function V(t,n){this._groups=t,this._parents=n}function Y(){return new V([[document.documentElement]],G)}function $(t){return"string"==typeof t?new V([[document.querySelector(t)]],[document.documentElement]):new V([[t]],G)}function U(){for(var t,n=O;t=n.sourceEvent;)n=t;return n}function W(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]}function Z(t){var n=U();return n.changedTouches&&(n=n.changedTouches[0]),W(t,n)}function K(t){return"string"==typeof t?new V([document.querySelectorAll(t)],[document.documentElement]):new V([null==t?[]:t],G)}function Q(t,n,e){arguments.length<3&&(e=n,n=U().changedTouches);for(var i,r=0,o=n?n.length:0;r<o;++r)if((i=n[r]).identifier===e)return W(t,i);return null}V.prototype=Y.prototype={constructor:V,select:function(t){"function"!=typeof t&&(t=d(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a,s=n[r],u=s.length,l=i[r]=new Array(u),h=0;h<u;++h)(o=s[h])&&(a=t.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),l[h]=a);return new V(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=m(t));for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var a,s=n[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(i.push(t.call(a,a.__data__,l,s)),r.push(a));return new V(i,r)},filter:function(t){"function"!=typeof t&&(t=f(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a=n[r],s=a.length,u=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new V(i,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),h=-1,this.each(function(t){p[++h]=t}),p;var e,i=n?M:b,r=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,s=new Array(a),u=new Array(a),l=new Array(a),h=0;h<a;++h){var c=r[h],f=o[h],d=f.length,p=t.call(c,c&&c.__data__,h,r),g=p.length,_=u[h]=new Array(g),m=s[h]=new Array(g);i(c,f,_,m,l[h]=new Array(d),p,n);for(var y,v,x=0,w=0;x<g;++x)if(y=_[x]){for(w<=x&&(w=x+1);!(v=m[w])&&++w<g;);y._next=v||null}}return(s=new V(s,r))._enter=u,s._exit=l,s},enter:function(){return new V(this._enter||this._groups.map(t),this._parents)},exit:function(){return new V(this._exit||this._groups.map(t),this._parents)},join:function(t,n,e){var i=this.enter(),r=this,o=this.exit(),i="function"==typeof t?t(i):i.append(t+"");return null!=n&&(r=n(r)),null==e?o.remove():e(o),i&&r?i.merge(r).order():r},merge:function(t){for(var n=this._groups,e=t._groups,i=n.length,t=e.length,r=Math.min(i,t),o=new Array(i),a=0;a<r;++a)for(var s,u=n[a],l=e[a],h=u.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=u[f]||l[f])&&(c[f]=s);for(;a<i;++a)o[a]=n[a];return new V(o,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i,r=t[n],o=r.length-1,a=r[o];0<=--o;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e=e||_;for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],u=s.length,l=r[o]=new Array(u),h=0;h<u;++h)(a=s[h])&&(l[h]=a);l.sort(t)}return new V(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each(function(){t[++n]=this}),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r,o=n[e],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,n){var e=a(t);if(arguments.length<2){t=this.node();return e.local?t.getAttributeNS(e.space,e.local):t.getAttribute(e)}return this.each((null==n?e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof n?e.local?function(n,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}:function(n,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(n):this.setAttribute(n,t)}}:e.local?function(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}:function(t,n){return function(){this.setAttribute(t,n)}})(e,n))},style:function(t,n,e){return 1<arguments.length?this.each((null==n?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof n?function(n,e,i){return function(){var t=e.apply(this,arguments);null==t?this.style.removeProperty(n):this.style.setProperty(n,t,i)}}:function(t,n,e){return function(){this.style.setProperty(t,n,e)}})(t,n,null==e?"":e)):C(this.node(),t)},property:function(t,n){return 1<arguments.length?this.each((null==n?function(t){return function(){delete this[t]}}:"function"==typeof n?function(n,e){return function(){var t=e.apply(this,arguments);null==t?delete this[n]:this[n]=t}}:function(t,n){return function(){this[t]=n}})(t,n)):this.node()[t]},classed:function(t,n){var e=v(t+"");if(arguments.length<2){for(var i=x(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each(("function"==typeof n?function(t,n){return function(){(n.apply(this,arguments)?k:A)(this,t)}}:n?function(t){return function(){k(this,t)}}:function(t){return function(){A(this,t)}})(e,n))},text:function(t){return arguments.length?this.each(null==t?S:("function"==typeof t?function(n){return function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?T:("function"==typeof t?function(n){return function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(N)},lower:function(){return this.each(E)},append:function(t){var n="function"==typeof t?t:u(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:u(t),i=null==n?H:"function"==typeof n?n:d(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(D)},clone:function(t){return this.select(t?P:F)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var i,r,o=(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");return 0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}),a=o.length;if(!(arguments.length<2)){for(s=n?R:j,null==e&&(e=!1),i=0;i<a;++i)this.each(s(o[i],n,e));return this}var s=this.node().__on;if(s)for(var u,l=0,h=s.length;l<h;++l)for(i=0,u=s[l];i<a;++i)if((r=o[i]).type===u.type&&r.name===u.name)return u.value},dispatch:function(t,n){return this.each(("function"==typeof n?function(t,n){return function(){return X(this,t,n.apply(this,arguments))}}:function(t,n){return function(){return X(this,t,n)}})(t,n))}};var J={value:function(){}};function tt(){for(var t,n=0,e=arguments.length,i={};n<e;++n){if(!(t=arguments[n]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new nt(i)}function nt(t){this._=t}function et(t,n,e){for(var i=0,r=t.length;i<r;++i)if(t[i].name===n){t[i]=J,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=e&&t.push({name:n,value:e}),t}nt.prototype=tt.prototype={constructor:nt,on:function(t,n){var e,i,r=this._,o=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");if(0<=e&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<s;)if(e=(t=o[a]).type)r[e]=et(r[e],t.name,n);else if(null==n)for(e in r)r[e]=et(r[e],t.name,null);return this}for(;++a<s;)if((e=(t=o[a]).type)&&(e=function(t,n){for(var e,i=0,r=t.length;i<r;++i)if((e=t[i]).name===n)return e.value}(r[e],t.name)))return e},copy:function(){var t,n={},e=this._;for(t in e)n[t]=e[t].slice();return new nt(n)},call:function(t,n){if(0<(e=arguments.length-2))for(var e,i,r=new Array(e),o=0;o<e;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(i=this._[t]).length;o<e;++o)i[o].value.apply(n,r)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};var it,rt,ot=0,at=0,st=0,ut=1e3,lt=0,ht=0,ct=0,ft="object"==typeof performance&&performance.now?performance:Date,dt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function pt(){return ht||(dt(gt),ht=ft.now()+ct)}function gt(){ht=0}function _t(){this._call=this._time=this._next=null}function mt(t,n,e){var i=new _t;return i.restart(t,n,e),i}function yt(){ht=(lt=ft.now())+ct,ot=at=0;try{!function(){pt(),++ot;for(var t,n=it;n;)0<=(t=ht-n._time)&&n._call.call(null,t),n=n._next;--ot}()}finally{ot=0,function(){for(var t,n,e=it,i=1/0;e;)e=e._call?(i>e._time&&(i=e._time),(t=e)._next):(n=e._next,e._next=null,t?t._next=n:it=n);rt=t,xt(i)}(),ht=0}}function vt(){var t=ft.now(),n=t-lt;ut<n&&(ct-=n,lt=t)}function xt(t){ot||(at=at&&clearTimeout(at),24<t-ht?(t<1/0&&(at=setTimeout(yt,t-ft.now()-ct)),st=st&&clearInterval(st)):(st||(lt=ft.now(),st=setInterval(vt,ut)),ot=1,dt(yt)))}function wt(n,e,t){var i=new _t;return e=null==e?0:+e,i.restart(function(t){i.stop(),n(t+e)},e,t),i}_t.prototype=mt.prototype={constructor:_t,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?pt():+e)+(null==n?0:+n),this._next||rt===this||(rt?rt._next=this:it=this,rt=this),this._call=t,this._time=e,xt()},stop:function(){this._call&&(this._call=null,this._time=1/0,xt())}};var bt=tt("start","end","cancel","interrupt"),Mt=[],kt=0,At=1,St=2,Tt=3,Nt=4,Ct=5,Et=6;function Ht(t,n,e,i,r,o){var a,s,u,l,h,c=t.__transition;if(c){if(e in c)return}else t.__transition={};function f(t){var n,e,i,r;if(u.state!==At)return p();for(n in h)if((r=h[n]).name===u.name){if(r.state===Tt)return wt(f);r.state===Nt?(r.state=Et,r.timer.stop(),r.on.call("interrupt",a,a.__data__,r.index,r.group),delete h[n]):+n<s&&(r.state=Et,r.timer.stop(),r.on.call("cancel",a,a.__data__,r.index,r.group),delete h[n])}if(wt(function(){u.state===Tt&&(u.state=Nt,u.timer.restart(d,u.delay,u.time),d(t))}),u.state=St,u.on.call("start",a,a.__data__,u.index,u.group),u.state===St){for(u.state=Tt,l=new Array(i=u.tween.length),n=0,e=-1;n<i;++n)(r=u.tween[n].value.call(a,a.__data__,u.index,u.group))&&(l[++e]=r);l.length=e+1}}function d(t){for(var n=t<u.duration?u.ease.call(null,t/u.duration):(u.timer.restart(p),u.state=Ct,1),e=-1,i=l.length;++e<i;)l[e].call(a,n);u.state===Ct&&(u.on.call("end",a,a.__data__,u.index,u.group),p())}function p(){for(var t in u.state=Et,u.timer.stop(),delete h[s],h)return;delete a.__transition}a=t,s=e,u={name:n,index:i,group:r,on:bt,tween:Mt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:kt},((h=a.__transition)[s]=u).timer=mt(function(t){u.state=At,u.timer.restart(f,u.delay,u.time),u.delay<=t&&f(t-u.delay)},0,u.time)}function Lt(t,n){n=Ft(t,n);if(n.state>kt)throw new Error("too late; already scheduled");return n}function Dt(t,n){n=Ft(t,n);if(n.state>Tt)throw new Error("too late; already running");return n}function Ft(t,n){t=t.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function Pt(t,n,e){(t.prototype=n.prototype=e).constructor=t}function Bt(t,n){var e,i=Object.create(t.prototype);for(e in n)i[e]=n[e];return i}function Ot(){}var zt="\\s*([+-]?\\d+)\\s*",It="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rt=/^#([0-9a-f]{3,8})$/,qt=new RegExp("^rgb\\("+[zt,zt,zt]+"\\)$"),Xt=new RegExp("^rgb\\("+[jt,jt,jt]+"\\)$"),Gt=new RegExp("^rgba\\("+[zt,zt,zt,It]+"\\)$"),Vt=new RegExp("^rgba\\("+[jt,jt,jt,It]+"\\)$"),Yt=new RegExp("^hsl\\("+[It,jt,jt]+"\\)$"),$t=new RegExp("^hsla\\("+[It,jt,jt,It]+"\\)$"),Ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wt(){return this.rgb().formatHex()}function Zt(){return this.rgb().formatRgb()}function Kt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Rt.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Qt(n):3===e?new nn(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?Jt(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?Jt(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=qt.exec(t))?new nn(n[1],n[2],n[3],1):(n=Xt.exec(t))?new nn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Gt.exec(t))?Jt(n[1],n[2],n[3],n[4]):(n=Vt.exec(t))?Jt(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Yt.exec(t))?an(n[1],n[2]/100,n[3]/100,1):(n=$t.exec(t))?an(n[1],n[2]/100,n[3]/100,n[4]):Ut.hasOwnProperty(t)?Qt(Ut[t]):"transparent"===t?new nn(NaN,NaN,NaN,0):null}function Qt(t){return new nn(t>>16&255,t>>8&255,255&t,1)}function Jt(t,n,e,i){return i<=0&&(t=n=e=NaN),new nn(t,n,e,i)}function tn(t,n,e,i){return 1===arguments.length?((r=t)instanceof Ot||(r=Kt(r)),r?new nn((r=r.rgb()).r,r.g,r.b,r.opacity):new nn):new nn(t,n,e,null==i?1:i);var r}function nn(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function en(){return"#"+on(this.r)+on(this.g)+on(this.b)}function rn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function on(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function an(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||1<=e?t=n=NaN:n<=0&&(t=NaN),new un(t,n,e,i)}function sn(t){if(t instanceof un)return new un(t.h,t.s,t.l,t.opacity);if(t instanceof Ot||(t=Kt(t)),!t)return new un;if(t instanceof un)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),a=NaN,s=o-r,u=(o+r)/2;return s?(a=n===o?(e-i)/s+6*(e<i):e===o?(i-n)/s+2:(n-e)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=0<u&&u<1?0:a,new un(a,s,u,t.opacity)}function un(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function ln(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function hn(t){return function(){return t}}function cn(o){return 1==(o=+o)?fn:function(t,n){return n-t?(e=t,i=n,r=o,e=Math.pow(e,r),i=Math.pow(i,r)-e,r=1/r,function(t){return Math.pow(e+t*i,r)}):hn(isNaN(t)?n:t);var e,i,r}}function fn(t,n){var e,i,r=n-t;return r?(e=t,i=r,function(t){return e+t*i}):hn(isNaN(t)?n:t)}Pt(Ot,Kt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Wt,formatHex:Wt,formatHsl:function(){return sn(this).formatHsl()},formatRgb:Zt,toString:Zt}),Pt(nn,tn,Bt(Ot,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new nn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new nn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:en,formatHex:en,formatRgb:rn,toString:rn})),Pt(un,function(t,n,e,i){return 1===arguments.length?sn(t):new un(t,n,e,null==i?1:i)},Bt(Ot,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new un(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new un(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*n,e=2*e-n;return new nn(ln(240<=t?t-240:120+t,e,n),ln(t,e,n),ln(t<120?240+t:t-120,e,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var dn=function t(n){var a=cn(n);function e(n,t){var e=a((n=tn(n)).r,(t=tn(t)).r),i=a(n.g,t.g),r=a(n.b,t.b),o=fn(n.opacity,t.opacity);return function(t){return n.r=e(t),n.g=i(t),n.b=r(t),n.opacity=o(t),n+""}}return e.gamma=t,e}(1);function pn(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}var gn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_n=new RegExp(gn.source,"g");function mn(t,i){var n,e,r,o,a,s=gn.lastIndex=_n.lastIndex=0,u=-1,l=[],h=[];for(t+="",i+="";(n=gn.exec(t))&&(e=_n.exec(i));)(r=e.index)>s&&(r=i.slice(s,r),l[u]?l[u]+=r:l[++u]=r),(n=n[0])===(e=e[0])?l[u]?l[u]+=e:l[++u]=e:(l[++u]=null,h.push({i:u,x:pn(n,e)})),s=_n.lastIndex;return s<i.length&&(r=i.slice(s),l[u]?l[u]+=r:l[++u]=r),l.length<2?h[0]?(a=h[0].x,function(t){return a(t)+""}):(o=i,function(){return o}):(i=h.length,function(t){for(var n,e=0;e<i;++e)l[(n=h[e]).i]=n.x(t);return l.join("")})}function yn(t,n){var e,i=typeof n;return null==n||"boolean"==i?hn(n):("number"==i?pn:"string"==i?(e=Kt(n))?(n=e,dn):mn:n instanceof Kt?dn:n instanceof Date?function(n,e){var i=new Date;return n=+n,e=+e,function(t){return i.setTime(n*(1-t)+e*t),i}}:(e=n,!ArrayBuffer.isView(e)||e instanceof DataView?Array.isArray(n)?function(t,n){for(var e=n?n.length:0,i=t?Math.min(e,t.length):0,r=new Array(i),o=new Array(e),a=0;a<i;++a)r[a]=yn(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(t){for(a=0;a<i;++a)o[a]=r[a](t);return o}}:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?function(t,n){var e,i={},r={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?i[e]=yn(t[e],n[e]):r[e]=n[e];return function(t){for(e in i)r[e]=i[e](t);return r}}:pn:function(n,e){e=e||[];var i,r=n?Math.min(e.length,n.length):0,o=e.slice();return function(t){for(i=0;i<r;++i)o[i]=n[i]*(1-t)+e[i]*t;return o}}))(t,n)}function vn(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var xn,wn,bn,Mn,kn=180/Math.PI,An={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,n,e,i,r,o){var a,s,u;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(u=t*e+n*i)&&(e-=t*u,i-=n*u),(s=Math.sqrt(e*e+i*i))&&(e/=s,i/=s,u/=s),t*i<n*e&&(t=-t,n=-n,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*kn,skewX:Math.atan(u)*kn,scaleX:a,scaleY:s}}function Tn(c,f,d,p){function g(t){return t.length?t.pop()+" ":""}return function(t,n){var e,i,r,o,a,s,u,l=[],h=[];return t=c(t),n=c(n),r=t.translateX,o=t.translateY,u=n.translateX,s=n.translateY,a=l,e=h,r!==u||o!==s?(i=a.push("translate(",null,f,null,d),e.push({i:i-4,x:pn(r,u)},{i:i-2,x:pn(o,s)})):(u||s)&&a.push("translate("+u+f+s+d),e=t.rotate,r=n.rotate,i=l,o=h,e!==r?(180<e-r?r+=360:180<r-e&&(e+=360),o.push({i:i.push(g(i)+"rotate(",null,p)-2,x:pn(e,r)})):r&&i.push(g(i)+"rotate("+r+p),a=t.skewX,u=n.skewX,s=l,o=h,a!==u?o.push({i:s.push(g(s)+"skewX(",null,p)-2,x:pn(a,u)}):u&&s.push(g(s)+"skewX("+u+p),e=t.scaleX,i=t.scaleY,r=n.scaleX,o=n.scaleY,a=l,s=h,e!==r||i!==o?(u=a.push(g(a)+"scale(",null,",",null,")"),s.push({i:u-4,x:pn(e,r)},{i:u-2,x:pn(i,o)})):1===r&&1===o||a.push(g(a)+"scale("+r+","+o+")"),t=n=null,function(t){for(var n,e=-1,i=h.length;++e<i;)l[(n=h[e]).i]=n.x(t);return l.join("")}}}var Nn=Tn(function(t){return"none"===t?An:(xn||(xn=document.createElement("DIV"),wn=document.documentElement,bn=document.defaultView),xn.style.transform=t,t=bn.getComputedStyle(wn.appendChild(xn),null).getPropertyValue("transform"),wn.removeChild(xn),Sn(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),Cn=Tn(function(t){return null==t?An:((Mn=Mn||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),(t=Mn.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):An)},", ",")",")");function En(t,n,e){var i=t._id;return t.each(function(){var t=Dt(this,i);(t.value||(t.value={}))[n]=e.apply(this,arguments)}),function(t){return Ft(t,i).value[n]}}function Hn(t,n){var e;return("number"==typeof n?pn:n instanceof Kt?dn:(e=Kt(n))?(n=e,dn):mn)(t,n)}function Ln(i,r){var o,a;function t(){var n,e,t=r.apply(this,arguments);return t!==a&&(o=(a=t)&&(n=i,e=t,function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))})),o}return t._value=r,t}function Dn(i,r){var o,a;function t(){var n,e,t=r.apply(this,arguments);return t!==a&&(o=(a=t)&&(n=i,e=t,function(t){this.setAttribute(n,e.call(this,t))})),o}return t._value=r,t}var Fn=Y.prototype.constructor;function Pn(t){return function(){this.style.removeProperty(t)}}function Bn(r,o,a){var s,u;function t(){var n,e,i,t=o.apply(this,arguments);return t!==u&&(s=(u=t)&&(n=r,e=t,i=a,function(t){this.style.setProperty(n,e.call(this,t),i)})),s}return t._value=o,t}function On(e){var i,r;function t(){var n,t=e.apply(this,arguments);return t!==r&&(i=(r=t)&&(n=t,function(t){this.textContent=n.call(this,t)})),i}return t._value=e,t}var zn=0;function In(t,n,e,i){this._groups=t,this._parents=n,this._name=e,this._id=i}In.prototype={constructor:In,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=d(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,u,l=i[a],h=l.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=l[f])&&(u=t.call(s,s.__data__,f,l))&&("__data__"in s&&(u.__data__=s.__data__),c[f]=u,Ht(c[f],n,e,f,c,Ft(s,e)));return new In(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=m(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var u,l=i[s],h=l.length,c=0;c<h;++c)if(u=l[c]){for(var f,d=t.call(u,u.__data__,c,l),p=Ft(u,e),g=0,_=d.length;g<_;++g)(f=d[g])&&Ht(f,n,e,g,d,p);o.push(d),a.push(u)}return new In(o,a,n,e)},filter:function(t){"function"!=typeof t&&(t=f(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o,a=n[r],s=a.length,u=i[r]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new In(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,i=n.length,t=e.length,r=Math.min(i,t),o=new Array(i),a=0;a<r;++a)for(var s,u=n[a],l=e[a],h=u.length,c=o[a]=new Array(h),f=0;f<h;++f)(s=u[f]||l[f])&&(c[f]=s);for(;a<i;++a)o[a]=n[a];return new In(o,this._parents,this._name,this._id)},selection:function(){return new Fn(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=++zn,i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,l=0;l<u;++l)(a=s[l])&&Ht(a,t,e,l,s,{time:(a=Ft(a,n)).time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease});return new In(i,this._parents,t,e)},call:(jt=Y.prototype).call,nodes:jt.nodes,node:jt.node,size:jt.size,empty:jt.empty,each:jt.each,on:function(t,n){var e,i,r,o,a,s,u=this._id;return arguments.length<2?Ft(this.node(),u).on.on(t):this.each((e=u,r=n,s=((i=t)+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return 0<=n&&(t=t.slice(0,n)),!t||"start"===t})?Lt:Dt,function(){var t=s(this,e),n=t.on;n!==o&&(a=(o=n).copy()).on(i,r),t.on=a}))},attr:function(t,n){var e=a(t),i="transform"===e?Cn:Hn;return this.attrTween(t,"function"==typeof n?(e.local?function(i,r,o){var a,s,u;return function(){var t,n,e=o(this);if(null!=e)return(t=this.getAttributeNS(i.space,i.local))===(n=e+"")?null:t===a&&n===s?u:(s=n,u=r(a=t,e));this.removeAttributeNS(i.space,i.local)}}:function(i,r,o){var a,s,u;return function(){var t,n,e=o(this);if(null!=e)return(t=this.getAttribute(i))===(n=e+"")?null:t===a&&n===s?u:(s=n,u=r(a=t,e));this.removeAttribute(i)}})(e,i,En(this,"attr."+t,n)):null==n?(e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(e):(e.local?function(n,e,i){var r,o,a=i+"";return function(){var t=this.getAttributeNS(n.space,n.local);return t===a?null:t===r?o:o=e(r=t,i)}}:function(n,e,i){var r,o,a=i+"";return function(){var t=this.getAttribute(n);return t===a?null:t===r?o:o=e(r=t,i)}})(e,i,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;return t=a(t),this.tween(e,(t.local?Ln:Dn)(t,n))},style:function(t,n,e){var i,r,o,a,s,u,l,h,c,f,d,p,g,_,m,y,v,x,w,b,M,k,A,S,T,N="transform"==(t+="")?Nn:Hn;return null==n?this.styleTween(t,(M=t,k=N,function(){var t=C(this,M),n=(this.style.removeProperty(M),C(this,M));return t===n?null:t===A&&n===S?T:T=k(A=t,S=n)})).on("end.style."+t,Pn(t)):"function"==typeof n?this.styleTween(t,(y=N,v=En(this,"style."+(m=t),n),function(){var t=C(this,m),n=v(this),e=n+"";return null==n&&(this.style.removeProperty(m),e=n=C(this,m)),t===e?null:t===x&&e===w?b:(w=e,b=y(x=t,n))})).each((l=this._id,_="end."+(g="style."+(h=t)),function(){var t=Dt(this,l),n=t.on,e=null==t.value[g]?p=p||Pn(h):void 0;n===c&&d===e||(f=(c=n).copy()).on(_,d=e),t.on=f})):this.styleTween(t,(i=t,r=N,u=(o=n)+"",function(){var t=C(this,i);return t===u?null:t===a?s:s=r(a=t,o)}),e).on("end.style."+t,null)},styleTween:function(t,n,e){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==n)return this.tween(i,null);if("function"!=typeof n)throw new Error;return this.tween(i,Bn(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?(e=En(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}));var n,e},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,On(t))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t,n=this.parentNode;for(t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}));var e},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var i,r=Ft(this.node(),e).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==n?function(r,o){var a,s;return function(){var t=Dt(this,r),n=t.tween;if(n!==a)for(var e=0,i=(s=a=n).length;e<i;++e)if(s[e].name===o){(s=s.slice()).splice(e,1);break}t.tween=s}}:function(o,a,s){var u,l;if("function"!=typeof s)throw new Error;return function(){var t=Dt(this,o),n=t.tween;if(n!==u){l=(u=n).slice();for(var e={name:a,value:s},i=0,r=l.length;i<r;++i)if(l[i].name===a){l[i]=e;break}i===r&&l.push(e)}t.tween=l}})(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){Lt(this,t).delay=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){Lt(this,t).delay=n}})(n,t)):Ft(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){Dt(this,t).duration=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){Dt(this,t).duration=n}})(n,t)):Ft(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){Dt(this,t).ease=n}}(n,t)):Ft(this.node(),n).ease},end:function(){var r,o,a=this,s=a._id,u=a.size();return new Promise(function(t,n){var e={value:n},i={value:function(){0==--u&&t()}};a.each(function(){var t=Dt(this,s),n=t.on;n!==r&&((o=(r=n).copy())._.cancel.push(e),o._.interrupt.push(e),o._.end.push(i)),t.on=o})})}};var jn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Rn(t,n){return t<n?-1:n<t?1:n<=t?0:NaN}function qn(o){var e;return 1===o.length&&(e=o,o=function(t,n){return Rn(e(t),n)}),{left:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;o(t[r],n)<0?e=1+r:i=r}return e},right:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;0<o(t[r],n)?i=r:e=1+r}return e}}}Y.prototype.interrupt=function(t){return this.each(function(){!function(t,n){var e,i,r,o=t.__transition,a=!0;if(o){for(r in n=null==n?null:n+"",o)(e=o[r]).name===n?(i=e.state>St&&e.state<Ct,e.state=Et,e.timer.stop(),e.on.call(i?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[r]):a=!1;a&&delete t.__transition}}(this,t)})},Y.prototype.transition=function(t){var n,e;t=t instanceof In?(n=t._id,t._name):(n=++zn,(e=jn).time=pt(),null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],u=s.length,l=0;l<u;++l)(a=s[l])&&Ht(a,t,n,l,s,e||function(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return jn.time=pt(),jn;return e}(a,n));return new In(i,this._parents,t,n)},Y.prototype.attrs=function(t){return("function"==typeof t?function(t,i){return t.each(function(){var t,n=i.apply(this,arguments),e=$(this);for(t in n)e.attr(t,n[t])})}:function(t,n){for(var e in n)t.attr(e,n[e]);return t})(this,t)},Y.prototype.styles=function(t,n){return("function"==typeof t?function(t,i,r){return t.each(function(){var t,n=i.apply(this,arguments),e=$(this);for(t in n)e.style(t,n[t],r)})}:function(t,n,e){for(var i in n)t.style(i,n[i],e);return t})(this,t,null==n?"":n)},Y.prototype.properties=function(t){return("function"==typeof t?function(t,i){return t.each(function(){var t,n=i.apply(this,arguments),e=$(this);for(t in n)e.property(t,n[t])})}:function(t,n){for(var e in n)t.property(e,n[e]);return t})(this,t)};var Xn=qn(Rn).right,Gn=Math.sqrt(50),Vn=Math.sqrt(10),Yn=Math.sqrt(2);function $n(t,n,e){t=(n-t)/Math.max(0,e),e=Math.floor(Math.log(t)/Math.LN10),t/=Math.pow(10,e);return 0<=e?(Gn<=t?10:Vn<=t?5:Yn<=t?2:1)*Math.pow(10,e):-Math.pow(10,-e)/(Gn<=t?10:Vn<=t?5:Yn<=t?2:1)}function Un(t,n){var e,i,r=t.length,o=-1;if(null==n){for(;++o<r;)if(null!=(e=t[o])&&e<=e)for(i=e;++o<r;)null!=(e=t[o])&&i<e&&(i=e)}else for(;++o<r;)if(null!=(e=n(t[o],o,t))&&e<=e)for(i=e;++o<r;)null!=(e=n(t[o],o,t))&&i<e&&(i=e);return i}function Wn(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}var Zn="$";function Kn(){}function Qn(t,n){var e=new Kn;if(t instanceof Kn)t.each(function(t,n){e.set(n,t)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(null==n)for(;++r<o;)e.set(r,t[r]);else for(;++r<o;)e.set(n(i=t[r],r,t),i)}else if(t)for(var a in t)e.set(a,t[a]);return e}Kn.prototype=Qn.prototype={constructor:Kn,has:function(t){return Zn+t in this},get:function(t){return this[Zn+t]},set:function(t,n){return this[Zn+t]=n,this},remove:function(t){t=Zn+t;return t in this&&delete this[t]},clear:function(){for(var t in this)t[0]===Zn&&delete this[t]},keys:function(){var t,n=[];for(t in this)t[0]===Zn&&n.push(t.slice(1));return n},values:function(){var t,n=[];for(t in this)t[0]===Zn&&n.push(this[t]);return n},entries:function(){var t,n=[];for(t in this)t[0]===Zn&&n.push({key:t.slice(1),value:this[t]});return n},size:function(){var t,n=0;for(t in this)t[0]===Zn&&++n;return n},empty:function(){for(var t in this)if(t[0]===Zn)return!1;return!0},each:function(t){for(var n in this)n[0]===Zn&&t(this[n],n.slice(1),this)}},It=Qn.prototype;var Jn=(jt=Array.prototype).map,te=jt.slice,ne={name:"implicit"};function ee(t){return+t}var ie=[0,1];function re(t){return t}function oe(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:(t=isNaN(e)?NaN:.5,function(){return t});var t}function ae(t){var n=t[0],e=t[t.length-1];return e<n&&(t=n,n=e,e=t),function(t){return Math.max(n,Math.min(e,t))}}function se(t,n,e){var i=t[0],t=t[1],r=n[0],n=n[1],r=t<i?(i=oe(t,i),e(n,r)):(i=oe(i,t),e(r,n));return function(t){return r(i(t))}}function ue(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=oe(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=Xn(e,t,1,i)-1;return o[n](r[n](t))}}function le(t,n){return c=h=ie,f=yn,d=re,i.invert=function(t){return d(o((l=l||s(c,h.map(r),pn))(t)))},i.domain=function(t){return arguments.length?(h=Jn.call(t,ee),d===re||(d=ae(h)),e()):h.slice()},i.range=function(t){return arguments.length?(c=te.call(t),e()):c.slice()},i.rangeRound=function(t){return c=te.call(t),f=vn,e()},i.clamp=function(t){return arguments.length?(d=t?ae(h):re,i):d!==re},i.interpolate=function(t){return arguments.length?(f=t,e()):f},i.unknown=function(t){return arguments.length?(a=t,i):a},function(t,n){return r=t,o=n,e()}(t,n);function e(){return s=2<Math.min(h.length,c.length)?ue:se,u=l=null,i}function i(t){return isNaN(t=+t)?a:(u=u||s(h.map(r),c,f))(r(d(t)))}var r,o,a,s,u,l,h,c,f,d}function he(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,n=t.slice(0,e);return[1<n.length?n[0]+n.slice(2):n,+t.slice(e+1)]}function ce(t){return(t=he(Math.abs(t)))?t[1]:NaN}var fe,de=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pe(t){if(!(n=de.exec(t)))throw new Error("invalid format: "+t);var n;return new ge({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function ge(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function _e(t,n){n=he(t,n);if(!n)return t+"";t=n[0],n=n[1];return n<0?"0."+new Array(-n).join("0")+t:t.length>n+1?t.slice(0,n+1)+"."+t.slice(n+1):t+new Array(n-t.length+2).join("0")}pe.prototype=ge.prototype,ge.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var me={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return _e(100*t,n)},r:_e,s:function(t,n){if(!(i=he(t,n)))return t+"";var e=i[0],i=(r=i[1])-(fe=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,r=e.length;return i===r?e:r<i?e+new Array(i-r+1).join("0"):0<i?e.slice(0,i)+"."+e.slice(i):"0."+new Array(1-i).join("0")+he(t,Math.max(0,n+i-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ye(t){return t}var ve,xe,we=Array.prototype.map,be=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function Me(t){var n,s,u,b=void 0===t.grouping||void 0===t.thousands?ye:(s=we.call(t.grouping,Number),u=t.thousands+"",function(t,n){for(var e=t.length,i=[],r=0,o=s[0],a=0;0<e&&0<o&&(n<a+o+1&&(o=Math.max(1,n-a)),i.push(t.substring(e-=o,e+o)),!((a+=o+1)>n));)o=s[r=(r+1)%s.length];return i.reverse().join(u)}),i=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",M=void 0===t.decimal?".":t.decimal+"",k=void 0===t.numerals?ye:(n=we.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return n[+t]})}),o=void 0===t.percent?"%":t.percent+"",A=void 0===t.minus?"-":t.minus+"",S=void 0===t.nan?"NaN":t.nan+"";function a(t){var l=(t=pe(t)).fill,h=t.align,c=t.sign,n=t.symbol,f=t.zero,d=t.width,p=t.comma,g=t.precision,_=t.trim,m=t.type;"n"===m?(p=!0,m="g"):me[m]||(void 0===g&&(g=12),_=!0,m="g"),(f||"0"===l&&"="===h)&&(f=!0,l="0",h="=");var y="$"===n?i:"#"===n&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===n?r:/[%p]/.test(m)?o:"",x=me[m],w=/[defgprs%]/.test(m);function e(t){var n,e,i,r=y,o=v;if("c"===m)o=x(t)+o,t="";else{var a=(t=+t)<0||1/t<0;if(t=isNaN(t)?S:x(Math.abs(t),g),_&&(t=function(t){t:for(var n,e=t.length,i=1,r=-1;i<e;++i)switch(t[i]){case".":r=n=i;break;case"0":0===r&&(r=i),n=i;break;default:if(!+t[i])break t;0<r&&(r=0)}return 0<r?t.slice(0,r)+t.slice(n+1):t}(t)),a&&0==+t&&"+"!==c&&(a=!1),r=(a?"("===c?c:A:"-"===c||"("===c?"":c)+r,o=("s"===m?be[8+fe/3]:"")+o+(a&&"("===c?")":""),w)for(n=-1,e=t.length;++n<e;)if((i=t.charCodeAt(n))<48||57<i){o=(46===i?M+t.slice(n+1):t.slice(n))+o,t=t.slice(0,n);break}}p&&!f&&(t=b(t,1/0));var s=r.length+t.length+o.length,u=s<d?new Array(d-s+1).join(l):"";switch(p&&f&&(t=b(u+t,u.length?d-o.length:1/0),u=""),h){case"<":t=r+t+o+u;break;case"=":t=r+u+t+o;break;case"^":t=u.slice(0,s=u.length>>1)+r+t+o+u.slice(s);break;default:t=u+r+t+o}return k(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),e.toString=function(){return t+""},e}return{format:a,formatPrefix:function(t,n){var e=a(((t=pe(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(ce(n)/3))),i=Math.pow(10,-n),r=be[8+n/3];return function(t){return e(i*t)+r}}}}function ke(t,n,e,i){var r,o,a,s,u,l,h=(r=t,o=n,a=e,e=Math.abs(o-r)/Math.max(0,a),a=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),Gn<=(e=e/a)?a*=10:Vn<=e?a*=5:Yn<=e&&(a*=2),o<r?-a:a);switch((i=pe(null==i?",f":i)).type){case"s":var c=Math.max(Math.abs(t),Math.abs(n));return null!=i.precision||isNaN((u=h,l=c,u=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ce(l)/3)))-ce(Math.abs(u)))))||(i.precision=u),xe(i,c);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN((s=h,c=Math.max(Math.abs(t),Math.abs(n)),s=Math.abs(s),c=Math.abs(c)-s,u=Math.max(0,ce(c)-ce(s))+1))||(i.precision=u-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN((s=h,u=Math.max(0,-ce(Math.abs(s)))))||(i.precision=u-2*("%"===i.type))}return ve(i)}function Ae(s){var u=s.domain;return s.ticks=function(t){var n=u();return function(t,n,e){var i,r,o,a,s=-1;if(e=+e,(t=+t)===(n=+n)&&0<e)return[t];if((i=n<t)&&(r=t,t=n,n=r),0===(a=$n(t,n,e))||!isFinite(a))return[];if(0<a)for(t=Math.ceil(t/a),n=Math.floor(n/a),o=new Array(r=Math.ceil(n-t+1));++s<r;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),n=Math.ceil(n*a),o=new Array(r=Math.ceil(t-n+1));++s<r;)o[s]=(t-s)/a;return i&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},s.tickFormat=function(t,n){var e=u();return ke(e[0],e[e.length-1],null==t?10:t,n)},s.nice=function(t){null==t&&(t=10);var n,e=u(),i=0,r=e.length-1,o=e[i],a=e[r];return a<o&&(n=o,o=a,a=n,n=i,i=r,r=n),0<(n=$n(o,a,t))?n=$n(o=Math.floor(o/n)*n,a=Math.ceil(a/n)*n,t):n<0&&(n=$n(o=Math.ceil(o*n)/n,a=Math.floor(a*n)/n,t)),0<n?(e[i]=Math.floor(o/n)*n,e[r]=Math.ceil(a/n)*n,u(e)):n<0&&(e[i]=Math.ceil(o*n)/n,e[r]=Math.floor(a*n)/n,u(e)),s},s}function Se(){var n=le(re,re);return n.copy=function(){return t=n,Se().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},Wn.apply(n,arguments),Ae(n)}function Te(){O.stopImmediatePropagation()}function Ne(){O.preventDefault(),O.stopImmediatePropagation()}function Ce(t){return function(){return t}}function Ee(t,n,e,i,r,o,a,s,u,l){this.target=t,this.type=n,this.subject=e,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=l}function He(){return!O.ctrlKey&&!O.button}function Le(){return this.parentNode}function De(t){return null==t?{x:O.x,y:O.y}:t}function Fe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pe(){var i,r,o,a,s=He,u=Le,n=De,e=Fe,p={},g=tt("start","drag","end"),_=0,l=0;function m(t){t.on("mousedown.drag",h).filter(e).on("touchstart.drag",d).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(){var t,n,e;a||!s.apply(this,arguments)||(t=x("mouse",u.apply(this,arguments),Z,this,arguments))&&($(O.view).on("mousemove.drag",c,!0).on("mouseup.drag",f,!0),n=O.view,e=n.document.documentElement,n=$(n).on("dragstart.drag",Ne,!0),"onselectstart"in e?n.on("selectstart.drag",Ne,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none"),Te(),o=!1,i=O.clientX,r=O.clientY,t("start"))}function c(){var t,n;Ne(),o||(t=O.clientX-i,n=O.clientY-r,o=l<t*t+n*n),p.mouse("drag")}function f(){var t,n,e,i;$(O.view).on("mousemove.drag mouseup.drag",null),t=O.view,n=o,e=t.document.documentElement,i=$(t).on("dragstart.drag",null),n&&(i.on("click.drag",Ne,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect),Ne(),p.mouse("end")}function d(){if(s.apply(this,arguments))for(var t,n=O.changedTouches,e=u.apply(this,arguments),i=n.length,r=0;r<i;++r)(t=x(n[r].identifier,e,Q,this,arguments))&&(Te(),t("start"))}function y(){for(var t,n=O.changedTouches,e=n.length,i=0;i<e;++i)(t=p[n[i].identifier])&&(Ne(),t("drag"))}function v(){var t,n,e=O.changedTouches,i=e.length;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),t=0;t<i;++t)(n=p[e[t].identifier])&&(Te(),n("end"))}function x(r,o,a,s,u){var l,h,c,f=a(o,r),d=g.copy();if(q(new Ee(m,"beforestart",l,r,_,f[0],f[1],0,0,d),function(){return null!=(O.subject=l=n.apply(s,u))&&(h=l.x-f[0]||0,c=l.y-f[1]||0,!0)}))return function t(n){var e,i=f;switch(n){case"start":p[r]=t,e=_++;break;case"end":delete p[r],--_;case"drag":f=a(o,r),e=_}q(new Ee(m,n,l,r,e,f[0]+h,f[1]+c,f[0]-i[0],f[1]-i[1],d),d.apply,d,[n,s,u])}}return m.filter=function(t){return arguments.length?(s="function"==typeof t?t:Ce(!!t),m):s},m.container=function(t){return arguments.length?(u="function"==typeof t?t:Ce(t),m):u},m.subject=function(t){return arguments.length?(n="function"==typeof t?t:Ce(t),m):n},m.touchable=function(t){return arguments.length?(e="function"==typeof t?t:Ce(!!t),m):e},m.on=function(){var t=g.on.apply(g,arguments);return t===g?m:t},m.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,m):Math.sqrt(l)},m}zt=Me({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),ve=zt.format,xe=zt.formatPrefix,Ee.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Be=Array.prototype.slice;function Oe(t){return t}var ze=1,Ie=2,je=3,Re=4,qe=1e-6;function Xe(t){return"translate("+(t+.5)+",0)"}function Ge(t){return"translate(0,"+(t+.5)+")"}function Ve(){return!this.__axis}function Ye(d,p){var g=[],_=null,m=null,y=6,v=6,x=3,w=d===ze||d===Re?-1:1,b=d===Re||d===Ie?"x":"y",M=d===ze||d===je?Xe:Ge;function n(t){var n=null==_?p.ticks?p.ticks.apply(p,g):p.domain():_,e=null==m?p.tickFormat?p.tickFormat.apply(p,g):Oe:m,i=Math.max(y,0)+x,r=p.range(),o=+r[0]+.5,a=+r[r.length-1]+.5,s=(p.bandwidth?function(n){var e=Math.max(0,n.bandwidth()-1)/2;return n.round()&&(e=Math.round(e)),function(t){return+n(t)+e}}:function(n){return function(t){return+n(t)}})(p.copy()),u=t.selection?t.selection():t,l=u.selectAll(".domain").data([null]),h=(f=u.selectAll(".tick").data(n,p).order()).exit(),c=f.enter().append("g").attr("class","tick"),r=f.select("line"),n=f.select("text"),l=l.merge(l.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),f=f.merge(c),r=r.merge(c.append("line").attr("stroke","currentColor").attr(b+"2",w*y)),n=n.merge(c.append("text").attr("fill","currentColor").attr(b,w*i).attr("dy",d===ze?"0em":d===je?"0.71em":"0.32em"));t!==u&&(l=l.transition(t),f=f.transition(t),r=r.transition(t),n=n.transition(t),h=h.transition(t).attr("opacity",qe).attr("transform",function(t){return isFinite(t=s(t))?M(t):this.getAttribute("transform")}),c.attr("opacity",qe).attr("transform",function(t){var n=this.parentNode.__axis;return M(n&&isFinite(n=n(t))?n:s(t))})),h.remove(),l.attr("d",d===Re||d==Ie?v?"M"+w*v+","+o+"H0.5V"+a+"H"+w*v:"M0.5,"+o+"V"+a:v?"M"+o+","+w*v+"V0.5H"+a+"V"+w*v:"M"+o+",0.5H"+a),f.attr("opacity",1).attr("transform",function(t){return M(s(t))}),r.attr(b+"2",w*y),n.attr(b,w*i).text(e),u.filter(Ve).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",d===Ie?"start":d===Re?"end":"middle"),u.each(function(){this.__axis=s})}return n.scale=function(t){return arguments.length?(p=t,n):p},n.ticks=function(){return g=Be.call(arguments),n},n.tickArguments=function(t){return arguments.length?(g=null==t?[]:Be.call(t),n):g.slice()},n.tickValues=function(t){return arguments.length?(_=null==t?null:Be.call(t),n):_&&_.slice()},n.tickFormat=function(t){return arguments.length?(m=t,n):m},n.tickSize=function(t){return arguments.length?(y=v=+t,n):y},n.tickSizeInner=function(t){return arguments.length?(y=+t,n):y},n.tickSizeOuter=function(t){return arguments.length?(v=+t,n):v},n.tickPadding=function(t){return arguments.length?(x=+t,n):x},n}function $e(t){return Ye(je,t)}function Ue(t){return Ye(Re,t)}var We=Math.PI,Ze=2*We,Ke=1e-6,Qe=Ze-Ke;function Je(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ti(){return new Je}function ni(t){return function(){return t}}Je.prototype=ti.prototype={constructor:Je,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,i){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+i)},bezierCurveTo:function(t,n,e,i,r,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,n,e,i,r){t=+t,n=+n,e=+e,i=+i,r=+r;var o,a,s=this._x1,u=this._y1,l=e-t,h=i-n,c=s-t,f=u-n,d=c*c+f*f;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=n):Ke<d&&(Math.abs(f*l-h*c)>Ke&&r?(a=l*l+h*h,s=(o=e-s)*o+(e=i-u)*e,i=Math.sqrt(a),u=Math.sqrt(d),u=(s=r*Math.tan((We-Math.acos((a+d-s)/(2*i*u)))/2))/u,i=s/i,Math.abs(u-1)>Ke&&(this._+="L"+(t+u*c)+","+(n+u*f)),this._+="A"+r+","+r+",0,0,"+ +(c*e<f*o)+","+(this._x1=t+i*l)+","+(this._y1=n+i*h)):this._+="L"+(this._x1=t)+","+(this._y1=n))},arc:function(t,n,e,i,r,o){t=+t,n=+n,o=!!o;var a=(e=+e)*Math.cos(i),s=e*Math.sin(i),u=t+a,l=n+s,h=1^o,i=o?i-r:r-i;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Ke||Math.abs(this._y1-l)>Ke)&&(this._+="L"+u+","+l),e&&(i<0&&(i=i%Ze+Ze),Qe<i?this._+="A"+e+","+e+",0,1,"+h+","+(t-a)+","+(n-s)+"A"+e+","+e+",0,1,"+h+","+(this._x1=u)+","+(this._y1=l):Ke<i&&(this._+="A"+e+","+e+",0,"+ +(We<=i)+","+h+","+(this._x1=t+e*Math.cos(r))+","+(this._y1=n+e*Math.sin(r))))},rect:function(t,n,e,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +i+"h"+-e+"Z"},toString:function(){return this._}};var ei=Math.PI,ii=2*ei;function ri(t){this._context=t}function oi(t){return new ri(t)}function ai(t){return t[0]}function si(t){return t[1]}function ui(){var a=ai,s=si,u=ni(!0),l=null,h=oi,c=null;function n(t){var n,e,i,r=t.length,o=!1;for(null==l&&(c=h(i=ti())),n=0;n<=r;++n)!(n<r&&u(e=t[n],n,t))===o&&((o=!o)?c.lineStart():c.lineEnd()),o&&c.point(+a(e,n,t),+s(e,n,t));if(i)return c=null,i+""||null}return n.x=function(t){return arguments.length?(a="function"==typeof t?t:ni(+t),n):a},n.y=function(t){return arguments.length?(s="function"==typeof t?t:ni(+t),n):s},n.defined=function(t){return arguments.length?(u="function"==typeof t?t:ni(!!t),n):u},n.curve=function(t){return arguments.length?(h=t,null!=l&&(c=h(l)),n):h},n.context=function(t){return arguments.length?(null==t?l=c=null:c=h(l=t),n):l},n}ri.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var li={draw:function(t,n){n=Math.sqrt(n/ei);t.moveTo(n,0),t.arc(0,0,n,0,ii)}},hi=Math.sqrt(3),ci={draw:function(t,n){n=-Math.sqrt(n/(3*hi));t.moveTo(0,2*n),t.lineTo(-hi*n,-n),t.lineTo(hi*n,-n),t.closePath()}};function fi(){var n=ni(li),e=ni(64),i=null;function r(){var t;if(i=i||(t=ti()),n.apply(this,arguments).draw(i,+e.apply(this,arguments)),t)return i=null,t+""||null}return r.type=function(t){return arguments.length?(n="function"==typeof t?t:ni(t),r):n},r.size=function(t){return arguments.length?(e="function"==typeof t?t:ni(+t),r):e},r.context=function(t){return arguments.length?(i=null==t?null:t,r):i},r}function di(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function pi(t){this._context=t}function gi(t){return new pi(t)}function _i(t){for(var n=t.length/6|0,e=new Array(n),i=0;i<n;)e[i]="#"+t.slice(6*i,6*++i);return e}pi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:di(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:di(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}};var mi=_i("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),yi=_i("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),vi=_i("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),xi=_i("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),wi=_i("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),bi=_i("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");It=function(x){return x.Control.Heightgraph=x.Control.extend({options:{position:"bottomright",width:800,height:280,margins:{top:10,right:30,bottom:55,left:50},mappings:void 0,expand:!0,expandControls:!0,translation:{},expandCallback:void 0,chooseSelectionCallback:void 0,selectedAttributeIdx:0,xTicks:void 0,yTicks:void 0,highlightStyle:void 0,graphStyle:void 0},_defaultTranslation:{distance:"Distance",elevation:"Elevation",segment_length:"Segment length",type:"Type",legend:"Legend"},_init_options:function(){this._margin=this.options.margins,this._width=this.options.width,this._height=this.options.height,this._mappings=this.options.mappings,this._svgWidth=this._width-this._margin.left-this._margin.right,this._svgHeight=this._height-this._margin.top-this._margin.bottom,this._highlightStyle=this.options.highlightStyle||{color:"red"},this._graphStyle=this.options.graphStyle||{},this._dragCache={}},onAdd:function(){var t,n=this._container=x.DomUtil.create("div","heightgraph");return x.DomEvent.disableClickPropagation(n),this.options.expandControls&&(t=this._button=x.DomUtil.create("div","heightgraph-toggle",n),x.DomUtil.create("a","heightgraph-toggle-icon",t),this._closeButton=x.DomUtil.create("a","heightgraph-close-icon",n)),this._showState=!1,this._initToggle(),this._init_options(),this._svg=$(this._container).append("svg").attr("class","heightgraph-container").attr("width",this._width).attr("height",this._height).append("g").attr("transform","translate("+this._margin.left+","+this._margin.top+")"),this.options.expand&&this._expand(),n},onRemove:function(){this._removeMarkedSegmentsOnMap(),this._container=null,this._svg=void 0},addData:function(t){this._addData(t)},_addData:function(t){void 0!==this._svg&&this._svg.selectAll("*").remove(),(!t||this.options.selectedAttributeIdx>=t.length)&&(this.options.selectedAttributeIdx=0),this._removeMarkedSegmentsOnMap(),this._resetDrag(!0),this._data=t,this._init_options(),this._prepareData(),this._calculateElevationBounds(),this._appendScales(),this._appendGrid(),0!==Object.keys(t).length&&this._createChart(this.options.selectedAttributeIdx),this._createSelectionBox()},resize:function(t){t.width&&(this.options.width=t.width),t.height&&(this.options.height=t.height),$(this._container).selectAll("svg").attr("width",this.options.width).attr("height",this.options.height),this._addData(this._data)},_initToggle:function(){x.Browser.touch?x.DomEvent.on(this._container,"click",x.DomEvent.stopPropagation):x.DomEvent.disableClickPropagation(this._container),this.options.expandControls&&(x.DomEvent.on(this._button,"click",this._expand,this),x.DomEvent.on(this._closeButton,"click",this._expand,this))},_dragHandler:function(){"undefined"!=typeof event&&(event.preventDefault(),event.stopPropagation()),this._gotDragged=!0,this._drawDragRectangle()},_drawDragRectangle:function(){var t,n,e;this._dragStartCoords&&(e=this._dragCurrentCoords=this._dragCache.end=Z(this._background.node()),t=Math.min(this._dragStartCoords[0],e[0]),n=Math.max(this._dragStartCoords[0],e[0]),this._dragRectangle||this._dragRectangleG?this._dragRectangle.attr("width",n-t).attr("x",t):(e=$(this._container).select("svg").select("g"),this._dragRectangleG=e.append("g"),this._dragRectangle=this._dragRectangleG.append("rect").attr("width",n-t).attr("height",this._svgHeight).attr("x",t).attr("class","mouse-drag").style("fill","grey").style("opacity",.5).style("pointer-events","none")))},_resetDrag:function(t){this._dragRectangleG&&(this._dragRectangleG.remove(),this._dragRectangleG=null,!(this._dragRectangle=null)===t||(t=this._calculateFullExtent(this._areasFlattended))&&this._map.fitBounds(t))},_dragEndHandler:function(){if(!this._dragStartCoords||!this._gotDragged)return this._dragStartCoords=null,this._gotDragged=!1,void this._resetDrag();var t=this._findItemForX(this._dragStartCoords[0]),n=this._findItemForX(this._dragCurrentCoords[0]);this._fitSection(t,n),this._dragStartCoords=null,this._gotDragged=!1},_dragStartHandler:function(){event.preventDefault(),event.stopPropagation(),this._gotDragged=!1,this._dragStartCoords=this._dragCache.start=Z(this._background.node())},_calculateFullExtent:function(t){if(!t||t.length<1)return null;var n=new x.latLngBounds(t[0].latlng,t[0].latlng);return t.forEach(function(t){n.contains(t.latlng)||n.extend(t.latlng)}),n},_fitSection:function(t,n){var e,i=Math.min(t,n),n=Math.max(t,n);i!==n?e=this._calculateFullExtent(this._areasFlattended.slice(i,n+1)):0<this._areasFlattended.length&&(e=[this._areasFlattended[i].latlng,this._areasFlattended[n].latlng]),e&&this._map.fitBounds(e)},_expand:function(){!0!==this.options.expandControls&&(this._showState=!1),this._showState?($(this._button).style("display","block"),$(this._container).selectAll("svg").style("display","none"),$(this._closeButton).style("display","none")):($(this._button).style("display","none"),$(this._container).selectAll("svg").style("display","block"),$(this._closeButton).style("display","block")),this._showState=!this._showState,"function"==typeof this.options.expandCallback&&this.options.expandCallback(this._showState)},_removeChart:function(){void 0!==this._svg&&(this._svg.selectAll("path.area").remove(),this._svg.selectAll("path.border-top").remove(),this._svg.selectAll(".legend").remove(),this._svg.selectAll(".lineSelection").remove(),this._svg.selectAll(".horizontalLine").remove(),this._svg.selectAll(".horizontalLineText").remove())},_randomNumber:function(t){return Math.round(Math.random()*+t)},_d3ColorCategorical:[yi,vi,wi,mi,bi,xi],_prepareData:function(){this._coordinates=[],this._elevations=[],this._cumulatedDistances=[],this._cumulatedDistances.push(0),this._categories=[];var t,n,e=this._data;void 0===this._mappings&&(t=this._randomNumber(this._d3ColorCategorical.length-1),n=function t(){var o=Qn(),a=[],i=[],r=ne;function s(t){var n=t+"",e=o.get(n);if(!e){if(r!==ne)return r;o.set(n,e=a.push(t))}return i[(e-1)%i.length]}return s.domain=function(t){if(!arguments.length)return a.slice();a=[],o=Qn();for(var n,e,i=-1,r=t.length;++i<r;)o.has(e=(n=t[i])+"")||o.set(e,a.push(n));return s},s.range=function(t){return arguments.length?(i=te.call(t),s):i.slice()},s.unknown=function(t){return arguments.length?(r=t,s):r},s.copy=function(){return t(a,i).unknown(r)},Wn.apply(s,arguments),s}(this._d3ColorCategorical[t]));for(var i=0;i<e.length;i++){var r=0;this._categories[i]={info:{id:i,text:e[i].properties.label||e[i].properties.summary},distances:[],attributes:[],geometries:[],legend:{}};for(var o=void 0,a=0,s={},u=void 0!==this._mappings&&"function"==typeof this._mappings[e[i].properties.summary],o=0;o<e[i].features.length;o++){var l,h,c=void 0,f=void 0,d=[],p=e[i].features[o].geometry.coordinates.length,g=e[i].features[o].properties.attributeType,_=void 0,m=void 0;void 0===this._mappings?g in s?m=s[_=g]:(_=g,m=n(o),s[g]=m):m=u?(_=(h=this._mappings[e[i].properties.summary](g)).text,h.color):(_=this._mappings[e[i].properties.summary][g].text,this._mappings[e[i].properties.summary][g].color);m={type:g,text:_,color:m};this._categories[i].attributes.push(m),g in this._categories[i].legend||(this._categories[i].legend[g]=m);for(var y=0;y<p;y++){c=new x.LatLng(e[i].features[o].geometry.coordinates[y][1],e[i].features[o].geometry.coordinates[y][0]),l=e[i].features[o].geometry.coordinates[y][2],y<p-1?(f=new x.LatLng(e[i].features[o].geometry.coordinates[y+1][1],e[i].features[o].geometry.coordinates[y+1][0]),r+=c.distanceTo(f)/1e3,0===i&&(this._elevations.push(l),this._coordinates.push(c),this._cumulatedDistances.push(r)),a+=1):y===p-1&&o===e[i].features.length-1&&(0===i&&(this._elevations.push(l),this._coordinates.push(f)),a+=1);var v=void 0,v=y===p-1&&o<e[i].features.length-1?this._cumulatedDistances[a]:this._cumulatedDistances[a-1];d.push({altitude:l,position:v,x:c.lng,y:c.lat,latlng:c,type:_,areaIdx:o})}this._categories[i].distances.push(r),this._categories[i].geometries.push(d)}i===e.length-1&&(this._totalDistance=r)}},_calculateElevationBounds:function(){var t=Un(this._elevations)||10,n=function(t,n){var e,i,r=t.length,o=-1;if(null==n){for(;++o<r;)if(null!=(e=t[o])&&e<=e)for(i=e;++o<r;)null!=(e=t[o])&&e<i&&(i=e)}else for(;++o<r;)if(null!=(e=n(t[o],o,t))&&e<=e)for(i=e;++o<r;)null!=(e=n(t[o],o,t))&&e<i&&(i=e);return i}(this._elevations)||0,e=t-n;this._elevationBounds={min:e<10?n-10:n-.1*e,max:e<10?t+10:t+.1*e}},_showMapMarker:function(t,n,e){var i=this._map.latLngToLayerPoint(t),r=i.y-75;this._mouseHeightFocus||(t=$(".leaflet-overlay-pane svg").append("g"),this._mouseHeightFocus=t.append("svg:line").attr("class","height-focus line").attr("x2","0").attr("y2","0").attr("x1","0").attr("y1","0"),this._mouseHeightFocusLabel=t.append("g").attr("class","height-focus label"),this._mouseHeightFocusLabelRect=this._mouseHeightFocusLabel.append("rect").attr("class","bBox"),this._mouseHeightFocusLabelTextElev=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),this._mouseHeightFocusLabelTextType=this._mouseHeightFocusLabel.append("text").attr("class","tspan"),(this._pointG=t.append("g").attr("class","height-focus circle")).append("svg:circle").attr("r",5).attr("cx",0).attr("cy",0).attr("class","height-focus circle-lower")),this._mouseHeightFocusLabel.style("display","block"),this._mouseHeightFocus.attr("x1",i.x).attr("x2",i.x).attr("y1",i.y).attr("y2",r).style("display","block"),this._pointG.attr("transform","translate("+i.x+","+i.y+")").style("display","block"),this._mouseHeightFocusLabelRect.attr("x",i.x+3).attr("y",r).attr("class","bBox"),this._mouseHeightFocusLabelTextElev.attr("x",i.x+5).attr("y",12+r).text(n+" m").attr("class","tspan mouse-height-box-text"),this._mouseHeightFocusLabelTextType.attr("x",i.x+5).attr("y",24+r).text(e).attr("class","tspan mouse-height-box-text");r=this._dynamicBoxSize("text.tspan")[1],e=""===e?18:30;K(".bBox").attr("width",r+10).attr("height",e)},_createChart:function(t){var n=0===this._categories.length?[]:this._categories[t].geometries;this._areasFlattended=[].concat.apply([],n);for(var e=0;e<n.length;e++)this._appendAreas(n[e],t,e);this._createFocus(),this._appendBackground(),this._createBorderTopLine(),this._createLegend(),this._createHorizontalLine()},_createFocus:function(){var t=this._elevationBounds.min;this._focus&&(this._focus.remove(),this._focusLineGroup.remove()),this._focus=this._svg.append("g").attr("class","focusbox"),this._focusRect=this._focus.append("rect").attr("x",3).attr("y",-this._y(t)).attr("display","none"),this._focusDistance=this._focus.append("text").attr("x",7).attr("y",15-this._y(t)).attr("id","heightgraph.distance").text(this._getTranslation("distance")+":"),this._focusHeight=this._focus.append("text").attr("x",7).attr("y",30-this._y(t)).attr("id","heightgraph.height").text(this._getTranslation("elevation")+":"),this._focusBlockDistance=this._focus.append("text").attr("x",7).attr("y",45-this._y(t)).attr("id","heightgraph.blockdistance").text(this._getTranslation("segment_length")+":"),this._focusType=this._focus.append("text").attr("x",7).attr("y",60-this._y(t)).attr("id","heightgraph.type").text(this._getTranslation("type")+":"),this._areaTspan=this._focusBlockDistance.append("tspan").attr("class","tspan"),this._typeTspan=this._focusType.append("tspan").attr("class","tspan");t=this._dynamicBoxSize(".focusbox text")[0];K(".focusbox rect").attr("height",15*t+7.5).attr("display","block"),this._focusLineGroup=this._svg.append("g").attr("class","focusLine"),this._focusLine=this._focusLineGroup.append("line").attr("y1",0).attr("y2",this._y(this._elevationBounds.min)),this._distTspan=this._focusDistance.append("tspan").attr("class","tspan"),this._altTspan=this._focusHeight.append("tspan").attr("class","tspan")},_createHorizontalLine:function(){var t=this;this._horizontalLine=this._svg.append("line").attr("class","horizontalLine").attr("x1",0).attr("x2",this._width-this._margin.left-this._margin.right).attr("y1",this._y(this._elevationBounds.min)).attr("y2",this._y(this._elevationBounds.min)).style("stroke","black"),this._elevationValueText=this._svg.append("text").attr("class","horizontalLineText").attr("x",this._width-this._margin.left-this._margin.right-20).attr("y",this._y(this._elevationBounds.min)-10).attr("fill","black");var n=[{x:this._width-this._margin.left-this._margin.right+7,y:this._y(this._elevationBounds.min),color:"black",type:ci,angle:-90,size:100}];this._svg.selectAll(".horizontal-symbol").data(n).enter().append("path").attr("class","lineSelection").attr("d",fi().type(function(t){return t.type}).size(function(t){return t.size})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).call(Pe().on("start",function(){$(this).raise().classed("active",!0),$(".horizontalLine").raise().classed("active",!0)}).on("drag",function(){var n=t._svgHeight,e=Z(t._container)[1]-10;$(this).attr("transform",function(t){return"translate("+t.x+","+(e<0?0:n<e?n:e)+") rotate("+t.angle+")"}),$(".horizontalLine").attr("y1",e<0?0:n<e?n:e).attr("y2",e<0?0:n<e?n:e),t._highlightedCoords=n<=e?[]:t._findCoordsForY(e),$(".horizontalLineText").attr("y",e<=10?0:n<e?n-10:e-10).text(ve(".0f")(t._y.invert(e<0?0:n<e?n:e))+" m"),t._removeMarkedSegmentsOnMap(),t._markSegmentsOnMap(t._highlightedCoords)}).on("end",function(){$(this).classed("active",!1),$(".horizontalLine").classed("active",!1),t._removeMarkedSegmentsOnMap(),t._markSegmentsOnMap(t._highlightedCoords)}))},_markSegmentsOnMap:function(t){if(t)if(1<t.length){this._markedSegments=x.featureGroup();var n=h(t);try{for(n.s();!(e=n.n()).done;){var e=e.value;x.polyline(e,i(i({},this._highlightStyle),{interactive:!1})).addTo(this._markedSegments)}}catch(t){n.e(t)}finally{n.f()}this._markedSegments.addTo(this._map).bringToFront()}else this._markedSegments=x.polyline(t,this._highlightStyle).addTo(this._map)},_removeMarkedSegmentsOnMap:function(){void 0!==this._markedSegments&&this._map.removeLayer(this._markedSegments)},_appendScales:function(){var t=Boolean(this._totalDistance<=10);this._x=Se().range([0,this._svgWidth]),this._y=Se().range([this._svgHeight,0]),this._x.domain([0,this._totalDistance]),this._y.domain([this._elevationBounds.min,this._elevationBounds.max]),this._xAxis=$e().scale(this._x),!0===t?this._xAxis.tickFormat(function(t){return ve(".2f")(t)+" km"}):this._xAxis.tickFormat(function(t){return ve(".0f")(t)+" km"}),this._xAxis.ticks(this.options.xTicks?Math.pow(2,this.options.xTicks):Math.round(this._svgWidth/75),"s"),this._yAxis=Ue().scale(this._y).tickFormat(function(t){return t+" m"}),this._yAxis.ticks(this.options.yTicks?Math.pow(2,this.options.yTicks):Math.round(this._svgHeight/30),"s")},_appendBackground:function(){var t=this._background=$(this._container).select("svg").select("g").append("rect").attr("width",this._svgWidth).attr("height",this._svgHeight).style("fill","none").style("stroke","none").style("pointer-events","all").on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this));x.Browser.android?(t.on("touchstart.drag",this._dragHandler.bind(this)).on("touchstart.drag",this._dragStartHandler.bind(this)).on("touchstart.focusbox",this._mousemoveHandler.bind(this)),x.DomEvent.on(this._container,"touchend",this._dragEndHandler,this)):(t.on("mousemove.focusbox",this._mousemoveHandler.bind(this)).on("mouseout.focusbox",this._mouseoutHandler.bind(this)).on("mousedown.drag",this._dragStartHandler.bind(this)).on("mousemove.drag",this._dragHandler.bind(this)),x.DomEvent.on(this._container,"mouseup",this._dragEndHandler,this))},_appendGrid:function(){this._svg.append("g").attr("class","grid").attr("transform","translate(0,"+this._svgHeight+")").call(this._make_x_axis().tickSize(-this._svgHeight,0,0).ticks(Math.round(this._svgWidth/75)).tickFormat("")),this._svg.append("g").attr("class","grid").call(this._make_y_axis().tickSize(-this._svgWidth,0,0).ticks(Math.round(this._svgHeight/30)).tickFormat("")),this._svg.append("g").attr("transform","translate(0,"+this._svgHeight+")").attr("class","x axis").call(this._xAxis),this._svg.append("g").attr("transform","translate(-2,0)").attr("class","y axis").call(this._yAxis)},_defined:function(t){return t&&void 0!==t.altitude&&null!==t.altitude},_appendAreas:function(t,n,e){var h,c,f,d,p,g,_,m,e=this._categories[n].attributes[e].color,i=this;this._area=(h=ai,f=ni(0),d=si,p=ni(!(c=null)),_=oi,m=g=null,r.x=function(t){return arguments.length?(h="function"==typeof t?t:ni(+t),c=null,r):h},r.x0=function(t){return arguments.length?(h="function"==typeof t?t:ni(+t),r):h},r.x1=function(t){return arguments.length?(c=null==t?null:"function"==typeof t?t:ni(+t),r):c},r.y=function(t){return arguments.length?(f="function"==typeof t?t:ni(+t),d=null,r):f},r.y0=function(t){return arguments.length?(f="function"==typeof t?t:ni(+t),r):f},r.y1=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:ni(+t),r):d},r.lineX0=r.lineY0=function(){return o().x(h).y(f)},r.lineY1=function(){return o().x(h).y(d)},r.lineX1=function(){return o().x(c).y(f)},r.defined=function(t){return arguments.length?(p="function"==typeof t?t:ni(!!t),r):p},r.curve=function(t){return arguments.length?(_=t,null!=g&&(m=_(g)),r):_},r.context=function(t){return arguments.length?(null==t?g=m=null:m=_(g=t),r):g},r.x(function(t){var n=i._x(t.position);return t.xDiagonalCoordinate=n}).y0(this._svgHeight).y1(function(t){return i._y(t.altitude)}).curve(oi).defined(this._defined));function r(t){var n,e,i,r,o,a=t.length,s=!1,u=new Array(a),l=new Array(a);for(null==g&&(m=_(o=ti())),n=0;n<=a;++n){if(!(n<a&&p(r=t[n],n,t))===s)if(s=!s)e=n,m.areaStart(),m.lineStart();else{for(m.lineEnd(),m.lineStart(),i=n-1;e<=i;--i)m.point(u[i],l[i]);m.lineEnd(),m.areaEnd()}s&&(u[n]=+h(r,n,t),l[n]=+f(r,n,t),m.point(c?+c(r,n,t):u[n],d?+d(r,n,t):l[n]))}if(o)return m=null,o+""||null}function o(){return ui().defined(p).curve(_).context(g)}this._areapath=this._svg.append("path").attr("class","area"),this._areapath.datum(t).attr("d",this._area).attr("stroke",e).styles(this._graphStyle).style("fill",e).style("pointer-events","none")},_make_x_axis:function(){return $e().scale(this._x)},_make_y_axis:function(){return Ue().scale(this._y)},_createSelectionBox:function(){var e=this,i=$(this._container).select("svg"),r=this._width-this._margin.right,o=this._height-this._margin.bottom+this._margin.bottom/2+6,t=[{x:r-25,y:3+o,color:"#000",type:ci,id:"leftArrowSelection",angle:0},{x:r-10,y:o,color:"#000",type:ci,id:"rightArrowSelection",angle:180}],n=i.selectAll(".select-symbol").data(t);n.remove(),n=i.selectAll(".select-symbol").data(t),1<e._data.length&&n.enter().append("path").merge(n).attr("class","select-symbol").attr("d",fi().type(function(t){return t.type})).attr("transform",function(t){return"translate("+t.x+","+t.y+") rotate("+t.angle+")"}).attr("id",function(t){return t.id}).style("fill",function(t){return t.color}).on("mousedown",function(t){"rightArrowSelection"===t.id&&s(),"leftArrowSelection"===t.id&&u(),e._gotDragged=!0,e._dragStartCoords=e._dragCache.start,e._dragCurrentCoords=e._dragCache.end});function a(t){var n;e._selectionText&&e._selectionText.remove(),0!==e._categories.length&&(n=e._categories[t].info,"function"==typeof e.options.chooseSelectionCallback&&e.options.chooseSelectionCallback(t,n),n=[{selection:n.text}],e._selectionText=i.selectAll("selection_text").data(n).enter().append("text").attr("x",r-35).attr("y",4+o).text(function(t){return t.selection}).attr("class","select-info").attr("id","selectionText").attr("text-anchor","end"))}a(this.options.selectedAttributeIdx);var s=function(){var t=e.options.selectedAttributeIdx+=1;t===e._categories.length&&(e.options.selectedAttributeIdx=t=0),a(t),e._removeChart(),e._removeMarkedSegmentsOnMap(),e._createChart(t)},u=function(){var t=--e.options.selectedAttributeIdx;-1===t&&(e.options.selectedAttributeIdx=t=e._categories.length-1),a(t),e._removeChart(),e._removeMarkedSegmentsOnMap(),e._createChart(t)}},_createLegend:function(){var t=this,e=this,n=[];if(0<this._categories.length)for(var i in this._categories[this.options.selectedAttributeIdx].legend)n.push(this._categories[this.options.selectedAttributeIdx].legend[i]);var r=this._height-this._margin.bottom,o=r+this._margin.bottom/2,a=[{text:this._getTranslation("legend")}],s=this._svg.selectAll(".hlegend-hover").data(n).enter().append("g").attr("class","legend").style("display","none").attr("transform",function(t,n){return"translate(-8,"+(14*n-28)+")"}),u=s.append("rect").attr("class","legend-rect").attr("x",15).attr("y",36).attr("width",6).attr("height",6);0!==Object.keys(this._graphStyle).length?u.styles(this._graphStyle).style("stroke",function(t,n){return t.color}).style("fill",function(t,n){return t.color}):u.style("stroke","black").style("fill",function(t,n){return t.color}),s.append("text").attr("class","legend-text").attr("x",30).attr("y",42).text(function(t,n){t=t.text;return e._boxBoundY=(r-2*r/3+7)*n,t});a=this._svg.selectAll(".legend-hover").data(a).enter().append("g").attr("class","legend-hover");this._showLegend=!1,a.append("text").attr("x",15).attr("y",o).attr("text-anchor","start").text(function(t,n){return t.text}).on("mouseover",function(){K(".legend").style("display","block")}).on("mouseleave",function(){t._showLegend||K(".legend").style("display","none")}).on("click",function(){t._showLegend=!t._showLegend})},_dynamicBoxSize:function(t){for(var n=K(t).nodes().length,e=[],i=0;i<n;i++)e.push(K(t).nodes()[i].getBoundingClientRect().width);return[n,Un(e)]},_createBorderTopLine:function(){var n=this,t=this._areasFlattended,e=ui().x(function(t){return(0,n._x)(t.position)}).y(function(t){return(0,n._y)(t.altitude)}).curve(gi).defined(this._defined);this._svg.append("svg:path").attr("d",e(t)).attr("class","border-top")},_mouseoutHandler:function(){for(var t=0,n=["_focusLine","_focus","_pointG","_mouseHeightFocus","_mouseHeightFocusLabel"];t<n.length;t++){var e=n[t];this[e]&&this[e].style("display","none")}},mapMouseoutHandler:function(t){var n=this,t=0<arguments.length&&void 0!==t?t:1e3;this.mouseoutDelay&&window.clearTimeout(this.mouseoutDelay),this.mouseoutDelay=window.setTimeout(function(){n._mouseoutHandler()},t)},mapMousemoveHandler:function(t,n){var n=(1<arguments.length&&void 0!==n?n:{}).showMapMarker,e=void 0===n||n;if(!1!==this._areasFlattended){var i=null,r=2*Math.pow(100,2),o=1.1/111111,a=h(this._areasFlattended);try{for(a.s();!(l=a.n()).done;){var s=l.value,u=t.latlng.lat-s.latlng.lat,l=t.latlng.lng-s.latlng.lng;if(Math.abs(u)<o&&Math.abs(l)<o){this._internalMousemoveHandler(s,e);break}l=Math.pow(u,2)+Math.pow(l,2);l<r&&(i=s,r=l)}}catch(t){a.e(t)}finally{a.f()}i&&this._internalMousemoveHandler(i,e)}},_mousemoveHandler:function(){var t=Z(this._svg.node()),t=this._areasFlattended[this._findItemForX(t[0])];t&&this._internalMousemoveHandler(t)},_internalMousemoveHandler:function(t,n){var e=!(1<arguments.length&&void 0!==n)||n,i=this._defined(t)?t.altitude:"-",r=t.position,o=t.latlng,a=t.areaIdx,n=t.type,t=this._dynamicBoxSize(".focusbox text")[1]+10,a=0===a?this._categories[this.options.selectedAttributeIdx].distances[a]:this._categories[this.options.selectedAttributeIdx].distances[a]-this._categories[this.options.selectedAttributeIdx].distances[a-1];e&&this._showMapMarker(o,i,n),this._distTspan.text(" "+r.toFixed(1)+" km"),this._altTspan.text(" "+i+" m"),this._areaTspan.text(" "+a.toFixed(1)+" km"),this._typeTspan.text(" "+n),this._focusRect.attr("width",t),this._focusLine.style("display","block").attr("x1",this._x(r)).attr("x2",this._x(r));a=this._x(r)-(t+5),n=this._width-this._margin.left-this._margin.right;this._x(r)+t<n&&this._focus.style("display","initial").attr("transform","translate("+this._x(r)+","+this._y(this._elevationBounds.min)+")"),this._x(r)+t>n&&this._focus.style("display","initial").attr("transform","translate("+a+","+this._y(this._elevationBounds.min)+")")},_findItemForX:function(t){var n=qn(function(t){return t.position}).left,t=this._x.invert(t);return n(this._areasFlattended,t)},_findCoordsForY:function(t){t=this._y.invert(t);return function(t,n){for(var e=[],i=0;i<t.length;i++)t[i].altitude>=n&&e.push(i);for(var r=[],o=0,a=0;a<e.length-1;a++)e[a+1]!==e[a]+1&&(r.push(e.slice(o,a+1)),o=a+1);r.push(e.slice(o,e.length));for(var s=0;s<r.length;s++)for(var u=0;u<r[s].length;u++)r[s][u]=t[r[s][u]].latlng;return r}(this._areasFlattended,t)},_getTranslation:function(t){return this.options.translation[t]||this._defaultTranslation[t]||(console.error("Unexpected error when looking up the translation for "+t),"No translation found")}}),x.control.heightgraph=function(t){return new x.Control.Heightgraph(t)},x.Control.Heightgraph},jt=window,"function"==typeof define&&define.amd?define(["leaflet"],It):"object"===("undefined"==typeof exports?"undefined":n(exports))&&(void 0!==jt&&jt.L?module.exports=It(L):module.exports=It(require("leaflet"))),void 0!==jt&&jt.L&&(jt.L.Control.Heightgraph=It(L))}();
!function(t,i){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(void 0!==i&&i.L?module.exports=t(L):module.exports=t(require("leaflet"))),void 0!==i&&i.L&&(i.L.Control.Locate=t(L))}(function(h){function o(i,o,t){(t=t.split(" ")).forEach(function(t){h.DomUtil[i].call(this,o,t)})}function i(t,i){o("addClass",t,i)}function s(t,i){o("removeClass",t,i)}var t=h.Marker.extend({initialize:function(t,i){h.Util.setOptions(this,i),this._latlng=t,this.createIcon()},createIcon:function(){var t=this.options,i="";void 0!==t.color&&(i+="stroke:"+t.color+";"),void 0!==t.weight&&(i+="stroke-width:"+t.weight+";"),void 0!==t.fillColor&&(i+="fill:"+t.fillColor+";"),void 0!==t.fillOpacity&&(i+="fill-opacity:"+t.fillOpacity+";"),void 0!==t.opacity&&(i+="opacity:"+t.opacity+";");i=this._getIconSVG(t,i);this._locationIcon=h.divIcon({className:i.className,html:i.svg,iconSize:[i.w,i.h]}),this.setIcon(this._locationIcon)},_getIconSVG:function(t,i){var o=t.radius,s=o+t.weight,t=2*s;return{className:"leaflet-control-locate-location",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+t+'" version="1.1" viewBox="-'+s+" -"+s+" "+t+" "+t+'"><circle r="'+o+'" style="'+i+'" /></svg>',w:t,h:t}},setStyle:function(t){h.Util.setOptions(this,t),this.createIcon()}}),e=t.extend({initialize:function(t,i,o){h.Util.setOptions(this,o),this._latlng=t,this._heading=i,this.createIcon()},setHeading:function(t){this._heading=t},_getIconSVG:function(t,i){var o=t.radius,s=t.width+t.weight,o=2*(o+t.depth+t.weight),t="M0,0 l"+t.width/2+","+t.depth+" l-"+s+",0 z";return{className:"leaflet-control-locate-heading",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="'+s+'" height="'+o+'" version="1.1" viewBox="-'+s/2+" 0 "+s+" "+o+'" style="'+("transform: rotate("+this._heading+"deg)")+'"><path d="'+t+'" style="'+i+'" /></svg>',w:s,h:o}}}),e=h.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds:function(t){return t.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:t,compassClass:e,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"fa fa-map-marker",iconLoading:"fa fa-spinner fa-spin",iconElementTag:"span",circlePadding:[0,0],metric:!0,createButtonCallback:function(t,i){t=h.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",t);return t.title=i.strings.title,t.role="button",t.href="#",{link:t,icon:h.DomUtil.create(i.iconElementTag,i.icon,t)}},onLocationError:function(t,i){alert(t.message)},onLocationOutsideMapBounds:function(t){t.stop(),alert(t.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(t){for(var i in t)"object"==typeof this.options[i]?h.extend(this.options[i],t[i]):this.options[i]=t[i];this.options.followMarkerStyle=h.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=h.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=h.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd:function(t){var i=h.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=i,this._map=t,this._layer=this.options.layer||new h.LayerGroup,this._layer.addTo(t),this._event=void 0,this._compassHeading=null,this._prevBounds=null;t=this.options.createButtonCallback(i,this.options);return this._link=t.link,this._icon=t.icon,h.DomEvent.on(this._link,"click",function(t){h.DomEvent.stopPropagation(t),h.DomEvent.preventDefault(t),this._onClick()},this).on(this._link,"dblclick",h.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),i},_onClick:function(){this._justClicked=!0;var t=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){var i=this.options.clickBehavior,o=i.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(o=t?i.inView:i.inViewNotFollowing),i[o]&&(o=i[o]),o){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds)}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing:function(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate:function(){var t,i,o;this._active||(this._map.locate(this.options.locateOptions),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),!this.options.showCompass||((t="ondeviceorientationabsolute"in window)||"ondeviceorientation"in window)&&(i=this,o=function(){h.DomEvent.on(window,t?"deviceorientationabsolute":"deviceorientation",i._onDeviceOrientation,i)},DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(t){"granted"===t&&o()}):o()))},_deactivate:function(){this._map.stopLocate(),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?h.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&h.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this))},setView:function(){var t;this._drawMarker(),this._isOutsideMapBounds()?(this._event=void 0,this.options.onLocationOutsideMapBounds(this)):this._justClicked&&!1!==this.options.initialZoomLevel?(t=this.options.flyTo?this._map.flyTo:this._map.setView).bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel):this.options.keepCurrentZoomLevel?(t=this.options.flyTo?this._map.flyTo:this._map.panTo).bind(this._map)([this._event.latitude,this._event.longitude]):(t=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds,this._ignoreEvent=!0,t.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.locateOptions.maxZoom}),h.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this))},_drawCompass:function(){var t,i;this._event&&(t=this._event.latlng,this.options.showCompass&&t&&null!==this._compassHeading&&(i=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle,this._compass?(this._compass.setLatLng(t),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(i)):this._compass=new this.options.compassClass(t,this._compassHeading,i).addTo(this._layer)),!this._compass||this.options.showCompass&&null!==this._compassHeading||(this._compass.removeFrom(this._layer),this._compass=null))},_drawMarker:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var t,i,o,s=this._event.accuracy,e=this._event.latlng;this.options.drawCircle&&(t=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle,this._circle?this._circle.setLatLng(e).setRadius(s).setStyle(t):this._circle=h.circle(e,s,t).addTo(this._layer)),o=this.options.metric?(i=s.toFixed(0),this.options.strings.metersUnit):(i=(3.2808399*s).toFixed(0),this.options.strings.feetUnit),this.options.drawMarker&&(s=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle,this._marker?(this._marker.setLatLng(e),this._marker.setStyle&&this._marker.setStyle(s)):this._marker=new this.options.markerClass(e,s).addTo(this._layer)),this._drawCompass();var n=this.options.strings.popup;function a(){return"string"==typeof n?h.Util.template(n,{distance:i,unit:o}):"function"==typeof n?n({distance:i,unit:o}):n}this.options.showPopup&&n&&this._marker&&this._marker.bindPopup(a())._popup.setLatLng(e),this.options.showPopup&&n&&this._compass&&this._compass.bindPopup(a())._popup.setLatLng(e)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading:function(t){!isNaN(parseFloat(t))&&isFinite(t)?(t=Math.round(t),this._compassHeading=t,h.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration:function(){this._setCompassHeading()},_onDeviceOrientation:function(t){this._active&&(t.webkitCompassHeading?this._setCompassHeading(t.webkitCompassHeading):t.absolute&&t.alpha&&this._setCompassHeading(360-t.alpha))},_onLocationError:function(t){3==t.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(t,this))},_onLocationFound:function(t){if((!this._event||this._event.latlng.lat!==t.latlng.lat||this._event.latlng.lng!==t.latlng.lng||this._event.accuracy!==t.accuracy)&&this._active){switch(this._event=t,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":this._userPanned||this._userZoomed||this.setView();break;case"always":this.setView()}this._justClicked=!1}},_onDrag:function(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom:function(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd:function(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){return!!this._active&&("always"===this.options.setView||("untilPan"===this.options.setView?!this._userPanned:"untilPanOrZoom"===this.options.setView?!this._userPanned&&!this._userZoomed:void 0))},_isOutsideMapBounds:function(){return void 0!==this._event&&(this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng))},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(t){"requesting"==t?(s(this._container,"active following"),i(this._container,"requesting"),s(this._icon,this.options.icon),i(this._icon,this.options.iconLoading)):"active"==t?(s(this._container,"requesting following"),i(this._container,"active"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon)):"following"==t&&(s(this._container,"requesting"),i(this._container,"active following"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon))},_cleanClasses:function(){h.DomUtil.removeClass(this._container,"requesting"),h.DomUtil.removeClass(this._container,"active"),h.DomUtil.removeClass(this._container,"following"),s(this._icon,this.options.iconLoading),i(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return h.control.locate=function(t){return new h.Control.Locate(t)},e},window);
!function(){var a=L.LineUtil.isFlat||L.LineUtil._flat;function n(o){var s,e=[o.latLng([90,180]),o.latLng([90,-180]),o.latLng([-90,-180]),o.latLng([-90,180])];o.version<"1.0.0"?(o.extend(o.Polygon.prototype,{initialize:function(t,n){var i;e=n.worldLatLngs||e,n&&n.invert&&!n.invertMultiPolygon&&((i=[]).push(e),i.push(t[0]),t=i),o.Polyline.prototype.initialize.call(this,t,n),this._initWithHoles(t)},getBounds:function(){return this.options.invert?new o.LatLngBounds(this._holes):new o.LatLngBounds(this.getLatLngs())}}),o.extend(o.MultiPolygon.prototype,{initialize:function(t,n){if(e=n.worldLatLngs||e,this._layers={},(this._options=n).invert){n.invertMultiPolygon=!0;var i,o=[];for(i in o.push(e),t)o.push(t[i][0]);t=[o]}this.setLatLngs(t)}})):(s={toGeoJSON:o.Polygon.prototype.toGeoJSON},o.extend(o.Polygon.prototype,{_setLatLngs:function(t){if(this._originalLatLngs=t,a(this._originalLatLngs)&&(this._originalLatLngs=[this._originalLatLngs]),this.options.invert){e=this.options.worldLatLngs||e;var n,i=[];for(n in i.push(e),t)i.push(t[n]);t=[i]}o.Polyline.prototype._setLatLngs.call(this,t)},getBounds:function(){return this._originalLatLngs?new o.LatLngBounds(this._originalLatLngs):new o.LatLngBounds(this.getLatLngs())},getLatLngs:function(){return this._originalLatLngs},toGeoJSON:function(t){if(!this.options.invert)return s.toGeoJSON.call(this,t);var n=!a(this._originalLatLngs),i=n&&!a(this._originalLatLngs[0]),t=o.GeoJSON.latLngsToCoords(this._originalLatLngs,i?2:n?1:0,!0,t);return n||(t=[t]),o.GeoJSON.getFeature(this,{type:(i?"Multi":"")+"Polygon",coordinates:t})}}))}"function"==typeof define&&define.amd?define(["leaflet"],function(t){n(t)}):n(L)}();
"use strict";L.Control.StravaSegments=L.Control.extend({options:{runningIcon:"fa-trophy",runningTitle:"Show Strava running segments",bikingIcon:"fa-bicycle",bikingTitle:"Show Strava biking segments",loadingIcon:"fa-spinner fa-pulse",loadingTitle:"Loadingâ¦",stravaToken:null},onError:function(t){console.warn("Error getting Strava segments:",t)},onAdd:function(t){var e=this;return this.stravaLayer=new L.LayerGroup([],{attribution:'<a href="https://strava.com">Strava</a>'}),this.runningButton=new L.easyButton({states:[{stateName:"default",icon:e.options.runningIcon,onClick:function(){e.showSegments(t,this,"running")},title:e.options.runningTitle},{stateName:"loading",icon:e.options.loadingIcon,title:e.options.loadingTitle}]}),this.bikingButton=new L.easyButton({states:[{stateName:"default",icon:e.options.bikingIcon,onClick:function(){e.showSegments(t,this,"biking")},title:e.options.bikingTitle},{stateName:"loading",icon:e.options.loadingIcon,title:e.options.loadingTitle}]}),new L.easyBar([this.bikingButton,this.runningButton]).addTo(t),t.on("zoom",function(t){t=t.target;e.toggleButtonsState(t)}),this.toggleButtonsState(t),new L.DomUtil.create("div")},toggleButtonsState:function(t){t.getZoom()<13?(this.bikingButton.disable(),this.runningButton.disable()):(this.bikingButton.enable(),this.runningButton.enable())},computeAngle:function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI},showSegments:function(t,e,n){e.state("loading"),this.fetchSegments(t,e,n,t.getBounds())},fetchSegments:function(d,h,f,v){var m=this,t="https://www.strava.com/api/v3/segments/explore?bounds="+v.getSouth()+","+v.getWest()+","+v.getNorth()+","+v.getEast()+"&activity_type="+f;this.stravaLayer.addTo(d),this.get(t,L.bind(function(t,e){if(t)return h.state("default"),void m.onError(t);var n=JSON.parse(e).segments;10===n.length?(m.fetchSegments(d,h,f,L.latLngBounds(v.getSouthWest(),v.getCenter())),m.fetchSegments(d,h,f,L.latLngBounds(v.getSouthEast(),v.getCenter())),m.fetchSegments(d,h,f,L.latLngBounds(v.getNorthEast(),v.getCenter())),m.fetchSegments(d,h,f,L.latLngBounds(v.getNorthWest(),v.getCenter()))):h.state("default");var o=!0,i=!1,a=void 0;try{for(var s=n[Symbol.iterator]();!(o=(g=s.next()).done);o=!0){var r,g,u,l,c=g.value;-1===m.stravaLayer.getLayers().map(function(t){return t.options.id}).indexOf(c.id)&&(u=polyline.decode(c.points),l="running"===f?"red":"blue",r=new L.TriangleMarker(u[0],{width:12,height:10,rotation:m.computeAngle(L.point(u[0]),L.point(u[1])),color:l}),g=new L.Circle(u[u.length-1],{radius:30,color:l}),(u=new L.Polyline(u,{id:c.id,weight:3,color:l})).on("mouseover",function(t){t.target.setStyle({weight:5})}),u.on("mouseout",function(t){t.target.setStyle({weight:3})}),l="<h4>"+c.name+"</h4>",l+="Distance: "+c.distance+"m, hill","NC"!=c.climb_category_desc&&(l+=" (cat. "+c.climb_category_desc+")"),l+=": "+c.elev_difference+"m (avg "+c.avg_grade+"%)",m.stravaLayer.addLayer(r),m.stravaLayer.addLayer(g),m.stravaLayer.addLayer(u.bindTooltip(l)))}}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}}))},get:function(t,e){var n=this;if(this.options.stravaToken){var o=new XMLHttpRequest;o.open("GET",t,!0),o.setRequestHeader("Authorization","Bearer "+this.options.stravaToken),o.onload=function(){200!==o.status&&0!==o.status||!o.responseText?e(n.getError(o)):e(null,o.responseText)},o.onerror=function(){e(n.getError(o))};try{o.send()}catch(t){e(t)}}else e("Strava API token no set.")},getError:function(t){var e="no response from server";return t.responseText?e=t.responseText:(t.status||t.statusText)&&(e=t.status+": "+t.statusText),e}}),L.control.stravaSegments=function(t){return new L.Control.StravaSegments(t)};
L.Control.StandardAttribution=L.Control.Attribution,L.Control.PermalinkAttribution=L.Control.Attribution.extend({onAdd:function(t){var o=L.Control.StandardAttribution.prototype.onAdd.call(this,t);return t.on("moveend",this._update,this),o},onRemove:function(t){t.off("moveend",this._update),L.Control.StandardAttribution.prototype.onRemove.call(this,t)},_update:function(){if(this._map){var t,o,n,i=[];for(o in this._attributions)this._attributions[o]&&((0<o.indexOf("/openstreetmap.org")||0<o.indexOf("/www.openstreetmap.org"))&&(t="http://www.openstreetmap.org/#map={zoom}/{lat}/{lon}",o=o.replace(/(['"])http[^'"]+openstreetmap.org[^'"]*(['"])/,"$1"+t+"$2"),this._map.options.attributionEditLink&&(n=t.replace("#","edit#"),o=o.replace(/(openstreetmap.org[^'"]*(['"])[^>]*>[^<]+<\/a>)/,"$1 (<a href=$2"+n+"$2 target=$2osmedit$2>Edit</a>)"))),n=this._map.getCenter(),o=o.replace(/\{zoom\}/g,this._map.getZoom()).replace(/\{lat\}/g,L.Util.formatNum(n.lat,4)).replace(/\{lon\}/g,L.Util.formatNum(n.lng,4)),i.push(o));var r=[];this.options.prefix&&r.push(this.options.prefix),i.length&&r.push(i.join(", ")),this._container.innerHTML=r.join(" | ")}}}),L.control.permalinkAttribution=function(t){return new L.Control.PermalinkAttribution(t)},L.Map.mergeOptions({attributionEditLink:!1}),L.Control.Attribution=L.Control.PermalinkAttribution,L.control.standardAttribution=L.control.attribution,L.control.attribution=L.control.permalinkAttribution;
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).osmtogeojson=e()}(function(){return function r(o,i,a){function u(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}};o[t][0].call(n.exports,function(e){return u(o[t][1][e]||e)},n,n.exports,r,o,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)u(a[e]);return u}({1:[function(e,t,n){var B=e("./lodash.custom.js"),L=e("@mapbox/geojson-rewind"),r={};function o(e,t){return(e.version||t.version)&&e.version!==t.version?(+e.version||0)>(+t.version||0)?e:t:B.merge(e,t)}function F(e){function t(e){return e[0]}function n(e){return e[e.length-1]}function r(e,t){return void 0!==e&&void 0!==t&&e.id===t.id}for(var o,i,a,u,s,l,c=[];e.length;)for(o=e.pop().nodes.slice(),c.push(o);e.length&&!r(o[0],n(o));){for(i=o[0],a=n(o),u=0;u<e.length;u++){if(r(a,t(l=e[u].nodes))){s=o.push,l=l.slice(1);break}if(r(a,n(l))){s=o.push,l=l.slice(0,-1).reverse();break}if(r(i,n(l))){s=o.unshift,l=l.slice(0,-1);break}if(r(i,l[0])){s=o.unshift,l=l.slice(1).reverse();break}l=s=null}if(!l)break;e.splice(u,1),s.apply(o,l)}return c}e("osm-polygon-features").forEach(function(e){var t,n;"all"===e.polygon?r[e.key]=!0:(t="whitelist"===e.polygon?"included_values":"excluded_values",n={},e.values.forEach(function(e){n[e]=!0}),r[e.key]={},r[e.key][t]=n)}),(e=function(e,S,N){var t,s,l,c,f,p;function y(e,t,n){e.hasAttribute(n)&&(t[n]=e.getAttribute(n))}function d(e,t){e=B.clone(e);y(t,e,"lat"),y(t,e,"lon"),e.__is_center_placeholder=!0,c.push(e)}function g(e,t){var r=B.clone(e);function n(e,t,n){t={type:"node",id:"_"+r.type+"/"+r.id+"bounds"+n,lat:e,lon:t};r.nodes.push(t.id),c.push(t)}r.nodes=[],n(t.getAttribute("minlat"),t.getAttribute("minlon"),1),n(t.getAttribute("maxlat"),t.getAttribute("minlon"),2),n(t.getAttribute("maxlat"),t.getAttribute("maxlon"),3),n(t.getAttribute("minlat"),t.getAttribute("maxlon"),4),r.nodes.push(r.nodes[0]),r.__is_bounds_placeholder=!0,f.push(r)}return S=B.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:r,deduplicator:o},S),"undefined"!=typeof XMLDocument&&e instanceof XMLDocument||"undefined"==typeof XMLDocument&&e.childNodes?(t=e,c=new Array,f=new Array,p=new Array,B.each(t.getElementsByTagName("node"),function(e,t){var n={};B.each(e.getElementsByTagName("tag"),function(e){n[e.getAttribute("k")]=e.getAttribute("v")});var r={type:"node"};y(e,r,"id"),y(e,r,"lat"),y(e,r,"lon"),y(e,r,"version"),y(e,r,"timestamp"),y(e,r,"changeset"),y(e,r,"uid"),y(e,r,"user"),B.isEmpty(n)||(r.tags=n),c.push(r)}),B.each(t.getElementsByTagName("way"),function(e,t){var n={},r=[];B.each(e.getElementsByTagName("tag"),function(e){n[e.getAttribute("k")]=e.getAttribute("v")});var o=!1;B.each(e.getElementsByTagName("nd"),function(e,t){var n;(n=e.getAttribute("ref"))&&(r[t]=n),!o&&e.getAttribute("lat")&&(o=!0)});var i,a,u={type:"way"};y(e,u,"id"),y(e,u,"version"),y(e,u,"timestamp"),y(e,u,"changeset"),y(e,u,"uid"),y(e,u,"user"),0<r.length&&(u.nodes=r),B.isEmpty(n)||(u.tags=n),(s=e.getElementsByTagName("center")[0])&&d(u,s),o?(i=u,a=e.getElementsByTagName("nd"),B.isArray(i.nodes)||(i.nodes=[],B.each(a,function(e,t){i.nodes.push("_anonymous@"+e.getAttribute("lat")+"/"+e.getAttribute("lon"))})),B.each(a,function(e,t){var n;e.getAttribute("lat")&&(n=e.getAttribute("lat"),e=e.getAttribute("lon"),e={type:"node",id:i.nodes[t],lat:n,lon:e},c.push(e))})):(l=e.getElementsByTagName("bounds")[0])&&g(u,l),f.push(u)}),B.each(t.getElementsByTagName("relation"),function(e,t){var n={},r=[];B.each(e.getElementsByTagName("tag"),function(e){n[e.getAttribute("k")]=e.getAttribute("v")});var o=!1;B.each(e.getElementsByTagName("member"),function(e,t){r[t]={},y(e,r[t],"ref"),y(e,r[t],"role"),y(e,r[t],"type"),(!o&&"node"==r[t].type&&e.getAttribute("lat")||"way"==r[t].type&&0<e.getElementsByTagName("nd").length)&&(o=!0)});var a,i,u={type:"relation"};y(e,u,"id"),y(e,u,"version"),y(e,u,"timestamp"),y(e,u,"changeset"),y(e,u,"uid"),y(e,u,"user"),0<r.length&&(u.members=r),B.isEmpty(n)||(u.tags=n),(s=e.getElementsByTagName("center")[0])&&d(u,s),o?(a=u,i=e.getElementsByTagName("member"),B.each(i,function(e,t){var n,r,o,i;"node"==a.members[t].type?e.getAttribute("lat")&&(n=e.getAttribute("lat"),r=e.getAttribute("lon"),r={type:"node",id:a.members[t].ref,lat:n,lon:r},c.push(r)):"way"==a.members[t].type&&0<e.getElementsByTagName("nd").length&&(a.members[t].ref="_fullGeom"+a.members[t].ref,e=e.getElementsByTagName("nd"),o=a.members[t].ref,f.some(function(e){return"way"==e.type&&e.id==o})||(i={type:"way",id:o,nodes:[]},B.each(e,function(e){var t;e.getAttribute("lat")?(e={type:"node",id:"_anonymous@"+(t=e.getAttribute("lat"))+"/"+(e=e.getAttribute("lon")),lat:t,lon:e},i.nodes.push(e.id),c.push(e)):i.nodes.push(void 0)}),f.push(i)))})):(l=e.getElementsByTagName("bounds")[0])&&g(u,l),p.push(u)}),h(c,f,p)):function(e){var a=new Array,u=new Array,t=new Array;function n(e){var t=B.clone(e);t.lat=e.center.lat,t.lon=e.center.lon,t.__is_center_placeholder=!0,a.push(t)}function r(e){var r=B.clone(e);function t(e,t,n){t={type:"node",id:"_"+r.type+"/"+r.id+"bounds"+n,lat:e,lon:t};r.nodes.push(t.id),a.push(t)}r.nodes=[],t(r.bounds.minlat,r.bounds.minlon,1),t(r.bounds.maxlat,r.bounds.minlon,2),t(r.bounds.maxlat,r.bounds.maxlon,3),t(r.bounds.minlat,r.bounds.maxlon,4),r.nodes.push(r.nodes[0]),r.__is_bounds_placeholder=!0,u.push(r)}function o(e){e.members.forEach(function(e,t){var n,r,o,i;"node"==e.type?e.lat&&(n=e.lat,r=e.lon,r={type:"node",id:e.ref,lat:n,lon:r},a.push(r)):"way"==e.type&&e.geometry&&(e.ref="_fullGeom"+e.ref,r=e.geometry,o=e.ref,u.some(function(e){return"way"==e.type&&e.id==o})||(i={type:"way",id:o,nodes:[]},r.forEach(function(e){var t;e?(e={type:"node",id:"_anonymous@"+(t=e.lat)+"/"+(e=e.lon),lat:t,lon:e},i.nodes.push(e.id),a.push(e)):i.nodes.push(void 0)}),u.push(i)))})}for(var i=0;i<e.elements.length;i++)switch(e.elements[i].type){case"node":var s=e.elements[i];a.push(s);break;case"way":var l=B.clone(e.elements[i]);l.nodes=B.clone(l.nodes),u.push(l),l.center&&n(l),l.geometry?function(r){B.isArray(r.nodes)||(r.nodes=r.geometry.map(function(e){return null!==e?"_anonymous@"+e.lat+"/"+e.lon:"_anonymous@unknown_location"})),r.geometry.forEach(function(e,t){var n;e&&(n=e.lat,e=e.lon,e={type:"node",id:r.nodes[t],lat:n,lon:e},a.push(e))})}(l):l.bounds&&r(l);break;case"relation":s=B.clone(e.elements[i]);s.members=B.clone(s.members),t.push(s);l=s.members&&s.members.some(function(e){return"node"==e.type&&e.lat||"way"==e.type&&e.geometry&&0<e.geometry.length});s.center&&n(s),l?o(s):s.bounds&&r(s)}return h(a,u,t)}(e);function h(e,t,n){function r(e,t){if("object"!=typeof t&&(t={}),"function"==typeof S.uninterestingTags)return!S.uninterestingTags(e,t);for(var n in e)if(!0!==S.uninterestingTags[n]&&!0!==t[n]&&t[n]!==e[n])return 1}function f(e){var t,n={timestamp:e.timestamp,version:e.version,changeset:e.changeset,user:e.user,uid:e.uid};for(t in n)void 0===n[t]&&delete n[t];return n}for(var o=new Object,i=new Object,a=0;a<e.length;a++)void 0!==o[(y=e[a]).id]&&(y=S.deduplicator(y,o[y.id])),void 0!==(o[y.id]=y).tags&&r(y.tags)&&(i[y.id]=!0);for(a=0;a<n.length;a++)if(B.isArray(n[a].members))for(var u=0;u<n[a].members.length;u++)"node"==n[a].members[u].type&&(i[n[a].members[u].ref]=!0);for(var p=new Object,s=new Object,a=0;a<t.length;a++){var l=t[a];if(p[l.id]&&(l=S.deduplicator(l,p[l.id])),p[l.id]=l,B.isArray(l.nodes))for(u=0;u<l.nodes.length;u++)"object"!=typeof l.nodes[u]&&(s[l.nodes[u]]=!0,l.nodes[u]=o[l.nodes[u]])}var c=new Array;for(h in o){var y=o[h];s[h]&&!i[h]||c.push(y)}var d=new Array;for(a=0;a<n.length;a++)d[(b=n[a]).id]&&(b=S.deduplicator(b,d[b.id])),d[b.id]=b;var g,h,m={node:{},way:{},relation:{}};for(h in d){var b=d[h];if(B.isArray(b.members))for(u=0;u<b.members.length;u++){var v=b.members[u].type,_=b.members[u].ref;"number"!=typeof _&&(_=_.replace("_fullGeom","")),m[v]?(void 0===m[v][_]&&(m[v][_]=[]),m[v][_].push({role:b.members[u].role,rel:b.id,reltags:b.tags})):S.verbose&&console.warn("Relation",b.type+"/"+b.id,"member",v+"/"+_,"ignored because it has an invalid type")}else S.verbose&&console.warn("Relation",b.type+"/"+b.id,"ignored because it has no members")}var w,j=[];for(a=0;a<c.length;a++)void 0!==c[a].lon&&void 0!==c[a].lat?(w={type:"Feature",id:c[a].type+"/"+c[a].id,properties:{type:c[a].type,id:c[a].id,tags:c[a].tags||{},relations:m.node[c[a].id]||[],meta:f(c[a])},geometry:{type:"Point",coordinates:[+c[a].lon,+c[a].lat]}},c[a].__is_center_placeholder&&(w.properties.geometry="center"),N?N(w):j.push(w)):S.verbose&&console.warn("POI",c[a].type+"/"+c[a].id,"ignored because it lacks coordinates");var A=[],k=[];for(a=0;a<n.length;a++)if(d[n[a].id]===n[a]){if(void 0!==n[a].tags&&("route"==n[a].tags.type||"waterway"==n[a].tags.type)){if(!B.isArray(n[a].members)){S.verbose&&console.warn("Route",n[a].type+"/"+n[a].id,"ignored because it has no members");continue}if(n[a].members.forEach(function(e){p[e.ref]&&!r(p[e.ref].tags)&&(p[e.ref].is_skippablerelationmember=!0)}),!1===(w=function(n){var r=!1;if(e=(e=n.members.filter(function(e){return"way"===e.type})).map(function(t){var e=p[t.ref];return void 0===e||void 0===e.nodes?(S.verbose&&console.warn("Route "+n.type+"/"+n.id,"tainted by a missing or incomplete  way",t.type+"/"+t.ref),void(r=!0)):{id:t.ref,role:t.role,way:e,nodes:e.nodes.filter(function(e){return void 0!==e||(r=!0,S.verbose&&console.warn("Route",n.type+"/"+n.id,"tainted by a way",t.type+"/"+t.ref,"with a missing node"),!1)})}}),e=F(e=B.compact(e)),0==(e=B.compact(e.map(function(e){return B.compact(e.map(function(e){return[+e.lon,+e.lat]}))}))).length)return S.verbose&&console.warn("Route",n.type+"/"+n.id,"contains no coordinates"),!1;var e={type:"Feature",id:n.type+"/"+n.id,properties:{type:n.type,id:n.id,tags:n.tags||{},relations:m[n.type][n.id]||[],meta:f(n)},geometry:{type:1===e.length?"LineString":"MultiLineString",coordinates:1===e.length?e[0]:e}};return r&&(S.verbose&&console.warn("Route",n.type+"/"+n.id,"is tainted"),e.properties.tainted=!0),e}(n[a]))){S.verbose&&console.warn("Route relation",n[a].type+"/"+n[a].id,"ignored because it has invalid geometry");continue}N?N(L(w)):k.push(w)}if(void 0!==n[a].tags&&("multipolygon"==n[a].tags.type||"boundary"==n[a].tags.type)){if(!B.isArray(n[a].members)){S.verbose&&console.warn("Multipolygon",n[a].type+"/"+n[a].id,"ignored because it has no members");continue}for(var O=0,u=0;u<n[a].members.length;u++)"outer"==n[a].members[u].role?O++:S.verbose&&"inner"!=n[a].members[u].role&&console.warn("Multipolygon",n[a].type+"/"+n[a].id,"member",n[a].members[u].type+"/"+n[a].members[u].ref,'ignored because it has an invalid role: "'+n[a].members[u].role+'"');if(n[a].members.forEach(function(e){p[e.ref]&&("outer"!==e.role||r(p[e.ref].tags,n[a].tags)||(p[e.ref].is_skippablerelationmember=!0),"inner"!==e.role||r(p[e.ref].tags)||(p[e.ref].is_skippablerelationmember=!0))}),0==O){S.verbose&&console.warn("Multipolygon relation",n[a].type+"/"+n[a].id,"ignored because it has no outer ways");continue}var x=!1;if(1!=O||r(n[a].tags,{type:!0})||(x=!0),w=null,x){var E=n[a].members.filter(function(e){return"outer"===e.role})[0];if(void 0===(E=p[E.ref])){S.verbose&&console.warn("Multipolygon relation",n[a].type+"/"+n[a].id,"ignored because outer way",E.type+"/"+E.ref,"is missing");continue}E.is_skippablerelationmember=!0,w=M(E,n[a])}else w=M(n[a],n[a]);if(!1===w){S.verbose&&console.warn("Multipolygon relation",n[a].type+"/"+n[a].id,"ignored because it has invalid geometry");continue}function M(e,t){var o,n,r,i=!1,a=x?"way":"relation",u="number"==typeof e.id?e.id:+e.id.replace("_fullGeom","");c=(c=t.members.filter(function(e){return"way"===e.type})).map(function(t){var e=p[t.ref];return void 0===e||void 0===e.nodes?(S.verbose&&console.warn("Multipolygon",a+"/"+u,"tainted by a missing or incomplete way",t.type+"/"+t.ref),void(i=!0)):{id:t.ref,role:t.role||"outer",way:e,nodes:e.nodes.filter(function(e){return void 0!==e||(i=!0,S.verbose&&console.warn("Multipolygon",a+"/"+u,"tainted by a way",t.type+"/"+t.ref,"with a missing node"),!1)})}}),c=B.compact(c),o=F(c.filter(function(e){return"outer"===e.role})),n=F(c.filter(function(e){return"inner"===e.role})),r=o.map(function(e){return[e]});for(var s=0;s<n.length;s++){var l=function(e){function t(e){return e.map(function(e){return[+e.lat,+e.lon]})}var n,r=function(e,t){for(var n=e[0],r=e[1],o=!1,i=0,a=t.length-1;i<t.length;a=i++){var u=t[i][0],s=t[i][1],l=t[a][0],c=t[a][1];r<s!=r<c&&n<(l-u)*(r-s)/(c-s)+u&&(o=!o)}return o};for(e=t(e),n=0;n<o.length;n++)if(function(e,t){for(var n=0;n<t.length;n++)if(r(t[n],e))return 1}(t(o[n]),e))return n}(n[s]);void 0!==l?r[l].push(n[s]):S.verbose&&console.warn("Multipolygon",a+"/"+u,"contains an inner ring with no containing outer")}t=[];if(0==(t=B.compact(r.map(function(e){e=B.compact(e.map(function(e){return e.length<4?void(S.verbose&&console.warn("Multipolygon",a+"/"+u,"contains a ring with less than four nodes")):B.compact(e.map(function(e){return[+e.lon,+e.lat]}))}));if(0!=e.length)return e;S.verbose&&console.warn("Multipolygon",a+"/"+u,"contains an empty ring cluster")}))).length)return S.verbose&&console.warn("Multipolygon",a+"/"+u,"contains no coordinates"),!1;var c="MultiPolygon";1===t.length&&(c="Polygon",t=t[0]);t={type:"Feature",id:e.type+"/"+u,properties:{type:e.type,id:u,tags:e.tags||{},relations:m[e.type][e.id]||[],meta:f(e)},geometry:{type:c,coordinates:t}};return i&&(S.verbose&&console.warn("Multipolygon",a+"/"+u,"is tainted"),t.properties.tainted=!0),t}N?N(L(w)):k.push(w)}}for(a=0;a<t.length;a++)if(p[t[a].id]===t[a])if(B.isArray(t[a].nodes)){if(!t[a].is_skippablerelationmember){"number"!=typeof t[a].id&&(t[a].id=+t[a].id.replace("_fullGeom","")),t[a].tainted=!1,t[a].hidden=!1;var T,P=new Array;for(u=0;u<t[a].nodes.length;u++)"object"==typeof t[a].nodes[u]?P.push([+t[a].nodes[u].lon,+t[a].nodes[u].lat]):(S.verbose&&console.warn("Way",t[a].type+"/"+t[a].id,"is tainted by an invalid node"),t[a].tainted=!0);P.length<=1?S.verbose&&console.warn("Way",t[a].type+"/"+t[a].id,"ignored because it contains too few nodes"):(T="LineString",void 0!==t[a].nodes[0]&&void 0!==t[a].nodes[t[a].nodes.length-1]&&t[a].nodes[0].id===t[a].nodes[t[a].nodes.length-1].id&&(void 0!==t[a].tags&&function(e){var t,n=S.polygonFeatures;if("function"==typeof n)return n(e);if("no"===e.area)return!1;for(t in e){var r=e[t],o=n[t];if(void 0!==o&&"no"!==r){if(!0===o)return!0;if(o.included_values&&!0===o.included_values[r])return!0;if(o.excluded_values&&!0!==o.excluded_values[r])return!0}}return!1}(t[a].tags)||t[a].__is_bounds_placeholder)&&(T="Polygon",P=[P]),w={type:"Feature",id:t[a].type+"/"+t[a].id,properties:{type:t[a].type,id:t[a].id,tags:t[a].tags||{},relations:m.way[t[a].id]||[],meta:f(t[a])},geometry:{type:T,coordinates:P}},t[a].tainted&&(S.verbose&&console.warn("Way",t[a].type+"/"+t[a].id,"is tainted"),w.properties.tainted=!0),t[a].__is_bounds_placeholder&&(w.properties.geometry="bounds"),N?N(L(w)):("LineString"==T?A:k).push(w))}}else S.verbose&&console.warn("Way",t[a].type+"/"+t[a].id,"ignored because it has no nodes");return!!N||((g={type:"FeatureCollection",features:[]}).features=g.features.concat(k),g.features=g.features.concat(A),g.features=g.features.concat(j),S.flatProperties&&g.features.forEach(function(e){e.properties=B.merge(e.properties.meta,e.properties.tags,{id:e.properties.type+"/"+e.properties.id})}),L(g))}}).toGeojson=e,t.exports=e},{"./lodash.custom.js":2,"@mapbox/geojson-rewind":4,"osm-polygon-features":5}],2:[function(e,Xt,Ht){(function(Vt){(function(){var b,e="Expected a function",r="__lodash_hash_undefined__",g=1,v=2,n=1/0,o=9007199254740991,h="[object Arguments]",f="[object Array]",m="[object Boolean]",_="[object Date]",p="[object Error]",w="[object Function]",j="[object GeneratorFunction]",A="[object Map]",k="[object Number]",O="[object Object]",i="[object Promise]",x="[object RegExp]",E="[object Set]",M="[object String]",T="[object Symbol]",a="[object WeakMap]",P="[object ArrayBuffer]",S="[object DataView]",N="[object Float32Array]",B="[object Float64Array]",L="[object Int8Array]",F="[object Int16Array]",I="[object Int32Array]",R="[object Uint8Array]",D="[object Uint8ClampedArray]",U="[object Uint16Array]",$="[object Uint32Array]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,t=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/\\(\\)?/g,G=/\w*$/,y=/^\[object .+?Constructor\]$/,d=/^(?:0|[1-9]\d*)$/,C={};C[N]=C[B]=C[L]=C[F]=C[I]=C[R]=C[D]=C[U]=C[$]=!0,C[h]=C[f]=C[P]=C[m]=C[S]=C[_]=C[p]=C[w]=C[A]=C[k]=C[O]=C[x]=C[E]=C[M]=C[a]=!1;var z={};z[h]=z[f]=z[P]=z[S]=z[m]=z[_]=z[N]=z[B]=z[L]=z[F]=z[I]=z[A]=z[k]=z[O]=z[x]=z[E]=z[M]=z[T]=z[R]=z[D]=z[U]=z[$]=!0,z[p]=z[w]=z[a]=!1;var W="object"==typeof Vt&&Vt&&Vt.Object===Object&&Vt,q="object"==typeof self&&self&&self.Object===Object&&self,V=W||q||Function("return this")(),X="object"==typeof Ht&&Ht&&!Ht.nodeType&&Ht,H=X&&"object"==typeof Xt&&Xt&&!Xt.nodeType&&Xt,J=H&&H.exports===X,K=J&&W.process,Q=function(){try{return K&&K.binding("util")}catch(e){}}(),Y=Q&&Q.isTypedArray;function Z(e,t){return e.set(t[0],t[1]),e}function ee(e,t){return e.add(t),e}function te(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}function ne(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function re(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function oe(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r}function ie(t,n){return function(e){return t(n(e))}}function ae(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var ue=Array.prototype,se=Function.prototype,le=Object.prototype,q=V["__core-js_shared__"],ce=(W=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",fe=se.toString,pe=le.hasOwnProperty,ye=fe.call(Object),de=le.toString,ge=RegExp("^"+fe.call(pe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q=J?V.Buffer:b,q=V.Symbol,he=V.Uint8Array,me=ie(Object.getPrototypeOf,Object),be=Object.create,ve=le.propertyIsEnumerable,_e=ue.splice,W=Object.getOwnPropertySymbols,se=Q?Q.isBuffer:b,we=ie(Object.keys,Object),je=Math.max,J=it(V,"DataView"),Ae=it(V,"Map"),ue=it(V,"Promise"),Q=it(V,"Set"),V=it(V,"WeakMap"),ke=it(Object,"create"),Oe=!ve.call({valueOf:1},"valueOf"),xe=gt(J),Ee=gt(Ae),Me=gt(ue),Te=gt(Q),Pe=gt(V),q=q?q.prototype:b,Se=q?q.valueOf:b,Ne=q?q.toString:b;function Be(){}function Le(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Fe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ie(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Re(e){var t=-1,n=e?e.length:0;for(this.__data__=new Ie;++t<n;)this.add(e[t])}function De(e){this.__data__=new Fe(e)}function Ue(e,t){var n,r=_t(e)||vt(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],o=r.length,i=!!o;for(n in e)!t&&!pe.call(e,n)||i&&("length"==n||st(n,o))||r.push(n);return r}function $e(e,t,n){(n===b||bt(e[t],n))&&("number"!=typeof t||n!==b||t in e)||(e[t]=n)}function Ge(e,t,n){var r=e[t];pe.call(e,t)&&bt(r,n)&&(n!==b||t in e)||(e[t]=n)}function Ce(e,t){for(var n=e.length;n--;)if(bt(e[n][0],t))return n;return-1}function ze(n,r,o,i,e,t,a){var u;if(i&&(u=t?i(n,e,t,a):i(n)),u!==b)return u;if(!xt(n))return n;var s,l,c=_t(n);if(c){if(e=(l=n).length,p=l.constructor(e),e&&"string"==typeof l[0]&&pe.call(l,"index")&&(p.index=l.index,p.input=l.input),u=p,!r)return tt(n,u)}else{var f=ut(n),p=f==w||f==j;if(At(n))return function(e){if(r)return e.slice();var t=new e.constructor(e.length);return e.copy(t),t}(n);if(f==O||f==h||p&&!t){if(re(n))return t?n:{};if(u="function"!=typeof(p=p?{}:n).constructor||ct(p)?{}:xt(s=me(p))?be(s):{},!r)return s=p=n,d=(d=u)&&nt(s,It(s),d),nt(p,at(p),d)}else{if(!z[f])return t?n:{};u=function(e,t,n){var r,o,i,a,u=e.constructor;switch(f){case P:return et(e);case m:case _:return new u(+e);case S:return i=e,a=n?et(i.buffer):i.buffer,new i.constructor(a,i.byteOffset,i.byteLength);case N:case B:case L:case F:case I:case R:case D:case U:case $:return a=e,i=n?et(a.buffer):a.buffer,new a.constructor(i,a.byteOffset,a.length);case A:return o=e,ne(n?t(oe(o),!0):oe(o),Z,new o.constructor);case k:case M:return new u(e);case x:return(r=new(o=e).constructor(o.source,G.exec(o))).lastIndex=o.lastIndex,r;case E:return r=e,ne(n?t(ae(r),!0):ae(r),ee,new r.constructor);case T:return Se?Object(Se.call(e)):{}}}(n,ze,r)}}var y,d=(a=a||new De).get(n);return d||(a.set(n,u),c||(y=o?(t=at,c=It(d=n),_t(d)?c:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(c,t(d))):It(n)),te(y||n,function(e,t){y&&(e=n[t=e]),Ge(u,t,ze(e,r,o,i,t,n,a))}),u)}Le.prototype.clear=function(){this.__data__=ke?ke(null):{}},Le.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Le.prototype.get=function(e){var t=this.__data__;if(ke){var n=t[e];return n===r?b:n}return pe.call(t,e)?t[e]:b},Le.prototype.has=function(e){var t=this.__data__;return ke?t[e]!==b:pe.call(t,e)},Le.prototype.set=function(e,t){return this.__data__[e]=ke&&t===b?r:t,this},Fe.prototype.clear=function(){this.__data__=[]},Fe.prototype.delete=function(e){var t=this.__data__,e=Ce(t,e);return!(e<0||(e==t.length-1?t.pop():_e.call(t,e,1),0))},Fe.prototype.get=function(e){var t=this.__data__,e=Ce(t,e);return e<0?b:t[e][1]},Fe.prototype.has=function(e){return-1<Ce(this.__data__,e)},Fe.prototype.set=function(e,t){var n=this.__data__,r=Ce(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},Ie.prototype.clear=function(){this.__data__={hash:new Le,map:new(Ae||Fe),string:new Le}},Ie.prototype.delete=function(e){return ot(this,e).delete(e)},Ie.prototype.get=function(e){return ot(this,e).get(e)},Ie.prototype.has=function(e){return ot(this,e).has(e)},Ie.prototype.set=function(e,t){return ot(this,e).set(e,t),this},Re.prototype.add=Re.prototype.push=function(e){return this.__data__.set(e,r),this},Re.prototype.has=function(e){return this.__data__.has(e)},De.prototype.clear=function(){this.__data__=new Fe},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Fe){var r=n.__data__;if(!Ae||r.length<199)return r.push([e,t]),this;n=this.__data__=new Ie(r)}return n.set(e,t),this};var We,qe=(We=function(e,t){return e&&Ve(e,t,It)},function(e,t){if(null==e)return e;if(!wt(e))return We(e,t);for(var n=e.length,r=-1,o=Object(e);++r<n&&!1!==t(o[r],r,o););return e}),Ve=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var u=i[++r];if(!1===t(o[u],u,o))break}return e};function Xe(e,t){for(var n=0,r=(t=lt(t,e)?[t]:Ze(t)).length;null!=e&&n<r;)e=e[dt(t[n++])];return n&&n==r?e:b}function He(e,t){return null!=e&&t in Object(e)}function Je(e,t,n,r,o){return e===t||(null==e||null==t||!xt(e)&&!Et(t)?e!=e&&t!=t:function(e,t,n,r,o,i){var a=_t(e),u=_t(t),s=f,l=f;a||(s=(s=ut(e))==h?O:s),u||(l=(l=ut(t))==h?O:l);var c=s==O&&!re(e),u=l==O&&!re(t),l=s==l;if(l&&!c)return i=i||new De,(a||St(e)?rt:function(e,t,n,r,o,i){switch(s){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case P:return!(e.byteLength!=t.byteLength||!n(new he(e),new he(t)));case m:case _:case k:return bt(+e,+t);case p:return e.name==t.name&&e.message==t.message;case x:case M:return e==t+"";case A:var a=oe;case E:var u=o&v,a=a||ae;if(e.size!=t.size&&!u)return!1;u=i.get(e);if(u)return u==t;o|=g,i.set(e,t);a=rt(a(e),a(t),n,r,o,i);return i.delete(e),a;case T:if(Se)return Se.call(e)==Se.call(t)}return!1})(e,t,n,r,o,i);if(!(o&v)){c=c&&pe.call(e,"__wrapped__"),u=u&&pe.call(t,"__wrapped__");if(c||u)return n(c?e.value():e,u?t.value():t,r,o,i=i||new De)}return l&&function(e,t,n,r,o,i){var a=o&v,u=It(e),s=u.length;if(s!=It(t).length&&!a)return!1;for(var l=s;l--;){var c=u[l];if(!(a?c in t:pe.call(t,c)))return!1}var f=i.get(e);if(f&&i.get(t))return f==t;var p=!0;i.set(e,t),i.set(t,e);for(var y,d=a;++l<s;){var g,h=e[c=u[l]],m=t[c];if(r&&(g=a?r(m,h,c,t,e,i):r(h,m,c,e,t,i)),!(g===b?h===m||n(h,m,r,o,i):g)){p=!1;break}d=d||"constructor"==c}return!p||d||(y=e.constructor)!=(f=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof f&&f instanceof f)&&(p=!1),i.delete(e),i.delete(t),p}(e,t,n,r,o,i=i||new De)}(e,t,Je,n,r,o))}function Ke(e){return"function"==typeof e?e:null==e?Gt:"object"==typeof e?_t(e)?(r=e[0],o=e[1],lt(r)&&ft(o)?pt(dt(r),o):function(e){var t=Lt(e,r);return t===b&&t===o?Ft(e,r):Je(o,t,b,g|v)}):1==(n=function(e){for(var t=It(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,ft(o)]}return t}(t=e)).length&&n[0][2]?pt(n[0][0],n[0][1]):function(e){return e===t||function(e,t,n){var r=t.length,o=r;if(null==e)return!o;for(e=Object(e);r--;){var i=t[r];if(i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++r<o;){var a=(i=t[r])[0],u=e[a],s=i[1];if(i[2]){if(u===b&&!(a in e))return!1}else{var l,a=new De;if(!(l===b?Je(s,u,n,g|v,a):l))return!1}}return!0}(e,n)}:zt(e);var t,n,r,o}function Qe(n){if(!xt(n))return function(){var e=[];if(null!=n)for(var t in Object(n))e.push(t);return e}();var e,t=ct(n),r=[];for(e in n)("constructor"!=e||!t&&pe.call(n,e))&&r.push(e);return r}function Ye(r,o,i,a,u){var s;r!==o&&(_t(o)||St(o)||(s=Qe(o)),te(s||o,function(e,t){var n;s&&(e=o[t=e]),xt(e)?(u=u||new De,function(e,t,n,r,o,i,a){var u=e[n],s=t[n],l=a.get(s);if(l)return $e(e,n,l);l=i?i(u,s,n+"",e,t,a):b,(t=l===b)&&(_t(l=s)||St(s)?l=_t(u)?u:jt(u)?tt(u):ze(s,!(t=!1)):Mt(s)||vt(s)?l=vt(u)?Nt(u):!xt(u)||r&&kt(u)?ze(s,!(t=!1)):u:t=!1),t&&(a.set(s,l),o(l,s,r,i,a),a.delete(s)),$e(e,n,l)}(r,o,t,i,Ye,a,u)):((n=a?a(r[t],e,t+"",r,o,u):b)===b&&(n=e),$e(r,t,n))}))}function Ze(e){return _t(e)?e:yt(e)}function et(e){var t=new e.constructor(e.byteLength);return new he(t).set(new he(e)),t}function tt(e,t){var n=-1,r=e.length;for(t=t||Array(r);++n<r;)t[n]=e[n];return t}function nt(e,t,n,r){n=n||{};for(var o=-1,i=t.length;++o<i;){var a=t[o],u=r?r(n[a],e[a],a,n,e):b;Ge(n,a,u===b?e[a]:u)}return n}function rt(e,t,n,r,o,i){var a=o&v,u=e.length,s=t.length;if(u!=s&&!(a&&u<s))return!1;s=i.get(e);if(s&&i.get(t))return s==t;var l=-1,c=!0,f=o&g?new Re:b;for(i.set(e,t),i.set(t,e);++l<u;){var p,y=e[l],d=t[l];if(r&&(p=a?r(d,y,l,t,e,i):r(y,d,l,e,t,i)),p!==b){if(p)continue;c=!1;break}if(f){if(!function(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return 1}(t,function(e,t){return!f.has(t)&&(y===e||n(y,e,r,o,i))&&f.add(t)})){c=!1;break}}else if(y!==d&&!n(y,d,r,o,i)){c=!1;break}}return i.delete(e),i.delete(t),c}function ot(e,t){var n=e.__data__;return("string"==(e=typeof t)||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t)?n["string"==typeof t?"string":"hash"]:n.map}function it(e,t){e=null==e?b:e[t];return!xt(t=e)||ce&&ce in t||!(kt(t)||re(t)?ge:y).test(gt(t))?b:e}var at=W?ie(W,Object):Wt,ut=function(e){return de.call(e)};function st(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||d.test(e))&&-1<e&&e%1==0&&e<t}function lt(e,t){if(!_t(e)){var n=typeof e;return"number"==n||"symbol"==n||"boolean"==n||null==e||Tt(e)||s.test(e)||!u.test(e)||null!=t&&e in Object(t)}}function ct(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||le)}function ft(e){return e==e&&!xt(e)}function pt(t,n){return function(e){return null!=e&&e[t]===n&&(n!==b||t in Object(e))}}(J&&ut(new J(new ArrayBuffer(1)))!=S||Ae&&ut(new Ae)!=A||ue&&ut(ue.resolve())!=i||Q&&ut(new Q)!=E||V&&ut(new V)!=a)&&(ut=function(e){var t=de.call(e),e=t==O?e.constructor:b,e=e?gt(e):b;if(e)switch(e){case xe:return S;case Ee:return A;case Me:return i;case Te:return E;case Pe:return a}return t});var yt=mt(function(e){e=Bt(e);var o=[];return t.test(e)&&o.push(""),e.replace(l,function(e,t,n,r){o.push(n?r.replace(c,"$1"):t||e)}),o});function dt(e){if("string"==typeof e||Tt(e))return e;var t=e+"";return"0"==t&&1/e==-n?"-0":t}function gt(e){if(null!=e){try{return fe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ht(e,t){return(_t(e)?te:qe)(e,function(e,t){var n=(n=Be.iteratee||Ct)===Ct?Ke:n;return arguments.length?n(e,t):n}(t,3))}function mt(r,o){if("function"!=typeof r||o&&"function"!=typeof o)throw new TypeError(e);var i=function(){var e=arguments,t=o?o.apply(this,e):e[0],n=i.cache;if(n.has(t))return n.get(t);e=r.apply(this,e);return i.cache=n.set(t,e),e};return i.cache=new(mt.Cache||Ie),i}function bt(e,t){return e===t||e!=e&&t!=t}function vt(e){return jt(e)&&pe.call(e,"callee")&&(!ve.call(e,"callee")||de.call(e)==h)}mt.Cache=Ie;var _t=Array.isArray;function wt(e){return null!=e&&Ot(e.length)&&!kt(e)}function jt(e){return Et(e)&&wt(e)}var At=se||qt;function kt(e){e=xt(e)?de.call(e):"";return e==w||e==j}function Ot(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=o}function xt(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Et(e){return!!e&&"object"==typeof e}function Mt(e){if(!Et(e)||de.call(e)!=O||re(e))return!1;e=me(e);if(null===e)return!0;e=pe.call(e,"constructor")&&e.constructor;return"function"==typeof e&&e instanceof e&&fe.call(e)==ye}function Tt(e){return"symbol"==typeof e||Et(e)&&de.call(e)==T}var Pt,St=Y?(Pt=Y,function(e){return Pt(e)}):function(e){return Et(e)&&Ot(e.length)&&!!C[de.call(e)]};function Nt(e){return nt(e,Rt(e))}function Bt(e){return null==e?"":function(e){if("string"==typeof e)return e;if(Tt(e))return Ne?Ne.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}(e)}function Lt(e,t,n){t=null==e?b:Xe(e,t);return t===b?n:t}function Ft(e,t){return null!=e&&function(e,t,n){for(var r,o=-1,i=(t=lt(t,e)?[t]:Ze(t)).length;++o<i;){var a=dt(t[o]);if(!(r=null!=e&&n(e,a)))break;e=e[a]}return r||!!(i=e?e.length:0)&&Ot(i)&&st(a,i)&&(_t(e)||vt(e))}(e,t,He)}function It(e){return(wt(e)?Ue:function(e){if(!ct(e))return we(e);var t,n=[];for(t in Object(e))pe.call(e,t)&&"constructor"!=t&&n.push(t);return n})(e)}function Rt(e){return wt(e)?Ue(e,!0):Qe(e)}var Dt,Ut,$t,Y=(Dt=function(e,t,n){Ye(e,t,n)},Ut=function(e,t){var n=-1,r=t.length,o=1<r?t[r-1]:b,i=2<r?t[2]:b,o=3<Dt.length&&"function"==typeof o?(r--,o):b;for(i&&function(e,t,n){if(xt(n)){var r=typeof t;return("number"==r?wt(n)&&st(t,n.length):"string"==r&&t in n)&&bt(n[t],e)}}(t[0],t[1],i)&&(o=r<3?b:o,r=1),e=Object(e);++n<r;){var a=t[n];a&&Dt(e,a,n)}return e},$t=je($t===b?Ut.length-1:$t,0),function(){for(var e=arguments,t=-1,n=je(e.length-$t,0),r=Array(n);++t<n;)r[t]=e[$t+t];t=-1;for(var o=Array($t+1);++t<$t;)o[t]=e[t];return o[$t]=r,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(Ut,this,o)});function Gt(e){return e}function Ct(e){return Ke("function"==typeof e?e:ze(e,!0))}function zt(e){return lt(e)?(n=dt(e),function(e){return null==e?b:e[n]}):(t=e,function(e){return Xe(e,t)});var t,n}function Wt(){return[]}function qt(){return!1}Be.compact=function(e){for(var t=-1,n=e?e.length:0,r=0,o=[];++t<n;){var i=e[t];i&&(o[r++]=i)}return o},Be.iteratee=Ct,Be.keys=It,Be.keysIn=Rt,Be.memoize=mt,Be.merge=Y,Be.property=zt,Be.toPlainObject=Nt,Be.clone=function(e){return ze(e,!1,!0)},Be.eq=bt,Be.forEach=ht,Be.get=Lt,Be.hasIn=Ft,Be.identity=Gt,Be.isArguments=vt,Be.isArray=_t,Be.isArrayLike=wt,Be.isArrayLikeObject=jt,Be.isBuffer=At,Be.isEmpty=function(e){if(wt(e)&&(_t(e)||"string"==typeof e||"function"==typeof e.splice||At(e)||vt(e)))return!e.length;var t,n=ut(e);if(n==A||n==E)return!e.size;if(Oe||ct(e))return!we(e).length;for(t in e)if(pe.call(e,t))return!1;return!0},Be.isFunction=kt,Be.isLength=Ot,Be.isObject=xt,Be.isObjectLike=Et,Be.isPlainObject=Mt,Be.isSymbol=Tt,Be.isTypedArray=St,Be.stubArray=Wt,Be.stubFalse=qt,Be.toString=Bt,Be.each=ht,Be.VERSION="4.15.0",H&&((H.exports=Be)._=Be,X._=Be)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){var l=e("wgs84");function o(e){var t=0;if(e&&0<e.length){t+=Math.abs(r(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(r(e[n]))}return t}function r(e){var t,n,r,o,i,a,u=0,s=e.length;if(2<s){for(a=0;a<s;a++)i=a===s-2?(r=s-2,o=s-1,0):a===s-1?(r=s-1,o=0,1):(o=(r=a)+1,a+2),t=e[r],n=e[o],u+=(c(e[i][0])-c(t[0]))*Math.sin(c(n[1]));u=u*l.RADIUS*l.RADIUS/2}return u}function c(e){return e*Math.PI/180}t.exports.geometry=function e(t){var n,r=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)r+=o(t.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)r+=e(t.geometries[n]);return r}},t.exports.ring=r},{wgs84:7}],4:[function(e,t,n){var r=e("@mapbox/geojson-area");function i(t,n){return function(e){return t(e,n)}}function a(e,t){t=!!t,e[0]=o(e[0],t);for(var n=1;n<e.length;n++)e[n]=o(e[n],!t);return e}function o(e,t){return 0<=r.ring(e)===t?e:e.reverse()}t.exports=function e(t,n){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(i(e,n)),t;case"GeometryCollection":return t.geometries=t.geometries.map(i(e,n)),t;case"Feature":return t.geometry=e(t.geometry,n),t;case"Polygon":case"MultiPolygon":return o=n,"Polygon"===(r=t).type?r.coordinates=a(r.coordinates,o):"MultiPolygon"===r.type&&(r.coordinates=r.coordinates.map(i(a,o))),r;default:return t}var r,o}},{"@mapbox/geojson-area":3}],5:[function(e,t,n){t.exports=e("./polygon-features.json")},{"./polygon-features.json":6}],6:[function(e,t,n){t.exports=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}]},{}],7:[function(e,t,n){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},{}]},{},[1])(1)});
function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=_superPropBase(e,t);if(n){n=Object.getOwnPropertyDescriptor(n,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof3(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty3(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return s};var s={},e=Object.prototype,u=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,r){return e[t]=r}}function a(e,t,r,n){var i,o,s,a,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new w(n||[]);return t._invoke=(i=e,o=r,s=n,a="suspendedStart",function(e,t){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===e)throw t;return _()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){var n=function e(t,r){var n=t.iterator[r.method];if(void 0===n){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method))return c;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}n=l(n,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,c;var n=n.arg;return n?n.done?(r[t.resultName]=n.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,c):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,c)}(r,s);if(n){if(n===c)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";n=l(i,o,s);if("normal"===n.type){if(a=s.done?"completed":"suspendedYield",n.arg===c)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(a="completed",s.method="throw",s.arg=n.arg)}}),t}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}s.wrap=a;var c={};function h(){}function p(){}function f(){}var d={};o(d,n,function(){return this});t=Object.getPrototypeOf,t=t&&t(t(x([])));t&&t!==e&&u.call(t,n)&&(d=t);var y=f.prototype=h.prototype=Object.create(d);function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function g(s,a){var t;this._invoke=function(r,n){function e(){return new a(function(e,t){!function t(e,r,n,i){e=l(s[e],s,r);if("throw"!==e.type){var o=e.arg,r=o.value;return r&&"object"==_typeof3(r)&&u.call(r,"__await")?a.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):a.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)})}i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function x(t){if(t){var e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return e.next=e}}return{next:_}}function _(){return{value:void 0,done:!0}}return o(y,"constructor",p.prototype=f),o(f,"constructor",p),p.displayName=o(f,i,"GeneratorFunction"),s.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,o(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},s.awrap=function(e){return{__await:e}},m(g.prototype),o(g.prototype,r,function(){return this}),s.AsyncIterator=g,s.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new g(a(e,t,r,n),i);return s.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(y),o(y,i,"Generator"),o(y,n,function(){return this}),o(y,"toString",function(){return"[object Generator]"}),s.keys=function(r){var e,n=[];for(e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=x,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var s=u.call(i,"catchLoc"),a=u.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),b(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n,i=r.completion;return"throw"===i.type&&(n=i.arg,b(r)),n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},s}function _classCallCheck2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass2(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toConsumableArray3(e){return _arrayWithoutHoles2(e)||_iterableToArray2(e)||_unsupportedIterableToArray2(e)||_nonIterableSpread2()}function _nonIterableSpread2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray2(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles2(e){if(Array.isArray(e))return _arrayLikeToArray2(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray2(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray2(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray2(e,t):void 0}}function _arrayLikeToArray2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof3(e){return(_typeof3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function n(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return a(i[t][1][e]||e)},r,r.exports,n,i,o,s)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,r){var n=e("overpass-frontend"),i=e("./src/OverpassLayer"),e=e("./src/OverpassLayerList");"undefined"!=typeof window&&(window.OverpassLayer=i,window.OverpassLayerList=e,window.OverpassFrontend=n),i.List=e,t.exports=i},{"./src/OverpassLayer":281,"./src/OverpassLayerList":283,"overpass-frontend":232}],2:[function(e,t,r){var l=e("wgs84");function i(e){var t=0;if(e&&0<e.length){t+=Math.abs(n(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(n(e[r]))}return t}function n(e){var t,r,n,i,o,s,a=0,u=e.length;if(2<u){for(s=0;s<u;s++)o=s===u-2?(n=u-2,i=u-1,0):s===u-1?(n=u-1,i=0,1):(i=(n=s)+1,s+2),t=e[n],r=e[i],a+=(c(e[o][0])-c(t[0]))*Math.sin(c(r[1]));a=a*l.RADIUS*l.RADIUS/2}return a}function c(e){return e*Math.PI/180}t.exports.geometry=function e(t){var r,n=0;switch(t.type){case"Polygon":return i(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)n+=i(t.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<t.geometries.length;r++)n+=e(t.geometries[r]);return n}},t.exports.ring=n},{wgs84:274}],3:[function(e,t,r){var n=e("@mapbox/geojson-area");function i(t,r){return function(e){return t(e,r)}}function o(e,t){return"Polygon"===e.type?e.coordinates=s(e.coordinates,t):"MultiPolygon"===e.type&&(e.coordinates=e.coordinates.map(i(s,t))),e}function s(e,t){t=!!t,e[0]=a(e[0],t);for(var r=1;r<e.length;r++)e[r]=a(e[r],!t);return e}function a(e,t){return r=e,0<=n.ring(r)===t?e:e.reverse();var r}t.exports=function e(t,r){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(i(e,r)),t;case"GeometryCollection":return t.geometries=t.geometries.map(i(e,r)),t;case"Feature":return t.geometry=e(t.geometry,r),t;case"Polygon":case"MultiPolygon":return o(t,r);default:return t}}},{"@mapbox/geojson-area":2}],4:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var u=n(e("@turf/bearing")),l=n(e("@turf/destination")),c=n(e("@turf/distance")),h=e("@turf/helpers"),p=e("@turf/invariant");r.default=function(e,t,r){void 0===r&&(r={});for(var n=p.getGeom(e).coordinates,i=0,o=0;o<n.length&&!(i<=t&&o===n.length-1);o++){if(t<=i){var s=t-i;if(s){var a=u.default(n[o],n[o-1])-180;return l.default(n[o],s,a,r)}return h.point(n[o])}i+=c.default(n[o],n[o+1],r)}return h.point(n[n.length-1])}},{"@turf/bearing":5,"@turf/destination":6,"@turf/distance":7,"@turf/helpers":8,"@turf/invariant":9}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("@turf/helpers"),s=e("@turf/invariant");function a(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){e=a(t,e);return e=(e+180)%360}(e,t);var n=s.getCoord(e),i=s.getCoord(t),r=o.degreesToRadians(n[0]),e=o.degreesToRadians(i[0]),t=o.degreesToRadians(n[1]),n=o.degreesToRadians(i[1]),i=Math.sin(e-r)*Math.cos(n),r=Math.cos(t)*Math.sin(n)-Math.sin(t)*Math.cos(n)*Math.cos(e-r);return o.radiansToDegrees(Math.atan2(i,r))}r.default=a},{"@turf/helpers":8,"@turf/invariant":9}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("@turf/helpers"),a=e("@turf/invariant");r.default=function(e,t,r,n){void 0===n&&(n={});var i=a.getCoord(e),o=s.degreesToRadians(i[0]),e=s.degreesToRadians(i[1]),i=s.degreesToRadians(r),r=s.lengthToRadians(t,n.units),t=Math.asin(Math.sin(e)*Math.cos(r)+Math.cos(e)*Math.sin(r)*Math.cos(i)),e=o+Math.atan2(Math.sin(i)*Math.sin(r)*Math.cos(e),Math.cos(r)-Math.sin(e)*Math.sin(t)),e=s.radiansToDegrees(e),t=s.radiansToDegrees(t);return s.point([e,t],n.properties)}},{"@turf/helpers":8,"@turf/invariant":9}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("@turf/invariant"),s=e("@turf/helpers");r.default=function(e,t,r){void 0===r&&(r={});var n=o.getCoord(e),i=o.getCoord(t),e=s.degreesToRadians(i[1]-n[1]),t=s.degreesToRadians(i[0]-n[0]),n=s.degreesToRadians(n[1]),i=s.degreesToRadians(i[1]),i=Math.pow(Math.sin(e/2),2)+Math.pow(Math.sin(t/2),2)*Math.cos(n)*Math.cos(i);return s.radiansToLength(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),r.units)}},{"@turf/helpers":8,"@turf/invariant":9}],8:[function(e,t,n){"use strict";function a(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return 0!==r.id&&!r.id||(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function i(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(e[0])||!d(e[1]))throw new Error("coordinates must contain numbers");return a({type:"Point",coordinates:e},t,r)}function o(e,t,r){void 0===r&&(r={});for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:e},t,r)}function s(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:e},t,r)}function u(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function l(e,t,r){return void 0===r&&(r={}),a({type:"MultiLineString",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),a({type:"MultiPoint",coordinates:e},t,r)}function h(e,t,r){return void 0===r&&(r={}),a({type:"MultiPolygon",coordinates:e},t,r)}function p(e,t){void 0===t&&(t="kilometers");var r=n.factors[t];if(!r)throw new Error(t+" units is invalid");return e*r}function f(e,t){void 0===t&&(t="kilometers");var r=n.factors[t];if(!r)throw new Error(t+" units is invalid");return e/r}function r(e){return 180*(e%(2*Math.PI))/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.earthRadius=6371008.8,n.factors={centimeters:100*n.earthRadius,centimetres:100*n.earthRadius,degrees:n.earthRadius/111325,feet:3.28084*n.earthRadius,inches:39.37*n.earthRadius,kilometers:n.earthRadius/1e3,kilometres:n.earthRadius/1e3,meters:n.earthRadius,metres:n.earthRadius,miles:n.earthRadius/1609.344,millimeters:1e3*n.earthRadius,millimetres:1e3*n.earthRadius,nauticalmiles:n.earthRadius/1852,radians:1,yards:1.0936*n.earthRadius},n.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/n.earthRadius,yards:1.0936133},n.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},n.feature=a,n.geometry=function(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return i(t).geometry;case"LineString":return s(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return c(t).geometry;case"MultiLineString":return l(t).geometry;case"MultiPolygon":return h(t).geometry;default:throw new Error(e+" is invalid")}},n.point=i,n.points=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return i(e,t)}),r)},n.polygon=o,n.polygons=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return o(e,t)}),r)},n.lineString=s,n.lineStrings=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return s(e,t)}),r)},n.featureCollection=u,n.multiLineString=l,n.multiPoint=c,n.multiPolygon=h,n.geometryCollection=function(e,t,r){return void 0===r&&(r={}),a({type:"GeometryCollection",geometries:e},t,r)},n.round=function(e,t){if(void 0===t&&(t=0),t&&!(0<=t))throw new Error("precision must be a positive number");return t=Math.pow(10,t||0),Math.round(e*t)/t},n.radiansToLength=p,n.lengthToRadians=f,n.lengthToDegrees=function(e,t){return r(f(e,t))},n.bearingToAzimuth=function(e){return(e%=360)<0&&(e+=360),e},n.radiansToDegrees=r,n.degreesToRadians=function(e){return e%360*Math.PI/180},n.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(0<=e))throw new Error("length must be a positive number");return p(f(e,t),r)},n.convertArea=function(e,t,r){if(void 0===t&&(t="meters"),void 0===r&&(r="kilometers"),!(0<=e))throw new Error("area must be a positive number");if(!(t=n.areaFactors[t]))throw new Error("invalid original units");if(!(r=n.areaFactors[r]))throw new Error("invalid final units");return e/t*r},n.isNumber=d,n.isObject=function(e){return!!e&&e.constructor===Object},n.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!d(e))throw new Error("bbox must only contain numbers")})},n.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(_typeof3(e)))throw new Error("id must be a number or a string")}},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("@turf/helpers");r.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&2<=e.length&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},r.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},r.containsNumber=function e(t){if(1<t.length&&n.isNumber(t[0])&&n.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},r.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},r.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},r.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var o=i[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+o.geometry.type)}},r.getGeom=function(e){return"Feature"===e.type?e.geometry:e},r.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":("Feature"===e.type&&null!==e.geometry?e.geometry:e).type}},{"@turf/helpers":8}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("@turf/meta");r.default=function(e){var t=[1/0,1/0,-1/0,-1/0];return n.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}},{"@turf/meta":57}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("@turf/helpers"),s=e("@turf/invariant");function a(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){e=a(t,e);return e=(e+180)%360}(e,t);var n=s.getCoord(e),i=s.getCoord(t),r=o.degreesToRadians(n[0]),e=o.degreesToRadians(i[0]),t=o.degreesToRadians(n[1]),n=o.degreesToRadians(i[1]),i=Math.sin(e-r)*Math.cos(n),r=Math.cos(t)*Math.sin(n)-Math.sin(t)*Math.cos(n)*Math.cos(e-r);return o.radiansToDegrees(Math.atan2(i,r))}r.default=a},{"@turf/helpers":45,"@turf/invariant":49}],12:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var u=n(e("@turf/boolean-point-in-polygon")),l=n(e("@turf/line-intersect")),i=e("@turf/meta"),c=n(e("@turf/polygon-to-line"));function o(e,t){for(var r=0;r<e.coordinates.length-1;r++)if(function(e,t,r){var n=r[0]-e[0],i=r[1]-e[1],o=t[0]-e[0],s=t[1]-e[1];if(n*s-i*o!=0)return!1;return Math.abs(o)>=Math.abs(s)?0<o?e[0]<=r[0]&&r[0]<=t[0]:t[0]<=r[0]&&r[0]<=e[0]:0<s?e[1]<=r[1]&&r[1]<=t[1]:t[1]<=r[1]&&r[1]<=e[1]}(e.coordinates[r],e.coordinates[r+1],t.coordinates))return 1}function s(e,t){for(var r=0,n=t.coordinates;r<n.length;r++){var i=n[r];if(u.default(i,e))return 1}return 0<l.default(t,c.default(e)).features.length}r.default=function(e,r){var n=!0;return i.flattenEach(e,function(t){i.flattenEach(r,function(e){return!1!==n&&void(n=function(e,t){switch(e.type){case"Point":switch(t.type){case"Point":return!function(e,t){return e[0]===t[0]&&e[1]===t[1]}(e.coordinates,t.coordinates);case"LineString":return!o(t,e);case"Polygon":return!u.default(e,t)}break;case"LineString":switch(t.type){case"Point":return!o(e,t);case"LineString":return!function(e,t){if(0<l.default(e,t).features.length)return!0;return!1}(e,t);case"Polygon":return!s(t,e)}break;case"Polygon":switch(t.type){case"Point":return!u.default(t,e);case"LineString":return!s(e,t);case"Polygon":return!function(e,t){for(var r=0,n=e.coordinates[0];r<n.length;r++){var i=n[r];if(u.default(i,t))return!0}for(var o=0,s=t.coordinates[0];o<s.length;o++){var a=s[o];if(u.default(a,e))return!0}if(0<l.default(c.default(e),c.default(t)).features.length)return!0;return!1}(t,e)}}return!1}(t.geometry,e.geometry))})}),n}},{"@turf/boolean-point-in-polygon":13,"@turf/line-intersect":16,"@turf/meta":18,"@turf/polygon-to-line":68}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=e("@turf/invariant");function h(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var i=0,o=t.length-1;i<t.length;o=i++){var s=t[i][0],a=t[i][1],u=t[o][0],l=t[o][1];if(e[1]*(s-u)+a*(u-e[0])+l*(e[0]-s)==0&&(s-e[0])*(u-e[0])<=0&&(a-e[1])*(l-e[1])<=0)return!r;a>e[1]!=l>e[1]&&e[0]<(u-s)*(e[1]-a)/(l-a)+s&&(n=!n)}return n}r.default=function(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n,i=c.getCoord(e),e=(n=c.getGeom(t)).type,t=t.bbox,o=n.coordinates;if(t&&!1==(n=i,(t=t)[0]<=n[0]&&t[1]<=n[1]&&t[2]>=n[0]&&t[3]>=n[1]))return!1;"Polygon"===e&&(o=[o]);for(var s=!1,a=0;a<o.length&&!s;a++)if(h(i,o[a][0],r.ignoreBoundary)){for(var u=!1,l=1;l<o[a].length&&!u;)h(i,o[a][l],!r.ignoreBoundary)&&(u=!0),l++;u||(s=!0)}return s}},{"@turf/invariant":15}],14:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],15:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":14,dup:9}],16:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var l=e("@turf/helpers"),c=e("@turf/invariant"),s=n(e("@turf/line-segment")),a=e("@turf/meta"),u=n(e("geojson-rbush"));function h(e,t){var r=c.getCoords(e),n=c.getCoords(t);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=r[0][0],o=r[0][1],s=r[1][0],a=r[1][1],u=n[0][0],e=n[0][1],t=n[1][0],r=n[1][1],n=(r-e)*(s-i)-(t-u)*(a-o),r=(t-u)*(o-e)-(r-e)*(i-u),u=(s-i)*(o-e)-(a-o)*(i-u);if(0==n)return null;r/=n,n=u/n;if(0<=r&&r<=1&&0<=n&&n<=1){i=i+r*(s-i),o=o+r*(a-o);return l.point([i,o])}return null}r.default=function(e,t){var n={},i=[];if("LineString"===e.type&&(e=l.feature(e)),"LineString"===t.type&&(t=l.feature(t)),"Feature"===e.type&&"Feature"===t.type&&null!==e.geometry&&null!==t.geometry&&"LineString"===e.geometry.type&&"LineString"===t.geometry.type&&2===e.geometry.coordinates.length&&2===t.geometry.coordinates.length){var r=h(e,t);return r&&i.push(r),l.featureCollection(i)}var o=u.default();return o.load(s.default(t)),a.featureEach(s.default(e),function(r){a.featureEach(o.search(r),function(e){var t=h(r,e);t&&(e=c.getCoords(t).join(","),n[e]||(n[e]=!0,i.push(t)))})}),l.featureCollection(i)}},{"@turf/helpers":14,"@turf/invariant":15,"@turf/line-segment":17,"@turf/meta":18,"geojson-rbush":96}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=e("@turf/helpers"),i=e("@turf/invariant"),n=e("@turf/meta");r.default=function(e){if(!e)throw new Error("geojson is required");var t=[];return n.flattenEach(e,function(e){!function(t,r){var e=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":e=i.getCoords(n);break;case"LineString":e=[i.getCoords(n)]}e.forEach(function(e){var s,a;(e=e,s=t.properties,a=[],e.reduce(function(e,t){var r,n,i,o=u.lineString([e,t],s);return o.bbox=(n=t,i=(r=e)[0],e=r[1],r=n[0],n=n[1],[i<r?i:r,e<n?e:n,r<i?i:r,n<e?e:n]),a.push(o),t}),a).forEach(function(e){e.id=r.length,r.push(e)})})}}(e,t)}),u.featureCollection(t)}},{"@turf/helpers":14,"@turf/invariant":15,"@turf/meta":18}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=e("@turf/helpers");function _(e,t,r){if(null!==e)for(var n,i,o,s,a,u,l,c=0,h=e.type,p="FeatureCollection"===h,f="Feature"===h,d=p?e.features.length:1,y=0;y<d;y++){s=(l=!!(u=p?e.features[y].geometry:f?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var m=0;m<s;m++){var g,v=0,b=0;if(null!==(g=l?u.geometries[m]:u)){a=g.coordinates;var w=g.type,x=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1;switch(w){case null:break;case"Point":if(!1===t(a,c,y,v,b))return!1;c++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(!1===t(a[n],c,y,v,b))return!1;c++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-x;i++){if(!1===t(a[n][i],c,y,v,b))return!1;c++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for(i=b=0;i<a[n].length;i++){for(o=0;o<a[n][i].length-x;o++){if(!1===t(a[n][i][o],c,y,v,b))return!1;c++}b++}v++}break;case"GeometryCollection":for(n=0;n<g.geometries.length;n++)if(!1===_(g.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function s(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function n(e,t){for(var r,n,i,o,s,a,u,l,c,h=0,p="FeatureCollection"===e.type,f="Feature"===e.type,d=p?e.features.length:1,y=0;y<d;y++){for(s=p?e.features[y].geometry:f?e.geometry:e,u=p?e.features[y].properties:f?e.properties:{},l=p?e.features[y].bbox:f?e.bbox:void 0,c=p?e.features[y].id:f?e.id:void 0,o=(a=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(i=a?s.geometries[n]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,u,l,c))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],h,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,u,l,c))return!1;h++}}function a(e,l){n(e,function(e,t,r,n,i){var o,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1===l(d.feature(e,r,{bbox:n,id:i}),t,0)?!1:void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<e.coordinates.length;a++){var u={type:o,coordinates:e.coordinates[a]};if(!1===l(d.feature(u,r),t,a))return!1}})}function i(e,f){a(e,function(o,s,a){var u=0;if(o.geometry){var e=o.geometry.type;if("Point"!==e&&"MultiPoint"!==e){var l,c=0,h=0,p=0;return!1!==_(o,function(e,t,r,n,i){if(void 0===l||c<s||h<n||p<i)return l=e,c=s,h=n,p=i,void(u=0);n=d.lineString([l,e],o.properties);if(!1===f(n,s,a,i,u))return!1;u++,l=e})&&void 0}}})}function u(e,s){if(!e)throw new Error("geojson is required");a(e,function(e,t,r){if(null!==e.geometry){var n=e.geometry.type,i=e.geometry.coordinates;switch(n){case"LineString":if(!1===s(e,t,r,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===s(d.lineString(i[o],e.properties),t,r,o))return!1}}})}r.coordAll=function(e){var t=[];return _(e,function(e){t.push(e)}),t},r.coordEach=_,r.coordReduce=function(e,o,s,t){var a=s;return _(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)},t),a},r.featureEach=s,r.featureReduce=function(e,r,n){var i=n;return s(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.findPoint=function(e,t){if(t=t||{},!d.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.coordIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return d.point(u,a,t);case"MultiPoint":return i<0&&(i=u.length+i),d.point(u[i],a,t);case"LineString":return s<0&&(s=u.length+s),d.point(u[s],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),d.point(u[o][s],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),d.point(u[i][s],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s),d.point(u[i][o][s],a,t)}throw new Error("geojson is invalid")},r.findSegment=function(e,t){if(t=t||{},!d.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.segmentIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),d.lineString([u[s],u[s+1]],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),d.lineString([u[o][s],u[o][s+1]],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s-1),d.lineString([u[i][s],u[i][s+1]],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s-1),d.lineString([u[i][o][s],u[i][o][s+1]],a,t)}throw new Error("geojson is invalid")},r.flattenEach=a,r.flattenReduce=function(e,n,i){var o=i;return a(e,function(e,t,r){o=0===t&&0===r&&void 0===i?e:n(o,e,t,r)}),o},r.geomEach=n,r.geomReduce=function(e,o,s){var a=s;return n(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)}),a},r.lineEach=u,r.lineReduce=function(e,i,o){var s=o;return u(e,function(e,t,r,n){s=0===t&&void 0===o?e:i(s,e,t,r,n)}),s},r.propEach=o,r.propReduce=function(e,r,n){var i=n;return o(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.segmentEach=i,r.segmentReduce=function(e,o,s){var a=s,u=!1;return i(e,function(e,t,r,n,i){a=!1===u&&void 0===s?e:o(a,e,t,r,n,i),u=!0}),a}},{"@turf/helpers":14}],19:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("@turf/boolean-disjoint")),o=e("@turf/meta");r.default=function(e,r){var n=!1;return o.flattenEach(e,function(t){o.flattenEach(r,function(e){return!0===n||void(n=!i.default(t.geometry,e.geometry))})}),n}},{"@turf/boolean-disjoint":12,"@turf/meta":21}],20:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],21:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"@turf/helpers":20,dup:18}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=e("@turf/invariant");function h(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var i=0,o=t.length-1;i<t.length;o=i++){var s=t[i][0],a=t[i][1],u=t[o][0],l=t[o][1];if(e[1]*(s-u)+a*(u-e[0])+l*(e[0]-s)==0&&(s-e[0])*(u-e[0])<=0&&(a-e[1])*(l-e[1])<=0)return!r;a>e[1]!=l>e[1]&&e[0]<(u-s)*(e[1]-a)/(l-a)+s&&(n=!n)}return n}r.default=function(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n,i=c.getCoord(e),e=(n=c.getGeom(t)).type,t=t.bbox,o=n.coordinates;if(t&&!1==(n=i,(t=t)[0]<=n[0]&&t[1]<=n[1]&&t[2]>=n[0]&&t[3]>=n[1]))return!1;"Polygon"===e&&(o=[o]);for(var s=!1,a=0;a<o.length&&!s;a++)if(h(i,o[a][0],r.ignoreBoundary)){for(var u=!1,l=1;l<o[a].length&&!u;)h(i,o[a][l],!r.ignoreBoundary)&&(u=!0),l++;u||(s=!0)}return s}},{"@turf/invariant":49}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("@turf/invariant");r.default=function(e,t,r){void 0===r&&(r={});for(var n=a.getCoord(e),i=a.getCoords(t),o=0;o<i.length-1;o++){var s=!1;if(r.ignoreEndVertices&&(0===o&&(s="start"),o===i.length-2&&(s="end"),0===o&&o+1===i.length-1&&(s="both")),function(e,t,r,n,i){var o=r[0],s=r[1],a=e[0],u=e[1],l=t[0],c=t[1],h=r[0]-a,e=r[1]-u,t=l-a,r=c-u,e=h*r-e*t;if(null!==i){if(Math.abs(e)>i)return!1}else if(0!=e)return!1;{if(!n)return Math.abs(t)>=Math.abs(r)?0<t?a<=o&&o<=l:l<=o&&o<=a:0<r?u<=s&&s<=c:c<=s&&s<=u;if("start"===n)return Math.abs(t)>=Math.abs(r)?0<t?a<o&&o<=l:l<=o&&o<a:0<r?u<s&&s<=c:c<=s&&s<u;if("end"===n)return Math.abs(t)>=Math.abs(r)?0<t?a<=o&&o<l:l<o&&o<=a:0<r?u<=s&&s<c:c<s&&s<=u;if("both"===n)return Math.abs(t)>=Math.abs(r)?0<t?a<o&&o<l:l<o&&o<a:0<r?u<s&&s<c:c<s&&s<u}return!1}(i[o],i[o+1],n,s,void 0===r.epsilon?null:r.epsilon))return!0}return!1}},{"@turf/invariant":25}],24:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],25:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":24,dup:9}],26:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var a=n(e("@turf/bbox")),s=n(e("@turf/boolean-point-on-line")),u=n(e("@turf/boolean-point-in-polygon")),l=e("@turf/invariant");function c(e,t){return!(e[0]>t[0])&&(!(e[2]<t[2])&&(!(e[1]>t[1])&&!(e[3]<t[3])))}function h(e,t){return e[0]===t[0]&&e[1]===t[1]}r.default=function(e,t){var r=l.getGeom(e),n=l.getGeom(t),i=r.type,o=n.type;switch(i){case"Point":switch(o){case"MultiPoint":return function(e,t){var r,n=!1;for(r=0;r<t.coordinates.length;r++)if(h(t.coordinates[r],e.coordinates)){n=!0;break}return n}(r,n);case"LineString":return s.default(r,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return u.default(r,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(e,t){for(var r=0;r<e.coordinates.length;r++){for(var n=!1,i=0;i<t.coordinates.length;i++)h(e.coordinates[r],t.coordinates[i])&&(n=!0);if(!n)return!1}return!0}(r,n);case"LineString":return function(e,t){for(var r=!1,n=0;n<e.coordinates.length;n++){if(!s.default(e.coordinates[n],t))return!1;r=r||s.default(e.coordinates[n],t,{ignoreEndVertices:!0})}return r}(r,n);case"Polygon":case"MultiPolygon":return function(e,t){for(var r=!0,n=!1,i=0;i<e.coordinates.length;i++){if(!(n=u.default(e.coordinates[1],t))){r=!1;break}n=u.default(e.coordinates[1],t,{ignoreBoundary:!0})}return r&&n}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(e,t){for(var r=0;r<e.coordinates.length;r++)if(!s.default(e.coordinates[r],t))return!1;return!0}(r,n);case"Polygon":case"MultiPolygon":return function(e,t){var r=a.default(t),n=a.default(e);if(!c(r,n))return!1;for(var i=!1,o=0;o<e.coordinates.length-1;o++){if(!u.default(e.coordinates[o],t))return!1;var s;(i=i||u.default(e.coordinates[o],t,{ignoreBoundary:!0}))||(s=function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}(e.coordinates[o],e.coordinates[o+1]),i=u.default(s,t,{ignoreBoundary:!0}))}return i}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(e,t){var r=a.default(e);if(!c(a.default(t),r))return!1;for(var n=0;n<e.coordinates[0].length;n++)if(!u.default(e.coordinates[0][n],t))return!1;return!0}(r,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+i+" geometry not supported")}}},{"@turf/bbox":27,"@turf/boolean-point-in-polygon":28,"@turf/boolean-point-on-line":23,"@turf/invariant":30}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("@turf/meta");function i(e){var t=[1/0,1/0,-1/0,-1/0];return n.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}i.default=i,r.default=i},{"@turf/meta":31}],28:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"@turf/invariant":30,dup:13}],29:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],30:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":29,dup:9}],31:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"@turf/helpers":29,dup:18}],32:[function(e,t,r){"use strict";var n,i=(n=e("@turf/bbox"))&&"object"===_typeof3(n)&&"default"in n?n.default:n,o=e("@turf/helpers");function s(e,t){if(t=t||{},!o.isObject(t))throw new Error("options is invalid");var r=t.properties;if(!e)throw new Error("geojson is required");t=i(e),e=(t[0]+t[2])/2,t=(t[1]+t[3])/2;return o.point([e,t],r)}t.exports=s,t.exports.default=s},{"@turf/bbox":33,"@turf/helpers":34}],33:[function(e,t,r){"use strict";var n=e("@turf/meta");function i(e){var t=[1/0,1/0,-1/0,-1/0];return n.coordEach(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}t.exports=i,t.exports.default=i},{"@turf/meta":35}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=6371008.8,i={meters:n,metres:n,millimeters:1e3*n,millimetres:1e3*n,centimeters:100*n,centimetres:100*n,kilometers:n/1e3,kilometres:n/1e3,miles:n/1609.344,nauticalmiles:n/1852,inches:39.37*n,yards:n/1.0936,feet:3.28084*n,radians:1,degrees:n/111325},o={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/n,degrees:1/111325},s={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function a(e,t,r){if(!b(r=r||{}))throw new Error("options is invalid");var n=r.bbox,i=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&w(n),i&&x(i);r={type:"Feature"};return i&&(r.id=i),n&&(r.bbox=n),r.properties=t||{},r.geometry=e,r}function u(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!v(e[0])||!v(e[1]))throw new Error("coordinates must contain numbers");return a({type:"Point",coordinates:e},t,r)}function l(e,t,r){if(!e)throw new Error("coordinates is required");for(var n=0;n<e.length;n++){var i=e[n];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++){if(0===n&&0===o&&!v(i[0][0])||!v(i[0][1]))throw new Error("coordinates must contain numbers");if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}}return a({type:"Polygon",coordinates:e},t,r)}function c(e,t,r){if(!e)throw new Error("coordinates is required");if(e.length<2)throw new Error("coordinates must be an array of two or more positions");if(!v(e[0][1])||!v(e[0][1]))throw new Error("coordinates must contain numbers");return a({type:"LineString",coordinates:e},t,r)}function h(e,t){if(!b(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");r&&w(r),n&&x(n);t={type:"FeatureCollection"};return n&&(t.id=n),r&&(t.bbox=r),t.features=e,t}function p(e,t,r){if(!e)throw new Error("coordinates is required");return a({type:"MultiLineString",coordinates:e},t,r)}function f(e,t,r){if(!e)throw new Error("coordinates is required");return a({type:"MultiPoint",coordinates:e},t,r)}function d(e,t,r){if(!e)throw new Error("coordinates is required");return a({type:"MultiPolygon",coordinates:e},t,r)}function y(e,t){if(null==e)throw new Error("radians is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");var r=i[t||"kilometers"];if(!r)throw new Error(t+" units is invalid");return e*r}function m(e,t){if(null==e)throw new Error("distance is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");var r=i[t||"kilometers"];if(!r)throw new Error(t+" units is invalid");return e/r}function g(e){if(null==e)throw new Error("radians is required");return 180*(e%(2*Math.PI))/Math.PI}function v(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function b(e){return!!e&&e.constructor===Object}function w(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!v(e))throw new Error("bbox must only contain numbers")})}function x(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(_typeof3(e)))throw new Error("id must be a number or a string")}r.earthRadius=n,r.factors=i,r.unitsFactors=o,r.areaFactors=s,r.feature=a,r.geometry=function(e,t,r){if(!b(r=r||{}))throw new Error("options is invalid");var n,r=r.bbox;if(!e)throw new Error("type is required");if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");switch(r&&w(r),e){case"Point":n=u(t).geometry;break;case"LineString":n=c(t).geometry;break;case"Polygon":n=l(t).geometry;break;case"MultiPoint":n=f(t).geometry;break;case"MultiLineString":n=p(t).geometry;break;case"MultiPolygon":n=d(t).geometry;break;default:throw new Error(e+" is invalid")}return r&&(n.bbox=r),n},r.point=u,r.points=function(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return h(e.map(function(e){return u(e,t)}),r)},r.polygon=l,r.polygons=function(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return h(e.map(function(e){return l(e,t)}),r)},r.lineString=c,r.lineStrings=function(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");return h(e.map(function(e){return c(e,t)}),r)},r.featureCollection=h,r.multiLineString=p,r.multiPoint=f,r.multiPolygon=d,r.geometryCollection=function(e,t,r){if(!e)throw new Error("geometries is required");if(!Array.isArray(e))throw new Error("geometries must be an Array");return a({type:"GeometryCollection",geometries:e},t,r)},r.round=function(e,t){if(null==e||isNaN(e))throw new Error("num is required");if(t&&!(0<=t))throw new Error("precision must be a positive number");return t=Math.pow(10,t||0),Math.round(e*t)/t},r.radiansToLength=y,r.lengthToRadians=m,r.lengthToDegrees=function(e,t){return g(m(e,t))},r.bearingToAzimuth=function(e){if(null==e)throw new Error("bearing is required");return(e%=360)<0&&(e+=360),e},r.radiansToDegrees=g,r.degreesToRadians=function(e){if(null==e)throw new Error("degrees is required");return e%360*Math.PI/180},r.convertLength=function(e,t,r){if(null==e)throw new Error("length is required");if(!(0<=e))throw new Error("length must be a positive number");return y(m(e,t),r||"kilometers")},r.convertArea=function(e,t,r){if(null==e)throw new Error("area is required");if(!(0<=e))throw new Error("area must be a positive number");if(!(t=s[t||"meters"]))throw new Error("invalid original units");if(!(r=s[r||"kilometers"]))throw new Error("invalid final units");return e/t*r},r.isNumber=v,r.isObject=b,r.validateBBox=w,r.validateId=x,r.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},r.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},r.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},r.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},r.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},r.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},r.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var p=e("@turf/helpers");function _(e,t,r){if(null!==e)for(var n,i,o,s,a,u,l,c=0,h=e.type,p="FeatureCollection"===h,f="Feature"===h,d=p?e.features.length:1,y=0;y<d;y++){s=(l=!!(u=p?e.features[y].geometry:f?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var m=0;m<s;m++){var g,v=0,b=0;if(null!==(g=l?u.geometries[m]:u)){a=g.coordinates;var w=g.type,x=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1;switch(w){case null:break;case"Point":if(!1===t(a,c,y,v,b))return!1;c++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(!1===t(a[n],c,y,v,b))return!1;c++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-x;i++){if(!1===t(a[n][i],c,y,v,b))return!1;c++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for("MultiPolygon"===w&&(b=0),i=0;i<a[n].length;i++){for(o=0;o<a[n][i].length-x;o++){if(!1===t(a[n][i][o],c,y,v,b))return!1;c++}b++}v++}break;case"GeometryCollection":for(n=0;n<g.geometries.length;n++)if(!1===_(g.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function s(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function n(e,t){for(var r,n,i,o,s,a,u,l,c,h=0,p="FeatureCollection"===e.type,f="Feature"===e.type,d=p?e.features.length:1,y=0;y<d;y++){for(s=p?e.features[y].geometry:f?e.geometry:e,u=p?e.features[y].properties:f?e.properties:{},l=p?e.features[y].bbox:f?e.bbox:void 0,c=p?e.features[y].id:f?e.id:void 0,o=(a=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(i=a?s.geometries[n]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,u,l,c))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],h,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,u,l,c))return!1;h++}}function a(e,l){n(e,function(e,t,r,n,i){var o,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1===l(p.feature(e,r,{bbox:n,id:i}),t,0)?!1:void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<e.coordinates.length;a++){var u={type:o,coordinates:e.coordinates[a]};if(!1===l(p.feature(u,r),t,a))return!1}})}function i(e,h){a(e,function(s,a,u){var l=0;if(s.geometry){var c,e=s.geometry.type;if("Point"!==e&&"MultiPoint"!==e)return!1!==_(s,function(e,t,r,n,i){if(void 0!==c){var o=p.lineString([c,e],s.properties);if(!1===h(o,a,u,i,l))return!1;l++,c=e}else c=e})&&void 0}})}function u(e,s){if(!e)throw new Error("geojson is required");a(e,function(e,t,r){if(null!==e.geometry){var n=e.geometry.type,i=e.geometry.coordinates;switch(n){case"LineString":if(!1===s(e,t,r,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===s(p.lineString(i[o],e.properties),t,r,o))return!1}}})}r.coordEach=_,r.coordReduce=function(e,o,s,t){var a=s;return _(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)},t),a},r.propEach=o,r.propReduce=function(e,r,n){var i=n;return o(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.featureEach=s,r.featureReduce=function(e,r,n){var i=n;return s(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.coordAll=function(e){var t=[];return _(e,function(e){t.push(e)}),t},r.geomEach=n,r.geomReduce=function(e,o,s){var a=s;return n(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)}),a},r.flattenEach=a,r.flattenReduce=function(e,n,i){var o=i;return a(e,function(e,t,r){o=0===t&&0===r&&void 0===i?e:n(o,e,t,r)}),o},r.segmentEach=i,r.segmentReduce=function(e,o,s){var a=s,u=!1;return i(e,function(e,t,r,n,i){a=!1===u&&void 0===s?e:o(a,e,t,r,n,i),u=!0}),a},r.lineEach=u,r.lineReduce=function(e,i,o){var s=o;return u(e,function(e,t,r,n){s=0===t&&void 0===o?e:i(s,e,t,r,n)}),s},r.findSegment=function(e,t){if(t=t||{},!p.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.segmentIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),p.lineString([u[s],u[s+1]],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),p.lineString([u[o][s],u[o][s+1]],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s-1),p.lineString([u[i][s],u[i][s+1]],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s-1),p.lineString([u[i][o][s],u[i][o][s+1]],a,t)}throw new Error("geojson is invalid")},r.findPoint=function(e,t){if(t=t||{},!p.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.coordIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return p.point(u,a,t);case"MultiPoint":return i<0&&(i=u.length+i),p.point(u[i],a,t);case"LineString":return s<0&&(s=u.length+s),p.point(u[s],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),p.point(u[o][s],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),p.point(u[i][s],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s),p.point(u[i][o][s],a,t)}throw new Error("geojson is invalid")}},{"@turf/helpers":34}],36:[function(e,t,r){"use strict";function n(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return i(e);case"FeatureCollection":return t=e,r={type:"FeatureCollection"},Object.keys(t).forEach(function(e){switch(e){case"type":case"features":return;default:r[e]=t[e]}}),r.features=t.features.map(i),r;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(e);default:throw new Error("unknown GeoJSON type")}var t,r}function i(t){var r={type:"Feature"};return Object.keys(t).forEach(function(e){switch(e){case"type":case"properties":case"geometry":return;default:r[e]=t[e]}}),r.properties=function r(n){var i={};if(!n)return i;Object.keys(n).forEach(function(e){var t=n[e];"object"===_typeof3(t)?null===t?i[e]=null:t.length?i[e]=t.map(function(e){return e}):i[e]=r(t):i[e]=t});return i}(t.properties),r.geometry=o(t.geometry),r}function o(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?t.geometries=e.geometries.map(o):t.coordinates=function t(e){if("object"!==_typeof3(e[0]))return e.slice();return e.map(function(e){return t(e)})}(e.coordinates),t}t.exports=n,t.exports.default=n},{}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("@turf/helpers"),a=e("@turf/invariant");r.default=function(e,t,r,n){void 0===n&&(n={});var i=a.getCoord(e),o=s.degreesToRadians(i[0]),e=s.degreesToRadians(i[1]),i=s.degreesToRadians(r),r=s.lengthToRadians(t,n.units),t=Math.asin(Math.sin(e)*Math.cos(r)+Math.cos(e)*Math.sin(r)*Math.cos(i)),e=o+Math.atan2(Math.sin(i)*Math.sin(r)*Math.cos(e),Math.cos(r)-Math.sin(e)*Math.sin(t)),e=s.radiansToDegrees(e),t=s.radiansToDegrees(t);return s.point([e,t],n.properties)}},{"@turf/helpers":45,"@turf/invariant":49}],38:[function(e,t,r){"use strict";var n=e("polygon-clipping"),i=e("@turf/helpers"),o=e("@turf/invariant");function s(e){return e&&"object"===_typeof3(e)&&"default"in e?e:{default:e}}var a=s(n);function u(e,t){var r=o.getGeom(e),t=o.getGeom(t),e=e.properties||{},t=a.default.difference(r.coordinates,t.coordinates);return 0===t.length?null:1===t.length?i.polygon(t[0],e):i.multiPolygon(t,e)}t.exports=u,t.exports.default=u},{"@turf/helpers":39,"@turf/invariant":40,"polygon-clipping":261}],39:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],40:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":39,dup:9}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("@turf/invariant"),s=e("@turf/helpers");r.default=function(e,t,r){void 0===r&&(r={});var n=o.getCoord(e),i=o.getCoord(t),e=s.degreesToRadians(i[1]-n[1]),t=s.degreesToRadians(i[0]-n[0]),n=s.degreesToRadians(n[1]),i=s.degreesToRadians(i[1]),i=Math.pow(Math.sin(e/2),2)+Math.pow(Math.sin(t/2),2)*Math.cos(n)*Math.cos(i);return s.radiansToLength(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),r.units)}},{"@turf/helpers":45,"@turf/invariant":49}],42:[function(e,t,r){"use strict";var n=e("@turf/meta"),i=e("@turf/helpers");function o(t){var r=[];return"FeatureCollection"===t.type?n.featureEach(t,function(t){n.coordEach(t,function(e){r.push(i.point(e,t.properties))})}):n.coordEach(t,function(e){r.push(i.point(e,t.properties))}),i.featureCollection(r)}t.exports=o,t.exports.default=o},{"@turf/helpers":43,"@turf/meta":44}],43:[function(e,t,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],44:[function(e,t,r){arguments[4][35][0].apply(r,arguments)},{"@turf/helpers":43,dup:35}],45:[function(e,t,n){"use strict";function a(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return 0!==r.id&&!r.id||(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function i(e,t,r){return void 0===r&&(r={}),a({type:"Point",coordinates:e},t,r)}function o(e,t,r){void 0===r&&(r={});for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:e},t,r)}function s(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:e},t,r)}function u(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function l(e,t,r){return void 0===r&&(r={}),a({type:"MultiLineString",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),a({type:"MultiPoint",coordinates:e},t,r)}function h(e,t,r){return void 0===r&&(r={}),a({type:"MultiPolygon",coordinates:e},t,r)}function p(e,t){void 0===t&&(t="kilometers");var r=n.factors[t];if(!r)throw new Error(t+" units is invalid");return e*r}function f(e,t){void 0===t&&(t="kilometers");var r=n.factors[t];if(!r)throw new Error(t+" units is invalid");return e/r}function r(e){return 180*(e%(2*Math.PI))/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.earthRadius=6371008.8,n.factors={centimeters:100*n.earthRadius,centimetres:100*n.earthRadius,degrees:n.earthRadius/111325,feet:3.28084*n.earthRadius,inches:39.37*n.earthRadius,kilometers:n.earthRadius/1e3,kilometres:n.earthRadius/1e3,meters:n.earthRadius,metres:n.earthRadius,miles:n.earthRadius/1609.344,millimeters:1e3*n.earthRadius,millimetres:1e3*n.earthRadius,nauticalmiles:n.earthRadius/1852,radians:1,yards:n.earthRadius/1.0936},n.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/n.earthRadius,yards:1/1.0936},n.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},n.feature=a,n.geometry=function(e,t,r){switch(void 0===r&&(r={}),e){case"Point":return i(t).geometry;case"LineString":return s(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return c(t).geometry;case"MultiLineString":return l(t).geometry;case"MultiPolygon":return h(t).geometry;default:throw new Error(e+" is invalid")}},n.point=i,n.points=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return i(e,t)}),r)},n.polygon=o,n.polygons=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return o(e,t)}),r)},n.lineString=s,n.lineStrings=function(e,t,r){return void 0===r&&(r={}),u(e.map(function(e){return s(e,t)}),r)},n.featureCollection=u,n.multiLineString=l,n.multiPoint=c,n.multiPolygon=h,n.geometryCollection=function(e,t,r){return void 0===r&&(r={}),a({type:"GeometryCollection",geometries:e},t,r)},n.round=function(e,t){if(void 0===t&&(t=0),t&&!(0<=t))throw new Error("precision must be a positive number");return t=Math.pow(10,t||0),Math.round(e*t)/t},n.radiansToLength=p,n.lengthToRadians=f,n.lengthToDegrees=function(e,t){return r(f(e,t))},n.bearingToAzimuth=function(e){return(e%=360)<0&&(e+=360),e},n.radiansToDegrees=r,n.degreesToRadians=function(e){return e%360*Math.PI/180},n.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(0<=e))throw new Error("length must be a positive number");return p(f(e,t),r)},n.convertArea=function(e,t,r){if(void 0===t&&(t="meters"),void 0===r&&(r="kilometers"),!(0<=e))throw new Error("area must be a positive number");if(!(t=n.areaFactors[t]))throw new Error("invalid original units");if(!(r=n.areaFactors[r]))throw new Error("invalid final units");return e/t*r},n.isNumber=d,n.isObject=function(e){return!!e&&e.constructor===Object},n.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(e){if(!d(e))throw new Error("bbox must only contain numbers")})},n.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(_typeof3(e)))throw new Error("id must be a number or a string")},n.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},n.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},n.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},n.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},n.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},n.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},n.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],46:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("@turf/helpers"),o=e("@turf/invariant"),s=n(e("polygon-clipping"));r.default=function(e,t,r){return void 0===r&&(r={}),e=o.getGeom(e),t=o.getGeom(t),0===(t=s.default.intersection(e.coordinates,t.coordinates)).length?null:1===t.length?i.polygon(t[0],r.properties):i.multiPolygon(t,r.properties)}},{"@turf/helpers":47,"@turf/invariant":48,"polygon-clipping":261}],47:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],48:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":47,dup:9}],49:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("@turf/helpers");r.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&2<=e.length&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},r.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},r.containsNumber=function e(t){if(1<t.length&&n.isNumber(t[0])&&n.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},r.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},r.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},r.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,i=e.features;n<i.length;n++){var o=i[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+o.geometry.type)}},r.getGeom=function(e){return"Feature"===e.type?e.geometry:e},r.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":("Feature"===e.type&&null!==e.geometry?e.geometry:e).type}},{"@turf/helpers":45}],50:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("@turf/distance")),o=e("@turf/meta");r.default=function(e,r){return void 0===r&&(r={}),o.segmentReduce(e,function(e,t){t=t.geometry.coordinates;return e+i.default(t[0],t[1],r)},0)}},{"@turf/distance":51,"@turf/meta":54}],51:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{"@turf/helpers":52,"@turf/invariant":53,dup:7}],52:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],53:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":52,dup:9}],54:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"@turf/helpers":52,dup:18}],55:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var l=e("@turf/helpers"),c=e("@turf/invariant"),s=n(e("@turf/line-segment")),a=e("@turf/meta"),u=n(e("geojson-rbush"));function h(e,t){var r=c.getCoords(e),n=c.getCoords(t);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=r[0][0],o=r[0][1],s=r[1][0],a=r[1][1],u=n[0][0],e=n[0][1],t=n[1][0],r=n[1][1],n=(r-e)*(s-i)-(t-u)*(a-o),r=(t-u)*(o-e)-(r-e)*(i-u),u=(s-i)*(o-e)-(a-o)*(i-u);if(0==n)return null;r/=n,n=u/n;if(0<=r&&r<=1&&0<=n&&n<=1){i=i+r*(s-i),o=o+r*(a-o);return l.point([i,o])}return null}r.default=function(e,t){var n={},i=[];if("LineString"===e.type&&(e=l.feature(e)),"LineString"===t.type&&(t=l.feature(t)),"Feature"===e.type&&"Feature"===t.type&&null!==e.geometry&&null!==t.geometry&&"LineString"===e.geometry.type&&"LineString"===t.geometry.type&&2===e.geometry.coordinates.length&&2===t.geometry.coordinates.length){var r=h(e,t);return r&&i.push(r),l.featureCollection(i)}var o=u.default();return o.load(s.default(t)),a.featureEach(s.default(e),function(r){a.featureEach(o.search(r),function(e){var t=h(r,e);t&&(e=c.getCoords(t).join(","),n[e]||(n[e]=!0,i.push(t)))})}),l.featureCollection(i)}},{"@turf/helpers":45,"@turf/invariant":49,"@turf/line-segment":56,"@turf/meta":57,"geojson-rbush":96}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=e("@turf/helpers"),i=e("@turf/invariant"),n=e("@turf/meta");r.default=function(e){if(!e)throw new Error("geojson is required");var t=[];return n.flattenEach(e,function(e){!function(t,r){var e=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":e=i.getCoords(n);break;case"LineString":e=[i.getCoords(n)]}e.forEach(function(e){var s,a;(e=e,s=t.properties,a=[],e.reduce(function(e,t){var r,n,i,o=u.lineString([e,t],s);return o.bbox=(n=t,i=(r=e)[0],e=r[1],r=n[0],n=n[1],[i<r?i:r,e<n?e:n,r<i?i:r,n<e?e:n]),a.push(o),t}),a).forEach(function(e){e.id=r.length,r.push(e)})})}}(e,t)}),u.featureCollection(t)}},{"@turf/helpers":45,"@turf/invariant":49,"@turf/meta":57}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=e("@turf/helpers");function _(e,t,r){if(null!==e)for(var n,i,o,s,a,u,l,c=0,h=e.type,p="FeatureCollection"===h,f="Feature"===h,d=p?e.features.length:1,y=0;y<d;y++){s=(l=!!(u=p?e.features[y].geometry:f?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var m=0;m<s;m++){var g,v=0,b=0;if(null!==(g=l?u.geometries[m]:u)){a=g.coordinates;var w=g.type,x=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1;switch(w){case null:break;case"Point":if(!1===t(a,c,y,v,b))return!1;c++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<a.length;n++){if(!1===t(a[n],c,y,v,b))return!1;c++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<a.length;n++){for(i=0;i<a[n].length-x;i++){if(!1===t(a[n][i],c,y,v,b))return!1;c++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<a.length;n++){for(i=b=0;i<a[n].length;i++){for(o=0;o<a[n][i].length-x;o++){if(!1===t(a[n][i][o],c,y,v,b))return!1;c++}b++}v++}break;case"GeometryCollection":for(n=0;n<g.geometries.length;n++)if(!1===_(g.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function s(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function n(e,t){for(var r,n,i,o,s,a,u,l,c,h=0,p="FeatureCollection"===e.type,f="Feature"===e.type,d=p?e.features.length:1,y=0;y<d;y++){for(s=p?e.features[y].geometry:f?e.geometry:e,u=p?e.features[y].properties:f?e.properties:{},l=p?e.features[y].bbox:f?e.bbox:void 0,c=p?e.features[y].id:f?e.id:void 0,o=(a=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(i=a?s.geometries[n]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,u,l,c))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],h,u,l,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,u,l,c))return!1;h++}}function a(e,l){n(e,function(e,t,r,n,i){var o,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1===l(d.feature(e,r,{bbox:n,id:i}),t,0)?!1:void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<e.coordinates.length;a++){var u={type:o,coordinates:e.coordinates[a]};if(!1===l(d.feature(u,r),t,a))return!1}})}function i(e,f){a(e,function(o,s,a){var u=0;if(o.geometry){var e=o.geometry.type;if("Point"!==e&&"MultiPoint"!==e){var l,c=0,h=0,p=0;return!1!==_(o,function(e,t,r,n,i){if(void 0===l||c<s||h<n||p<i)return l=e,c=s,h=n,p=i,void(u=0);n=d.lineString([l,e],o.properties);if(!1===f(n,s,a,i,u))return!1;u++,l=e})&&void 0}}})}function u(e,s){if(!e)throw new Error("geojson is required");a(e,function(e,t,r){if(null!==e.geometry){var n=e.geometry.type,i=e.geometry.coordinates;switch(n){case"LineString":if(!1===s(e,t,r,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===s(d.lineString(i[o],e.properties),t,r,o))return!1}}})}r.coordEach=_,r.coordReduce=function(e,o,s,t){var a=s;return _(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)},t),a},r.propEach=o,r.propReduce=function(e,r,n){var i=n;return o(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.featureEach=s,r.featureReduce=function(e,r,n){var i=n;return s(e,function(e,t){i=0===t&&void 0===n?e:r(i,e,t)}),i},r.coordAll=function(e){var t=[];return _(e,function(e){t.push(e)}),t},r.geomEach=n,r.geomReduce=function(e,o,s){var a=s;return n(e,function(e,t,r,n,i){a=0===t&&void 0===s?e:o(a,e,t,r,n,i)}),a},r.flattenEach=a,r.flattenReduce=function(e,n,i){var o=i;return a(e,function(e,t,r){o=0===t&&0===r&&void 0===i?e:n(o,e,t,r)}),o},r.segmentEach=i,r.segmentReduce=function(e,o,s){var a=s,u=!1;return i(e,function(e,t,r,n,i){a=!1===u&&void 0===s?e:o(a,e,t,r,n,i),u=!0}),a},r.lineEach=u,r.lineReduce=function(e,i,o){var s=o;return u(e,function(e,t,r,n){s=0===t&&void 0===o?e:i(s,e,t,r,n)}),s},r.findSegment=function(e,t){if(t=t||{},!d.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.segmentIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),d.lineString([u[s],u[s+1]],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s-1),d.lineString([u[o][s],u[o][s+1]],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s-1),d.lineString([u[i][s],u[i][s+1]],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s-1),d.lineString([u[i][o][s],u[i][o][s+1]],a,t)}throw new Error("geojson is invalid")},r.findPoint=function(e,t){if(t=t||{},!d.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,s=t.coordIndex||0,a=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),a=a||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":a=a||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return d.point(u,a,t);case"MultiPoint":return i<0&&(i=u.length+i),d.point(u[i],a,t);case"LineString":return s<0&&(s=u.length+s),d.point(u[s],a,t);case"Polygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),d.point(u[o][s],a,t);case"MultiLineString":return i<0&&(i=u.length+i),s<0&&(s=u[i].length+s),d.point(u[i][s],a,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),s<0&&(s=u[i][o].length-s),d.point(u[i][o][s],a,t)}throw new Error("geojson is invalid")}},{"@turf/helpers":45}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=e("@turf/bearing"),d=e("@turf/distance"),y=e("@turf/destination"),m=e("@turf/line-intersect"),n=e("@turf/meta"),g=e("@turf/helpers"),v=e("@turf/invariant");r.default=function(e,l,c){void 0===c&&(c={});var h=g.point([1/0,1/0],{dist:1/0}),p=0;return n.flattenEach(e,function(e){for(var t=v.getCoords(e),r=0;r<t.length-1;r++){var n=g.point(t[r]);n.properties.dist=d.default(l,n,c);var i=g.point(t[r+1]);i.properties.dist=d.default(l,i,c);var o=d.default(n,i,c),s=Math.max(n.properties.dist,i.properties.dist),a=f.default(n,i),u=y.default(l,s,a+90,c),a=y.default(l,s,a-90,c),u=m.default(g.lineString([u.geometry.coordinates,a.geometry.coordinates]),g.lineString([n.geometry.coordinates,i.geometry.coordinates])),a=null;0<u.features.length&&((a=u.features[0]).properties.dist=d.default(l,a,c),a.properties.location=p+d.default(n,a,c)),n.properties.dist<h.properties.dist&&((h=n).properties.index=r,h.properties.location=p),i.properties.dist<h.properties.dist&&((h=i).properties.index=r+1,h.properties.location=p+o),a&&a.properties.dist<h.properties.dist&&((h=a).properties.index=r),p+=o}}),h}},{"@turf/bearing":11,"@turf/destination":37,"@turf/distance":41,"@turf/helpers":45,"@turf/invariant":49,"@turf/line-intersect":55,"@turf/meta":57}],59:[function(e,t,r){"use strict";function n(e){return e&&"object"===_typeof3(e)&&"default"in e?e.default:e}var s=n(e("@turf/clone")),a=n(e("@turf/distance")),u=e("@turf/meta");function i(n,e){if(!n)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var i,o=1/0;return u.featureEach(e,function(e,t){var r=a(n,e);r<o&&((i=s(e)).properties.featureIndex=t,i.properties.distanceToPoint=r,o=r)}),i}t.exports=i,t.exports.default=i},{"@turf/clone":36,"@turf/distance":60,"@turf/meta":63}],60:[function(e,t,r){"use strict";var o=e("@turf/invariant"),s=e("@turf/helpers");function n(e,t,r){if(r=r||{},!s.isObject(r))throw new Error("options is invalid");var n=r.units,i=o.getCoord(e),r=o.getCoord(t),e=s.degreesToRadians(r[1]-i[1]),t=s.degreesToRadians(r[0]-i[0]),i=s.degreesToRadians(i[1]),r=s.degreesToRadians(r[1]),r=Math.pow(Math.sin(e/2),2)+Math.pow(Math.sin(t/2),2)*Math.cos(i)*Math.cos(r);return s.radiansToLength(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),n)}t.exports=n,t.exports.default=n},{"@turf/helpers":61,"@turf/invariant":62}],61:[function(e,t,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("@turf/helpers");r.getCoord=function(e){if(!e)throw new Error("coord is required");if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates;if(Array.isArray(e)&&2<=e.length&&void 0===e[0].length&&void 0===e[1].length)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},r.getCoords=function(e){if(!e)throw new Error("coords is required");if("Feature"===e.type&&null!==e.geometry)return e.geometry.coordinates;if(e.coordinates)return e.coordinates;if(Array.isArray(e))return e;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},r.containsNumber=function e(t){if(1<t.length&&n.isNumber(t[0])&&n.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},r.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},r.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},r.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0;n<e.features.length;n++){var i=e.features[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+i.geometry.type)}},r.getGeom=function(e){if(!e)throw new Error("geojson is required");if(void 0!==e.geometry)return e.geometry;if(e.coordinates||e.geometries)return e;throw new Error("geojson must be a valid Feature or Geometry Object")},r.getGeomType=function(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")},r.getType=function(e,t){if(!e)throw new Error((t||"geojson")+" is required");if(e.geometry&&e.geometry.type)return e.geometry.type;if(e.type)return e.type;throw new Error((t||"geojson")+" is invalid")}},{"@turf/helpers":61}],63:[function(e,t,r){arguments[4][35][0].apply(r,arguments)},{"@turf/helpers":61,dup:35}],64:[function(e,t,r){"use strict";function n(e){return e&&"object"===_typeof3(e)&&"default"in e?e.default:e}var p=n(e("@turf/explode")),f=n(e("@turf/center")),d=n(e("@turf/nearest-point")),y=n(e("@turf/boolean-point-in-polygon")),m=e("@turf/helpers");function i(e){for(var t="FeatureCollection"===(e=e).type?e:"Feature"===e.type?m.featureCollection([e]):m.featureCollection([m.feature(e)]),r=f(t),n=!1,i=0;!n&&i<t.features.length;){var o=t.features[i].geometry,s=!1;if("Point"===o.type)r.geometry.coordinates[0]===o.coordinates[0]&&r.geometry.coordinates[1]===o.coordinates[1]&&(n=!0);else if("MultiPoint"===o.type)for(var a=!1,u=0;!a&&u<o.coordinates.length;)r.geometry.coordinates[0]===o.coordinates[u][0]&&r.geometry.coordinates[1]===o.coordinates[u][1]&&(a=n=!0),u++;else if("LineString"===o.type)for(u=0;!s&&u<o.coordinates.length-1;)g(r.geometry.coordinates[0],r.geometry.coordinates[1],o.coordinates[u][0],o.coordinates[u][1],o.coordinates[u+1][0],o.coordinates[u+1][1])&&(n=s=!0),u++;else if("MultiLineString"===o.type)for(var l=0;l<o.coordinates.length;){s=!1,u=0;for(var c=o.coordinates[l];!s&&u<c.length-1;)g(r.geometry.coordinates[0],r.geometry.coordinates[1],c[u][0],c[u][1],c[u+1][0],c[u+1][1])&&(n=s=!0),u++;l++}else"Polygon"!==o.type&&"MultiPolygon"!==o.type||y(r,o)&&(n=!0);i++}if(n)return r;for(var h=m.featureCollection([]),i=0;i<t.features.length;i++)h.features=h.features.concat(p(t.features[i]).features);return m.point(d(r,h).geometry.coordinates)}function g(e,t,r,n,i,o){return Math.sqrt((i-r)*(i-r)+(o-n)*(o-n))===Math.sqrt((e-r)*(e-r)+(t-n)*(t-n))+Math.sqrt((i-e)*(i-e)+(o-t)*(o-t))}t.exports=i,t.exports.default=i},{"@turf/boolean-point-in-polygon":65,"@turf/center":32,"@turf/explode":42,"@turf/helpers":66,"@turf/nearest-point":59}],65:[function(e,t,r){"use strict";var c=e("@turf/invariant");function n(e,t,r){if("object"!==_typeof3(r=r||{}))throw new Error("options is invalid");var n=r.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var i=c.getCoord(e),o=c.getCoords(t),r=(t.geometry||t).type,e=t.bbox;if(e&&!1==(t=i,(e=e)[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]))return!1;"Polygon"===r&&(o=[o]);for(var s=0,a=!1;s<o.length&&!a;s++)if(h(i,o[s][0],n)){for(var u=!1,l=1;l<o[s].length&&!u;)h(i,o[s][l],!n)&&(u=!0),l++;u||(a=!0)}return a}function h(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var i=0,o=t.length-1;i<t.length;o=i++){var s=t[i][0],a=t[i][1],u=t[o][0],l=t[o][1];if(e[1]*(s-u)+a*(u-e[0])+l*(e[0]-s)==0&&(s-e[0])*(u-e[0])<=0&&(a-e[1])*(l-e[1])<=0)return!r;a>e[1]!=l>e[1]&&e[0]<(u-s)*(e[1]-a)/(l-a)+s&&(n=!n)}return n}t.exports=n,t.exports.default=n},{"@turf/invariant":67}],66:[function(e,t,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],67:[function(e,t,r){arguments[4][62][0].apply(r,arguments)},{"@turf/helpers":66,dup:62}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("@turf/helpers"),s=e("@turf/invariant");function n(e,t){return void 0===t&&(t={}),a(s.getGeom(e).coordinates,t.properties||("Feature"===e.type?e.properties:{}))}function i(e,t){void 0===t&&(t={});var r=s.getGeom(e).coordinates,n=t.properties||("Feature"===e.type?e.properties:{}),i=[];return r.forEach(function(e){i.push(a(e,n))}),o.featureCollection(i)}function a(e,t){return 1<e.length?o.multiLineString(e,t):o.lineString(e[0],t)}r.default=function(e,t){void 0===t&&(t={});var r=s.getGeom(e);switch(t.properties||"Feature"!==e.type||(t.properties=e.properties),r.type){case"Polygon":return n(r,t);case"MultiPolygon":return i(r,t);default:throw new Error("invalid poly")}},r.polygonToLine=n,r.multiPolygonToLine=i,r.coordsToLine=a},{"@turf/helpers":69,"@turf/invariant":70}],69:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],70:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":69,dup:9}],71:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("polygon-clipping")),o=e("@turf/invariant"),s=e("@turf/helpers");r.default=function(e,t,r){return void 0===r&&(r={}),e=o.getGeom(e),t=o.getGeom(t),0===(t=i.default.union(e.coordinates,t.coordinates)).length?null:1===t.length?s.polygon(t[0],r.properties):s.multiPolygon(t,r.properties)}},{"@turf/helpers":72,"@turf/invariant":73,"polygon-clipping":261}],72:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],73:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"@turf/helpers":72,dup:9}],74:[function(e,t,r){"use strict";var l=e("geojson-bounds"),n=e("haversine");function c(t){var e,r=this;if(null==t)return this.minlat=-90,this.minlon=-180,this.maxlat=90,void(this.maxlon=180);if("function"==typeof t.getSouthWest&&(n=t.getSouthWest().wrap(),i=t.getNorthEast().wrap(),t={minlat:n.lat,minlon:n.lng,maxlat:i.lat,maxlon:i.lng}),"Feature"===t.type){var n="GeometryCollection"===t.geometry.type?t.geometry.geometries.map(function(e){e=new c({type:"Feature",geometry:e});return[e.minlon,e.minlat,e.maxlon,e.maxlat]}):["MultiPoint","MultiPolygon","MultiLineString"].includes(t.geometry.type)?t.geometry.coordinates.map(function(e){return l.extent({type:"Feature",geometry:{type:t.geometry.type.substr(5),coordinates:e}})}):[l.extent(t)],i=n.shift();return this.minlat=i[1],this.minlon=i[0],this.maxlat=i[3],this.maxlon=i[2],n.forEach(function(e){return r.extend({minlat:e[1],minlon:e[0],maxlat:e[3],maxlon:e[2]})}),void this._wrap()}if("FeatureCollection"===t.type){if(0===t.features.length)return;for(var o=new c(t.features[0]),s=1;s<t.features.length;s++)o.extend(t.features[s]);return this.minlat=o.minlat,this.minlon=o.minlon,this.maxlat=o.maxlat,void(this.maxlon=o.maxlon)}"bounds"in t&&(t=t.bounds),t.lat&&(this.minlat=+t.lat,this.maxlat=+t.lat),t.lon&&(this.minlon=+t.lon,this.maxlon=+t.lon),t.latitude&&(this.minlat=+t.latitude,this.maxlat=+t.latitude,this.minlon=+t.longitude,this.maxlon=+t.longitude),Array.isArray(t)&&(this.minlat=+t[0],this.maxlat=+t[0],this.minlon=+t[1],this.maxlon=+t[1]),t.lng&&(this.minlon=+t.lng,this.maxlon=+t.lng);for(var a=["minlon","minlat","maxlon","maxlat"],u=0;u<a.length;u++)(e=a[u])in t&&(this[e]=t[e]);this._wrap()}c.prototype.wrapMaxLon=function(){return this.minlon>this.maxlon?this.maxlon+360:this.maxlon},c.prototype.wrapMinLon=function(){return this.minlon>this.maxlon?this.minlon-360:this.minlon},c.prototype._wrap=function(){return(this.minlon<-180||180<this.minlon)&&(this.minlon=(this.minlon+180)%360-180),(this.maxlon<-180||180<this.maxlon)&&(this.maxlon=(this.maxlon+180)%360-180),this},c.prototype.intersects=function(e){return e instanceof c||(e=new c(e)),!(e.maxlat<this.minlat)&&(!(e.minlat>this.maxlat)&&(this.wrapMaxLon()>=e.minlon&&this.minlon<=e.wrapMaxLon()||this.maxlon>=e.wrapMinLon()&&this.wrapMinLon()<=e.maxlon))},c.prototype.within=function(e){return e instanceof c||(e=new c(e)),!(e.maxlat<this.maxlat)&&(!(e.minlat>this.minlat)&&(this.wrapMinLon()>=e.wrapMinLon()&&this.maxlon<=e.maxlon||this.minlon>=e.minlon&&this.wrapMaxLon()<=e.wrapMaxLon()))},c.prototype.toTile=function(){return new c({minlat:Math.floor(10*this.minlat)/10,minlon:Math.floor(10*this.minlon)/10,maxlat:Math.ceil(10*this.maxlat)/10,maxlon:Math.ceil(10*this.maxlon)/10})},c.prototype.toBBoxString=c.prototype.toLonLatString=function(){return this.minlon+","+this.minlat+","+this.maxlon+","+this.maxlat},c.prototype.toLatLonString=function(){return this.minlat+","+this.minlon+","+this.maxlat+","+this.maxlon},c.prototype.diagonalLength=function(){var e=this.maxlat-this.minlat,t=this.wrapMaxLon()-this.minlon;return Math.sqrt(e*e+t*t)},c.prototype.diagonalDistance=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return n({latitude:this.minlat,longitude:this.minlon},{latitude:this.maxlat,longitude:this.maxlon},e)},c.prototype.getCenter=function(){var e=this.maxlat-this.minlat,t=this.wrapMaxLon()-this.minlon,t=this.minlon+t/2;return(t<-180||180<t)&&(t=(t+180)%360-180),{lat:this.minlat+e/2,lon:t}},c.prototype.getNorth=function(){return this.maxlat},c.prototype.getSouth=function(){return this.minlat},c.prototype.getEast=function(){return this.maxlon},c.prototype.getWest=function(){return this.minlon},c.prototype.extend=function(e){e instanceof c||(e=new c(e)),e.minlat<this.minlat&&(this.minlat=e.minlat),e.maxlat>this.maxlat&&(this.maxlat=e.maxlat);for(var t=-360;t<=360;t+=360)if(e.wrapMaxLon()+t>this.minlon&&e.minlon+t<this.wrapMaxLon())return this.minlon=Math.min(this.minlon,e.minlon+t),this.maxlon=Math.max(this.wrapMaxLon(),e.wrapMaxLon()+t),void this._wrap();var r=Math.min(this.minlon,e.minlon),n=Math.max(this.minlon,e.minlon),i=Math.max(this.wrapMaxLon(),e.wrapMaxLon()),o=Math.min(this.wrapMaxLon(),e.wrapMaxLon());i-r<o-n+360?(this.minlon=r,this.maxlon=i):(this.minlon=n,this.maxlon=o),this._wrap()},c.prototype.toGeoJSON=function(){return this.minlon>this.maxlon?{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:[[[[this.minlon,this.minlat],[180,this.minlat],[180,this.maxlat],[this.minlon,this.maxlat],[this.minlon,this.minlat]]],[[[-180,this.minlat],[this.maxlon,this.minlat],[this.maxlon,this.maxlat],[-180,this.maxlat],[-180,this.minlat]]]]}}:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[this.minlon,this.minlat],[this.maxlon,this.minlat],[this.maxlon,this.maxlat],[this.minlon,this.maxlat],[this.minlon,this.minlat]]]}}},c.prototype.toLeaflet=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return"shiftWorld"in e||(e.shiftWorld=[0,0]),L.latLngBounds(L.latLng(this.minlat,this.minlon+(this.minlon<0?e.shiftWorld[0]:e.shiftWorld[1])),L.latLng(this.maxlat,this.maxlon+(this.maxlon<0?e.shiftWorld[0]:e.shiftWorld[1])))},void 0!==t&&t.exports&&(t.exports=c),"undefined"!=typeof window&&(window.BoundingBox=c)},{"geojson-bounds":95,haversine:97}],75:[function(e,t,r){},{}],76:[function(e,t,r){"use strict";function s(e,t){var r=document.head||document.getElementsByTagName("head")[0],n=i[i.length-1];if((t=t||{}).insertAt=t.insertAt||"bottom","top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),i.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}var i=[];t.exports={createLink:function(e,t){var r,n,i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("link");for(r in o.href=e,o.rel="stylesheet",t)t.hasOwnProperty(r)&&(n=t[r],o.setAttribute("data-"+r,n));i.appendChild(o)},createStyle:function(e,t,r){r=r||{};var n,i,o=document.createElement("style");for(n in o.type="text/css",t)t.hasOwnProperty(n)&&(i=t[n],o.setAttribute("data-"+n,i));o.sheet?(o.innerHTML=e,o.sheet.cssText=e,s(o,{insertAt:r.insertAt})):o.styleSheet?(s(o,{insertAt:r.insertAt}),o.styleSheet.cssText=e):(o.appendChild(document.createTextNode(e)),s(o,{insertAt:r.insertAt}))}}},{}],77:[function(e,t,r){arguments[4][75][0].apply(r,arguments)},{dup:75}],78:[function(e,t,r){var a={array:function(n){var i=0,o=0,s=[0,1,3,7,15,31,63,127,255];return function(e){for(var t=0;0<e;){var r=8-i;r<=e?(t<<=r,t|=s[r]&n[o++],i=0,e-=r):(t<<=e,t|=(n[o]&s[e]<<8-e-i)>>8-e-i,i+=e,e=0)}return t}},simple:function(e){for(var t,r,n=a.header(e),i=[],o=0;-1!=(r=a.decompress(e,n))&&(i.push(r),o+=r.byteLength),-1!=r;);t=new Uint8Array(o);for(var s=o=0;s<i.length;++s)r=i[s],t.set(r,o),o+=r.byteLength;return t},header:function(e){if(4348520!=e(24))throw"No magic number found";e=e(8)-48;if(e<1||9<e)throw"Not a BZIP archive";return e},decompress:function(e,t,r){for(var n="",i=0;i<6;i++)n+=e(8).toString(16);if("177245385090"==n)return-1;if("314159265359"!=n)throw"eek not valid bzip data";if(e(32),e(1))throw"unsupported obsolete version";var o=e(24);if(9e5<o)throw"Initial position larger than buffer size";var s=e(16),a=new Uint8Array(256),u=0;for(i=0;i<16;i++)if(s&1<<15-i){var l=e(16);for(d=0;d<16;d++)l&1<<15-d&&(a[u++]=16*i+d)}var c=e(3);if(c<2||6<c)throw"another error";var h=e(15);if(0==h)throw"meh";for(var p=[],i=0;i<c;i++)p[i]=i;for(var f=new Uint8Array(32768),i=0;i<h;i++){for(var d=0;e(1);d++)if(c<=d)throw"whoops another error";var y=p[d];p.splice(d,1),p.splice(0,0,y),f[i]=y}for(var m=u+2,g=[],d=0;d<c;d++){var v=new Uint8Array(258),b=new Uint8Array(21);s=e(5);for(var w,x,i=0;i<m;i++){for(;;){if(s<1||20<s)throw"I gave up a while ago on writing error messages";if(!e(1))break;e(1)?s--:s++}v[i]=s}w=x=v[0];for(var _,i=1;i<m;i++)v[i]>x?x=v[i]:v[i]<w&&(w=v[i]);(_=g[d]={}).permute=new Uint32Array(258),_.limit=new Uint32Array(21),_.base=new Uint32Array(21),_.minLen=w,_.maxLen=x;for(var k=_.base.subarray(1),E=_.limit.subarray(1),S=0,i=w;i<=x;i++)for(s=0;s<m;s++)v[s]==i&&(_.permute[S++]=s);for(i=w;i<=x;i++)b[i]=E[i]=0;for(i=0;i<m;i++)b[v[i]]++;for(S=s=0,i=w;i<x;i++)S+=b[i],E[i]=S-1,S<<=1,k[i+1]=S-(s+=b[i]);E[x]=S+b[x]-1,k[w]=0}for(var O,A,M,P=new Uint32Array(256),i=0;i<256;i++)p[i]=i;O=A=m=M=0;for(var j=new Uint32Array(9e5);;){if(!m--){if(m=49,h<=M)throw"meow i'm a kitty, that's an error";k=(_=g[f[M++]]).base.subarray(1),E=_.limit.subarray(1)}for(d=e(i=_.minLen);;){if(i>_.maxLen)throw"rawr i'm a dinosaur";if(d<=E[i])break;i++,d=d<<1|e(1)}if((d-=k[i])<0||258<=d)throw"moo i'm a cow";var T=_.permute[d];if(0!=T&&1!=T){if(O){if(9e5<=A+s)throw"Boom.";for(P[y=a[p[O=0]]]+=s;s--;)j[A++]=y}if(u<T)break;if(9e5<=A)throw"I can't think of anything. Error";y=p[i=T-1],p.splice(i,1),p.splice(0,0,y),P[y=a[y]]++,j[A++]=y}else O||(O=1,s=0),s+=0==T?O:2*O,O<<=1}if(o<0||A<=o)throw"I'm a monkey and I'm throwing something at someone, namely you";for(d=0,i=0;i<256;i++)l=d+P[i],P[i]=d,d=l;for(i=0;i<A;i++)j[P[y=255&j[i]]]|=i<<8,P[y]++;var C=0,I=0,N=0;A&&(I=255&(C=j[o]),C>>=8,N=-1);var L,F,R,D=new Uint8Array(9e5),q=0;for(r=r||1/0;A;){for(A--,F=I,I=255&(C=j[C]),C>>=8,3==N++?(L=I,R=F,I=-1):(L=1,R=I);L--;)if(D[q++]=R,!--r)return D;I!=F&&(N=0)}return D.subarray(0,q)}};t.exports=a},{}],79:[function(e,t,r){"use strict";var s=e("type/value/is"),o=e("type/plain-function/is"),a=e("es5-ext/object/assign"),u=e("es5-ext/object/normalize-options"),l=e("es5-ext/string/#/contains");(t.exports=function(e,t){var r,n,i,o;return arguments.length<2||"string"!=typeof e?(i=t,t=e,e=null):i=arguments[2],s(e)?(r=l.call(e,"c"),n=l.call(e,"e"),o=l.call(e,"w")):n=!(r=o=!0),o={value:t,configurable:r,enumerable:n,writable:o},i?a(u(i),o):o}).gs=function(e,t,r){var n,i;return"string"!=typeof e?(i=r,r=t,t=e,e=null):i=arguments[3],s(t)?o(t)?s(r)?o(r)||(i=r,r=void 0):r=void 0:(i=t,t=r=void 0):t=void 0,e=s(e)?(n=l.call(e,"c"),l.call(e,"e")):!(n=!0),e={get:t,set:r,configurable:n,enumerable:e},i?a(u(i),e):e}},{"es5-ext/object/assign":81,"es5-ext/object/normalize-options":88,"es5-ext/string/#/contains":91,"type/plain-function/is":270,"type/value/is":272}],80:[function(e,t,r){"use strict";t.exports=function(){}},{}],81:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":82,"./shim":83}],82:[function(e,t,r){"use strict";t.exports=function(){var e=Object.assign;return"function"==typeof e&&(e(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],83:[function(e,t,r){"use strict";var s=e("../keys"),a=e("../valid-value"),u=Math.max;t.exports=function(t,r){var n,e,i,o=u(arguments.length,2);for(t=Object(a(t)),i=function(e){try{t[e]=r[e]}catch(e){n=n||e}},e=1;e<o;++e)s(r=arguments[e]).forEach(i);if(void 0!==n)throw n;return t}},{"../keys":85,"../valid-value":90}],84:[function(e,t,r){"use strict";var n=e("../function/noop")();t.exports=function(e){return e!==n&&null!==e}},{"../function/noop":80}],85:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":86,"./shim":87}],86:[function(e,t,r){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],87:[function(e,t,r){"use strict";var n=e("../is-value"),i=Object.keys;t.exports=function(e){return i(n(e)?Object(e):e)}},{"../is-value":84}],88:[function(e,t,r){"use strict";var n=e("./is-value"),i=Array.prototype.forEach,o=Object.create;t.exports=function(e){var t=o(null);return i.call(arguments,function(e){n(e)&&function(e,t){for(var r in e)t[r]=e[r]}(Object(e),t)}),t}},{"./is-value":84}],89:[function(e,t,r){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],90:[function(e,t,r){"use strict";var n=e("./is-value");t.exports=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":84}],91:[function(e,t,r){"use strict";t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":92,"./shim":93}],92:[function(e,t,r){"use strict";var n="razdwatrzy";t.exports=function(){return"function"==typeof n.contains&&(!0===n.contains("dwa")&&!1===n.contains("foo"))}},{}],93:[function(e,t,r){"use strict";var n=String.prototype.indexOf;t.exports=function(e){return-1<n.call(this,e,arguments[1])}},{}],94:[function(e,t,r){"use strict";var n=e("d"),s=e("es5-ext/object/valid-callable"),u=Function.prototype.apply,l=Function.prototype.call,i=Object.create,o=Object.defineProperty,a=Object.defineProperties,c=Object.prototype.hasOwnProperty,h={configurable:!0,enumerable:!1,writable:!0},p=function(e,t){var r;return s(t),c.call(this,"__ee__")?r=this.__ee__:(r=h.value=i(null),o(this,"__ee__",h),h.value=null),r[e]?"object"===_typeof3(r[e])?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},f=function(e,t){var r,n;return s(t),p.call(n=this,e,r=function(){d.call(n,e,r),u.call(t,this,arguments)}),r.__eeOnceListener__=t,this},d=function(e,t){var r,n,i,o;if(s(t),!c.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"===_typeof3(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},y=function(e,t,r){var n,i,o,s,a;if(c.call(this,"__ee__")&&(s=this.__ee__[e]))if("object"===_typeof3(s)){for(i=arguments.length,a=new Array(i-1),n=1;n<i;++n)a[n-1]=arguments[n];for(s=s.slice(),n=0;o=s[n];++n)u.call(o,this,a)}else switch(arguments.length){case 1:l.call(s,this);break;case 2:l.call(s,this,t);break;case 3:l.call(s,this,t,r);break;default:for(i=arguments.length,a=new Array(i-1),n=1;n<i;++n)a[n-1]=arguments[n];u.call(s,this,a)}},e={on:p,once:f,off:d,emit:y},m={on:n(p),once:n(f),off:n(d),emit:n(y)},g=a({},m);t.exports=r=function(e){return null==e?i(g):a(Object(e),m)},r.methods=e},{d:79,"es5-ext/object/valid-callable":89}],95:[function(e,u,t){(function(e){(function(){function i(e,t){for(var r=(t=t||[]).length,n=0;n<e.length;n++)Array.isArray(e[n])&&Array.isArray(e[n][0])?(i(e[n],t),r=t.length):t[r++]=e[n];return Array.isArray(t[0])?t:[t]}function t(e){return Math.max.apply(null,e.map(function(e){return e[1]}))}function r(e){return Math.max.apply(null,e.map(function(e){return e[0]}))}function n(e){return Math.min.apply(null,e.map(function(e){return e[1]}))}function o(e){return Math.min.apply(null,e.map(function(e){return e[0]}))}function s(e){return i(e.geometry.coordinates)}function a(e){if(!e)return[];switch(e.type){case"Feature":return s(e);case"GeometryCollection":return i(e.geometries.map(a));case"FeatureCollection":return i(e.features.map(s));case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiPolygon":case"MultiLineString":return i(e.coordinates);default:return[]}}u.exports={envelope:function(e){return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[(e={minLng:o(e=a(e)),minLat:n(e),maxLng:r(e),maxLat:t(e)}).minLng,e.minLat],[e.minLng,e.maxLat],[e.maxLng,e.maxLat],[e.maxLng,e.minLat],[e.minLng,e.minLat]]]}}},extent:function(e){return[o(e=a(e)),n(e),r(e),t(e)]},centroid:function(e){return function(e){for(var t={x:0,y:0},r=0,n=0,i=0,o=0,s=0,a=0,u=0;u<e.length-1;u++)n=e[u][0],i=e[u][1],o=e[u+1][0],r+=a=n*(s=e[u+1][1])-o*i,t.x+=(n+o)*a,t.y+=(i+s)*a;return n=e[e.length-1][0],i=e[e.length-1][1],o=e[0][0],r+=a=n*(s=e[0][1])-o*i,t.x+=(n+o)*a,t.y+=(i+s)*a,r*=.5,t.x=t.x/(6*r),t.y=t.y/(6*r),[t.x,t.y]}(a(e))},xMin:function(e){return o(a(e))},xMax:function(e){return r(a(e))},yMin:function(e){return n(a(e))},yMax:function(e){return t(a(e))}}}).call(this)}).call(this,e("_process"))},{_process:262}],96:[function(e,t,r){var n=e("rbush"),i=e("@turf/helpers"),o=e("@turf/meta"),s=e("@turf/bbox").default,a=o.featureEach,u=(o.coordEach,i.polygon,i.featureCollection);function l(e){e=n(e);return e.insert=function(e){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox||s(e),n.prototype.insert.call(this,e)},e.load=function(e){var t=[];return Array.isArray(e)?e.forEach(function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox||s(e),t.push(e)}):a(e,function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox||s(e),t.push(e)}),n.prototype.load.call(this,t)},e.remove=function(e,t){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox||s(e),n.prototype.remove.call(this,e,t)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(e){e=n.prototype.search.call(this,this.toBBox(e));return u(e)},e.collides=function(e){return n.prototype.collides.call(this,this.toBBox(e))},e.all=function(){var e=n.prototype.all.call(this);return u(e)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(e){return n.prototype.fromJSON.call(this,e)},e.toBBox=function(e){var t;if(e.bbox)t=e.bbox;else if(Array.isArray(e)&&4===e.length)t=e;else if(Array.isArray(e)&&6===e.length)t=[e[0],e[1],e[3],e[4]];else if("Feature"===e.type)t=s(e);else{if("FeatureCollection"!==e.type)throw new Error("invalid geojson");t=s(e)}return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},e}t.exports=l,t.exports.default=l},{"@turf/bbox":10,"@turf/helpers":45,"@turf/meta":57,rbush:264}],97:[function(e,t,r){var s,n=(s={km:6371,mile:3960,meter:6371e3,nmi:3440},function(e,t,r){var n=(r=r||{}).unit in s?s[r.unit]:s.km,i=u(r.format,e),o=u(r.format,t),e=a(o.latitude-i.latitude),t=a(o.longitude-i.longitude),i=a(i.latitude),o=a(o.latitude),o=Math.sin(e/2)*Math.sin(e/2)+Math.sin(t/2)*Math.sin(t/2)*Math.cos(i)*Math.cos(o),o=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return r.threshold?r.threshold>n*o:n*o});function a(e){return e*Math.PI/180}function u(e,t){switch(e){case"[lat,lon]":return{latitude:t[0],longitude:t[1]};case"[lon,lat]":return{latitude:t[1],longitude:t[0]};case"{lon,lat}":return{latitude:t.lat,longitude:t.lon};case"{lat,lng}":return{latitude:t.lat,longitude:t.lng};case"geojson":return{latitude:t.geometry.coordinates[1],longitude:t.geometry.coordinates[0]};default:return t}}void 0!==t&&t.exports&&(t.exports=n)},{}],98:[function(e,t,r){"use strict";var n=/&/g,i=/</g,o=/\'/g,s=/\"/g,a=/[&<>\"\']/;t.exports=function(e){return null==e?e:("string"!=typeof e&&(e=String(e)),a.test(String(e))?e.replace(n,"&amp;").replace(i,"&lt;").replace(o,"&apos;").replace(s,"&quot;"):e)}},{}],99:[function(e,t,r){e=e("./_getNative")(e("./_root"),"DataView");t.exports=e},{"./_getNative":154,"./_root":189}],100:[function(e,t,r){var n=e("./_hashClear"),i=e("./_hashDelete"),o=e("./_hashGet"),s=e("./_hashHas"),e=e("./_hashSet");function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=n,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=e,t.exports=a},{"./_hashClear":160,"./_hashDelete":161,"./_hashGet":162,"./_hashHas":163,"./_hashSet":164}],101:[function(e,t,r){var n=e("./_listCacheClear"),i=e("./_listCacheDelete"),o=e("./_listCacheGet"),s=e("./_listCacheHas"),e=e("./_listCacheSet");function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=n,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=e,t.exports=a},{"./_listCacheClear":171,"./_listCacheDelete":172,"./_listCacheGet":173,"./_listCacheHas":174,"./_listCacheSet":175}],102:[function(e,t,r){e=e("./_getNative")(e("./_root"),"Map");t.exports=e},{"./_getNative":154,"./_root":189}],103:[function(e,t,r){var n=e("./_mapCacheClear"),i=e("./_mapCacheDelete"),o=e("./_mapCacheGet"),s=e("./_mapCacheHas"),e=e("./_mapCacheSet");function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=n,a.prototype.delete=i,a.prototype.get=o,a.prototype.has=s,a.prototype.set=e,t.exports=a},{"./_mapCacheClear":176,"./_mapCacheDelete":177,"./_mapCacheGet":178,"./_mapCacheHas":179,"./_mapCacheSet":180}],104:[function(e,t,r){e=e("./_getNative")(e("./_root"),"Promise");t.exports=e},{"./_getNative":154,"./_root":189}],105:[function(e,t,r){e=e("./_getNative")(e("./_root"),"Set");t.exports=e},{"./_getNative":154,"./_root":189}],106:[function(e,t,r){var n=e("./_MapCache"),i=e("./_setCacheAdd"),e=e("./_setCacheHas");function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=e,t.exports=o},{"./_MapCache":103,"./_setCacheAdd":190,"./_setCacheHas":191}],107:[function(e,t,r){var n=e("./_ListCache"),i=e("./_stackClear"),o=e("./_stackDelete"),s=e("./_stackGet"),a=e("./_stackHas"),e=e("./_stackSet");function u(e){e=this.__data__=new n(e);this.size=e.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=e,t.exports=u},{"./_ListCache":101,"./_stackClear":193,"./_stackDelete":194,"./_stackGet":195,"./_stackHas":196,"./_stackSet":197}],108:[function(e,t,r){e=e("./_root").Symbol;t.exports=e},{"./_root":189}],109:[function(e,t,r){e=e("./_root").Uint8Array;t.exports=e},{"./_root":189}],110:[function(e,t,r){e=e("./_getNative")(e("./_root"),"WeakMap");t.exports=e},{"./_getNative":154,"./_root":189}],111:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},{}],112:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}},{}],113:[function(e,t,r){var c=e("./_baseTimes"),h=e("./isArguments"),p=e("./isArray"),f=e("./isBuffer"),d=e("./_isIndex"),y=e("./isTypedArray"),m=Object.prototype.hasOwnProperty;t.exports=function(e,t){var r,n=p(e),i=!n&&h(e),o=!n&&!i&&f(e),s=!n&&!i&&!o&&y(e),a=n||i||o||s,u=a?c(e.length,String):[],l=u.length;for(r in e)!t&&!m.call(e,r)||a&&("length"==r||o&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||d(r,l))||u.push(r);return u}},{"./_baseTimes":138,"./_isIndex":165,"./isArguments":206,"./isArray":207,"./isBuffer":209,"./isTypedArray":215}],114:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}},{}],115:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},{}],116:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},{}],117:[function(e,t,r){var n=e("./eq");t.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},{"./eq":201}],118:[function(e,t,r){var n=e("./_baseForOwn"),n=e("./_createBaseEach")(n);t.exports=n},{"./_baseForOwn":120,"./_createBaseEach":145}],119:[function(e,t,r){e=e("./_createBaseFor")();t.exports=e},{"./_createBaseFor":146}],120:[function(e,t,r){var n=e("./_baseFor"),i=e("./keys");t.exports=function(e,t){return e&&n(e,t,i)}},{"./_baseFor":119,"./keys":216}],121:[function(e,t,r){var i=e("./_castPath"),o=e("./_toKey");t.exports=function(e,t){for(var r=0,n=(t=i(t,e)).length;null!=e&&r<n;)e=e[o(t[r++])];return r&&r==n?e:void 0}},{"./_castPath":143,"./_toKey":199}],122:[function(e,t,r){var n=e("./_arrayPush"),i=e("./isArray");t.exports=function(e,t,r){return t=t(e),i(e)?t:n(t,r(e))}},{"./_arrayPush":115,"./isArray":207}],123:[function(e,t,r){var n=e("./_Symbol"),i=e("./_getRawTag"),o=e("./_objectToString"),s=n?n.toStringTag:void 0;t.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(s&&s in Object(e)?i:o)(e)}},{"./_Symbol":108,"./_getRawTag":155,"./_objectToString":187}],124:[function(e,t,r){t.exports=function(e,t){return null!=e&&t in Object(e)}},{}],125:[function(e,t,r){var n=e("./_baseGetTag"),i=e("./isObjectLike");t.exports=function(e){return i(e)&&"[object Arguments]"==n(e)}},{"./_baseGetTag":123,"./isObjectLike":213}],126:[function(e,t,r){var s=e("./_baseIsEqualDeep"),a=e("./isObjectLike");t.exports=function e(t,r,n,i,o){return t===r||(null==t||null==r||!a(t)&&!a(r)?t!=t&&r!=r:s(t,r,n,i,e,o))}},{"./_baseIsEqualDeep":127,"./isObjectLike":213}],127:[function(e,t,r){var h=e("./_Stack"),p=e("./_equalArrays"),f=e("./_equalByTag"),d=e("./_equalObjects"),y=e("./_getTag"),m=e("./isArray"),g=e("./isBuffer"),v=e("./isTypedArray"),b="[object Arguments]",w="[object Array]",x="[object Object]",_=Object.prototype.hasOwnProperty;t.exports=function(e,t,r,n,i,o){var s=m(e),a=m(t),u=s?w:y(e),l=a?w:y(t),c=(u=u==b?x:u)==x,a=(l=l==b?x:l)==x;if((l=u==l)&&g(e)){if(!g(t))return!1;c=!(s=!0)}if(l&&!c)return o=o||new h,s||v(e)?p(e,t,r,n,i,o):f(e,t,u,r,n,i,o);if(!(1&r)){c=c&&_.call(e,"__wrapped__"),a=a&&_.call(t,"__wrapped__");if(c||a)return i(c?e.value():e,a?t.value():t,r,n,o=o||new h)}return!!l&&(o=o||new h,d(e,t,r,n,i,o))}},{"./_Stack":107,"./_equalArrays":147,"./_equalByTag":148,"./_equalObjects":149,"./_getTag":157,"./isArray":207,"./isBuffer":209,"./isTypedArray":215}],128:[function(e,t,r){var f=e("./_Stack"),d=e("./_baseIsEqual");t.exports=function(e,t,r,n){var i=r.length,o=i,s=!n;if(null==e)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var u=(a=r[i])[0],l=e[u],c=a[1];if(s&&a[2]){if(void 0===l&&!(u in e))return!1}else{var h,p=new f;if(n&&(h=n(l,c,u,e,t,p)),!(void 0===h?d(c,l,3,n,p):h))return!1}}return!0}},{"./_Stack":107,"./_baseIsEqual":126}],129:[function(e,t,r){var n=e("./isFunction"),i=e("./_isMasked"),o=e("./isObject"),s=e("./_toSource"),a=/^\[object .+?Constructor\]$/,u=Function.prototype,e=Object.prototype,u=u.toString,e=e.hasOwnProperty,l=RegExp("^"+u.call(e).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(e){return!(!o(e)||i(e))&&(n(e)?l:a).test(s(e))}},{"./_isMasked":168,"./_toSource":200,"./isFunction":210,"./isObject":212}],130:[function(e,t,r){var n=e("./_baseGetTag"),i=e("./isLength"),o=e("./isObjectLike"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(e){return o(e)&&i(e.length)&&!!s[n(e)]}},{"./_baseGetTag":123,"./isLength":211,"./isObjectLike":213}],131:[function(e,t,r){var n=e("./_baseMatches"),i=e("./_baseMatchesProperty"),o=e("./identity"),s=e("./isArray"),a=e("./property");t.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==_typeof3(e)?s(e)?i(e[0],e[1]):n(e):a(e)}},{"./_baseMatches":134,"./_baseMatchesProperty":135,"./identity":205,"./isArray":207,"./property":219}],132:[function(e,t,r){var n=e("./_isPrototype"),i=e("./_nativeKeys"),o=Object.prototype.hasOwnProperty;t.exports=function(e){if(!n(e))return i(e);var t,r=[];for(t in Object(e))o.call(e,t)&&"constructor"!=t&&r.push(t);return r}},{"./_isPrototype":169,"./_nativeKeys":185}],133:[function(e,t,r){var s=e("./_baseEach"),a=e("./isArrayLike");t.exports=function(e,n){var i=-1,o=a(e)?Array(e.length):[];return s(e,function(e,t,r){o[++i]=n(e,t,r)}),o}},{"./_baseEach":118,"./isArrayLike":208}],134:[function(e,t,r){var n=e("./_baseIsMatch"),i=e("./_getMatchData"),o=e("./_matchesStrictComparable");t.exports=function(t){var r=i(t);return 1==r.length&&r[0][2]?o(r[0][0],r[0][1]):function(e){return e===t||n(e,t,r)}}},{"./_baseIsMatch":128,"./_getMatchData":153,"./_matchesStrictComparable":182}],135:[function(e,t,r){var i=e("./_baseIsEqual"),o=e("./get"),s=e("./hasIn"),a=e("./_isKey"),u=e("./_isStrictComparable"),l=e("./_matchesStrictComparable"),c=e("./_toKey");t.exports=function(r,n){return a(r)&&u(n)?l(c(r),n):function(e){var t=o(e,r);return void 0===t&&t===n?s(e,r):i(n,t,3)}}},{"./_baseIsEqual":126,"./_isKey":166,"./_isStrictComparable":170,"./_matchesStrictComparable":182,"./_toKey":199,"./get":203,"./hasIn":204}],136:[function(e,t,r){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},{}],137:[function(e,t,r){var n=e("./_baseGet");t.exports=function(t){return function(e){return n(e,t)}}},{"./_baseGet":121}],138:[function(e,t,r){t.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},{}],139:[function(e,t,r){var n=e("./_Symbol"),i=e("./_arrayMap"),o=e("./isArray"),s=e("./isSymbol"),a=1/0,n=n?n.prototype:void 0,u=n?n.toString:void 0;t.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-a?"-0":r}},{"./_Symbol":108,"./_arrayMap":114,"./isArray":207,"./isSymbol":214}],140:[function(e,t,r){t.exports=function(t){return function(e){return t(e)}}},{}],141:[function(e,t,r){t.exports=function(e,t){return e.has(t)}},{}],142:[function(e,t,r){var n=e("./identity");t.exports=function(e){return"function"==typeof e?e:n}},{"./identity":205}],143:[function(e,t,r){var n=e("./isArray"),i=e("./_isKey"),o=e("./_stringToPath"),s=e("./toString");t.exports=function(e,t){return n(e)?e:i(e,t)?[e]:o(s(e))}},{"./_isKey":166,"./_stringToPath":198,"./isArray":207,"./toString":222}],144:[function(e,t,r){e=e("./_root")["__core-js_shared__"];t.exports=e},{"./_root":189}],145:[function(e,t,r){var a=e("./isArrayLike");t.exports=function(o,s){return function(e,t){if(null==e)return e;if(!a(e))return o(e,t);for(var r=e.length,n=s?r:-1,i=Object(e);(s?n--:++n<r)&&!1!==t(i[n],n,i););return e}}},{"./isArrayLike":208}],146:[function(e,t,r){t.exports=function(u){return function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[u?s:++n];if(!1===t(i[a],a,i))break}return e}}},{}],147:[function(e,t,r){var m=e("./_SetCache"),g=e("./_arraySome"),v=e("./_cacheHas");t.exports=function(e,t,r,n,i,o){var s=1&r,a=e.length,u=t.length;if(a!=u&&!(s&&a<u))return!1;var l=o.get(e),u=o.get(t);if(l&&u)return l==t&&u==e;var c=-1,h=!0,p=2&r?new m:void 0;for(o.set(e,t),o.set(t,e);++c<a;){var f,d=e[c],y=t[c];if(n&&(f=s?n(y,d,c,t,e,o):n(d,y,c,e,t,o)),void 0!==f){if(f)continue;h=!1;break}if(p){if(!g(t,function(e,t){if(!v(p,t)&&(d===e||i(d,e,r,n,o)))return p.push(t)})){h=!1;break}}else if(d!==y&&!i(d,y,r,n,o)){h=!1;break}}return o.delete(e),o.delete(t),h}},{"./_SetCache":106,"./_arraySome":116,"./_cacheHas":141}],148:[function(e,t,r){var n=e("./_Symbol"),l=e("./_Uint8Array"),c=e("./eq"),h=e("./_equalArrays"),p=e("./_mapToArray"),f=e("./_setToArray"),n=n?n.prototype:void 0,d=n?n.valueOf:void 0;t.exports=function(e,t,r,n,i,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return e.byteLength==t.byteLength&&o(new l(e),new l(t))?!0:!1;case"[object Boolean]":case"[object Date]":case"[object Number]":return c(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=p;case"[object Set]":var u=1&n,a=a||f;if(e.size!=t.size&&!u)return!1;u=s.get(e);if(u)return u==t;n|=2,s.set(e,t);a=h(a(e),a(t),n,i,o,s);return s.delete(e),a;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},{"./_Symbol":108,"./_Uint8Array":109,"./_equalArrays":147,"./_mapToArray":181,"./_setToArray":192,"./eq":201}],149:[function(e,t,r){var v=e("./_getAllKeys"),b=Object.prototype.hasOwnProperty;t.exports=function(e,t,r,n,i,o){var s=1&r,a=v(e),u=a.length;if(u!=v(t).length&&!s)return!1;for(var l=u;l--;){var c=a[l];if(!(s?c in t:b.call(t,c)))return!1}var h=o.get(e),p=o.get(t);if(h&&p)return h==t&&p==e;var f=!0;o.set(e,t),o.set(t,e);for(var d=s;++l<u;){var y,m=e[c=a[l]],g=t[c];if(n&&(y=s?n(g,m,c,t,e,o):n(m,g,c,e,t,o)),!(void 0===y?m===g||i(m,g,r,n,o):y)){f=!1;break}d=d||"constructor"==c}return!f||d||(h=e.constructor)!=(p=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof h&&h instanceof h&&"function"==typeof p&&p instanceof p)&&(f=!1),o.delete(e),o.delete(t),f}},{"./_getAllKeys":151}],150:[function(e,r,t){(function(t){(function(){var e="object"==_typeof3(t)&&t&&t.Object===Object&&t;r.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],151:[function(e,t,r){var n=e("./_baseGetAllKeys"),i=e("./_getSymbols"),o=e("./keys");t.exports=function(e){return n(e,o,i)}},{"./_baseGetAllKeys":122,"./_getSymbols":156,"./keys":216}],152:[function(e,t,r){var n=e("./_isKeyable");t.exports=function(e,t){return e=e.__data__,n(t)?e["string"==typeof t?"string":"hash"]:e.map}},{"./_isKeyable":167}],153:[function(e,t,r){var o=e("./_isStrictComparable"),s=e("./keys");t.exports=function(e){for(var t=s(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,o(i)]}return t}},{"./_isStrictComparable":170,"./keys":216}],154:[function(e,t,r){var n=e("./_baseIsNative"),i=e("./_getValue");t.exports=function(e,t){return t=i(e,t),n(t)?t:void 0}},{"./_baseIsNative":129,"./_getValue":158}],155:[function(e,t,r){var n=e("./_Symbol"),e=Object.prototype,o=e.hasOwnProperty,s=e.toString,a=n?n.toStringTag:void 0;t.exports=function(e){var t=o.call(e,a),r=e[a];try{var n=!(e[a]=void 0)}catch(e){}var i=s.call(e);return n&&(t?e[a]=r:delete e[a]),i}},{"./_Symbol":108}],156:[function(e,t,r){var n=e("./_arrayFilter"),e=e("./stubArray"),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,e=o?function(t){return null==t?[]:(t=Object(t),n(o(t),function(e){return i.call(t,e)}))}:e;t.exports=e},{"./_arrayFilter":112,"./stubArray":220}],157:[function(e,t,r){var n=e("./_DataView"),i=e("./_Map"),o=e("./_Promise"),s=e("./_Set"),a=e("./_WeakMap"),u=e("./_baseGetTag"),l=e("./_toSource"),c="[object Map]",h="[object Promise]",p="[object Set]",f="[object WeakMap]",d="[object DataView]",y=l(n),m=l(i),g=l(o),v=l(s),b=l(a),e=u;(n&&e(new n(new ArrayBuffer(1)))!=d||i&&e(new i)!=c||o&&e(o.resolve())!=h||s&&e(new s)!=p||a&&e(new a)!=f)&&(e=function(e){var t=u(e),e="[object Object]"==t?e.constructor:void 0,e=e?l(e):"";if(e)switch(e){case y:return d;case m:return c;case g:return h;case v:return p;case b:return f}return t}),t.exports=e},{"./_DataView":99,"./_Map":102,"./_Promise":104,"./_Set":105,"./_WeakMap":110,"./_baseGetTag":123,"./_toSource":200}],158:[function(e,t,r){t.exports=function(e,t){return null==e?void 0:e[t]}},{}],159:[function(e,t,r){var a=e("./_castPath"),u=e("./isArguments"),l=e("./isArray"),c=e("./_isIndex"),h=e("./isLength"),p=e("./_toKey");t.exports=function(e,t,r){for(var n=-1,i=(t=a(t,e)).length,o=!1;++n<i;){var s=p(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&h(i)&&c(s,i)&&(l(e)||u(e))}},{"./_castPath":143,"./_isIndex":165,"./_toKey":199,"./isArguments":206,"./isArray":207,"./isLength":211}],160:[function(e,t,r){var n=e("./_nativeCreate");t.exports=function(){this.__data__=n?n(null):{},this.size=0}},{"./_nativeCreate":184}],161:[function(e,t,r){t.exports=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e}},{}],162:[function(e,t,r){var n=e("./_nativeCreate"),i=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return i.call(t,e)?t[e]:void 0}},{"./_nativeCreate":184}],163:[function(e,t,r){var n=e("./_nativeCreate"),i=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},{"./_nativeCreate":184}],164:[function(e,t,r){var n=e("./_nativeCreate");t.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},{"./_nativeCreate":184}],165:[function(e,t,r){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(e,t){var r=_typeof3(e);return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&-1<e&&e%1==0&&e<t}},{}],166:[function(e,t,r){var n=e("./isArray"),i=e("./isSymbol"),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(e,t){if(n(e))return!1;var r=_typeof3(e);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},{"./isArray":207,"./isSymbol":214}],167:[function(e,t,r){t.exports=function(e){var t=_typeof3(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},{}],168:[function(e,t,r){var e=e("./_coreJsData"),n=(e=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"";t.exports=function(e){return!!n&&n in e}},{"./_coreJsData":144}],169:[function(e,t,r){var n=Object.prototype;t.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},{}],170:[function(e,t,r){var n=e("./isObject");t.exports=function(e){return e==e&&!n(e)}},{"./isObject":212}],171:[function(e,t,r){t.exports=function(){this.__data__=[],this.size=0}},{}],172:[function(e,t,r){var n=e("./_assocIndexOf"),i=Array.prototype.splice;t.exports=function(e){var t=this.__data__;return!((e=n(t,e))<0)&&(e==t.length-1?t.pop():i.call(t,e,1),--this.size,!0)}},{"./_assocIndexOf":117}],173:[function(e,t,r){var n=e("./_assocIndexOf");t.exports=function(e){var t=this.__data__;return(e=n(t,e))<0?void 0:t[e][1]}},{"./_assocIndexOf":117}],174:[function(e,t,r){var n=e("./_assocIndexOf");t.exports=function(e){return-1<n(this.__data__,e)}},{"./_assocIndexOf":117}],175:[function(e,t,r){var i=e("./_assocIndexOf");t.exports=function(e,t){var r=this.__data__,n=i(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}},{"./_assocIndexOf":117}],176:[function(e,t,r){var n=e("./_Hash"),i=e("./_ListCache"),o=e("./_Map");t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},{"./_Hash":100,"./_ListCache":101,"./_Map":102}],177:[function(e,t,r){var n=e("./_getMapData");t.exports=function(e){return e=n(this,e).delete(e),this.size-=e?1:0,e}},{"./_getMapData":152}],178:[function(e,t,r){var n=e("./_getMapData");t.exports=function(e){return n(this,e).get(e)}},{"./_getMapData":152}],179:[function(e,t,r){var n=e("./_getMapData");t.exports=function(e){return n(this,e).has(e)}},{"./_getMapData":152}],180:[function(e,t,r){var i=e("./_getMapData");t.exports=function(e,t){var r=i(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}},{"./_getMapData":152}],181:[function(e,t,r){t.exports=function(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n}},{}],182:[function(e,t,r){t.exports=function(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}}},{}],183:[function(e,t,r){var n=e("./memoize");t.exports=function(e){var t=(e=n(e,function(e){return 500===t.size&&t.clear(),e})).cache;return e}},{"./memoize":218}],184:[function(e,t,r){e=e("./_getNative")(Object,"create");t.exports=e},{"./_getNative":154}],185:[function(e,t,r){e=e("./_overArg")(Object.keys,Object);t.exports=e},{"./_overArg":188}],186:[function(e,t,r){var e=e("./_freeGlobal"),r="object"==_typeof3(r)&&r&&!r.nodeType&&r,n=r&&"object"==_typeof3(t)&&t&&!t.nodeType&&t,i=n&&n.exports===r&&e.process,e=function(){try{var e=n&&n.require&&n.require("util").types;return e?e:i&&i.binding&&i.binding("util")}catch(e){}}();t.exports=e},{"./_freeGlobal":150}],187:[function(e,t,r){var n=Object.prototype.toString;t.exports=function(e){return n.call(e)}},{}],188:[function(e,t,r){t.exports=function(t,r){return function(e){return t(r(e))}}},{}],189:[function(e,t,r){var n=e("./_freeGlobal"),e="object"==("undefined"==typeof self?"undefined":_typeof3(self))&&self&&self.Object===Object&&self,e=n||e||Function("return this")();t.exports=e},{"./_freeGlobal":150}],190:[function(e,t,r){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},{}],191:[function(e,t,r){t.exports=function(e){return this.__data__.has(e)}},{}],192:[function(e,t,r){t.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},{}],193:[function(e,t,r){var n=e("./_ListCache");t.exports=function(){this.__data__=new n,this.size=0}},{"./_ListCache":101}],194:[function(e,t,r){t.exports=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}},{}],195:[function(e,t,r){t.exports=function(e){return this.__data__.get(e)}},{}],196:[function(e,t,r){t.exports=function(e){return this.__data__.has(e)}},{}],197:[function(e,t,r){var i=e("./_ListCache"),o=e("./_Map"),s=e("./_MapCache");t.exports=function(e,t){var r=this.__data__;if(r instanceof i){var n=r.__data__;if(!o||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new s(n)}return r.set(e,t),this.size=r.size,this}},{"./_ListCache":101,"./_Map":102,"./_MapCache":103}],198:[function(e,t,r){var e=e("./_memoizeCapped"),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,e=e(function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(n,function(e,t,r,n){i.push(r?n.replace(o,"$1"):t||e)}),i});t.exports=e},{"./_memoizeCapped":183}],199:[function(e,t,r){var n=e("./isSymbol");t.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},{"./isSymbol":214}],200:[function(e,t,r){var n=Function.prototype.toString;t.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},{}],201:[function(e,t,r){t.exports=function(e,t){return e===t||e!=e&&t!=t}},{}],202:[function(e,t,r){var n=e("./_arrayEach"),i=e("./_baseEach"),o=e("./_castFunction"),s=e("./isArray");t.exports=function(e,t){return(s(e)?n:i)(e,o(t))}},{"./_arrayEach":111,"./_baseEach":118,"./_castFunction":142,"./isArray":207}],203:[function(e,t,r){var n=e("./_baseGet");t.exports=function(e,t,r){return void 0===(t=null==e?void 0:n(e,t))?r:t}},{"./_baseGet":121}],204:[function(e,t,r){var n=e("./_baseHasIn"),i=e("./_hasPath");t.exports=function(e,t){return null!=e&&i(e,t,n)}},{"./_baseHasIn":124,"./_hasPath":159}],205:[function(e,t,r){t.exports=function(e){return e}},{}],206:[function(e,t,r){var n=e("./_baseIsArguments"),i=e("./isObjectLike"),e=Object.prototype,o=e.hasOwnProperty,s=e.propertyIsEnumerable,n=n(function(){return arguments}())?n:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};t.exports=n},{"./_baseIsArguments":125,"./isObjectLike":213}],207:[function(e,t,r){var n=Array.isArray;t.exports=n},{}],208:[function(e,t,r){var n=e("./isFunction"),i=e("./isLength");t.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},{"./isFunction":210,"./isLength":211}],209:[function(e,t,r){var n=e("./_root"),i=e("./stubFalse"),e="object"==_typeof3(r)&&r&&!r.nodeType&&r,r=e&&"object"==_typeof3(t)&&t&&!t.nodeType&&t,n=r&&r.exports===e?n.Buffer:void 0,i=(n?n.isBuffer:void 0)||i;t.exports=i},{"./_root":189,"./stubFalse":221}],210:[function(e,t,r){var n=e("./_baseGetTag"),i=e("./isObject");t.exports=function(e){return!!i(e)&&("[object Function]"==(e=n(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)}},{"./_baseGetTag":123,"./isObject":212}],211:[function(e,t,r){t.exports=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}},{}],212:[function(e,t,r){t.exports=function(e){var t=_typeof3(e);return null!=e&&("object"==t||"function"==t)}},{}],213:[function(e,t,r){t.exports=function(e){return null!=e&&"object"==_typeof3(e)}},{}],214:[function(e,t,r){var n=e("./_baseGetTag"),i=e("./isObjectLike");t.exports=function(e){return"symbol"==_typeof3(e)||i(e)&&"[object Symbol]"==n(e)}},{"./_baseGetTag":123,"./isObjectLike":213}],215:[function(e,t,r){var n=e("./_baseIsTypedArray"),i=e("./_baseUnary"),e=e("./_nodeUtil"),e=e&&e.isTypedArray,n=e?i(e):n;t.exports=n},{"./_baseIsTypedArray":130,"./_baseUnary":140,"./_nodeUtil":186}],216:[function(e,t,r){var n=e("./_arrayLikeKeys"),i=e("./_baseKeys"),o=e("./isArrayLike");t.exports=function(e){return(o(e)?n:i)(e)}},{"./_arrayLikeKeys":113,"./_baseKeys":132,"./isArrayLike":208}],217:[function(e,t,r){var n=e("./_arrayMap"),i=e("./_baseIteratee"),o=e("./_baseMap"),s=e("./isArray");t.exports=function(e,t){return(s(e)?n:o)(e,i(t,3))}},{"./_arrayMap":114,"./_baseIteratee":131,"./_baseMap":133,"./isArray":207}],218:[function(e,t,r){var s=e("./_MapCache"),a="Expected a function";function u(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new TypeError(a);function o(){var e=arguments,t=i?i.apply(this,e):e[0],r=o.cache;return r.has(t)?r.get(t):(e=n.apply(this,e),o.cache=r.set(t,e)||r,e)}return o.cache=new(u.Cache||s),o}u.Cache=s,t.exports=u},{"./_MapCache":103}],219:[function(e,t,r){var n=e("./_baseProperty"),i=e("./_basePropertyDeep"),o=e("./_isKey"),s=e("./_toKey");t.exports=function(e){return o(e)?n(s(e)):i(e)}},{"./_baseProperty":136,"./_basePropertyDeep":137,"./_isKey":166,"./_toKey":199}],220:[function(e,t,r){t.exports=function(){return[]}},{}],221:[function(e,t,r){t.exports=function(){return!1}},{}],222:[function(e,t,r){var n=e("./_baseToString");t.exports=function(e){return null==e?"":n(e)}},{"./_baseToString":139}],223:[function(e,t,r){var n,i;n=this,i=function(){return e.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},e.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},e.prototype.loadKey=e.prototype.loadDatabase=function(t,r){var e=this.app,n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(e,t,function(e){"function"==typeof r?0!==e.id?r(e.val):r(null):console.log(e.val)}):this.catalog=new s(function(e){n.catalog=e,n.loadDatabase(t,r)})},e.prototype.saveKey=e.prototype.saveDatabase=function(t,r,n){var e=this.app,i=this;function o(e){e&&!0===e.success?n(null):n(new Error("Error saving database")),i.options.closeAfterSave&&i.closeDatabase()}null!==this.catalog&&null!==this.catalog.db?this.catalog.setAppKey(e,t,r,o):this.catalog=new s(function(e){i.saveDatabase(t,r,o)})},e.prototype.deleteKey=e.prototype.deleteDatabase=function(t,r){var e=this.app,n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(e,t,function(e){e=e.id;0!==e?n.catalog.deleteAppKey(e,r):"function"==typeof r&&r({success:!0})}):this.catalog=new s(function(e){n.catalog=e,n.deleteDatabase(t,r)})},e.prototype.deleteDatabasePartitions=function(t){var r=this;this.getDatabaseList(function(e){e.forEach(function(e){e.startsWith(t)&&r.deleteDatabase(e)})})},e.prototype.getKeyList=e.prototype.getDatabaseList=function(n){var e=this.app,t=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKeys(e,function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].key);"function"==typeof n?n(t):t.forEach(function(e){console.log(e)})}):this.catalog=new s(function(e){t.catalog=e,t.getDatabaseList(n)})},e.prototype.getCatalogSummary=function(a){this.app;var t=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAllKeys(function(e){for(var t,r,n,i,o=[],s=0;s<e.length;s++)r=(t=e[s]).app||"",n=t.key||"",i=t.val||"",i=2*r.length+2*n.length+i.length+1,o.push({app:t.app,key:t.key,size:i});"function"==typeof a?a(o):o.forEach(function(e){console.log(e)})}):this.catalog=new s(function(e){t.catalog=e,t.getCatalogSummary(a)})},s.prototype.initializeLokiCatalog=function(t){var e=indexedDB.open("LokiCatalog",1),r=this;e.onupgradeneeded=function(e){e=e.target.result;e.objectStoreNames.contains("LokiAKV")&&e.deleteObjectStore("LokiAKV"),e.objectStoreNames.contains("LokiAKV")||((e=e.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0})).createIndex("app","app",{unique:!1}),e.createIndex("key","key",{unique:!1}),e.createIndex("appkey","appkey",{unique:!0}))},e.onsuccess=function(e){r.db=e.target.result,"function"==typeof t&&t(r)},e.onerror=function(e){throw e}},s.prototype.getAppKey=function(e,t,r){var n,i,t=e+","+t,t=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(t);t.onsuccess=(n=r,function(e){e=e.target.result;null==e&&(e={id:0,success:!1}),"function"==typeof n?n(e):console.log(e)}),t.onerror=(i=r,function(e){if("function"!=typeof i)throw e;i({id:0,success:!1})})},s.prototype.getAppKeyById=function(e,t,r){var n,i;this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(e).onsuccess=(n=r,i=t,function(e){"function"==typeof i?i(e.target.result,n):console.log(e.target.result)})},s.prototype.setAppKey=function(n,i,o,s){var t,a=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),e=a.index("appkey"),r=n+","+i,u=e.get(r);u.onsuccess=function(e){e=e.target.result;null==e?e={app:n,key:i,appkey:n+","+i,val:o}:e.val=o;var t,r,e=a.put(e);e.onerror=(t=s,function(e){"function"==typeof t?t({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(u.error))}),e.onsuccess=(r=s,function(e){"function"==typeof r&&r({success:!0})})},u.onerror=(t=s,function(e){"function"==typeof t?t({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(u.error))})},s.prototype.deleteAppKey=function(e,t){var r,n,i=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(e);i.onsuccess=(r=t,function(e){"function"==typeof r&&r({success:!0})}),i.onerror=(n=t,function(e){"function"==typeof n?n({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(i.error))})},s.prototype.getAppKeys=function(e,t){var r,n,i,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),e=IDBKeyRange.only(e),e=o.openCursor(e);e.onsuccess=(r=[],n=t,function(e){var t=e.target.result;t?(e=t.value,r.push(e),t.continue()):"function"==typeof n?n(r):console.log(r)}),e.onerror=(i=t,function(e){"function"==typeof i?i(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(e))})},s.prototype.getAllKeys=function(e){var r,n,t,i=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor();i.onsuccess=(r=[],n=e,function(e){var t=e.target.result;t?(e=t.value,r.push(e),t.continue()):"function"==typeof n?n(r):console.log(r)}),i.onerror=(t=e,function(e){"function"==typeof t&&t(null)})},e;function e(e,t){if(this.app="loki",this.options=t||{},void 0!==e&&(this.app=e),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function s(e){this.db=null,this.initializeLokiCatalog(e)}},"function"==typeof define&&define.amd?define([],i):"object"===_typeof3(r)?t.exports=i():n.LokiIndexedAdapter=i()},{}],224:[function(q,r,n){(function(R,D){(function(){var e,t;e=this,t=function(){"use strict";var _=Object.prototype.hasOwnProperty;function f(e){var t,r;if(Array.isArray(e)){for(r=0;r<e.length;r++)f(e[r]);s(e)}else if(null!==e&&"object"===_typeof3(e)){for(t in e)e.hasOwnProperty(t)&&f(e[t]);s(e)}}function s(e){Object.isFrozen(e)||Object.freeze(e)}function a(e){return Object.isFrozen(e)?h(e,"shallow"):e}var k={copyProperties:function(e,t){for(var r in e)t[r]=e[r]},resolveTransformObject:function(e,t,r){var n,i;if("number"!=typeof r&&(r=0),10<=++r)return e;for(n in e)"string"==typeof e[n]&&0===e[n].indexOf("[%lktxp]")?(i=e[n].substring(8),t.hasOwnProperty(i)&&(e[n]=t[i])):"object"===_typeof3(e[n])&&(e[n]=k.resolveTransformObject(e[n],t,r));return e},resolveTransformParams:function(e,t){var r,n,i=[];if(void 0===t)return e;for(r=0;r<e.length;r++)n=h(e[r],"shallow-recurse-objects"),i.push(k.resolveTransformObject(n,t));return i},getIn:function(e,t,r){if(null!=e){if(!r)return e[t];if("string"==typeof t&&(t=t.split(".")),!Array.isArray(t))throw new Error("path must be a string or array. Found "+_typeof3(t));for(var n=0,i=t.length;null!=e&&n<i;)e=e[t[n++]];return n&&n==i?e:void 0}}},v={aeq:e,lt:t,gt:r};function e(e,t){var r,n,i,o;if(e===t)return!0;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:i=1;break;case!1:i=3;break;case!0:i=4;break;case"":i=5;break;default:i=e==e?9:0}switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}if(9!==i||9!==o)return i===o}return r=Number(e),n=Number(t),r==r||n==n?r===n:(r=e.toString())==(n=t.toString())}function t(e,t,r){var n,i,o,s;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}switch(t){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=t==t?9:0}if(9!==o||9!==s)return o===s?r:o<s}return n=Number(e),i=Number(t),n==n&&i==i?n<i||!(i<n)&&r:n==n&&i!=i||(i!=i||n==n)&&(e<t||!(t<e)&&(e==t?r:(n=e.toString())<(i=t.toString())||n==i&&r))}function r(e,t,r){var n,i,o,s;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}switch(t){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=t==t?9:0}if(9!==o||9!==s)return o===s?r:s<o}return n=Number(e),i=Number(t),n==n&&i==i?i<n||!(n<i)&&r:(n!=n||i==i)&&(i==i&&n!=n||(t<e||!(e<t)&&(e==t?r:(n=e.toString(),(i=t.toString())<n||n==i&&r))))}function d(e,t,r){return v.aeq(e,t)?0:v.lt(e,t,!1)?r?1:-1:v.gt(e,t,!1)?r?-1:1:0}function E(e,t,r,n,i,o){var s,a=o||0,o=t[a],u=!1;if("object"===_typeof3(e)&&o in e&&(s=e[o]),a+1>=t.length)u=r(s,n,i);else if(Array.isArray(s))for(var l=0,c=s.length;l<c&&!0!==(u=E(s[l],t,r,n,i,a+1));l+=1);else u=E(s,t,r,n,i,a+1);return u}function n(t){return"string"==typeof t||Array.isArray(t)?function(e){return-1!==t.indexOf(e)}:"object"===_typeof3(t)&&null!==t?function(e){return _.call(t,e)}:null}function o(e,t,r){for(var n in t)if(_.call(t,n))return S[n](e,t[n],r);return!1}var S={$eq:function(e,t){return e===t},$aeq:function(e,t){return e==t},$ne:function(e,t){return t!=t?e==e:e!==t},$dteq:function(e,t){return v.aeq(e,t)},$gt:function(e,t){return v.gt(e,t,!1)},$gte:function(e,t){return v.gt(e,t,!0)},$lt:function(e,t){return v.lt(e,t,!1)},$lte:function(e,t){return v.lt(e,t,!0)},$jgt:function(e,t){return t<e},$jgte:function(e,t){return t<=e},$jlt:function(e,t){return e<t},$jlte:function(e,t){return e<=t},$between:function(e,t){return null!=e&&(v.gt(e,t[0],!0)&&v.lt(e,t[1],!0))},$jbetween:function(e,t){return null!=e&&(e>=t[0]&&e<=t[1])},$in:function(e,t){return-1!==t.indexOf(e)},$inSet:function(e,t){return t.has(e)},$nin:function(e,t){return-1===t.indexOf(e)},$keyin:function(e,t){return e in t},$nkeyin:function(e,t){return!(e in t)},$definedin:function(e,t){return void 0!==t[e]},$undefinedin:function(e,t){return void 0===t[e]},$regex:function(e,t){return t.test(e)},$containsString:function(e,t){return"string"==typeof e&&-1!==e.indexOf(t)},$containsNone:function(e,t){return!S.$containsAny(e,t)},$containsAny:function(e,t){e=n(e);return null!==e&&(Array.isArray(t)?t.some(e):e(t))},$contains:function(e,t){e=n(e);return null!==e&&(Array.isArray(t)?t.every(e):e(t))},$elemMatch:function(e,n){return!!Array.isArray(e)&&e.some(function(r){return Object.keys(n).every(function(e){var t=n[e];return"object"===_typeof3(t)&&t||(t={$eq:t}),-1!==e.indexOf(".")?E(r,e.split("."),o,n[e],r):o(r[e],t,r)})})},$type:function(e,t,r){var n=_typeof3(e);return"object"===n&&(Array.isArray(e)?n="array":e instanceof Date&&(n="date")),"object"!==_typeof3(t)?n===t:o(n,t,r)},$finite:function(e,t){return t===isFinite(e)},$size:function(e,t,r){return!!Array.isArray(e)&&("object"!==_typeof3(t)?e.length===t:o(e.length,t,r))},$len:function(e,t,r){return"string"==typeof e&&("object"!==_typeof3(t)?e.length===t:o(e.length,t,r))},$where:function(e,t){return!0===t(e)},$not:function(e,t,r){return!o(e,t,r)},$and:function(e,t,r){for(var n=0,i=t.length;n<i;n+=1)if(!o(e,t[n],r))return!1;return!0},$or:function(e,t,r){for(var n=0,i=t.length;n<i;n+=1)if(o(e,t[n],r))return!0;return!1},$exists:function(e,t){return t?void 0!==e:void 0===e}};["$eq","$aeq","$ne","$dteq","$gt","$gte","$lt","$lte","$jgt","$jgte","$jlt","$jlte","$type"].forEach(function(e){var n=S[e];S["$"+e]=function(e,t,r){if("string"==typeof t)return n(e,r[t]);if("function"==typeof t)return n(e,t(r));throw new Error("Invalid argument to $$ matcher")}});var O={$eq:S.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};function h(t,e){if(null==t)return null;switch(e||"parse-stringify"){case"parse-stringify":r=JSON.parse(JSON.stringify(t));break;case"jquery-extend-deep":r=jQuery.extend(!0,{},t);break;case"shallow":r=Object.create(t.constructor.prototype),Object.keys(t).map(function(e){r[e]=t[e]});break;case"shallow-assign":r=Object.create(t.constructor.prototype),Object.assign(r,t);break;case"shallow-recurse-objects":var r=h(t,"shallow");Object.keys(t).forEach(function(e){"object"===_typeof3(t[e])&&"Object"===t[e].constructor.name?r[e]=h(t[e],"shallow-recurse-objects"):Array.isArray(t[e])&&(r[e]=function(e,t){if("parse-stringify"==t)return h(e,t);for(var r=[],n=0,i=e.length;n<i;n++)r[n]=h(e[n],t);return r}(t[e],"shallow-recurse-objects"))})}return r}function i(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(e){return}}function u(){}function l(e,t){this.filename=e||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!t||!t.hasOwnProperty("verbose"))&&t.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]};t&&t.hasOwnProperty("env")?this.ENV=t.env:this.ENV=void 0!==D&&(D.android||D.NSObject)?"NATIVESCRIPT":"undefined"==typeof window||void 0!==D&&D.window&&void 0!==R?"NODEJS":"undefined"==typeof document||-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER","undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(t,!0),this.on("init",this.clearChanges)}function c(e){this.hashStore={},this.options=e||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function p(e,t){if(this.mode="reference",this.adapter=null,this.options=t||{},this.dbref=null,this.dbname="",this.pageIterator={},!e)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===e.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=e,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function y(){try{this.fs=q("fs")}catch(e){this.fs=null}}function m(){}function g(e,t){return this.collection=e,this.filteredrows=[],this.filterInitialized=!1,this}function b(e,t,r){this.collection=e,this.name=t,this.rebuildPending=!1,this.options=r||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new g(e),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.collection.disableFreeze||Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[],filter:[],sort:[]}}function w(e,t){this.name=e,this.data=[],this.idIndex=null,this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=e,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var a=this;(t=t||{}).hasOwnProperty("unique")&&(Array.isArray(t.unique)||(t.unique=[t.unique]),t.unique.forEach(function(e){a.uniqueNames.push(e)})),t.hasOwnProperty("exact")&&t.exact.forEach(function(e){a.constraints.exact[e]=new F(e)}),this.adaptiveBinaryIndices=!t.hasOwnProperty("adaptiveBinaryIndices")||t.adaptiveBinaryIndices,this.transactional=!!t.hasOwnProperty("transactional")&&t.transactional,this.cloneObjects=!!t.hasOwnProperty("clone")&&t.clone,this.cloneMethod=t.hasOwnProperty("cloneMethod")?t.cloneMethod:"parse-stringify",this.asyncListeners=!!t.hasOwnProperty("asyncListeners")&&t.asyncListeners,this.disableMeta=!!t.hasOwnProperty("disableMeta")&&t.disableMeta,this.disableChangesApi=!t.hasOwnProperty("disableChangesApi")||t.disableChangesApi,this.disableDeltaChangesApi=!t.hasOwnProperty("disableDeltaChangesApi")||t.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!t.hasOwnProperty("autoupdate")&&t.autoupdate,this.serializableIndices=!t.hasOwnProperty("serializableIndices")||t.serializableIndices,this.disableFreeze=!t.hasOwnProperty("disableFreeze")||t.disableFreeze,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(t.ttl||-1,t.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.dirtyIds=[];var r=[];if(t&&t.indices)if("[object Array]"===Object.prototype.toString.call(t.indices))r=t.indices;else{if("string"!=typeof t.indices)throw new TypeError("Indices needs to be a string or an array of strings");r=[t.indices]}for(var n=0;n<r.length;n++)this.ensureIndex(r[n]);function u(e,t){var r=null!==t&&"object"===_typeof3(t)?Object.keys(t):null;if(r&&r.length&&["string","boolean","number"].indexOf(_typeof3(t))<0){for(var n={},i=0;i<r.length;i++){var o,s=r[i];t.hasOwnProperty(s)&&(!e.hasOwnProperty(s)||0<=a.uniqueNames.indexOf(s)||"$loki"==s||"meta"==s?n[s]=t[s]:void 0!==(o=u(e[s],t[s]))&&o!={}&&(n[s]=o))}return 0===Object.keys(n).length?void 0:n}return e===t?void 0:t}function i(){a.changes=[]}this.observerCallback=function(e){var t="function"==typeof Set?new Set:[];t.add||(t.add=function(e){return-1===this.indexOf(e)&&this.push(e),this}),e.forEach(function(e){t.add(e.object)}),t.forEach(function(e){if(!_.call(e,"$loki"))return a.removeAutoUpdateObserver(e);try{a.update(e)}catch(e){}})},this.getChangeDelta=function(e,t){return t?u(t,e):JSON.parse(JSON.stringify(e))},this.getObjectDelta=u,this.getChanges=function(){return a.changes},this.flushChanges=i,this.setChangesApi=function(e){a.disableChangesApi=!e,e||(a.disableDeltaChangesApi=!1)},this.on("delete",function(e){a.disableChangesApi||a.createChange(a.name,"R",e)}),this.on("warning",function(e){a.lokiConsoleWrapper.warn(e)}),i()}function x(e){return-1!==e.indexOf(".")}function A(e){return parseFloat(e,10)}function M(e,t){return e+t}function P(e,t){return e-t}function j(e){return e.reduce(M,0)/e.length}function T(e,t,r){if(!1===r)return e[t];for(var n=t.split("."),i=e;0<n.length;)i=i[n.shift()];return i}function C(e,t,r){for(var n,i,o=0,s=e.length;o<s;){if(i=o+s>>1,0===(n=r.apply(null,[t,e[i]])))return{found:!0,index:i};n<0?s=i:o=1+i}return{found:!1,index:s}}function I(r){return function(e,t){return C(e,t,r)}}function N(){}function L(e){this.field=e,this.keyMap=Object.create(null),this.lokiMap=Object.create(null)}function F(e){this.index=Object.create(null),this.field=e}return u.prototype.events={},u.prototype.asyncListeners=!1,u.prototype.on=function(e,t){var r=this;return Array.isArray(e)?e.forEach(function(e){r.on(e,t)}):(this.events[e]||(this.events[e]=[])).push(t),t},u.prototype.emit=function(e){var t,r=this;if(!e||!this.events[e])throw new Error("No event "+e+" defined");this.events[e].length&&(t=Array.prototype.slice.call(arguments,1),this.events[e].forEach(function(e){r.asyncListeners?setTimeout(function(){e.apply(r,t)},1):e.apply(r,t)}))},u.prototype.addListener=u.prototype.on,u.prototype.removeListener=function(e,t){var r=this;Array.isArray(e)?e.forEach(function(e){r.removeListener(e,t)}):this.events[e]&&(e=this.events[e]).splice(e.indexOf(t),1)},((l.prototype=new u).constructor=l).prototype.getIndexedAdapter=function(){var e;return"function"==typeof q&&(e=q("./loki-indexed-adapter.js")),e},l.prototype.configureOptions=function(e,t){var r,n={fs:y,localStorage:m,memory:c};this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==e&&(this.options=e,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof n[e.persistenceMethod]&&(this.persistenceMethod=e.persistenceMethod,this.persistenceAdapter=new n[e.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=e.adapter,this.options.adapter=null,this.isIncremental="incremental"===this.persistenceAdapter.mode),e.autoload&&t&&(r=this,setTimeout(function(){r.loadDatabase(e,e.autoloadCallback)},1)),this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(e,e.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves")&&(this.throttledSaves=this.options.throttledSaves)),this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"}[this.ENV],this.persistenceMethod&&(this.persistenceAdapter=new n[this.persistenceMethod]))},l.prototype.copy=function(e){var t,r,n=new l(this.filename,{env:"NA"});if(e=e||{},n.loadJSONObject(this,{retainDirtyFlags:!0}),e.hasOwnProperty("removeNonSerializable")&&!0===e.removeNonSerializable)for(n.autosaveHandle=null,n.persistenceAdapter=null,t=n.collections.length,r=0;r<t;r++)n.collections[r].constraints=null,n.collections[r].ttl=null;return n},l.prototype.addCollection=function(e,t){var r,n=this.collections.length;if(t&&!0===t.disableMeta){if(!1===t.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===t.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof t.ttl&&0<t.ttl)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(r=0;r<n;r+=1)if(this.collections[r].name===e)return this.collections[r];t=new w(e,t);return t.isIncremental=this.isIncremental,this.collections.push(t),this.verbose&&(t.lokiConsoleWrapper=console),t},l.prototype.loadCollection=function(e){if(!e.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(e)},l.prototype.getCollection=function(e){for(var t=this.collections.length,r=0;r<t;r+=1)if(this.collections[r].name===e)return this.collections[r];return this.emit("warning","collection "+e+" not found"),null},l.prototype.renameCollection=function(e,t){e=this.getCollection(e);return e&&(e.name=t),e},l.prototype.listCollections=function(){for(var e=this.collections.length,t=[];e--;)t.push({name:this.collections[e].name,type:this.collections[e].objType,count:this.collections[e].data.length});return t},l.prototype.removeCollection=function(e){for(var t=this.collections.length,r=0;r<t;r+=1)if(this.collections[r].name===e){var n,i=new w(e,{}),o=this.collections[r];for(n in o)o.hasOwnProperty(n)&&i.hasOwnProperty(n)&&(o[n]=i[n]);return void this.collections.splice(r,1)}},l.prototype.getName=function(){return this.name},l.prototype.serializeReplacer=function(e,t){switch(e){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":return null;case"throttledSavePending":case"throttledCallbacks":return;case"lokiConsoleWrapper":return null;default:return t}},l.prototype.toJson=l.prototype.serialize=function(e){switch((e=e||{}).hasOwnProperty("serializationMethod")||(e.serializationMethod=this.options.serializationMethod),e.serializationMethod){case"normal":return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured();default:return JSON.stringify(this,this.serializeReplacer)}},l.prototype.serializeDestructured=function(e){var t,r,n,i,o,s=[];if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),!0===e.partitioned&&e.hasOwnProperty("partition")&&0<=e.partition)return this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:e.partition});for((o=new l(this.filename)).loadJSONObject(this),t=0;t<o.collections.length;t++)o.collections[t].data=[];if(!0===e.partitioned&&-1===e.partition)return o.serialize({serializationMethod:"normal"});for(s.push(o.serialize({serializationMethod:"normal"})),o=null,t=0;t<this.collections.length;t++)if(n=this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:t}),!1===e.partitioned&&!1===e.delimited){if(!Array.isArray(n))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(i=n.length,r=0;r<i;r++)s.push(n[r]),n[r]=null;s.push("")}else s.push(n);return e.partitioned?(e.delimited,s):e.delimited?(s.push(""),s.join(e.delimiter)):(s.push(""),s)},l.prototype.serializeCollection=function(e){var t,r,n=[];if((e=e||{}).hasOwnProperty("delimited")||(e.delimited=!0),!e.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(t=this.collections[e.collectionIndex].data.length,n=[],r=0;r<t;r++)n.push(JSON.stringify(this.collections[e.collectionIndex].data[r]));return e.delimited?(n.push(""),n.join(e.delimiter)):n},l.prototype.deserializeDestructured=function(e,t){var r,n,i,o=[],s=0,a=1,u=!1;if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.partitioned){if(t.hasOwnProperty("partition"))return-1===t.partition?r=JSON.parse(e[0]):this.deserializeCollection(e[t.partition+1],t);for(n=(r=JSON.parse(e[0])).collections.length,s=0;s<n;s++)r.collections[s].data=this.deserializeCollection(e[s+1],t);return r}if(t.delimited){if(o=e.split(t.delimiter),e=null,0===o.length)return null}else o=e;for(n=(r=JSON.parse(o[0])).collections.length,o[0]=null;!u;)o[a],""===o[a]?++s>n&&(u=!0):(i=JSON.parse(o[a]),r.collections[s].data.push(i)),o[a++]=null;return r},l.prototype.deserializeCollection=function(e,t){var r,n,i=[];for((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.delimited?(i=e.split(t.delimiter)).pop():i=e,n=i.length,r=0;r<n;r++)i[r]=JSON.parse(i[r]);return i},l.prototype.loadJSON=function(e,t){var r;if(0===e.length)r={};else switch(this.options.serializationMethod){case"normal":case"pretty":r=JSON.parse(e);break;case"destructured":r=this.deserializeDestructured(e);break;default:r=JSON.parse(e)}this.loadJSONObject(r,t)},l.prototype.loadJSONObject=function(e,t){var r,n,i,o,s,a,u=0,l=e.collections?e.collections.length:0;for(this.name=e.name,e.hasOwnProperty("throttledSaves")&&t&&!t.hasOwnProperty("throttledSaves")&&(this.throttledSaves=e.throttledSaves),this.collections=[];u<l;u+=1){if(r=e.collections[u],(n=this.addCollection(r.name,{disableChangesApi:r.disableChangesApi,disableDeltaChangesApi:r.disableDeltaChangesApi,disableMeta:r.disableMeta,disableFreeze:!r.hasOwnProperty("disableFreeze")||r.disableFreeze})).adaptiveBinaryIndices=!!r.hasOwnProperty("adaptiveBinaryIndices")&&!0===r.adaptiveBinaryIndices,n.transactional=r.transactional,n.asyncListeners=r.asyncListeners,n.cloneObjects=r.cloneObjects,n.cloneMethod=r.cloneMethod||"parse-stringify",n.autoupdate=r.autoupdate,n.changes=r.changes,n.dirtyIds=r.dirtyIds||[],t&&!0===t.retainDirtyFlags?n.dirty=r.dirty:n.dirty=!1,i=r.data.length,o=0,t&&t.hasOwnProperty(r.name))for(s=function(e){var r,n=t[e.name];return n.proto?(r=n.inflate||k.copyProperties,function(e){var t=new n.proto;return r(e,t),t}):n.inflate}(r);o<i;o++)a=s(r.data[o]),n.data[o]=a,n.addAutoUpdateObserver(a),n.disableFreeze||f(n.data[o]);else for(;o<i;o++)n.data[o]=r.data[o],n.addAutoUpdateObserver(n.data[o]),n.disableFreeze||f(n.data[o]);if(n.maxId=void 0===r.maxId?0:r.maxId,void 0!==r.binaryIndices&&(n.binaryIndices=r.binaryIndices),void 0!==r.transforms&&(n.transforms=r.transforms),n.uniqueNames=[],r.hasOwnProperty("uniqueNames")&&(n.uniqueNames=r.uniqueNames),void 0!==r.DynamicViews){for(var c=0;c<r.DynamicViews.length;c++){var h=r.DynamicViews[c],p=n.addDynamicView(h.name,h.options);p.resultdata=h.resultdata,p.resultsdirty=h.resultsdirty,p.filterPipeline=h.filterPipeline,p.sortCriteriaSimple=h.sortCriteriaSimple,p.sortCriteria=h.sortCriteria,p.sortFunction=null,p.sortDirty=h.sortDirty,n.disableFreeze||(f(p.filterPipeline),p.sortCriteriaSimple?f(p.sortCriteriaSimple):p.sortCriteria&&f(p.sortCriteria)),p.resultset.filteredrows=h.resultset.filteredrows,p.resultset.filterInitialized=h.resultset.filterInitialized,p.rematerialize({removeWhereFilters:!0})}e.databaseVersion<1.5&&(n.ensureAllIndexes(!0),n.dirty=!0)}}},l.prototype.close=function(e){this.autosave&&(this.autosaveDisable(),this.autosaveDirty()&&(this.saveDatabase(e),e=void 0)),e&&this.on("close",e),this.emit("close")},l.prototype.generateChangesNotification=function(e){function t(e){return e.name}var r=[],n=e||this.collections.map(t);return this.collections.forEach(function(e){-1!==n.indexOf(e.name)&&(r=r.concat(e.getChanges()))}),r},l.prototype.serializeChanges=function(e){return JSON.stringify(this.generateChangesNotification(e))},l.prototype.clearChanges=function(){this.collections.forEach(function(e){e.flushChanges&&e.flushChanges()})},c.prototype.loadDatabase=function(e,t){var r=this;this.options.asyncResponses?setTimeout(function(){r.hashStore.hasOwnProperty(e)?t(r.hashStore[e].value):t(null)},this.options.asyncTimeout):this.hashStore.hasOwnProperty(e)?t(this.hashStore[e].value):t(null)},c.prototype.saveDatabase=function(e,t,r){var n,i=this;this.options.asyncResponses?setTimeout(function(){n=i.hashStore.hasOwnProperty(e)?i.hashStore[e].savecount:0,i.hashStore[e]={savecount:n+1,lastsave:new Date,value:t},r()},this.options.asyncTimeout):(n=this.hashStore.hasOwnProperty(e)?this.hashStore[e].savecount:0,this.hashStore[e]={savecount:n+1,lastsave:new Date,value:t},r())},c.prototype.deleteDatabase=function(e,t){this.hashStore.hasOwnProperty(e)&&delete this.hashStore[e],"function"==typeof t&&t()},p.prototype.loadDatabase=function(e,r){var n=this;this.dbname=e,this.dbref=new l(e),this.adapter.loadDatabase(e,function(e){var t;e?("string"!=typeof e&&r(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()")),t=JSON.parse(e),n.dbref.loadJSONObject(t),t=null,n.dbref.collections.length,0!==n.dbref.collections.length?(n.pageIterator={collection:0,pageIndex:0},n.loadNextPartition(0,function(){r(n.dbref)})):r(n.dbref)):r(e)})},p.prototype.loadNextPartition=function(t,r){var e=this.dbname+"."+t,n=this;if(!0===this.options.paging)return this.pageIterator.pageIndex=0,void this.loadNextPage(r);this.adapter.loadDatabase(e,function(e){e=n.dbref.deserializeCollection(e,{delimited:!0,collectionIndex:t});n.dbref.collections[t].data=e,++t<n.dbref.collections.length?n.loadNextPartition(t,r):r()})},p.prototype.loadNextPage=function(i){var e=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,o=this;this.adapter.loadDatabase(e,function(e){var t=e.split(o.options.delimiter);e="";var r,n=t.length,e=""===t[n-1];for(e&&(t.pop(),""===t[(n=t.length)-1]&&1===n&&(t.pop(),n=t.length)),r=0;r<n;r++)o.dbref.collections[o.pageIterator.collection].data.push(JSON.parse(t[r])),t[r]=null;t=[],e?++o.pageIterator.collection<o.dbref.collections.length?o.loadNextPartition(o.pageIterator.collection,i):i():(o.pageIterator.pageIndex++,o.loadNextPage(i))})},p.prototype.exportDatabase=function(e,t,r){var n,i=t.collections.length;for(this.dbref=t,this.dbname=e,this.dirtyPartitions=[-1],n=0;n<i;n++)t.collections[n].dirty&&this.dirtyPartitions.push(n);this.saveNextPartition(function(e){r(e)})},p.prototype.saveNextPartition=function(t){var r=this,e=this.dirtyPartitions.shift(),n=this.dbname+(-1===e?"":"."+e);if(this.options.paging&&-1!==e)return this.pageIterator={collection:e,docIndex:0,pageIndex:0},void this.saveNextPage(function(e){0===r.dirtyPartitions.length?t(e):r.saveNextPartition(t)});e=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:e});this.adapter.saveDatabase(n,e,function(e){e?t(e):0===r.dirtyPartitions.length?t(null):r.saveNextPartition(t)})},p.prototype.saveNextPage=function(t){function e(e){l="",e&&t(e),c?t(null):(n.pageIterator.pageIndex++,n.saveNextPage(t))}var r,n=this,i=this.dbref.collections[this.pageIterator.collection],o=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,s=0,a=i.data.length,u=this.options.delimiter.length,l="",c=!1,h=!1;for(0===i.data.length&&(c=!0);;)if(c||(r=JSON.stringify(i.data[this.pageIterator.docIndex]),l+=r,s+=r.length,++this.pageIterator.docIndex>=a&&(c=!0)),s>=this.options.pageSize&&(h=!0),h&&!c||(l+=this.options.delimiter,s+=u),c||h)return void this.adapter.saveDatabase(o,l,e)},y.prototype.loadDatabase=function(r,n){var i=this;this.fs.stat(r,function(e,t){!e&&t.isFile()?i.fs.readFile(r,{encoding:"utf8"},function(e,t){n(e?new Error(e):t)}):n(null)})},y.prototype.saveDatabase=function(t,e,r){var n=this,i=t+"~";this.fs.writeFile(i,e,function(e){e?r(new Error(e)):n.fs.rename(i,t,r)})},y.prototype.deleteDatabase=function(e,t){this.fs.unlink(e,function(e){e?t(new Error(e)):t()})},m.prototype.loadDatabase=function(e,t){i()?t(localStorage.getItem(e)):t(new Error("localStorage is not available"))},m.prototype.saveDatabase=function(e,t,r){i()?(localStorage.setItem(e,t),r(null)):r(new Error("localStorage is not available"))},m.prototype.deleteDatabase=function(e,t){i()?(localStorage.removeItem(e),t(null)):t(new Error("localStorage is not available"))},l.prototype.throttledSaveDrain=function(e,t){var r=this,n=(new Date).getTime();this.throttledSaves||e(!0),(t=t||{}).hasOwnProperty("recursiveWait")||(t.recursiveWait=!0),t.hasOwnProperty("recursiveWaitLimit")||(t.recursiveWaitLimit=!1),t.hasOwnProperty("recursiveWaitLimitDuration")||(t.recursiveWaitLimitDuration=2e3),t.hasOwnProperty("started")||(t.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending?t.recursiveWait?this.throttledCallbacks.push(function(){r.throttledSavePending?t.recursiveWaitLimit&&n-t.started>t.recursiveWaitLimitDuration?e(!1):r.throttledSaveDrain(e,t):e(!0)}):this.throttledCallbacks.push(e):e(!0)},l.prototype.loadDatabaseInternal=function(r,e){var n=e||function(e,t){if(e)throw e},i=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,function(e){if("string"!=typeof e)return e?e instanceof Error?void n(e):"object"===_typeof3(e)?(i.loadJSONObject(e,r||{}),n(null),void i.emit("loaded","database "+i.filename+" loaded")):void n("unexpected adapter response : "+e):(n(null),void i.emit("loaded","empty database "+i.filename+" loaded"));var t=!1;try{i.loadJSON(e,r||{}),t=!0}catch(e){n(e)}t&&(n(null),i.emit("loaded","database "+i.filename+" loaded"))}):n(new Error("persistenceAdapter not configured"))},l.prototype.loadDatabase=function(t,r){var n=this;this.throttledSaves?this.throttledSaveDrain(function(e){e?(n.throttledSavePending=!0,n.loadDatabaseInternal(t,function(e){0===n.throttledCallbacks.length?n.throttledSavePending=!1:n.saveDatabase(),"function"==typeof r&&r(e)})):"function"==typeof r&&r(new Error("Unable to pause save throttling long enough to read database"))},t):this.loadDatabaseInternal(t,r)},l.prototype.saveDatabaseInternal=function(e){var r,t=e||function(e){if(e)throw e},n=this;this.persistenceAdapter?"incremental"===this.persistenceAdapter.mode?(this.ignoreAutosave=!0,this.persistenceAdapter.saveDatabase(this.filename,function(){if(n.ignoreAutosave=!1,!r){var e=n.copy({removeNonSerializable:!0});return r=n.collections.map(function(e){return[e.dirty,e.dirtyIds]}),n.collections.forEach(function(e){e.dirty=!1,e.dirtyIds=[]}),e}t(new Error("adapter error - getLokiCopy called more than once"))},function(e){n.ignoreAutosave=!1,e&&r&&n.collections.forEach(function(e,t){t=r[t];e.dirty=e.dirty||t[0],e.dirtyIds=e.dirtyIds.concat(t[1])}),t(e)})):"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),function(e){n.autosaveClearFlags(),t(e)}):(this.autosaveClearFlags(),this.persistenceAdapter.saveDatabase(this.filename,this.serialize(),function(e){t(e)})):t(new Error("persistenceAdapter not configured"))},l.prototype.save=l.prototype.saveDatabase=function(e){var r,n;this.throttledSaves?this.throttledSavePending?this.throttledCallbacks.push(e):(r=this.throttledCallbacks,this.throttledCallbacks=[],r.unshift(e),this.throttledSavePending=!0,(n=this).saveDatabaseInternal(function(t){n.throttledSavePending=!1,r.forEach(function(e){"function"==typeof e&&setTimeout(function(){e(t)},1)}),0<n.throttledCallbacks.length&&n.saveDatabase()})):this.saveDatabaseInternal(e)},l.prototype.deleteDatabase=function(e,t){var r="function"!=typeof e||t?t||function(e,t){if(e)throw e}:e;null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,function(e){r(e)}):r(new Error("persistenceAdapter not configured"))},l.prototype.autosaveDirty=function(){for(var e=0;e<this.collections.length;e++)if(this.collections[e].dirty)return!0;return!1},l.prototype.autosaveClearFlags=function(){for(var e=0;e<this.collections.length;e++)this.collections[e].dirty=!1},l.prototype.autosaveEnable=function(e,t){this.autosave=!0;var r=5e3,n=this;void 0!==this.autosaveInterval&&null!==this.autosaveInterval&&(r=this.autosaveInterval),this.autosaveHandle=setInterval(function(){n.autosaveDirty()&&!n.ignoreAutosave&&n.saveDatabase(t)},r)},l.prototype.autosaveDisable=function(){void 0!==this.autosaveHandle&&null!==this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},g.prototype.reset=function(){return 0<this.filteredrows.length&&(this.filteredrows=[]),this.filterInitialized=!1,this},g.prototype.toJSON=function(){var e=this.copy();return e.collection=null,e},g.prototype.limit=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new g(this.collection);return t.filteredrows=this.filteredrows.slice(0,e),t.filterInitialized=!0,t},g.prototype.offset=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new g(this.collection);return t.filteredrows=this.filteredrows.slice(e),t.filterInitialized=!0,t},g.prototype.branch=g.prototype.copy=function(){var e=new g(this.collection);return 0<this.filteredrows.length&&(e.filteredrows=this.filteredrows.slice()),e.filterInitialized=this.filterInitialized,e},g.prototype.transform=function(e,t){var r,n,i=this;if("string"==typeof e&&this.collection.transforms.hasOwnProperty(e)&&(e=this.collection.transforms[e]),"object"!==_typeof3(e)||!Array.isArray(e))throw new Error("Invalid transform");for(void 0!==t&&(e=k.resolveTransformParams(e,t)),r=0;r<e.length;r++)switch((n=e[r]).type){case"find":i.find(n.value);break;case"where":i.where(n.value);break;case"simplesort":i.simplesort(n.property,n.desc||n.options);break;case"compoundsort":i.compoundsort(n.value);break;case"sort":i.sort(n.value);break;case"limit":i=i.limit(n.value);break;case"offset":i=i.offset(n.value);break;case"map":i=i.map(n.value,n.dataOptions);break;case"eqJoin":i=i.eqJoin(n.joinData,n.leftJoinKey,n.rightJoinKey,n.mapFun,n.dataOptions);break;case"mapReduce":i=i.mapReduce(n.mapFunction,n.reduceFunction);break;case"update":i.update(n.value);break;case"remove":i.remove()}return i},g.prototype.sort=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var r,n,e=(r=e,n=this.collection.data,function(e,t){return r(n[e],n[t])});return this.filteredrows.sort(e),this},g.prototype.simplesort=function(r,e){var t=10,n=this.collection.data.length,i=this.filteredrows.length,o=this.collection.binaryIndices.hasOwnProperty(r);if(void 0!==e&&!1!==e||(e={desc:!1}),!0===e&&(e={desc:!0}),0===i){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(r))return this.collection.ensureIndex(r),this.filteredrows=this.collection.binaryIndices[r].values.slice(0),e.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!e.disableIndexIntersect&&o&&(n=n/i,e.useJavascriptSorting&&(t=6),n<=t||e.forceIndexIntersect)){for(var s=this.filteredrows,a={},u=0;u<i;u++)a[s[u]]=!0;t=this.collection.binaryIndices[r].values;return this.filteredrows=t.filter(function(e){return a[e]}),e.desc&&this.filteredrows.reverse(),this}if(e.useJavascriptSorting)return this.sort(function(e,t){return e[r]===t[r]?0:e[r]>t[r]?1:e[r]<t[r]?-1:void 0});var l,c,h,p,f,e=(l=r,c=e.desc,h=this.collection.data,function(e,t){return f=~l.indexOf(".")?(f=l.split("."),p=k.getIn(h[e],f,!0),k.getIn(h[t],f,!0)):(p=h[e][l],h[t][l]),d(p,f,c)});return this.filteredrows.sort(e),this},g.prototype.compoundsort=function(e){if(0===e.length)throw new Error("Invalid call to compoundsort, need at least one property");var t;if(1===e.length)return t=e[0],Array.isArray(t)?this.simplesort(t[0],t[1]):this.simplesort(t,!1);for(var r=0,n=e.length;r<n;r+=1)t=e[r],Array.isArray(t)||(e[r]=[t,!1]);this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var i,o,s=(i=e,o=this.collection.data,function(e,t){return function(e,t,r){for(var n,i,o,s,a=0,u=e.length;a<u;a++)if(o=~(o=(n=e[a])[0]).indexOf(".")?(s=o.split("."),i=k.getIn(t,s,!0),k.getIn(r,s,!0)):(i=t[o],r[o]),0!==(n=d(i,o,n[1])))return n;return 0}(i,o[e],o[t])});return this.filteredrows.sort(s),this},g.prototype.$or=g.prototype.findOr=function(e){for(var t,r,n,i=0,o=[],s=[],a=(this.count(),0),u=e.length;a<u;a++)for(r=(t=this.branch().find(e[a]).filteredrows).length,i=0;i<r;i++)void 0===s[n=t[i]]&&(s[n]=!0,o.push(n));return this.filteredrows=o,this.filterInitialized=!0,this},g.prototype.$and=g.prototype.findAnd=function(e){for(var t=0,r=e.length;t<r;t++){if(0===this.count())return this;this.find(e[t])}return this},g.prototype.find=function(e,t){if(0===this.collection.data.length)return this.filteredrows=[],this.filterInitialized=!0,this;var r,n,i,o,s,a,u,l=e||"getAll",e=!1,c=[],h=[],p=null;if(t=t||!1,"object"===_typeof3(l)){for(r in l)(o={})[r]=l[r],h.push(o),_.call(l,r)&&(i=l[n=r]);if(1<h.length)return this.find({$and:h},t)}if(!n||"getAll"===l)return t&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=0<this.collection.data.length?[0]:[],this.filterInitialized=!0)),this;if("$and"===n||"$or"===n)return this[n](i),t&&1<this.filteredrows.length&&(this.filteredrows=this.filteredrows.slice(0,1)),this;if(null===i||"object"!==_typeof3(i)||i instanceof Date)s="$eq",a=i;else{if("object"!==_typeof3(i))throw new Error("Do not know what you want to do.");for(u in i)if(_.call(i,u)){a=i[s=u];break}}"$regex"!==s&&"object"!==_typeof3(a)||(a=function e(t,r){if("$regex"===t)Array.isArray(r)?r=new RegExp(r[0],r[1]):r instanceof RegExp||(r=new RegExp(r));else if("object"===_typeof3(r))for(var n in r)"$regex"!==n&&"object"!==_typeof3(r[n])||(r[n]=e(n,r[n]));return r}(s,a));var f=-1!==n.indexOf(".");!this.filterInitialized&&this.collection.binaryIndices[n]&&O[s]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(n),e=!0,p=this.collection.binaryIndices[n]),!e&&"$in"===s&&Array.isArray(a)&&"undefined"!=typeof Set&&(a=new Set(a),s="$inSet");var d,y,m=S[s],g=this.collection.data,v=0,b=0,w=0;if(this.filterInitialized){if(b=(d=this.filteredrows).length,f){for(n=n.split("."),v=0;v<b;v++)if(w=d[v],y=g[w],E(y,n,m,a,y)&&(c.push(w),t))return this.filteredrows=c,this}else for(v=0;v<b;v++)if(w=d[v],y=g[w],m(y[n],a,y)&&(c.push(w),t))return this.filteredrows=c,this}else if(e){var x=this.collection.calculateRange(s,n,a);if("$in"!==s){for(v=x[0];v<=x[1];v++)if(!0!==O[s]){if(O[s](k.getIn(g[p.values[v]],n,f),a)&&(c.push(p.values[v]),t))return this.filteredrows=c,this.filterInitialized=!0,this}else if(c.push(p.values[v]),t)return this.filteredrows=c,this.filterInitialized=!0,this}else for(v=0,b=x.length;v<b;v++)if(c.push(p.values[x[v]]),t)return this.filteredrows=c,this.filterInitialized=!0,this}else if(b=g.length,f){for(n=n.split("."),v=0;v<b;v++)if(y=g[v],E(y,n,m,a,y)&&(c.push(v),t))return this.filteredrows=c,this.filterInitialized=!0,this}else for(v=0;v<b;v++)if(y=g[v],m(y[n],a,y)&&(c.push(v),t))return this.filteredrows=c,this.filterInitialized=!0,this;return this.filteredrows=c,this.filterInitialized=!0,this},g.prototype.where=function(e){var t,r=[];if("function"!=typeof e)throw new TypeError("Argument is not a stored view or a function");t=e;try{if(this.filterInitialized){for(var n=this.filteredrows.length;n--;)!0===t(this.collection.data[this.filteredrows[n]])&&r.push(this.filteredrows[n]);return this.filteredrows=r,this}for(var i=this.collection.data.length;i--;)!0===t(this.collection.data[i])&&r.push(i);return this.filteredrows=r,this.filterInitialized=!0,this}catch(e){throw e}},g.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},g.prototype.data=function(e){var t,r,n,i=[],o=this.collection.data;if((e=e||{}).removeMeta&&!e.forceClones&&(e.forceClones=!0,e.forceCloneMethod=e.forceCloneMethod||"shallow"),!this.collection.disableDeltaChangesApi&&this.collection.disableFreeze&&(e.forceClones=!0,e.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||e.forceClones){for(a=o.length,n=e.forceCloneMethod||this.collection.cloneMethod,r=0;r<a;r++)t=h(o[r],n),e.removeMeta&&(delete t.$loki,delete t.meta),i.push(t);return i}return o.slice()}this.filterInitialized=!0}var s=this.filteredrows,a=s.length;if(this.collection.cloneObjects||e.forceClones)for(n=e.forceCloneMethod||this.collection.cloneMethod,r=0;r<a;r++)t=h(o[s[r]],n),e.removeMeta&&(delete t.$loki,delete t.meta),i.push(t);else for(r=0;r<a;r++)i.push(o[s[r]]);return i},g.prototype.update=function(e){if("function"!=typeof e)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var t,r=this.filteredrows.length,n=this.collection.data,i=0;i<r;i++)this.disableFreeze&&!this.collection.cloneObjects&&this.collection.disableDeltaChangesApi?(e(n[this.filteredrows[i]]),this.collection.update(n[this.filteredrows[i]])):(e(t=h(n[this.filteredrows[i]],this.collection.cloneMethod)),this.collection.update(t));return this},g.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},g.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(e){throw e}},g.prototype.eqJoin=function(e,t,r,n,i){var o,s,a=[],u=[],l=[],c="function"==typeof t,h="function"==typeof r,p={},f=(a=this.data(i)).length;if(e instanceof w)u=e.chain().data(i);else if(e instanceof g)u=e.data(i);else{if(!Array.isArray(e))throw new TypeError("joinData needs to be an array or result set");u=e}o=u.length;for(var d=0;d<o;d++)p[s=h?r(u[d]):u[d][r]]=u[d];n=n||function(e,t){return{left:e,right:t}};for(var y=0;y<f;y++)s=c?t(a[y]):a[y][t],l.push(n(a[y],p[s]||{}));return this.collection=new w("joinData"),this.collection.insert(l),this.filteredrows=[],this.filterInitialized=!1,this},g.prototype.map=function(e,t){e=this.data(t).map(e);return this.collection=new w("mappedData"),this.collection.insert(e),this.filteredrows=[],this.filterInitialized=!1,this},((b.prototype=new u).constructor=b).prototype.getSort=function(){return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple},b.prototype.rematerialize=function(e){var t,r,n;e=e||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new g(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0);var i=Object.isFrozen(this.filterPipeline);if(e.hasOwnProperty("removeWhereFilters"))for(i&&(this.filterPipeline=this.filterPipeline.slice()),r=t=this.filterPipeline.length;r--;)"where"===this.filterPipeline[r].type&&(r!==this.filterPipeline.length-1&&(this.filterPipeline[r]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var o=this.filterPipeline;for(this.filterPipeline=[],t=o.length,n=0;n<t;n++)this.applyFind(o[n].val,o[n].uid);return i&&Object.freeze(this.filterPipeline),this.data(),this.emit("rebuild",this),this},b.prototype.branchResultset=function(e,t){var r=this.resultset.branch();return void 0===e?r:r.transform(e,t)},b.prototype.toJSON=function(){var e=new b(this.collection,this.name,this.options);return e.resultset=this.resultset,e.resultdata=[],e.resultsdirty=!0,e.filterPipeline=this.filterPipeline,e.sortFunction=this.sortFunction,e.sortCriteria=this.sortCriteria,e.sortCriteriaSimple=this.sortCriteriaSimple||null,e.sortDirty=this.sortDirty,e.collection=null,e},b.prototype.removeFilters=function(e){e=e||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null;var t=Object.isFrozen(this.filterPipeline),r=0<this.filterPipeline.length;this.filterPipeline=[],t&&Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,!(this.sortDirty=!1)===e.queueSortPhase&&this.queueSortPhase(),r&&this.emit("filter")},b.prototype.applySort=function(e){return this.sortFunction=e,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this.emit("sort"),this},b.prototype.applySimpleSort=function(e,t){return this.sortCriteriaSimple={propname:e,options:t||!1},this.collection.disableFreeze||f(this.sortCriteriaSimple),this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},b.prototype.applySortCriteria=function(e){return this.sortCriteria=e,this.collection.disableFreeze||f(this.sortCriteria),this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},b.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},b.prototype.commit=function(){return this.cachedresultset=null,this},b.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},b.prototype._indexOfFilterWithId=function(e){if("string"==typeof e||"number"==typeof e)for(var t=0,r=this.filterPipeline.length;t<r;t+=1)if(e===this.filterPipeline[t].uid)return t;return-1},b.prototype._addFilter=function(e){var t=Object.isFrozen(this.filterPipeline);t&&(this.filterPipeline=this.filterPipeline.slice()),this.collection.disableFreeze||f(e),this.filterPipeline.push(e),t&&Object.freeze(this.filterPipeline),this.resultset[e.type](e.val)},b.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var e=this.filterPipeline,t=Object.isFrozen(e);this.filterPipeline=[];for(var r=0,n=e.length;r<n;r+=1)this._addFilter(e[r]);return t&&Object.freeze(this.filterPipeline),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},b.prototype.applyFilter=function(e){var t=this._indexOfFilterWithId(e.uid);if(0<=t){var r=Object.isFrozen(this.filterPipeline);return r&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline[t]=e,r&&(s(e),Object.freeze(this.filterPipeline)),this.reapplyFilters()}return this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(e),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},b.prototype.applyFind=function(e,t){return this.applyFilter({type:"find",val:e,uid:t}),this},b.prototype.applyWhere=function(e,t){return this.applyFilter({type:"where",val:e,uid:t}),this},b.prototype.removeFilter=function(e){var t=this._indexOfFilterWithId(e);if(t<0)throw new Error("Dynamic view does not contain a filter with ID: "+e);e=Object.isFrozen(this.filterPipeline);return e&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline.splice(t,1),e&&Object.freeze(this.filterPipeline),this.reapplyFilters(),this},b.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},b.prototype.data=function(e){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(e)},b.prototype.queueRebuildEvent=function(){var e;this.rebuildPending||(this.rebuildPending=!0,e=this,setTimeout(function(){e.rebuildPending&&(e.rebuildPending=!1,e.emit("rebuild",e))},this.options.minRebuildInterval))},b.prototype.queueSortPhase=function(){var e;this.sortDirty||(this.sortDirty=!0,"active"===(e=this).options.sortPriority?setTimeout(function(){e.performSortPhase()},this.options.minRebuildInterval):this.queueRebuildEvent())},b.prototype.performSortPhase=function(e){(this.sortDirty||this.resultsdirty)&&(e=e||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),e.suppressRebuildEvent||this.emit("rebuild",this))},b.prototype.evaluateDocument=function(e,t){if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var r,n=this.resultset.filteredrows,i=t?-1:n.indexOf(+e),o=n.length,s=new g(this.collection);s.filteredrows=[e],s.filterInitialized=!0;for(var a=0,u=this.filterPipeline.length;a<u;a++)s[(r=this.filterPipeline[a]).type](r.val);t=0===s.filteredrows.length?-1:0;return-1!==i||-1!=t?-1===i&&-1!=t?(n.push(e),this.options.persistent&&this.resultdata.push(this.collection.data[e]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==i&&-1==t?(i<o-1?(n.splice(i,1),this.options.persistent&&this.resultdata.splice(i,1)):(n.length=o-1,this.options.persistent&&(this.resultdata.length=o-1)),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void(-1!==i&&-1!=t&&(this.options.persistent&&(this.resultdata[i]=this.collection.data[e]),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void 0},b.prototype.removeDocument=function(e){var t,r,n,i={},o={},s=this.resultset,a=this.resultset.filteredrows,u=a.length;if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(Array.isArray(e)||(e=[e]),r=e.length,t=0;t<r;t++)i[e[t]]=!0;for(l=0;l<u;l++)i[a[l]]&&(o[l]=!0);0<Object.keys(o).length&&(this.resultset.filteredrows=this.resultset.filteredrows.filter(function(e,t){return!o[t]}),this.options.persistent&&(this.resultdata=this.resultdata.filter(function(e,t){return!o[t]})),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(var u=s.filteredrows.length,l=0;l<u;l++)n=e.filter(function(t){return function(e){return e<s.filteredrows[t]}}(l)),s.filteredrows[l]-=n.length},b.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(e){throw e}},((w.prototype=new u).contructor=w).prototype.createChange=function(e,t,r,n){this.changes.push({name:e,operation:t,obj:"U"!=t||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(r)):this.getChangeDelta(r,n)})},w.prototype.insertMeta=function(e){var t,r;if(!this.disableMeta&&e)if(Array.isArray(e))for(t=e.length,r=0;r<t;r++)e[r].hasOwnProperty("meta")||(e[r].meta={}),e[r].meta.created=(new Date).getTime(),e[r].meta.revision=0;else e.meta||(e.meta={}),e.meta.created=(new Date).getTime(),e.meta.revision=0},w.prototype.updateMeta=function(e){return this.disableMeta||!e||(this.disableFreeze||((e=a(e)).meta=a(e.meta)),e.meta.updated=(new Date).getTime(),e.meta.revision+=1),e},w.prototype.createInsertChange=function(e){this.createChange(this.name,"I",e)},w.prototype.createUpdateChange=function(e,t){this.createChange(this.name,"U",e,t)},w.prototype.insertMetaWithChange=function(e){this.insertMeta(e),this.createInsertChange(e)},w.prototype.updateMetaWithChange=function(e,t,r){return e=this.updateMeta(e,r),this.createUpdateChange(e,t),e},w.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},w.prototype.addAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(e,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},w.prototype.removeAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(e,this.observerCallback)},w.prototype.addTransform=function(e,t){if(this.transforms.hasOwnProperty(e))throw new Error("a transform by that name already exists");this.transforms[e]=t},w.prototype.getTransform=function(e){return this.transforms[e]},w.prototype.setTransform=function(e,t){this.transforms[e]=t},w.prototype.removeTransform=function(e){delete this.transforms[e]},w.prototype.byExample=function(e){var t,r,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(((r={})[t]=e[t],r));return{$and:n}},w.prototype.findObject=function(e){return this.findOne(this.byExample(e))},w.prototype.findObjects=function(e){return this.find(this.byExample(e))},w.prototype.ttlDaemonFuncGen=function(){var e=this,r=this.ttl.age;return function(){var t=Date.now();e.chain().where(function(e){e=e.meta.updated||e.meta.created;return r<t-e}).remove()}},w.prototype.setTTL=function(e,t){e<0?clearInterval(this.ttl.daemon):(this.ttl.age=e,this.ttl.ttlInterval=t,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),t))},w.prototype.prepareFullDocIndex=function(){for(var e=this.data.length,t=new Array(e),r=0;r<e;r+=1)t[r]=r;return t},w.prototype.configureOptions=function(e){(e=e||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=e.adaptiveBinaryIndices,this.adaptiveBinaryIndices&&this.ensureAllIndexes())},w.prototype.ensureIndex=function(e,t){if(void 0===t&&(t=!1),null==e)throw new Error("Attempting to set index without an associated property");var r,n,i,o,s;this.binaryIndices[e]&&!t&&!this.binaryIndices[e].dirty||!0===this.adaptiveBinaryIndices&&this.binaryIndices.hasOwnProperty(e)&&!t||(t={name:e,dirty:!0,values:this.prepareFullDocIndex()},this.binaryIndices[e]=t,r=e,n=this.data,s=!!~r.indexOf(".")&&r.split("."),e=function(e,t){if(o=s?(i=k.getIn(n[e],s,!0),k.getIn(n[t],s,!0)):(i=n[e][r],n[t][r]),i!==o){if(v.lt(i,o,!1))return-1;if(v.gt(i,o,!1))return 1}return 0},t.values.sort(e),t.dirty=!1,this.dirty=!0)},w.prototype.checkAllIndexes=function(e){var t,r=this.binaryIndices,n=[];for(t in r)_.call(r,t)&&(this.checkIndex(t,e)||n.push(t));return n},w.prototype.checkIndex=function(e,t){(t=t||{}).randomSamplingFactor&&!1!==t.randomSampling&&(t.randomSampling=!0),t.randomSamplingFactor=t.randomSamplingFactor||.1,(t.randomSamplingFactor<0||1<t.randomSamplingFactor)&&(t.randomSamplingFactor=.1);var r,n,i,o,s,a=!0;if(!this.binaryIndices.hasOwnProperty(e))throw new Error("called checkIndex on property without an index: "+e);if(this.adaptiveBinaryIndices||this.ensureIndex(e),(o=(s=this.binaryIndices[e].values).length)!==this.data.length)return t.repair&&this.ensureIndex(e,!0),!1;if(0===o)return!0;var u=-1!==e.indexOf(".");if(1===o)a=0===s[0];else if(t.randomSampling){if(S.$lte(k.getIn(this.data[s[0]],e,u),k.getIn(this.data[s[1]],e,u))||(a=!1),S.$lte(k.getIn(this.data[s[o-2]],e,u),k.getIn(this.data[s[o-1]],e,u))||(a=!1),a)for(n=Math.floor((o-1)*t.randomSamplingFactor),r=0;r<n-1;r++)if(i=Math.floor(Math.random()*(o-1)),!S.$lte(k.getIn(this.data[s[i]],e,u),k.getIn(this.data[s[i+1]],e,u))){a=!1;break}}else for(r=0;r<o-1;r++)if(!S.$lte(k.getIn(this.data[s[r]],e,u),k.getIn(this.data[s[r+1]],e,u))){a=!1;break}return!a&&t.repair&&this.ensureIndex(e,!0),a},w.prototype.getBinaryIndexValues=function(e){for(var t=this.binaryIndices[e].values,r=[],n=0;n<t.length;n++)r.push(k.getIn(this.data[t[n]],e,!0));return r},w.prototype.getUniqueIndex=function(e,t){var r=this.constraints.unique[e];return!r&&t?this.ensureUniqueIndex(e):r},w.prototype.ensureUniqueIndex=function(e){var t=this.constraints.unique[e];return t||-1==this.uniqueNames.indexOf(e)&&this.uniqueNames.push(e),this.constraints.unique[e]=t=new L(e),this.data.forEach(function(e){t.set(e)}),t},w.prototype.ensureAllIndexes=function(e){var t,r=this.binaryIndices;for(t in r)_.call(r,t)&&this.ensureIndex(t,e)},w.prototype.flagBinaryIndexesDirty=function(){var e,t=this.binaryIndices;for(e in t)_.call(t,e)&&(t[e].dirty=!0)},w.prototype.flagBinaryIndexDirty=function(e){this.binaryIndices[e]&&(this.binaryIndices[e].dirty=!0)},w.prototype.count=function(e){return(e?this.chain().find(e).filteredrows:this.data).length},w.prototype.ensureId=function(){if(!this.idIndex){for(var e=this.data,t=0,r=e.length,n=new Array(r);t<r;t++)n[t]=e[t].$loki;this.idIndex=n}},w.prototype.ensureIdAsync=function(e){this.async(function(){this.ensureId()},e)},w.prototype.addDynamicView=function(e,t){t=new b(this,e,t);return this.DynamicViews.push(t),t},w.prototype.removeDynamicView=function(t){this.DynamicViews=this.DynamicViews.filter(function(e){return e.name!==t})},w.prototype.getDynamicView=function(e){for(var t=0;t<this.DynamicViews.length;t++)if(this.DynamicViews[t].name===e)return this.DynamicViews[t];return null},w.prototype.findAndUpdate=function(e,t){"function"==typeof e?this.updateWhere(e,t):this.chain().find(e).update(t)},w.prototype.findAndRemove=function(e){this.chain().find(e).remove()},w.prototype.insert=function(e,t){if(!Array.isArray(e))return this.insertOne(e);var r,n=[],t=t&&!this.cloneObjects&&this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length;t&&(this.adaptiveBinaryIndices=!1);try{this.emit("pre-insert",e);for(var i=0,o=e.length;i<o;i++){if(!(r=this.insertOne(e[i],!0)))return;n.push(r)}}finally{t&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}return this.emit("insert",n),1===(n=this.cloneObjects?h(n,this.cloneMethod):n).length?n[0]:n},w.prototype.insertOne=function(e,t){var r=null;if("object"!==_typeof3(e)?r=new TypeError("Document needs to be an object"):null===e&&(r=new TypeError("Object cannot be null")),null!==r)throw this.emit("error",r),r;var e=this.cloneObjects?h(e,this.cloneMethod):e;if(this.disableFreeze||(e=a(e)),this.disableMeta||(void 0===e.meta?e.meta={revision:0,created:0}:this.disableFreeze||(e.meta=a(e.meta))),t||this.emit("pre-insert",e),this.add(e))return this.disableChangesApi?this.insertMeta(e):this.insertMetaWithChange(e),this.disableFreeze||f(e),e=this.cloneObjects?h(e,this.cloneMethod):e,t||this.emit("insert",e),this.addAutoUpdateObserver(e),e},w.prototype.clear=function(e){var t=this;e=e||{},this.data=[],this.idIndex=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,this.constraints={unique:{},exact:{}},!0===e.removeIndices?(this.binaryIndices={},this.uniqueNames=[]):Object.keys(this.binaryIndices).forEach(function(e){t.binaryIndices[e].dirty=!1,t.binaryIndices[e].values=[]})},w.prototype.update=function(e){var t,r,n;if(Array.isArray(e)){n=e.length,(t=!this.cloneObjects&&this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length)&&(this.adaptiveBinaryIndices=!1);try{for(r=0;r<n;r+=1)this.update(e[r])}finally{t&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!_.call(e,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var i,o,s,a=this.get(e.$loki,!0),u=this;if(!a)throw new Error("Trying to update a document not in collection.");i=a[0],s=a[1],o=this.cloneObjects||!this.disableDeltaChangesApi&&this.disableFreeze?h(e,this.cloneMethod):e,this.emit("pre-update",e),this.uniqueNames.forEach(function(e){u.getUniqueIndex(e,!0).update(i,o)}),(this.data[s]=o)!==e&&this.addAutoUpdateObserver(e);for(var l,c=0;c<this.DynamicViews.length;c++)this.DynamicViews[c].evaluateDocument(s,!1);if(this.adaptiveBinaryIndices)for(l in this.binaryIndices)this.adaptiveBinaryIndexUpdate(s,l);else this.flagBinaryIndexesDirty();return this.idIndex[s]=o.$loki,this.isIncremental&&this.dirtyIds.push(o.$loki),this.commit(),this.dirty=!0,o=this.disableChangesApi?this.updateMeta(o):this.updateMetaWithChange(o,i),this.disableFreeze||f(o),a=this.cloneObjects?h(o,this.cloneMethod):o,this.emit("update",a,i),a}catch(e){throw this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),e}}},w.prototype.add=function(e){if("object"!==_typeof3(e))throw new TypeError("Object being added needs to be an object");if(void 0!==e.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1);var t=this.maxId;e.$loki=t,this.disableMeta||(e.meta.version=0);for(var r=0,n=this.uniqueNames.length;r<n;r++)this.getUniqueIndex(this.uniqueNames[r],!0).set(e);this.idIndex&&this.idIndex.push(t),this.isIncremental&&this.dirtyIds.push(t),this.data.push(e);for(var i,o=this.data.length-1,s=this.DynamicViews.length,r=0;r<s;r++)this.DynamicViews[r].evaluateDocument(o,!0);if(this.adaptiveBinaryIndices)for(i in this.binaryIndices)this.adaptiveBinaryIndexInsert(o,i);else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?h(e,this.cloneMethod):e}catch(e){throw this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),e}},w.prototype.updateWhere=function(e,t){var r,n=this.where(e),i=0;try{for(;i<n.length;i++)r=t(n[i]),this.update(r)}catch(e){this.rollback(),this.lokiConsoleWrapper.error(e.message)}},w.prototype.removeWhere=function(e){var t;"function"==typeof e?(t=this.data.filter(e),this.remove(t)):this.chain().find(e).remove()},w.prototype.removeDataOnly=function(){this.remove(this.data.slice())},w.prototype.removeBatchByPositions=function(r){var e,t,n,i,o,s=r.length,a={},u=Object.keys(this.binaryIndices).length,l=Object.keys(this.constraints.unique).length,c=this.adaptiveBinaryIndices&&0<Object.keys(this.binaryIndices).length,h=this;try{for(this.startTransaction(),this.ensureId(),n=0;n<s;n++)a[this.idIndex[r[n]]]=!0;if(0<(e=this.DynamicViews.length)||0<u||0<l){if(0<e)for(t=0;t<e;t++)this.DynamicViews[t].removeDocument(r);if(this.adaptiveBinaryIndices&&!c)for(o in this.binaryIndices)this.adaptiveBinaryIndexRemove(r,o);else this.flagBinaryIndexesDirty();l&&this.uniqueNames.forEach(function(e){var t=h.getUniqueIndex(e);if(t)for(n=0;n<s;n++)null!==(i=h.data[r[n]])[e]&&void 0!==i[e]&&t.remove(i[e])})}if(!this.disableChangesApi||1<this.events.delete.length)for(n=0;n<s;n++)this.emit("delete",this.data[r[n]]);if(this.data=this.data.filter(function(e){return!a[e.$loki]}),this.isIncremental)for(n=0;n<s;n++)this.dirtyIds.push(this.idIndex[r[n]]);this.idIndex=this.idIndex.filter(function(e){return!a[e]}),this.adaptiveBinaryIndices&&c&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(e){return this.rollback(),c&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),null}},w.prototype.removeBatch=function(e){for(var t=e.length,r=this.data.length,n={},i=[],o=0;o<r;o++)n[this.data[o].$loki]=o;for(o=0;o<t;o++)"object"===_typeof3(e[o])?i.push(n[e[o].$loki]):i.push(n[e[o]]);this.removeBatchByPositions(i)},w.prototype.remove=function(r){if("number"==typeof r&&(r=this.get(r)),"object"!==_typeof3(r))throw new Error("Parameter is not an object");if(Array.isArray(r))this.removeBatch(r);else{if(!_.call(r,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var e=this.get(r.$loki,!0),t=e[1],n=this;this.uniqueNames.forEach(function(e){var t;null===r[e]||void 0===r[e]||(t=n.getUniqueIndex(e))&&t.remove(r[e])});for(var i,o=0;o<this.DynamicViews.length;o++)this.DynamicViews[o].removeDocument(t);if(this.adaptiveBinaryIndices)for(i in this.binaryIndices)this.adaptiveBinaryIndexRemove(t,i);else this.flagBinaryIndexesDirty();return this.data.splice(t,1),this.removeAutoUpdateObserver(r),this.idIndex.splice(t,1),this.isIncremental&&this.dirtyIds.push(r.$loki),this.commit(),this.dirty=!0,this.emit("delete",e[0]),this.disableFreeze||(r=a(r)),delete r.$loki,delete r.meta,this.disableFreeze||s(r),r}catch(e){return this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),null}}},w.prototype.get=function(e,t){this.idIndex||this.ensureId();var r,t=t||!1,n=this.idIndex,i=n.length-1,o=0;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))throw new TypeError("Passed id is not an integer");for(;n[o]<n[i];)n[r=o+i>>1]<e?o=1+r:i=r;return i===o&&n[o]===e?t?[this.data[o],o]:this.data[o]:null},w.prototype.getBinaryIndexPosition=function(e,t){var r=k.getIn(this.data[e],t,!0),n=this.binaryIndices[t].values,t=this.calculateRange("$eq",t,r);if(0===t[0]&&-1===t[1])return null;for(var r=t[0],i=t[1],o=r;o<=i;o++)if(n[o]===e)return o;return null},w.prototype.adaptiveBinaryIndexInsert=function(e,t){var r=-1!==t.indexOf("."),n=this.binaryIndices[t].values,i=k.getIn(this.data[e],t,r);!0===this.serializableIndices&&i instanceof Date&&(this.data[e][t]=i.getTime(),i=k.getIn(this.data[e],t));r=0===n.length?0:this.calculateRangeStart(t,i,!0,r);this.binaryIndices[t].values.splice(r,0,e)},w.prototype.adaptiveBinaryIndexUpdate=function(e,t){for(var r=this.binaryIndices[t].values,n=r.length,i=0;i<n&&r[i]!==e;i++);this.binaryIndices[t].values.splice(i,1),this.adaptiveBinaryIndexInsert(e,t)},w.prototype.adaptiveBinaryIndexRemove=function(e,t,r){var n,i,o,s,a,u,l=this.binaryIndices[t],c={};if(Array.isArray(e)){if(1!==(s=e.length)){for(o=0;o<s;o++)c[e[o]]=!0;if(l.values=l.values.filter(function(e){return!c[e]}),!0===r)return;var h=e.slice();for(h.sort(function(e,t){return e-t}),n=l.values.length,i=0;i<n;i++){for(a=l.values[i],o=u=0;o<s&&a>h[o];o++)u++;l.values[i]-=u}return}e=e[0]}if(null===(t=this.getBinaryIndexPosition(e,t)))return null;if(l.values.splice(t,1),!0!==r)for(n=l.values.length,i=0;i<n;i++)l.values[i]>e&&l.values[i]--},w.prototype.calculateRangeStart=function(e,t,r,n){var i,o=this.data,s=this.binaryIndices[e].values,a=0,u=s.length-1;if(0===s.length)return-1;for(k.getIn(o[s[a]],e,n),k.getIn(o[s[u]],e,n);a<u;)i=a+u>>1,v.lt(k.getIn(o[s[i]],e,n),t,!1)?a=1+i:u=i;var l=a;return v.aeq(t,k.getIn(o[s[l]],e,n))?l:v.lt(t,k.getIn(o[s[l]],e,n),!1)?r?l:l-1:r?l+1:l},w.prototype.calculateRangeEnd=function(e,t,r){var n,i=this.data,o=this.binaryIndices[e].values,s=0,a=o.length-1;if(0===o.length)return-1;for(k.getIn(i[o[s]],e,r),k.getIn(i[o[a]],e,r);s<a;)n=s+a>>1,v.lt(t,k.getIn(i[o[n]],e,r),!1)?a=n:s=1+n;var u=a;return v.aeq(t,k.getIn(i[o[u]],e,r))?u:v.gt(t,k.getIn(i[o[u]],e,r),!1)?u+1:v.aeq(t,k.getIn(i[o[u-1]],e,r))?u-1:u},w.prototype.calculateRange=function(e,t,r){var n,i,o,s=this.data,a=this.binaryIndices[t].values,u=a.length-1;if(0===s.length)return[0,-1];var l=-1!==t.indexOf("."),c=k.getIn(s[a[0]],t,l),h=k.getIn(s[a[u]],t,l);switch(e){case"$eq":case"$aeq":case"$dteq":if(v.lt(r,c,!1)||v.gt(r,h,!1))return[0,-1];break;case"$gt":if(v.gt(r,h,!0))return[0,-1];if(v.gt(c,r,!1))return[0,u];break;case"$gte":if(v.gt(r,h,!1))return[0,-1];if(v.gt(c,r,!0))return[0,u];break;case"$lt":if(v.lt(r,c,!0))return[0,-1];if(v.lt(h,r,!1))return[0,u];break;case"$lte":if(v.lt(r,c,!1))return[0,-1];if(v.lt(h,r,!0))return[0,u];break;case"$between":return v.gt(r[0],h,!1)?[0,-1]:v.lt(r[1],c,!1)?[0,-1]:((n=this.calculateRangeStart(t,r[0],!1,l))<0&&n++,u<(o=this.calculateRangeEnd(t,r[1],l))&&o--,v.gt(k.getIn(s[a[n]],t,l),r[0],!0)||n++,v.lt(k.getIn(s[a[o]],t,l),r[1],!0)||o--,o<n?[0,-1]:[n,o]);case"$in":for(var p=[],f=[],d=0,y=r.length;d<y;d++)for(var m=this.calculateRange("$eq",t,r[d]),g=m[0];g<=m[1];g++)void 0===p[g]&&(p[g]=!0,f.push(g));return f}switch(e){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":n=this.calculateRangeStart(t,r,!1,l),i=k.getIn(s[a[n]],t,l)}switch(e){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":o=this.calculateRangeEnd(t,r,l),k.getIn(s[a[o]],t,l)}switch(e){case"$eq":case"$aeq":case"$dteq":return v.aeq(i,r)?[n,o]:[0,-1];case"$gt":return v.aeq(k.getIn(s[a[o]],t,l),r)?[o+1,u]:[o,u];case"$gte":return v.aeq(k.getIn(s[a[n]],t,l),r)?[n,u]:[n+1,u];case"$lt":return v.aeq(k.getIn(s[a[n]],t,l),r)?[0,n-1]:[0,n];case"$lte":return v.aeq(k.getIn(s[a[o]],t,l),r)?[0,o]:[0,o-1];default:return[0,s.length-1]}},w.prototype.by=function(t,e){var r;if(void 0===e)return r=this,function(e){return r.by(t,e)};e=this.getUniqueIndex(t,!0).get(e);return this.cloneObjects?h(e,this.cloneMethod):e},w.prototype.findOne=function(e){e=e||{};e=this.chain().find(e,!0).data();return Array.isArray(e)&&0===e.length?null:this.cloneObjects?h(e[0],this.cloneMethod):e[0]},w.prototype.chain=function(e,t){var r=new g(this);return void 0===e?r:r.transform(e,t)},w.prototype.find=function(e){return this.chain().find(e).data()},w.prototype.findOneUnindexed=function(e,t){for(var r=this.data.length;r--;)if(k.getIn(this.data[r],e,!0)===t)return this.data[r];return null},w.prototype.startTransaction=function(){if(this.transactional){this.cachedData=h(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices,this.cachedDirtyIds=this.dirtyIds;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].startTransaction()}},w.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedDirtyIds=null;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].commit()}},w.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex,this.dirtyIds=this.cachedDirtyIds);for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].rollback()}},w.prototype.async=function(e,t){setTimeout(function(){if("function"!=typeof e)throw new TypeError("Argument passed for async execution is not a function");e(),t()},0)},w.prototype.where=function(e){return this.chain().where(e).data()},w.prototype.mapReduce=function(e,t){try{return t(this.data.map(e))}catch(e){throw e}},w.prototype.eqJoin=function(e,t,r,n,i){return new g(this).eqJoin(e,t,r,n,i)},w.prototype.stages={},w.prototype.getStage=function(e){return this.stages[e]||(this.stages[e]={}),this.stages[e]},w.prototype.commitLog=[],w.prototype.stage=function(e,t){var r=JSON.parse(JSON.stringify(t));return this.getStage(e)[t.$loki]=r},w.prototype.commitStage=function(e,t){var r,n=this.getStage(e),i=(new Date).getTime();for(r in n)this.update(n[r]),this.commitLog.push({timestamp:i,message:t,data:JSON.parse(JSON.stringify(n[r]))});this.stages[e]={}},w.prototype.no_op=function(){},w.prototype.extract=function(e){for(var t=0,r=this.data.length,n=x(e),i=[];t<r;t+=1)i.push(T(this.data[t],e,n));return i},w.prototype.max=function(e){return Math.max.apply(null,this.extract(e))},w.prototype.min=function(e){return Math.min.apply(null,this.extract(e))},w.prototype.maxRecord=function(e){for(var t,r=0,n=this.data.length,i=x(e),o={index:0,value:void 0};r<n;r+=1)(void 0===t||t<T(this.data[r],e,i))&&(t=T(this.data[r],e,i),o.index=this.data[r].$loki);return o.value=t,o},w.prototype.minRecord=function(e){for(var t,r=0,n=this.data.length,i=x(e),o={index:0,value:void 0};r<n;r+=1)(void 0===t||t>T(this.data[r],e,i))&&(t=T(this.data[r],e,i),o.index=this.data[r].$loki);return o.value=t,o},w.prototype.extractNumerical=function(e){return this.extract(e).map(A).filter(Number).filter(function(e){return!isNaN(e)})},w.prototype.avg=function(e){return j(this.extractNumerical(e))},w.prototype.stdDev=function(e){return e=this.extractNumerical(e),t=j(e),e=j(e.map(function(e){e-=t;return e*e})),Math.sqrt(e);var t},w.prototype.mode=function(e){var t,r,n,i={};for(r in this.extract(e).forEach(function(e){i[e]?i[e]+=1:i[e]=1}),i)t?t<i[r]&&(n=r):t=i[n=r];return n},w.prototype.median=function(e){var t=this.extractNumerical(e);t.sort(P);e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},N.prototype={keys:[],values:[],sort:function(e,t){return e<t?-1:t<e?1:0},setSort:function(e){this.bs=new I(e)},bs:function(){return new I(this.sort)},set:function(e,t){var r=this.bs(this.keys,e);r.found?this.values[r.index]=t:(this.keys.splice(r.index,0,e),this.values.splice(r.index,0,t))},get:function(e){return this.values[C(this.keys,e,this.sort).index]}},L.prototype.keyMap={},L.prototype.lokiMap={},L.prototype.set=function(e){var t=e[this.field];if(null!=t){if(this.keyMap[t])throw new Error("Duplicate key for property "+this.field+": "+t);this.keyMap[t]=e,this.lokiMap[e.$loki]=t}},L.prototype.get=function(e){return this.keyMap[e]},L.prototype.byId=function(e){return this.keyMap[this.lokiMap[e]]},L.prototype.update=function(e,t){var r;this.lokiMap[e.$loki]!==t[this.field]?(r=this.lokiMap[e.$loki],this.set(t),this.keyMap[r]=void 0):this.keyMap[e[this.field]]=t},L.prototype.remove=function(e){var t=this.keyMap[e];if(null==t)throw new Error("Key is not in unique index: "+this.field);this.keyMap[e]=void 0,this.lokiMap[t.$loki]=void 0},L.prototype.clear=function(){this.keyMap=Object.create(null),this.lokiMap=Object.create(null)},F.prototype={set:function(e,t){this.index[e]?this.index[e].push(t):this.index[e]=[t]},remove:function(e,t){var r,n=this.index[e];for(r in n)n[r]==t&&n.splice(r,1);n.length<1&&(this.index[e]=void 0)},get:function(e){return this.index[e]},clear:function(){this.index={}}},l.deepFreeze=f,l.freeze=s,l.unFreeze=a,l.LokiOps=S,l.Collection=w,l.DynamicView=b,l.Resultset=g,l.KeyValueStore=N,l.LokiMemoryAdapter=c,l.LokiPartitioningAdapter=p,l.LokiLocalStorageAdapter=m,l.LokiFsAdapter=y,l.persistenceAdapters={fs:y,localStorage:m},l.aeq=e,l.lt=t,l.gt=r,l.Comparators=v,l},"function"==typeof define&&define.amd?define([],t):"object"===_typeof3(n)?r.exports=t():e.loki=t()}).call(this)}).call(this,q("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./loki-indexed-adapter.js":223,_process:262,fs:77}],225:[function(e,t,r){var s={nearestPointOnLine:e("@turf/nearest-point-on-line").default,booleanPointInPolygon:e("@turf/boolean-point-in-polygon").default};t.exports=function t(e,r,n){var i;if(!e.geometry)return null;switch(e.geometry.type){case"LineString":case"MultiLineString":return s.nearestPointOnLine(e,r,n);case"Polygon":if(s.booleanPointInPolygon(r,e,n)){var o=JSON.parse(JSON.stringify(r));return o.properties={dist:0,location:0},o}return(o=JSON.parse(JSON.stringify(e))).geometry.type="MultiLineString",t(o,r,n);case"MultiPolygon":return 0<(i=(i=(i=e.geometry.coordinates.map(function(e){return t({type:"Feature",geometry:{type:"Polygon",coordinates:e}},r,n)})).filter(function(e){return e})).sort(function(e,t){return e&&t?e.properties.dist-t.properties.dist:null})).length?i[0]:void 0;case"GeometryCollection":return 0<(i=(i=(i=e.geometry.geometries.map(function(e){return t({type:"Feature",geometry:e},r,n)})).filter(function(e){return e})).sort(function(e,t){return e&&t?e.properties.dist-t.properties.dist:null})).length?i[0]:void 0;default:console.log("nearestPointOnGeometry: don't know how to handle "+e.geometry.type)}}},{"@turf/boolean-point-in-polygon":22,"@turf/nearest-point-on-line":58}],226:[function(e,t,r){t.exports=e("./polygon-features.json")},{"./polygon-features.json":227}],227:[function(e,t,r){t.exports=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}]},{}],228:[function(e,t,r){var I=e("./lodash.custom.js"),N=e("@mapbox/geojson-rewind"),n={};function i(e,t){return(e.version||t.version)&&e.version!==t.version?(+e.version||0)>(+t.version||0)?e:t:I.merge(e,t)}e("osm-polygon-features").forEach(function(e){var t,r;"all"===e.polygon?n[e.key]=!0:(t="whitelist"===e.polygon?"included_values":"excluded_values",r={},e.values.forEach(function(e){r[e]=!0}),n[e.key]={},n[e.key][t]=r)});e={};function L(e){function t(e){return e[0]}function r(e){return e[e.length-1]}function n(e,t){return void 0!==e&&void 0!==t&&e.id===t.id}for(var i,o,s,a,u,l,c=[];e.length;)for(i=e.pop().nodes.slice(),c.push(i);e.length&&!n(t(i),r(i));){for(o=t(i),s=r(i),a=0;a<e.length;a++){if(n(s,t(l=e[a].nodes))){u=i.push,l=l.slice(1);break}if(n(s,r(l))){u=i.push,l=l.slice(0,-1).reverse();break}if(n(o,r(l))){u=i.unshift,l=l.slice(0,-1);break}if(n(o,t(l))){u=i.unshift,l=l.slice(1).reverse();break}l=u=null}if(!l)break;e.splice(a,1),u.apply(i,l)}return c}(e=function(e,T,C){var t,l,c,h,p,f;function d(e,t,r){e.hasAttribute(r)&&(t[r]=e.getAttribute(r))}function y(e,t){e=I.clone(e);d(t,e,"lat"),d(t,e,"lon"),e.__is_center_placeholder=!0,h.push(e)}function m(e,t){var n=I.clone(e);function r(e,t,r){t={type:"node",id:"_"+n.type+"/"+n.id+"bounds"+r,lat:e,lon:t};n.nodes.push(t.id),h.push(t)}n.nodes=[],r(t.getAttribute("minlat"),t.getAttribute("minlon"),1),r(t.getAttribute("maxlat"),t.getAttribute("minlon"),2),r(t.getAttribute("maxlat"),t.getAttribute("maxlon"),3),r(t.getAttribute("minlat"),t.getAttribute("maxlon"),4),n.nodes.push(n.nodes[0]),n.__is_bounds_placeholder=!0,p.push(n)}return T=I.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:n,deduplicator:i},T),"undefined"!=typeof XMLDocument&&e instanceof XMLDocument||"undefined"==typeof XMLDocument&&e.childNodes?(t=e,h=new Array,p=new Array,f=new Array,I.each(t.getElementsByTagName("node"),function(e,t){var r={};I.each(e.getElementsByTagName("tag"),function(e){r[e.getAttribute("k")]=e.getAttribute("v")});var n={type:"node"};d(e,n,"id"),d(e,n,"lat"),d(e,n,"lon"),d(e,n,"version"),d(e,n,"timestamp"),d(e,n,"changeset"),d(e,n,"uid"),d(e,n,"user"),I.isEmpty(r)||(n.tags=r),h.push(n)}),I.each(t.getElementsByTagName("way"),function(e,t){var r={},n=[];I.each(e.getElementsByTagName("tag"),function(e){r[e.getAttribute("k")]=e.getAttribute("v")});var i=!1;I.each(e.getElementsByTagName("nd"),function(e,t){var r;(r=e.getAttribute("ref"))&&(n[t]=r),!i&&e.getAttribute("lat")&&(i=!0)});var o,s,a={type:"way"};d(e,a,"id"),d(e,a,"version"),d(e,a,"timestamp"),d(e,a,"changeset"),d(e,a,"uid"),d(e,a,"user"),0<n.length&&(a.nodes=n),I.isEmpty(r)||(a.tags=r),(l=e.getElementsByTagName("center")[0])&&y(a,l),i?(o=a,s=e.getElementsByTagName("nd"),I.isArray(o.nodes)||(o.nodes=[],I.each(s,function(e,t){o.nodes.push("_anonymous@"+e.getAttribute("lat")+"/"+e.getAttribute("lon"))})),I.each(s,function(e,t){var r;e.getAttribute("lat")&&(r=e.getAttribute("lat"),e=e.getAttribute("lon"),t=o.nodes[t],e={type:"node",id:t,lat:r,lon:e},h.push(e),e.id)})):(c=e.getElementsByTagName("bounds")[0])&&m(a,c),p.push(a)}),I.each(t.getElementsByTagName("relation"),function(e,t){var r={},n=[];I.each(e.getElementsByTagName("tag"),function(e){r[e.getAttribute("k")]=e.getAttribute("v")});var i=!1;I.each(e.getElementsByTagName("member"),function(e,t){n[t]={},d(e,n[t],"ref"),d(e,n[t],"role"),d(e,n[t],"type"),(!i&&"node"==n[t].type&&e.getAttribute("lat")||"way"==n[t].type&&0<e.getElementsByTagName("nd").length)&&(i=!0)});var o,s,a={type:"relation"};function u(e,t){var r;p.some(function(e){return"way"==e.type&&e.id==t})||(r={type:"way",id:t,nodes:[]},I.each(e,function(e){var t;e.getAttribute("lat")?(t=e.getAttribute("lat"),e=e.getAttribute("lon"),e={type:"node",id:"_anonymous@"+t+"/"+e,lat:t,lon:e},r.nodes.push(e.id),h.push(e)):r.nodes.push(void 0)}),p.push(r))}d(e,a,"id"),d(e,a,"version"),d(e,a,"timestamp"),d(e,a,"changeset"),d(e,a,"uid"),d(e,a,"user"),0<n.length&&(a.members=n),I.isEmpty(r)||(a.tags=r),(l=e.getElementsByTagName("center")[0])&&y(a,l),i?(o=a,s=e.getElementsByTagName("member"),I.each(s,function(e,t){var r,n,i;"node"==o.members[t].type?e.getAttribute("lat")&&(r=e.getAttribute("lat"),n=e.getAttribute("lon"),i=o.members[t].ref,n={type:"node",id:i,lat:r,lon:n},h.push(n)):"way"==o.members[t].type&&0<e.getElementsByTagName("nd").length&&(o.members[t].ref="_fullGeom"+o.members[t].ref,u(e.getElementsByTagName("nd"),o.members[t].ref))})):(c=e.getElementsByTagName("bounds")[0])&&m(a,c),f.push(a)}),g(h,p,f)):function(e){var s=new Array,i=new Array,t=new Array;function r(e){var t=I.clone(e);t.lat=e.center.lat,t.lon=e.center.lon,t.__is_center_placeholder=!0,s.push(t)}function n(e){var n=I.clone(e);function t(e,t,r){t={type:"node",id:"_"+n.type+"/"+n.id+"bounds"+r,lat:e,lon:t};n.nodes.push(t.id),s.push(t)}n.nodes=[],t(n.bounds.minlat,n.bounds.minlon,1),t(n.bounds.maxlat,n.bounds.minlon,2),t(n.bounds.maxlat,n.bounds.maxlon,3),t(n.bounds.minlat,n.bounds.maxlon,4),n.nodes.push(n.nodes[0]),n.__is_bounds_placeholder=!0,i.push(n)}function o(n){I.isArray(n.nodes)||(n.nodes=n.geometry.map(function(e){return null!==e?"_anonymous@"+e.lat+"/"+e.lon:"_anonymous@unknown_location"})),n.geometry.forEach(function(e,t){var r;e&&(r=e.lat,e=e.lon,t=n.nodes[t],e={type:"node",id:t,lat:r,lon:e},s.push(e))})}function a(e){function o(e,t){var r;i.some(function(e){return"way"==e.type&&e.id==t})||(r={type:"way",id:t,nodes:[]},e.forEach(function(e){var t;e?(t=e.lat,e=e.lon,e={type:"node",id:"_anonymous@"+t+"/"+e,lat:t,lon:e},r.nodes.push(e.id),s.push(e)):r.nodes.push(void 0)}),i.push(r))}e.members.forEach(function(e,t){var r,n,i;"node"==e.type?e.lat&&(r=e.lat,n=e.lon,i=e.ref,n={type:"node",id:i,lat:r,lon:n},s.push(n)):"way"==e.type&&e.geometry&&(e.ref="_fullGeom"+e.ref,o(e.geometry,e.ref))})}for(var u=0;u<e.elements.length;u++)switch(e.elements[u].type){case"node":var l=e.elements[u];s.push(l);break;case"way":var c=I.clone(e.elements[u]);c.nodes=I.clone(c.nodes),i.push(c),c.center&&r(c),c.geometry?o(c):c.bounds&&n(c);break;case"relation":l=I.clone(e.elements[u]);l.members=I.clone(l.members),t.push(l);c=l.members&&l.members.some(function(e){return"node"==e.type&&e.lat||"way"==e.type&&e.geometry&&0<e.geometry.length});l.center&&r(l),c?a(l):l.bounds&&n(l)}return g(s,i,t)}(e);function g(e,t,r){function n(e,t){if("object"!==_typeof3(t)&&(t={}),"function"==typeof T.uninterestingTags)return!T.uninterestingTags(e,t);for(var r in e)if(!0!==T.uninterestingTags[r]&&!0!==t[r]&&t[r]!==e[r])return 1}function h(e){var t,r={timestamp:e.timestamp,version:e.version,changeset:e.changeset,user:e.user,uid:e.uid};for(t in r)void 0===r[t]&&delete r[t];return r}for(var i=new Object,o=new Object,s=0;s<e.length;s++)void 0!==i[(f=e[s]).id]&&(f=T.deduplicator(f,i[f.id])),void 0!==(i[f.id]=f).tags&&n(f.tags)&&(o[f.id]=!0);for(s=0;s<r.length;s++)if(I.isArray(r[s].members))for(var a=0;a<r[s].members.length;a++)"node"==r[s].members[a].type&&(o[r[s].members[a].ref]=!0);for(var p=new Object,u=new Object,s=0;s<t.length;s++){var l=t[s];if(p[l.id]&&(l=T.deduplicator(l,p[l.id])),p[l.id]=l,I.isArray(l.nodes))for(a=0;a<l.nodes.length;a++)"object"!==_typeof3(l.nodes[a])&&(u[l.nodes[a]]=!0,l.nodes[a]=i[l.nodes[a]])}var c=new Array;for(y in i){var f=i[y];u[y]&&!o[y]||c.push(f)}for(var d=new Array,s=0;s<r.length;s++)d[(v=r[s]).id]&&(v=T.deduplicator(v,d[v.id])),d[v.id]=v;var y,m,g={node:{},way:{},relation:{}};for(y in d){var v=d[y];if(I.isArray(v.members))for(a=0;a<v.members.length;a++){var b=v.members[a].type,w=v.members[a].ref;"number"!=typeof w&&(w=w.replace("_fullGeom","")),g[b]?(void 0===g[b][w]&&(g[b][w]=[]),g[b][w].push({role:v.members[a].role,rel:v.id,reltags:v.tags})):T.verbose&&console.warn("Relation",v.type+"/"+v.id,"member",b+"/"+w,"ignored because it has an invalid type")}else T.verbose&&console.warn("Relation",v.type+"/"+v.id,"ignored because it has no members")}var x=[];for(s=0;s<c.length;s++)void 0!==c[s].lon&&void 0!==c[s].lat?(A={type:"Feature",id:c[s].type+"/"+c[s].id,properties:{type:c[s].type,id:c[s].id,tags:c[s].tags||{},relations:g.node[c[s].id]||[],meta:h(c[s])},geometry:{type:"Point",coordinates:[+c[s].lon,+c[s].lat]}},c[s].__is_center_placeholder&&(A.properties.geometry="center"),C?C(A):x.push(A)):T.verbose&&console.warn("POI",c[s].type+"/"+c[s].id,"ignored because it lacks coordinates");for(var _=[],k=[],s=0;s<r.length;s++)if(d[r[s].id]===r[s]){if(void 0!==r[s].tags&&("route"==r[s].tags.type||"waterway"==r[s].tags.type)){if(!I.isArray(r[s].members)){T.verbose&&console.warn("Route",r[s].type+"/"+r[s].id,"ignored because it has no members");continue}if(r[s].members.forEach(function(e){p[e.ref]&&!n(p[e.ref].tags)&&(p[e.ref].is_skippablerelationmember=!0)}),!1===(A=function(r){var e,n=!1,t=r.members.filter(function(e){return"way"===e.type});t=t.map(function(t){var e=p[t.ref];return void 0===e||void 0===e.nodes?(T.verbose&&console.warn("Route "+r.type+"/"+r.id,"tainted by a missing or incomplete  way",t.type+"/"+t.ref),void(n=!0)):{id:t.ref,role:t.role,way:e,nodes:e.nodes.filter(function(e){return void 0!==e||(n=!0,T.verbose&&console.warn("Route",r.type+"/"+r.id,"tainted by a way",t.type+"/"+t.ref,"with a missing node"),!1)})}}),e=L(t=I.compact(t));t=[];if(0==(t=I.compact(e.map(function(e){return I.compact(e.map(function(e){return[+e.lon,+e.lat]}))}))).length)return T.verbose&&console.warn("Route",r.type+"/"+r.id,"contains no coordinates"),!1;t={type:"Feature",id:r.type+"/"+r.id,properties:{type:r.type,id:r.id,tags:r.tags||{},relations:g[r.type][r.id]||[],meta:h(r)},geometry:{type:1===t.length?"LineString":"MultiLineString",coordinates:1===t.length?t[0]:t}};return n&&(T.verbose&&console.warn("Route",r.type+"/"+r.id,"is tainted"),t.properties.tainted=!0),t}(r[s]))){T.verbose&&console.warn("Route relation",r[s].type+"/"+r[s].id,"ignored because it has invalid geometry");continue}C?C(N(A)):k.push(A)}if(void 0!==r[s].tags&&("multipolygon"==r[s].tags.type||"boundary"==r[s].tags.type)){function E(e,t){var i,r,n,o=!1,s=O?"way":"relation",a="number"==typeof e.id?e.id:+e.id.replace("_fullGeom","");c=(c=t.members.filter(function(e){return"way"===e.type})).map(function(t){var e=p[t.ref];return void 0===e||void 0===e.nodes?(T.verbose&&console.warn("Multipolygon",s+"/"+a,"tainted by a missing or incomplete way",t.type+"/"+t.ref),void(o=!0)):{id:t.ref,role:t.role||"outer",way:e,nodes:e.nodes.filter(function(e){return void 0!==e||(o=!0,T.verbose&&console.warn("Multipolygon",s+"/"+a,"tainted by a way",t.type+"/"+t.ref,"with a missing node"),!1)})}}),c=I.compact(c),i=L(c.filter(function(e){return"outer"===e.role})),r=L(c.filter(function(e){return"inner"===e.role})),n=i.map(function(e){return[e]});for(var u=0;u<r.length;u++){var l=function(e){function t(e){return e.map(function(e){return[+e.lat,+e.lon]})}var r,n=function(e,t){for(var r=e[0],n=e[1],i=!1,o=0,s=t.length-1;o<t.length;s=o++){var a=t[o][0],u=t[o][1],l=t[s][0],c=t[s][1];n<u!=n<c&&r<(l-a)*(n-u)/(c-u)+a&&(i=!i)}return i};for(e=t(e),r=0;r<i.length;r++)if(function(e,t){for(var r=0;r<t.length;r++)if(n(t[r],e))return!0;return!1}(t(i[r]),e))return r}(r[u]);void 0!==l?n[l].push(r[u]):T.verbose&&console.warn("Multipolygon",s+"/"+a,"contains an inner ring with no containing outer")}t=[];if(0==(t=I.compact(n.map(function(e){e=I.compact(e.map(function(e){return e.length<4?void(T.verbose&&console.warn("Multipolygon",s+"/"+a,"contains a ring with less than four nodes")):I.compact(e.map(function(e){return[+e.lon,+e.lat]}))}));if(0!=e.length)return e;T.verbose&&console.warn("Multipolygon",s+"/"+a,"contains an empty ring cluster")}))).length)return T.verbose&&console.warn("Multipolygon",s+"/"+a,"contains no coordinates"),!1;var c="MultiPolygon";1===t.length&&(c="Polygon",t=t[0]);t={type:"Feature",id:e.type+"/"+a,properties:{type:e.type,id:a,tags:e.tags||{},relations:g[e.type][e.id]||[],meta:h(e)},geometry:{type:c,coordinates:t}};return o&&(T.verbose&&console.warn("Multipolygon",s+"/"+a,"is tainted"),t.properties.tainted=!0),t}if(I.isArray(r[s].members)){for(var S=0,a=0;a<r[s].members.length;a++)"outer"==r[s].members[a].role?S++:T.verbose&&"inner"!=r[s].members[a].role&&console.warn("Multipolygon",r[s].type+"/"+r[s].id,"member",r[s].members[a].type+"/"+r[s].members[a].ref,'ignored because it has an invalid role: "'+r[s].members[a].role+'"');if(r[s].members.forEach(function(e){p[e.ref]&&("outer"!==e.role||n(p[e.ref].tags,r[s].tags)||(p[e.ref].is_skippablerelationmember=!0),"inner"!==e.role||n(p[e.ref].tags)||(p[e.ref].is_skippablerelationmember=!0))}),0!=S){var O=!1;1!=S||n(r[s].tags,{type:!0})||(O=!0);var A=null;if(O){var M=r[s].members.filter(function(e){return"outer"===e.role})[0];if(void 0===(M=p[M.ref])){T.verbose&&console.warn("Multipolygon relation",r[s].type+"/"+r[s].id,"ignored because outer way",M.type+"/"+M.ref,"is missing");continue}M.is_skippablerelationmember=!0,A=E(M,r[s])}else A=E(r[s],r[s]);!1!==A?C?C(N(A)):k.push(A):T.verbose&&console.warn("Multipolygon relation",r[s].type+"/"+r[s].id,"ignored because it has invalid geometry")}else T.verbose&&console.warn("Multipolygon relation",r[s].type+"/"+r[s].id,"ignored because it has no outer ways")}else T.verbose&&console.warn("Multipolygon",r[s].type+"/"+r[s].id,"ignored because it has no members")}}for(s=0;s<t.length;s++)if(p[t[s].id]===t[s])if(I.isArray(t[s].nodes)){if(!t[s].is_skippablerelationmember){"number"!=typeof t[s].id&&(t[s].id=+t[s].id.replace("_fullGeom","")),t[s].tainted=!1,t[s].hidden=!1;var P,j=new Array;for(a=0;a<t[s].nodes.length;a++)"object"==_typeof3(t[s].nodes[a])?j.push([+t[s].nodes[a].lon,+t[s].nodes[a].lat]):(T.verbose&&console.warn("Way",t[s].type+"/"+t[s].id,"is tainted by an invalid node"),t[s].tainted=!0);j.length<=1?T.verbose&&console.warn("Way",t[s].type+"/"+t[s].id,"ignored because it contains too few nodes"):(P="LineString",void 0!==t[s].nodes[0]&&void 0!==t[s].nodes[t[s].nodes.length-1]&&t[s].nodes[0].id===t[s].nodes[t[s].nodes.length-1].id&&(void 0!==t[s].tags&&function(e){var t,r=T.polygonFeatures;if("function"==typeof r)return r(e);if("no"===e.area)return!1;for(t in e){var n=e[t],i=r[t];if(void 0!==i&&"no"!==n){if(!0===i)return!0;if(i.included_values&&!0===i.included_values[n])return!0;if(i.excluded_values&&!0!==i.excluded_values[n])return!0}}return!1}(t[s].tags)||t[s].__is_bounds_placeholder)&&(P="Polygon",j=[j]),A={type:"Feature",id:t[s].type+"/"+t[s].id,properties:{type:t[s].type,id:t[s].id,tags:t[s].tags||{},relations:g.way[t[s].id]||[],meta:h(t[s])},geometry:{type:P,coordinates:j}},t[s].tainted&&(T.verbose&&console.warn("Way",t[s].type+"/"+t[s].id,"is tainted"),A.properties.tainted=!0),t[s].__is_bounds_placeholder&&(A.properties.geometry="bounds"),C?C(N(A)):("LineString"==P?_:k).push(A))}}else T.verbose&&console.warn("Way",t[s].type+"/"+t[s].id,"ignored because it has no nodes");return!!C||((m={type:"FeatureCollection",features:[]}).features=m.features.concat(k),m.features=m.features.concat(_),m.features=m.features.concat(x),T.flatProperties&&m.features.forEach(function(e){e.properties=I.merge(e.properties.meta,e.properties.tags,{id:e.properties.type+"/"+e.properties.id})}),m=N(m))}}).toGeojson=e,t.exports=e},{"./lodash.custom.js":229,"@mapbox/geojson-rewind":3,"osm-polygon-features":226}],229:[function(e,Ht,Yt){(function(Xt){(function(){(function(){var v,e="Expected a function",n="__lodash_hash_undefined__",y=1,b=2,r=1/0,i=9007199254740991,f="[object Arguments]",h="[object Array]",d="[object Boolean]",m="[object Date]",p="[object Error]",g="[object Function]",w="[object GeneratorFunction]",x="[object Map]",_="[object Number]",k="[object Object]",o="[object Promise]",E="[object RegExp]",S="[object Set]",O="[object String]",A="[object Symbol]",s="[object WeakMap]",M="[object ArrayBuffer]",P="[object DataView]",j="[object Float32Array]",T="[object Float64Array]",C="[object Int8Array]",I="[object Int16Array]",N="[object Int32Array]",L="[object Uint8Array]",F="[object Uint8ClampedArray]",R="[object Uint16Array]",D="[object Uint32Array]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/,t=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/\\(\\)?/g,q=/\w*$/,B=/^\[object .+?Constructor\]$/,z=/^(?:0|[1-9]\d*)$/,$={};$[j]=$[T]=$[C]=$[I]=$[N]=$[L]=$[F]=$[R]=$[D]=!0,$[f]=$[h]=$[M]=$[d]=$[P]=$[m]=$[p]=$[g]=$[x]=$[_]=$[k]=$[E]=$[S]=$[O]=$[s]=!1;var G={};G[f]=G[h]=G[M]=G[P]=G[d]=G[m]=G[j]=G[T]=G[C]=G[I]=G[N]=G[x]=G[_]=G[k]=G[E]=G[S]=G[O]=G[A]=G[L]=G[F]=G[R]=G[D]=!0,G[p]=G[g]=G[s]=!1;var U="object"==_typeof3(Xt)&&Xt&&Xt.Object===Object&&Xt,W="object"==("undefined"==typeof self?"undefined":_typeof3(self))&&self&&self.Object===Object&&self,J=U||W||Function("return this")(),V="object"==_typeof3(Yt)&&Yt&&!Yt.nodeType&&Yt,X=V&&"object"==_typeof3(Ht)&&Ht&&!Ht.nodeType&&Ht,H=X&&X.exports===V,Y=H&&U.process,K=function(){try{return Y&&Y.binding("util")}catch(e){}}(),Q=K&&K.isTypedArray;function Z(e,t){return e.set(t[0],t[1]),e}function ee(e,t){return e.add(t),e}function te(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););return e}function re(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function ne(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function ie(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n}function oe(t,r){return function(e){return t(r(e))}}function se(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var ae=Array.prototype,ue=Function.prototype,le=Object.prototype,W=J["__core-js_shared__"],ce=(U=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",he=ue.toString,pe=le.hasOwnProperty,fe=he.call(Object),de=le.toString,ye=RegExp("^"+he.call(pe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),K=H?J.Buffer:v,W=J.Symbol,me=J.Uint8Array,ge=oe(Object.getPrototypeOf,Object),ve=Object.create,be=le.propertyIsEnumerable,we=ae.splice,U=Object.getOwnPropertySymbols,ue=K?K.isBuffer:v,xe=oe(Object.keys,Object),_e=Math.max,H=lt(J,"DataView"),ke=lt(J,"Map"),ae=lt(J,"Promise"),K=lt(J,"Set"),J=lt(J,"WeakMap"),Ee=lt(Object,"create"),Se=!be.call({valueOf:1},"valueOf"),Oe=bt(H),Ae=bt(ke),Me=bt(ae),Pe=bt(K),je=bt(J),W=W?W.prototype:v,Te=W?W.valueOf:v,Ce=W?W.toString:v;function Ie(){}function Ne(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Le(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Fe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Re(e){var t=-1,r=e?e.length:0;for(this.__data__=new Fe;++t<r;)this.add(e[t])}function De(e){this.__data__=new Le(e)}function qe(e,t){var r,n=Et(e)||kt(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],i=n.length,o=!!i;for(r in e)!t&&!pe.call(e,r)||o&&("length"==r||pt(r,i))||n.push(r);return n}function Be(e,t,r){(r===v||_t(e[t],r))&&("number"!=typeof t||r!==v||t in e)||(e[t]=r)}function ze(e,t,r){var n=e[t];pe.call(e,t)&&_t(n,r)&&(r!==v||t in e)||(e[t]=r)}function $e(e,t){for(var r=e.length;r--;)if(_t(e[r][0],t))return r;return-1}function Ge(r,n,i,o,e,t,s){var a;if(o&&(a=t?o(r,e,t,s):o(r)),a!==v)return a;if(!jt(r))return r;var u,l=Et(r);if(l){if(a=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&pe.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(r),!n)return ot(r,a)}else{var c=ht(r),h=c==g||c==w;if(At(r))return function(e,t){if(t)return e.slice();t=new e.constructor(e.length);return e.copy(t),t}(r,n);if(c==k||c==f||h&&!t){if(ne(r))return t?r:{};if(a="function"!=typeof(u=h?{}:r).constructor||dt(u)?{}:function(e){return jt(e)?ve(e):{}}(ge(u)),!n)return h=e=r,u=(u=a)&&st(h,Bt(h),u),st(e,ct(e),u)}else{if(!G[c])return t?r:{};a=function(e,t,r,n){var i=e.constructor;switch(t){case M:return it(e);case d:case m:return new i(+e);case P:return function(e,t){t=t?it(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,n);case j:case T:case C:case I:case N:case L:case F:case R:case D:return function(e,t){t=t?it(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}(e,n);case x:return function(e,t,r){return re(t?r(ie(e),!0):ie(e),Z,new e.constructor)}(e,n,r);case _:case O:return new i(e);case E:return function(e){var t=new e.constructor(e.source,q.exec(e));return t.lastIndex=e.lastIndex,t}(e);case S:return function(e,t,r){return re(t?r(se(e),!0):se(e),ee,new e.constructor)}(e,n,r);case A:return function(e){return Te?Object(Te.call(e)):{}}(e)}}(r,c,Ge,n)}}var p,c=(s=s||new De).get(r);return c||(s.set(r,a),l||(p=i?function(e,t,r){t=t(e);return Et(e)?t:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(t,r(e))}(r,Bt,ct):Bt(r)),te(p||r,function(e,t){p&&(e=r[t=e]),ze(a,t,Ge(e,n,i,o,t,r,s))}),a)}Ne.prototype.clear=function(){this.__data__=Ee?Ee(null):{}},Ne.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ne.prototype.get=function(e){var t=this.__data__;if(Ee){var r=t[e];return r===n?v:r}return pe.call(t,e)?t[e]:v},Ne.prototype.has=function(e){var t=this.__data__;return Ee?t[e]!==v:pe.call(t,e)},Ne.prototype.set=function(e,t){return this.__data__[e]=Ee&&t===v?n:t,this},Le.prototype.clear=function(){this.__data__=[]},Le.prototype.delete=function(e){var t=this.__data__;return!((e=$e(t,e))<0)&&(e==t.length-1?t.pop():we.call(t,e,1),!0)},Le.prototype.get=function(e){var t=this.__data__;return(e=$e(t,e))<0?v:t[e][1]},Le.prototype.has=function(e){return-1<$e(this.__data__,e)},Le.prototype.set=function(e,t){var r=this.__data__,n=$e(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Fe.prototype.clear=function(){this.__data__={hash:new Ne,map:new(ke||Le),string:new Ne}},Fe.prototype.delete=function(e){return ut(this,e).delete(e)},Fe.prototype.get=function(e){return ut(this,e).get(e)},Fe.prototype.has=function(e){return ut(this,e).has(e)},Fe.prototype.set=function(e,t){return ut(this,e).set(e,t),this},Re.prototype.add=Re.prototype.push=function(e){return this.__data__.set(e,n),this},Re.prototype.has=function(e){return this.__data__.has(e)},De.prototype.clear=function(){this.__data__=new Le},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Le){var n=r.__data__;if(!ke||n.length<199)return n.push([e,t]),this;r=this.__data__=new Fe(n)}return r.set(e,t),this};var Ue,We,Je,Ve=(Ue=function(e,t){return e&&Xe(e,t,Bt)},function(e,t){if(null==e)return e;if(!St(e))return Ue(e,t);for(var r=e.length,n=We?r:-1,i=Object(e);(We?n--:++n<r)&&!1!==t(i[n],n,i););return e}),Xe=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[Je?s:++n];if(!1===t(i[a],a,i))break}return e};function He(e,t){for(var r=0,n=(t=ft(t,e)?[t]:nt(t)).length;null!=e&&r<n;)e=e[vt(t[r++])];return r&&r==n?e:v}function Ye(e,t){return null!=e&&t in Object(e)}function Ke(e,t,r,n,i){return e===t||(null==e||null==t||!jt(e)&&!Tt(t)?e!=e&&t!=t:function(e,t,r,n,i,o){var s=Et(e),a=Et(t),u=h,l=h;s||(u=(u=ht(e))==f?k:u);a||(l=(l=ht(t))==f?k:l);var c=u==k&&!ne(e),a=l==k&&!ne(t),l=u==l;if(l&&!c)return o=o||new De,s||Lt(e)?at(e,t,r,n,i,o):function(e,t,r,n,i,o,s){switch(r){case P:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case M:return e.byteLength==t.byteLength&&n(new me(e),new me(t))?!0:!1;case d:case m:case _:return _t(+e,+t);case p:return e.name==t.name&&e.message==t.message;case E:case O:return e==t+"";case x:var a=ie;case S:var u=o&b;if(a=a||se,e.size!=t.size&&!u)return!1;u=s.get(e);if(u)return u==t;o|=y,s.set(e,t);a=at(a(e),a(t),n,i,o,s);return s.delete(e),a;case A:if(Te)return Te.call(e)==Te.call(t)}return!1}(e,t,u,r,n,i,o);if(!(i&b)){c=c&&pe.call(e,"__wrapped__"),a=a&&pe.call(t,"__wrapped__");if(c||a){c=c?e.value():e,a=a?t.value():t;return o=o||new De,r(c,a,n,i,o)}}return l&&(o=o||new De,function(e,t,r,n,i,o){var s=i&b,a=Bt(e),u=a.length,l=Bt(t).length;if(u!=l&&!s)return!1;var c=u;for(;c--;){var h=a[c];if(!(s?h in t:pe.call(t,h)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var f=!0;o.set(e,t),o.set(t,e);var d=s;for(;++c<u;){h=a[c];var y,m=e[h],g=t[h];if(n&&(y=s?n(g,m,h,t,e,o):n(m,g,h,e,t,o)),!(y===v?m===g||r(m,g,n,i,o):y)){f=!1;break}d=d||"constructor"==h}f&&!d&&(l=e.constructor,p=t.constructor,l!=p&&"constructor"in e&&"constructor"in t&&!("function"==typeof l&&l instanceof l&&"function"==typeof p&&p instanceof p)&&(f=!1));return o.delete(e),o.delete(t),f}(e,t,r,n,i,o))}(e,t,Ke,r,n,i))}function Qe(e){var t;return jt(e)&&(t=e,!(ce&&ce in t))&&(Mt(e)||ne(e)?ye:B).test(bt(e))}function Ze(e){return"function"==typeof e?e:null==e?Gt:"object"==_typeof3(e)?Et(e)?function(r,n){if(ft(r)&&yt(n))return mt(vt(r),n);return function(e){var t=Dt(e,r);return t===v&&t===n?qt(e,r):Ke(n,t,v,y|b)}}(e[0],e[1]):function(t){var r=function(e){var t=Bt(e),r=t.length;for(;r--;){var n=t[r],i=e[n];t[r]=[n,i,yt(i)]}return t}(t);if(1==r.length&&r[0][2])return mt(r[0][0],r[0][1]);return function(e){return e===t||function(e,t,r,n){var i=r.length,o=i,s=!n;if(null==e)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var u=(a=r[i])[0],l=e[u],c=a[1];if(s&&a[2]){if(l===v&&!(u in e))return!1}else{var h,p=new De;if(n&&(h=n(l,c,u,e,t,p)),!(h===v?Ke(c,l,n,y|b,p):h))return!1}}return!0}(e,t,r)}}(e):Wt(e)}function et(e){if(!jt(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t,r=dt(e),n=[];for(t in e)("constructor"!=t||!r&&pe.call(e,t))&&n.push(t);return n}function tt(n,i,o,s,a){var u;n!==i&&(Et(i)||Lt(i)||(u=et(i)),te(u||i,function(e,t){var r;u&&(e=i[t=e]),jt(e)?(a=a||new De,function(e,t,r,n,i,o,s){var a=e[r],u=t[r],l=s.get(u);if(l)return Be(e,r,l);l=o?o(a,u,r+"",e,t,s):v,(t=l===v)&&(Et(l=u)||Lt(u)?l=Et(a)?a:Ot(a)?ot(a):Ge(u,!(t=!1)):Ct(u)||kt(u)?l=kt(a)?Ft(a):!jt(a)||n&&Mt(a)?Ge(u,!(t=!1)):a:t=!1),t&&(s.set(u,l),i(l,u,n,o,s),s.delete(u)),Be(e,r,l)}(n,i,t,o,tt,s,a)):((r=s?s(n[t],e,t+"",n,i,a):v)===v&&(r=e),Be(n,t,r))}))}function rt(o,s){return s=_e(s===v?o.length-1:s,0),function(){for(var e=arguments,t=-1,r=_e(e.length-s,0),n=Array(r);++t<r;)n[t]=e[s+t];t=-1;for(var i=Array(s+1);++t<s;)i[t]=e[t];return i[s]=n,function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(o,this,i)}}function nt(e){return Et(e)?e:gt(e)}function it(e){var t=new e.constructor(e.byteLength);return new me(t).set(new me(e)),t}function ot(e,t){var r=-1,n=e.length;for(t=t||Array(n);++r<n;)t[r]=e[r];return t}function st(e,t,r,n){r=r||{};for(var i=-1,o=t.length;++i<o;){var s=t[i],a=n?n(r[s],e[s],s,r,e):v;ze(r,s,a===v?e[s]:a)}return r}function at(e,t,r,n,i,o){var s=i&b,a=e.length,u=t.length;if(a!=u&&!(s&&a<u))return!1;u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,c=!0,h=i&y?new Re:v;for(o.set(e,t),o.set(t,e);++l<a;){var p,f=e[l],d=t[l];if(n&&(p=s?n(d,f,l,t,e,o):n(f,d,l,e,t,o)),p!==v){if(p)continue;c=!1;break}if(h){if(!function(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return 1}(t,function(e,t){return!h.has(t)&&(f===e||r(f,e,n,i,o))&&h.add(t)})){c=!1;break}}else if(f!==d&&!r(f,d,n,i,o)){c=!1;break}}return o.delete(e),o.delete(t),c}function ut(e,t){var r,n=e.__data__;return("string"==(e=_typeof3(r=t))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function lt(e,t){t=t,t=null==(e=e)?v:e[t];return Qe(t)?t:v}var ct=U?oe(U,Object):Jt,ht=function(e){return de.call(e)};function pt(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||z.test(e))&&-1<e&&e%1==0&&e<t}function ft(e,t){if(!Et(e)){var r=_typeof3(e);return"number"==r||"symbol"==r||"boolean"==r||null==e||It(e)||(u.test(e)||!a.test(e)||null!=t&&e in Object(t))}}function dt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||le)}function yt(e){return e==e&&!jt(e)}function mt(t,r){return function(e){return null!=e&&(e[t]===r&&(r!==v||t in Object(e)))}}(H&&ht(new H(new ArrayBuffer(1)))!=P||ke&&ht(new ke)!=x||ae&&ht(ae.resolve())!=o||K&&ht(new K)!=S||J&&ht(new J)!=s)&&(ht=function(e){var t=de.call(e),e=t==k?e.constructor:v,e=e?bt(e):v;if(e)switch(e){case Oe:return P;case Ae:return x;case Me:return o;case Pe:return S;case je:return s}return t});var gt=xt(function(e){e=Rt(e);var i=[];return t.test(e)&&i.push(""),e.replace(l,function(e,t,r,n){i.push(r?n.replace(c,"$1"):t||e)}),i});function vt(e){if("string"==typeof e||It(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}function bt(e){if(null!=e){try{return he.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function wt(e,t){return(Et(e)?te:Ve)(e,function(e,t){var r=(r=Ie.iteratee||Ut)===Ut?Ze:r;return arguments.length?r(e,t):r}(t,3))}function xt(n,i){if("function"!=typeof n||i&&"function"!=typeof i)throw new TypeError(e);function o(){var e=arguments,t=i?i.apply(this,e):e[0],r=o.cache;return r.has(t)?r.get(t):(e=n.apply(this,e),o.cache=r.set(t,e),e)}return o.cache=new(xt.Cache||Fe),o}function _t(e,t){return e===t||e!=e&&t!=t}function kt(e){return Ot(e)&&pe.call(e,"callee")&&(!be.call(e,"callee")||de.call(e)==f)}xt.Cache=Fe;var Et=Array.isArray;function St(e){return null!=e&&Pt(e.length)&&!Mt(e)}function Ot(e){return Tt(e)&&St(e)}var At=ue||Vt;function Mt(e){e=jt(e)?de.call(e):"";return e==g||e==w}function Pt(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=i}function jt(e){var t=_typeof3(e);return!!e&&("object"==t||"function"==t)}function Tt(e){return!!e&&"object"==_typeof3(e)}function Ct(e){if(!Tt(e)||de.call(e)!=k||ne(e))return!1;e=ge(e);if(null===e)return!0;e=pe.call(e,"constructor")&&e.constructor;return"function"==typeof e&&e instanceof e&&he.call(e)==fe}function It(e){return"symbol"==_typeof3(e)||Tt(e)&&de.call(e)==A}var Nt,Lt=Q?(Nt=Q,function(e){return Nt(e)}):function(e){return Tt(e)&&Pt(e.length)&&!!$[de.call(e)]};function Ft(e){return st(e,zt(e))}function Rt(e){return null==e?"":function(e){if("string"==typeof e)return e;if(It(e))return Ce?Ce.call(e):"";var t=e+"";return"0"==t&&1/e==-r?"-0":t}(e)}function Dt(e,t,r){t=null==e?v:He(e,t);return t===v?r:t}function qt(e,t){return null!=e&&function(e,t,r){for(var n,i=-1,o=(t=ft(t,e)?[t]:nt(t)).length;++i<o;){var s=vt(t[i]);if(!(n=null!=e&&r(e,s)))break;e=e[s]}return n||!!(o=e?e.length:0)&&Pt(o)&&pt(s,o)&&(Et(e)||kt(e))}(e,t,Ye)}function Bt(e){return(St(e)?qe:function(e){if(!dt(e))return xe(e);var t,r=[];for(t in Object(e))pe.call(e,t)&&"constructor"!=t&&r.push(t);return r})(e)}function zt(e){return St(e)?qe(e,!0):et(e)}var $t,Q=($t=function(e,t,r){tt(e,t,r)},rt(function(e,t){var r=-1,n=t.length,i=1<n?t[n-1]:v,o=2<n?t[2]:v,i=3<$t.length&&"function"==typeof i?(n--,i):v;for(o&&function(e,t,r){if(!jt(r))return!1;var n=_typeof3(t);if("number"==n?St(r)&&pt(t,r.length):"string"==n&&t in r)return _t(r[t],e);return!1}(t[0],t[1],o)&&(i=n<3?v:i,n=1),e=Object(e);++r<n;){var s=t[r];s&&$t(e,s,r,i)}return e}));function Gt(e){return e}function Ut(e){return Ze("function"==typeof e?e:Ge(e,!0))}function Wt(e){return ft(e)?(r=vt(e),function(e){return null==e?v:e[r]}):(t=e,function(e){return He(e,t)});var t,r}function Jt(){return[]}function Vt(){return!1}Ie.compact=function(e){for(var t=-1,r=e?e.length:0,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},Ie.iteratee=Ut,Ie.keys=Bt,Ie.keysIn=zt,Ie.memoize=xt,Ie.merge=Q,Ie.property=Wt,Ie.toPlainObject=Ft,Ie.clone=function(e){return Ge(e,!1,!0)},Ie.eq=_t,Ie.forEach=wt,Ie.get=Dt,Ie.hasIn=qt,Ie.identity=Gt,Ie.isArguments=kt,Ie.isArray=Et,Ie.isArrayLike=St,Ie.isArrayLikeObject=Ot,Ie.isBuffer=At,Ie.isEmpty=function(e){if(St(e)&&(Et(e)||"string"==typeof e||"function"==typeof e.splice||At(e)||kt(e)))return!e.length;var t,r=ht(e);if(r==x||r==S)return!e.size;if(Se||dt(e))return!xe(e).length;for(t in e)if(pe.call(e,t))return!1;return!0},Ie.isFunction=Mt,Ie.isLength=Pt,Ie.isObject=jt,Ie.isObjectLike=Tt,Ie.isPlainObject=Ct,Ie.isSymbol=It,Ie.isTypedArray=Lt,Ie.stubArray=Jt,Ie.stubFalse=Vt,Ie.toString=Rt,Ie.each=wt,Ie.VERSION="4.15.0",X&&((X.exports=Ie)._=Ie,V._=Ie)}).call(this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],230:[function(e,r,n){(function(ft,dt){(function(){var e,t;e=this,t=function(e){"use strict";function t(n){for(var e=arguments.length,i=new Array(1<e?e-1:0),t=1;t<e;t++)i[t-1]=arguments[t];return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,i.concat(t))}}function c(i){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop();return i.call(this,t,n)}}var r="function"==typeof queueMicrotask&&queueMicrotask,n="function"==typeof dt&&dt,i="object"===_typeof3(ft)&&"function"==typeof ft.nextTick;function o(e){setTimeout(e,0)}function s(i){return function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(function(){return e.apply(void 0,r)})}}var y=s(r?queueMicrotask:n?dt:i?ft.nextTick:o);function a(i){return h(i)?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop();return u(i.apply(this,t),n)}:c(function(e,t){var r;try{r=i.apply(this,e)}catch(e){return t(e)}if(r&&"function"==typeof r.then)return u(r,t);t(null,r)})}function u(e,t){return e.then(function(e){l(t,null,e)},function(e){l(t,e&&e.message?e:new Error(e))})}function l(e,t,r){try{e(t,r)}catch(e){y(function(e){throw e},e)}}function h(e){return"AsyncFunction"===e[Symbol.toStringTag]}function g(e){if("function"!=typeof e)throw new Error("expected a function");return h(e)?a(e):e}function p(s,e){var a=1<arguments.length&&void 0!==e?e:s.length;if(!a)throw new Error("arity is undefined");return function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return"function"==typeof r[a-1]?s.apply(this,r):new Promise(function(i,o){r[a-1]=function(e){if(e)return o(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i(1<r.length?r:r[0])},s.apply(e,r)})}}function f(i){return function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return p(function(e){var r=this;return i(t,function(e,t){g(e).apply(r,n.concat(t))},e)})}}function d(e,t,r,n){t=t||[];var i=[],o=0,s=g(r);return e(t,function(e,t,r){var n=o++;s(e,function(e,t){i[n]=t,r(e)})},function(e){n(e,i)})}function m(e){return e&&"number"==typeof e.length&&0<=e.length&&e.length%1==0}var v={};function b(i){function e(){if(null!==i){var e=i;i=null;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.apply(this,r)}}return Object.assign(e,i),e}function w(e){if(m(e))return r=-1,n=(t=e).length,function(){return++r<n?{value:t[r],key:r}:null};var t,r,n,i,o,s,a,u,l,c,i=(i=e)[Symbol.iterator]&&i[Symbol.iterator]();return i?(l=i,c=-1,function(){var e=l.next();return e.done?null:(c++,{value:e.value,key:c})}):(s=(o=e)?Object.keys(o):[],a=-1,u=s.length,function e(){var t=s[++a];return"__proto__"===t?e():a<u?{value:o[t],key:t}:null})}function x(i){return function(){if(null===i)throw new Error("Callback was already called.");var e=i;i=null;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];e.apply(this,r)}}function _(e,t,r,n){var i=!1,o=!1,s=!1,a=0,u=0;function l(){t<=a||s||i||(s=!0,e.next().then(function(e){var t=e.value,e=e.done;if(!o&&!i){if(s=!1,e)return i=!0,void(a<=0&&n(null));a++,r(t,u,c),u++,l()}}).catch(h))}function c(e,t){if(--a,!o)return e?h(e):!1!==e?t===v||i&&a<=0?(i=!0,n(null)):void l():void(o=i=!0)}function h(e){o||(i=!(s=!1),n(e))}l()}function k(c){return function(e,t,r){if(r=b(r),c<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return r(null);if("AsyncGenerator"===e[Symbol.toStringTag])return _(e,c,t,r);if("function"==typeof e[Symbol.asyncIterator])return _(e[Symbol.asyncIterator](),c,t,r);var n=w(e),i=!1,o=!1,s=0,a=!1;function u(e,t){if(!o)if(--s,e)i=!0,r(e);else if(!1===e)o=i=!0;else{if(t===v||i&&s<=0)return i=!0,r(null);a||l()}}function l(){for(a=!0;s<c&&!i;){var e=n();if(null===e)return i=!0,void(s<=0&&r(null));s+=1,t(e.value,e.key,x(u))}a=!1}l()}}var E=p(function(e,t,r,n){return k(t)(e,g(r),n)},4);function S(e,t,r){r=b(r);var n=0,i=0,o=e.length,s=!1;function a(e,t){!1===e&&(s=!0),!0!==s&&(e?r(e):++i!==o&&t!==v||r(null))}for(0===o&&r(null);n<o;n++)t(e[n],n,x(a))}function O(e,t,r){return E(e,1/0,t,r)}var A=p(function(e,t,r){return(m(e)?S:O)(e,g(t),r)},3);var M=p(function(e,t,r){return d(A,e,t,r)},3),P=f(M);var j=p(function(e,t,r){return E(e,1,t,r)},3);var T=p(function(e,t,r){return d(j,e,t,r)},3),C=f(T),I=Symbol("promiseCallback");function N(){var i,o;function e(e){if(e)return o(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i(1<r.length?r:r[0])}return e[I]=new Promise(function(e,t){i=e,o=t}),e}function L(s,e,a){"number"!=typeof e&&(a=e,e=null),a=b(a||N());var r=Object.keys(s).length;if(!r)return a(null);e=e||r;var u={},l=0,c=!1,h=!1,p=Object.create(null),n=[],f=[],d={};function y(e,t){n.push(function(){return function(o,e){if(h)return;var t=x(function(e){for(var t,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];l--,!1!==e?(n.length<2&&(n=_slicedToArray(n,1)[0]),e?(t={},Object.keys(u).forEach(function(e){t[e]=u[e]}),t[o]=n,h=!0,p=Object.create(null),c||a(e,t)):(u[o]=n,(p[o]||[]).forEach(function(e){return e()}),m())):c=!0});l++;var r=g(e[e.length-1]);1<e.length?r(u,t):r(t)}(e,t)})}function m(){if(!c){if(0===n.length&&0===l)return a(null,u);for(;n.length&&l<e;)n.shift()()}}return Object.keys(s).forEach(function(r){var n=s[r];if(!Array.isArray(n))return y(r,[n]),void f.push(r);var i=n.slice(0,n.length-1),o=i.length;if(0===o)return y(r,n),void f.push(r);d[r]=o,i.forEach(function(e){if(!s[e])throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+e+"` in "+i.join(", "));var t;t=function(){0===--o&&y(r,n)},(p[e=e]||(p[e]=[])).push(t)})}),function(){for(var e,t=0;f.length;)e=f.pop(),t++,function(r){var n=[];return Object.keys(s).forEach(function(e){var t=s[e];Array.isArray(t)&&0<=t.indexOf(r)&&n.push(e)}),n}(e).forEach(function(e){0==--d[e]&&f.push(e)});if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),m(),a[I]}var F=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,R=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,D=/,/,q=/(=.+)?(\s*)$/,B=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function z(s,e){var a={};return Object.keys(s).forEach(function(e){var n,i=s[e],t=h(i),r=!t&&1===i.length||t&&0===i.length;if(Array.isArray(i))n=_toConsumableArray3(i),i=n.pop(),a[e]=n.concat(0<n.length?o:i);else if(r)a[e]=i;else{if(n=function(e){var t=e.toString().replace(B,"");if(!(e=(e=t.match(F))||t.match(R)))throw new Error("could not parse args in autoInject\nSource:\n"+t);return _slicedToArray(e,2)[1].replace(/\s/g,"").split(D).map(function(e){return e.replace(q,"").trim()})}(i),0===i.length&&!t&&0===n.length)throw new Error("autoInject task functions require explicit parameters.");t||n.pop(),a[e]=n.concat(o)}function o(t,e){var r=n.map(function(e){return t[e]});r.push(e),g(i).apply(void 0,_toConsumableArray3(r))}}),L(a,e)}var $=function(){function e(){_classCallCheck2(this,e),this.head=this.tail=null,this.length=0}return _createClass2(e,[{key:"removeLink",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,--this.length,e}},{key:"empty",value:function(){for(;this.head;)this.shift();return this}},{key:"insertAfter",value:function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}},{key:"insertBefore",value:function(e,t){t.prev=e.prev,(t.next=e).prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}},{key:"unshift",value:function(e){this.head?this.insertBefore(this.head,e):G(this,e)}},{key:"push",value:function(e){this.tail?this.insertAfter(this.tail,e):G(this,e)}},{key:"shift",value:function(){return this.head&&this.removeLink(this.head)}},{key:"pop",value:function(){return this.tail&&this.removeLink(this.tail)}},{key:"toArray",value:function(){return _toConsumableArray3(this)}},{key:Symbol.iterator,value:_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(t)return e.next=4,t.data;e.next=7;break;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})},{key:"remove",value:function(e){for(var t=this.head;t;){var r=t.next;e(t)&&this.removeLink(t),t=r}return this}}]),e}();function G(e,t){e.length=1,e.head=e.tail=t}function U(e,t,r){if(null==t)t=1;else if(0===t)throw new RangeError("Concurrency must not be zero");var s=g(e),l=0,c=[],a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function u(e,t){return e?t?void(a[e]=a[e].filter(function(e){return e!==t})):a[e]=[]:Object.keys(a).forEach(function(e){return a[e]=[]})}function h(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a[e].forEach(function(e){return e.apply(void 0,r)})}var p=!1;function n(e,t,i,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");var o,s;function n(e){if(e)return i?s(e):o();for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length<=1)return o(r[0]);o(r)}d.started=!0;e={data:e,callback:!i&&r||n};if(t?d._tasks.unshift(e):d._tasks.push(e),p||(p=!0,y(function(){p=!1,d.process()})),i||!r)return new Promise(function(e,t){o=e,s=t})}function i(e){return 0===e.length&&d.idle()&&(y(function(){return h("drain")}),1)}function o(o){return function(e){if(!e)return new Promise(function(r,n){function e(){u(t,e),i.apply(void 0,arguments)}var t,i;i=function(e,t){return e?n(e):void r(t)},a[t=o].push(e)});u(o),e=e,a[o].push(e)}}var f=!1,d=(_defineProperty3(e={_tasks:new $},Symbol.iterator,_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(d._tasks[Symbol.iterator](),"t0",1);case 1:case"end":return e.stop()}},e)})),_defineProperty3(e,"concurrency",t),_defineProperty3(e,"payload",r),_defineProperty3(e,"buffer",t/4),_defineProperty3(e,"started",!1),_defineProperty3(e,"paused",!1),_defineProperty3(e,"push",function(e,t){return Array.isArray(e)?i(e)?void 0:e.map(function(e){return n(e,!1,!1,t)}):n(e,!1,!1,t)}),_defineProperty3(e,"pushAsync",function(e,t){return Array.isArray(e)?i(e)?void 0:e.map(function(e){return n(e,!1,!0,t)}):n(e,!1,!0,t)}),_defineProperty3(e,"kill",function(){u(),d._tasks.empty()}),_defineProperty3(e,"unshift",function(e,t){return Array.isArray(e)?i(e)?void 0:e.map(function(e){return n(e,!0,!1,t)}):n(e,!0,!1,t)}),_defineProperty3(e,"unshiftAsync",function(e,t){return Array.isArray(e)?i(e)?void 0:e.map(function(e){return n(e,!0,!0,t)}):n(e,!0,!0,t)}),_defineProperty3(e,"remove",function(e){d._tasks.remove(e)}),_defineProperty3(e,"process",function(){if(!f){for(f=!0;!d.paused&&l<d.concurrency&&d._tasks.length;){var e=[],t=[],r=d._tasks.length;d.payload&&(r=Math.min(r,d.payload));for(var n=0;n<r;n++){var i=d._tasks.shift();e.push(i),c.push(i),t.push(i.data)}l+=1,0===d._tasks.length&&h("empty"),l===d.concurrency&&h("saturated");var o=x(function(u){return function(e){--l;for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,o=u.length;i<o;i++){var s=u[i],a=c.indexOf(s);0===a?c.shift():0<a&&c.splice(a,1),s.callback.apply(s,[e].concat(r)),null!=e&&h("error",e,s.data)}l<=d.concurrency-d.buffer&&h("unsaturated"),d.idle()&&h("drain"),d.process()}}(e));s(t,o)}f=!1}}),_defineProperty3(e,"length",function(){return d._tasks.length}),_defineProperty3(e,"running",function(){return l}),_defineProperty3(e,"workersList",function(){return c}),_defineProperty3(e,"idle",function(){return d._tasks.length+l===0}),_defineProperty3(e,"pause",function(){d.paused=!0}),_defineProperty3(e,"resume",function(){!1!==d.paused&&(d.paused=!1,y(d.process))}),e);return Object.defineProperties(d,{saturated:{writable:!1,value:o("saturated")},unsaturated:{writable:!1,value:o("unsaturated")},empty:{writable:!1,value:o("empty")},drain:{writable:!1,value:o("drain")},error:{writable:!1,value:o("error")}}),d}function W(e,t){return U(e,1,t)}function J(e,t,r){return U(e,t,r)}var V=p(function(e,n,t,r){r=b(r);var i=g(t);return j(e,function(e,t,r){i(n,e,function(e,t){n=t,r(e)})},function(e){return r(e,n)})},4);function X(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=t.map(g);return function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return"function"==typeof i?t.pop():i=N(),V(o,t,function(e,t,i){t.apply(r,e.concat(function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i(e,r)}))},function(e,t){return i.apply(void 0,[e].concat(_toConsumableArray3(t)))}),i[I]}}function H(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.apply(void 0,_toConsumableArray3(t.reverse()))}var Y=p(function(e,t,r,n){return d(k(t),e,r,n)},4);var K=p(function(e,t,r,i){var n=g(r);return Y(e,t,function(e,i){n(e,function(e){if(e)return i(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,r)})},function(e,t){for(var r=[],n=0;n<t.length;n++)t[n]&&(r=r.concat.apply(r,_toConsumableArray3(t[n])));return i(e,r)})},4);var Q=p(function(e,t,r){return K(e,1/0,t,r)},3);var Z=p(function(e,t,r){return K(e,1,t,r)},3);function ee(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.pop().apply(void 0,[null].concat(n))}}function te(a,u){return function(e,t,r,n){var i,o=!1,s=g(r);e(t,function(r,e,n){s(r,function(e,t){return e||!1===e?n(e):a(t)&&!i?(i=u(o=!0,r),n(null,v)):void n()})},function(e){return e?n(e):void n(null,o?i:u(!1))})}}var re=p(function(e,t,r){return te(function(e){return e},function(e,t){return t})(A,e,t,r)},3);var ne=p(function(e,t,r,n){return te(function(e){return e},function(e,t){return t})(k(t),e,r,n)},4);var ie=p(function(e,t,r){return te(function(e){return e},function(e,t){return t})(k(1),e,t,r)},3);function oe(i){return function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return g(e).apply(void 0,r.concat([function(e){if("object"===("undefined"==typeof console?"undefined":_typeof3(console)))if(e)console.error&&console.error(e);else if(console[i]){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach(function(e){return console[i](e)})}}]))}}var se=oe("dir");var ae=p(function(e,t,i){i=x(i);var o,r=g(e),s=g(t);function n(e){if(e)return i(e);if(!1!==e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o=r,s.apply(void 0,r.concat([a]))}}function a(e,t){return e?i(e):!1!==e?t?void r(n):i.apply(void 0,[null].concat(_toConsumableArray3(o))):void 0}return a(null,!0)},3);function ue(e,t,r){var i=g(t);return ae(e,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop();i.apply(void 0,t.concat([function(e,t){return n(e,!t)}]))},r)}function le(n){return function(e,t,r){return n(e,r)}}var ce=p(function(e,t,r){return A(e,le(g(t)),r)},3);var he=p(function(e,t,r,n){return k(t)(e,le(g(r)),n)},4);var pe=p(function(e,t,r){return he(e,1,t,r)},3);function fe(o){return h(o)?o:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.pop(),i=!0;t.push(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];i?y(function(){return n.apply(void 0,t)}):n.apply(void 0,t)}),o.apply(this,t),i=!1}}var de=p(function(e,t,r){return te(function(e){return!e},function(e){return!e})(A,e,t,r)},3);var ye=p(function(e,t,r,n){return te(function(e){return!e},function(e){return!e})(k(t),e,r,n)},4);var me=p(function(e,t,r){return te(function(e){return!e},function(e){return!e})(j,e,t,r)},3);function ge(e,n,t,i){var o=new Array(n.length);e(n,function(e,r,n){t(e,function(e,t){o[r]=!!t,n(e)})},function(e){if(e)return i(e);for(var t=[],r=0;r<n.length;r++)o[r]&&t.push(n[r]);i(null,t)})}function ve(e,t,o,r){var s=[];e(t,function(r,n,i){o(r,function(e,t){return e?i(e):(t&&s.push({index:n,value:r}),void i(e))})},function(e){return e?r(e):void r(null,s.sort(function(e,t){return e.index-t.index}).map(function(e){return e.value}))})}function be(e,t,r,n){return(m(t)?ge:ve)(e,t,g(r),n)}var we=p(function(e,t,r){return be(A,e,t,r)},3);var xe=p(function(e,t,r,n){return be(k(t),e,r,n)},4);var _e=p(function(e,t,r){return be(j,e,t,r)},3);var ke=p(function(e,t){var r=x(t),n=g(fe(e));return function e(t){if(t)return r(t);!1!==t&&n(e)}()},2);var Ee=p(function(e,t,r,a){var i=g(r);return Y(e,t,function(r,n){i(r,function(e,t){return e?n(e):n(e,{key:t,val:r})})},function(e,t){for(var r,n,i={},o=Object.prototype.hasOwnProperty,s=0;s<t.length;s++)t[s]&&(r=t[s].key,n=t[s].val,o.call(i,r)?i[r].push(n):i[r]=[n]);return a(e,i)})},4);function Se(e,t,r){return Ee(e,1/0,t,r)}function Oe(e,t,r){return Ee(e,1,t,r)}var Ae=oe("log");var Me=p(function(e,t,r,n){n=b(n);var i={},o=g(r);return k(t)(e,function(e,r,n){o(e,r,function(e,t){return e?n(e):(i[r]=t,void n(e))})},function(e){return n(e,i)})},4);function Pe(e,t,r){return Me(e,1/0,t,r)}function je(e,t,r){return Me(e,1,t,r)}function Te(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e){return e},u=Object.create(null),l=Object.create(null),n=g(e),t=c(function(e,t){var a=r.apply(void 0,_toConsumableArray3(e));a in u?y(function(){return t.apply(void 0,[null].concat(_toConsumableArray3(u[a])))}):a in l?l[a].push(t):(l[a]=[t],n.apply(void 0,_toConsumableArray3(e).concat([function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e||(u[a]=r);var i=l[a];delete l[a];for(var o=0,s=i.length;o<s;o++)i[o].apply(i,[e].concat(r))}])))});return t.memo=u,t.unmemoized=e,t}var Ce=s(i?ft.nextTick:n?dt:o),Ie=p(function(e,t,r){var s=m(t)?[]:{};e(t,function(e,i,o){g(e)(function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.length<2&&(r=_slicedToArray(r,1)[0]),s[i]=r,o(e)})},function(e){return r(e,s)})},3);function Ne(e,t){return Ie(A,e,t)}function Le(e,t,r){return Ie(k(t),e,r)}function Fe(e,t){var r=g(e);return U(function(e,t){r(e[0],t)},t,1)}var Re=function(){function e(){_classCallCheck2(this,e),this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}return _createClass2(e,[{key:"length",get:function(){return this.heap.length}},{key:"empty",value:function(){return this.heap=[],this}},{key:"percUp",value:function(e){for(var t;0<e&&qe(this.heap[e],this.heap[t=De(e)]);){var r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}},{key:"percDown",value:function(e){for(var t;(t=1+(e<<1))<this.heap.length&&(t+1<this.heap.length&&qe(this.heap[t+1],this.heap[t])&&(t+=1),!qe(this.heap[e],this.heap[t]));){var r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}},{key:"push",value:function(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}},{key:"unshift",value:function(e){return this.heap.push(e)}},{key:"shift",value:function(){var e=_slicedToArray(this.heap,1)[0];return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}},{key:"toArray",value:function(){return _toConsumableArray3(this)}},{key:Symbol.iterator,value:_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(t<this.heap.length)return e.next=4,this.heap[t].data;e.next=7;break;case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}},e,this)})},{key:"remove",value:function(e){for(var t=0,r=0;r<this.heap.length;r++)e(this.heap[r])||(this.heap[t]=this.heap[r],t++);this.heap.splice(t);for(var n=De(this.heap.length-1);0<=n;n--)this.percDown(n);return this}}]),e}();function De(e){return(e+1>>1)-1}function qe(e,t){return e.priority!==t.priority?e.priority<t.priority:e.pushCount<t.pushCount}function Be(e,t){var s=Fe(e,t),a=!1;return s._tasks=new Re,s.push=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};if("function"!=typeof r)throw new Error("task callback must be a function");if(s.started=!0,Array.isArray(e)||(e=[e]),0===e.length&&s.idle())return y(function(){return s.drain()});for(var n=0,i=e.length;n<i;n++){var o={data:e[n],priority:t,callback:r};s._tasks.push(o)}a||(a=!0,y(function(){a=!1,s.process()}))},delete s.unshift,s}var ze=p(function(e,t){if(t=b(t),!Array.isArray(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,n=e.length;r<n;r++)g(e[r])(t)},2);function $e(e,t,r,n){e=_toConsumableArray3(e).reverse();return V(e,t,r,n)}function Ge(e){var t=g(e);return c(function(e,o){return e.push(function(e){var t={};e&&(t.error=e);for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];0<n.length&&((e=n).length<=1&&(e=n[0]),t.value=e),o(null,t)}),t.apply(this,e)})}function Ue(t){var r,n=this;return Array.isArray(t)?r=t.map(Ge):(r={},Object.keys(t).forEach(function(e){r[e]=Ge.call(n,t[e])})),r}function We(e,t,r,n){var i=g(r);return be(e,t,function(e,r){i(e,function(e,t){r(e,!t)})},n)}var Je=p(function(e,t,r){return We(A,e,t,r)},3);var Ve=p(function(e,t,r,n){return We(k(t),e,r,n)},4);var Xe=p(function(e,t,r){return We(j,e,t,r)},3);function He(e){return function(){return e}}var Ye=5,Ke=0;function Qe(e,t,o){var s={times:Ye,intervalFunc:He(Ke)};if(arguments.length<3&&"function"==typeof e?(o=t||N(),t=e):(function(e,t){if("object"===_typeof3(t))e.times=+t.times||Ye,e.intervalFunc="function"==typeof t.interval?t.interval:He(+t.interval||Ke),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||Ye}}(s,e),o=o||N()),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var r=g(t),a=1;return function i(){r(function(e){if(!1!==e)if(e&&a++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(e)))setTimeout(i,s.intervalFunc(a-1));else{for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o.apply(void 0,[e].concat(r))}})}(),o[I]}function Ze(n,e){e||(e=n,n=null);var i=n&&n.arity||e.length;h(e)&&(i+=1);var o=g(e);return c(function(t,e){function r(e){o.apply(void 0,_toConsumableArray3(t).concat([e]))}return(t.length<i-1||null==e)&&(t.push(e),e=N()),n?Qe(n,r,e):Qe(r,e),e[I]})}function et(e,t){return Ie(j,e,t)}var tt=p(function(e,t,r){return te(Boolean,function(e){return e})(A,e,t,r)},3);var rt=p(function(e,t,r,n){return te(Boolean,function(e){return e})(k(t),e,r,n)},4);var nt=p(function(e,t,r){return te(Boolean,function(e){return e})(j,e,t,r)},3);var it=p(function(e,t,r){var i=g(t);return M(e,function(r,n){i(r,function(e,t){return e?n(e):void n(e,{value:r,criteria:t})})},function(e,t){return e?r(e):void r(null,t.sort(n).map(function(e){return e.value}))});function n(e,t){e=e.criteria,t=t.criteria;return e<t?-1:t<e?1:0}},3);function ot(i,o,s){var a=g(i);return c(function(e,t){var r,n=!1;e.push(function(){n||(t.apply(void 0,arguments),clearTimeout(r))}),r=setTimeout(function(){var e=i.name||"anonymous";(e=new Error('Callback function "'+e+'" timed out.')).code="ETIMEDOUT",s&&(e.info=s),n=!0,t(e)},o),a.apply(void 0,_toConsumableArray3(e))})}function st(e,t,r,n){r=g(r);return Y(function(e){for(var t=Array(e);e--;)t[e]=e;return t}(e),t,r,n)}function at(e,t,r){return st(e,1/0,t,r)}function ut(e,t,r){return st(e,1,t,r)}function lt(e,n,t,r){arguments.length<=3&&"function"==typeof n&&(r=t,t=n,n=Array.isArray(e)?[]:{}),r=b(r||N());var i=g(t);return A(e,function(e,t,r){i(n,e,t,r)},function(e){return r(e,n)}),r[I]}r=p(function(e,t){var o,s=null;return pe(e,function(e,i){g(e)(function(e){if(!1===e)return i(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o=r.length<2?r[0]:r,i((s=e)?null:{})})},function(){return t(s,o)})});function ct(e){return function(){return(e.unmemoized||e).apply(void 0,arguments)}}var ht=p(function(e,t,i){i=x(i);var r=g(t),o=g(e),s=[];function n(e){if(e)return i(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];s=r,!1!==e&&o(a)}function a(e,t){return e?i(e):!1!==e?t?void r(n):i.apply(void 0,[null].concat(_toConsumableArray3(s))):void 0}return o(a)},3);function pt(e,t,r){var n=g(e);return ht(function(r){return n(function(e,t){return r(e,!t)})},t,r)}i=p(function(i,o){if(o=b(o),!Array.isArray(i))return o(new Error("First argument to waterfall must be an array of functions"));if(!i.length)return o();var s=0;function a(e){g(i[s++]).apply(void 0,_toConsumableArray3(e).concat([x(t)]))}function t(e){if(!1!==e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e||s===i.length)return o.apply(void 0,[e].concat(r));a(r)}}a([])}),n={apply:t,applyEach:P,applyEachSeries:C,asyncify:a,auto:L,autoInject:z,cargo:W,cargoQueue:J,compose:H,concat:Q,concatLimit:K,concatSeries:Z,constant:ee,detect:re,detectLimit:ne,detectSeries:ie,dir:se,doUntil:ue,doWhilst:ae,each:ce,eachLimit:he,eachOf:A,eachOfLimit:E,eachOfSeries:j,eachSeries:pe,ensureAsync:fe,every:de,everyLimit:ye,everySeries:me,filter:we,filterLimit:xe,filterSeries:_e,forever:ke,groupBy:Se,groupByLimit:Ee,groupBySeries:Oe,log:Ae,map:M,mapLimit:Y,mapSeries:T,mapValues:Pe,mapValuesLimit:Me,mapValuesSeries:je,memoize:Te,nextTick:Ce,parallel:Ne,parallelLimit:Le,priorityQueue:Be,queue:Fe,race:ze,reduce:V,reduceRight:$e,reflect:Ge,reflectAll:Ue,reject:Je,rejectLimit:Ve,rejectSeries:Xe,retry:Qe,retryable:Ze,seq:X,series:et,setImmediate:y,some:tt,someLimit:rt,someSeries:nt,sortBy:it,timeout:ot,times:at,timesLimit:st,timesSeries:ut,transform:lt,tryEach:r,unmemoize:ct,until:pt,waterfall:i,whilst:ht,all:de,allLimit:ye,allSeries:me,any:tt,anyLimit:rt,anySeries:nt,find:re,findLimit:ne,findSeries:ie,flatMap:Q,flatMapLimit:K,flatMapSeries:Z,forEach:ce,forEachSeries:pe,forEachLimit:he,forEachOf:A,forEachOfSeries:j,forEachOfLimit:E,inject:V,foldl:V,foldr:$e,select:we,selectLimit:xe,selectSeries:_e,wrapSync:a,during:ht,doDuring:ae};e.default=n,e.apply=t,e.applyEach=P,e.applyEachSeries=C,e.asyncify=a,e.auto=L,e.autoInject=z,e.cargo=W,e.cargoQueue=J,e.compose=H,e.concat=Q,e.concatLimit=K,e.concatSeries=Z,e.constant=ee,e.detect=re,e.detectLimit=ne,e.detectSeries=ie,e.dir=se,e.doUntil=ue,e.doWhilst=ae,e.each=ce,e.eachLimit=he,e.eachOf=A,e.eachOfLimit=E,e.eachOfSeries=j,e.eachSeries=pe,e.ensureAsync=fe,e.every=de,e.everyLimit=ye,e.everySeries=me,e.filter=we,e.filterLimit=xe,e.filterSeries=_e,e.forever=ke,e.groupBy=Se,e.groupByLimit=Ee,e.groupBySeries=Oe,e.log=Ae,e.map=M,e.mapLimit=Y,e.mapSeries=T,e.mapValues=Pe,e.mapValuesLimit=Me,e.mapValuesSeries=je,e.memoize=Te,e.nextTick=Ce,e.parallel=Ne,e.parallelLimit=Le,e.priorityQueue=Be,e.queue=Fe,e.race=ze,e.reduce=V,e.reduceRight=$e,e.reflect=Ge,e.reflectAll=Ue,e.reject=Je,e.rejectLimit=Ve,e.rejectSeries=Xe,e.retry=Qe,e.retryable=Ze,e.seq=X,e.series=et,e.setImmediate=y,e.some=tt,e.someLimit=rt,e.someSeries=nt,e.sortBy=it,e.timeout=ot,e.times=at,e.timesLimit=st,e.timesSeries=ut,e.transform=lt,e.tryEach=r,e.unmemoize=ct,e.until=pt,e.waterfall=i,e.whilst=ht,e.all=de,e.allLimit=ye,e.allSeries=me,e.any=tt,e.anyLimit=rt,e.anySeries=nt,e.find=re,e.findLimit=ne,e.findSeries=ie,e.flatMap=Q,e.flatMapLimit=K,e.flatMapSeries=Z,e.forEach=ce,e.forEachSeries=pe,e.forEachLimit=he,e.forEachOf=A,e.forEachOfSeries=j,e.forEachOfLimit=E,e.inject=V,e.foldl=V,e.foldr=$e,e.select=we,e.selectLimit=xe,e.selectSeries=_e,e.wrapSync=a,e.during=ht,e.doDuring=ae,Object.defineProperty(e,"__esModule",{value:!0})},"object"===_typeof3(n)&&void 0!==r?t(n):"function"==typeof define&&define.amd?define(["exports"],t):t(e.async={})}).call(this)}).call(this,e("_process"),e("timers").setImmediate)},{_process:262,timers:266}],231:[function(e,t,r){var l=e("strsearch2regexp"),c=e("./filterJoin");function n(e){return'"'+e.replace(/"/g,'\\"')+'"'}function h(e){if(Array.isArray(e))return e.map(h).join("");if(e.or)return{or:e.or.map(h)};var t=e.keyRegexp?"~":"";switch(e.op){case"has_key":return t?"[~"+n(e.key)+'~"."]':"["+t+n(e.key)+"]";case"not_exists":return"[!"+n(e.key)+"]";case"=":case"!=":case"~":case"!~":return"["+t+n(e.key)+e.op+n(e.value)+"]";case"~i":case"!~i":return"["+t+n(e.key)+e.op.substr(0,e.op.length-1)+n(e.value)+",i]";case"has":return"["+t+n(e.key)+"~"+n("^(.*;|)"+e.value+"(|;.*)$")+"]";case"strsearch":return"["+t+n(e.key)+"~"+n(l(e.value))+",i]";default:throw new Error("unknown operator")}}function i(t,e){if(Array.isArray(e))return e.every(function(e){return i(t,e)});if(e.type)return t.type===e.type;if(e.or)return e.or.some(function(e){return i(t,e)});if(e.and)return e.and.every(function(e){return i(t,e)});if(e.keyRegexp){var r,n;for(n in e.value&&(r=new RegExp(e.value,e.op.match(/i$/)?"i":"")),t.tags)if(n.match(e.key)){if(!r)return!0;if(t.tags[n].match(r))return!0}return!1}switch(e.op){case"has_key":return t.tags&&e.key in t.tags;case"not_exists":return t.tags&&!(e.key in t.tags);case"=":return t.tags&&e.key in t.tags&&t.tags[e.key]===e.value;case"!=":return t.tags&&(!(e.key in t.tags)||t.tags[e.key]!==e.value);case"~":return t.tags&&e.key in t.tags&&t.tags[e.key].match(e.value);case"!~":return t.tags&&(!(e.key in t.tags)||!t.tags[e.key].match(e.value));case"~i":return t.tags&&e.key in t.tags&&t.tags[e.key].match(new RegExp(e.value,"i"));case"!~i":return t.tags&&(!(e.key in t.tags)||!t.tags[e.key].match(new RegExp(e.value,"i")));case"has":return t.tags&&e.key in t.tags&&-1!==t.tags[e.key].split(/;/).indexOf(e.value);case"strsearch":return t.tags&&e.key in t.tags&&t.tags[e.key].match(new RegExp(l(e.value),"i"));default:return console.log("match: unknown operator in filter",e),!1}}function m(e){var t="",r=e[0];for(e=e.slice(1);e.length;){var n=e.match("^[^\\\\"+r+"]+");if(n)t+=n[0],e=e.slice(n[0].length);else{if("\\"!==e[0]){if(e[0]===r)return[t,e=e.slice(1)];throw new Error("Can't parse string from query: "+e)}t+=e[1],e=e.slice(2)}}}function o(e){return"string"==typeof e?function e(t){for(var r,n,i=[],o=0,s=!1,a=null;t.length;)if(0===o){if((n=t.match(/^\s*(node|way|relation|rel|nwr|\()/))&&"("===n[1]){t=t.slice(n[0].length);var u=[];do{var l=_slicedToArray(e(t),2),c=l[0]}while(t=l[1],u.push(c),!t.match(/^\s*\)/));return[{or:u},t]}if(!n)throw new Error("Can't parse query, expected type of object (e.g. 'node'): "+t);"rel"===n[1]?i.push({type:"relation"}):"nwr"===n[1]||i.push({type:n[1]}),o=10,t=t.slice(n[0].length)}else if(10===o){var h=t.match(/^\s*(\[|;)/);if(!h||"["!==h[1]){if(h&&";"===h[1])return[i,t=t.slice(h[0].length)];if(!h&&t.match(/^\s*$/))return[i,""];throw new Error("Can't parse query, expected '[' or ';': "+t)}t=t.slice(h[0].length),o=11}else if(11===o)if((n=t.match(/^(\s*)(([~!])\s*)?([a-zA-Z0-9_]+|"|')/))&&n[2]&&("~"===n[3]?s=!0:"!"===n[3]&&(a=!0)),!n||'"'!==n[4]&&"'"!==n[4]){if(!n)throw new Error("Can't parse query, expected key: "+t);f=n[4],t=t.slice(n[0].length),o=12}else{var p=m(t=t.slice(n[1].length+(n[2]||"").length)),f=p[0];t=p[1],o=12}else if(12===o)if((n=t.match(/^\s*(=|!=|~|!~|\^|]|%)/))&&"]"===n[1])p={key:f,op:"has_key"},s&&(p.keyRegexp=!0),a&&(p.op="not_exists"),i.push(p),t=t.slice(n[0].length),o=10;else{if(!n)throw new Error("Can't parse query, expected operator or ']': "+t);if(a)throw new Error("Can't parse query, expected ']': "+t);r="^"===n[1]?"has":"%"===n[1]?"strsearch":n[1],o=13,t=t.slice(n[0].length)}else if(13===o)if(!(n=t.match(/^(\s*)([a-zA-Z0-9_]+|"|')/))||'"'!==n[2]&&"'"!==n[2]){if(!n)throw new Error("Can't parse query, expected value: "+t);y=n[2],t=t.slice(n[0].length),o=14}else{var d=m(t=t.slice(n[1].length)),y=d[0];t=d[1],o=14}else if(14===o){if(!(n=t.match(/^\s*(,i)?\]/)))throw new Error("Can't parse query, expected ']': "+t);if(",i"===n[1]){if("~"!==r&&"!~"!==r)throw new Error("Can't parse query, expected ']': "+t);r+="i"}d={key:f,op:r,value:y},s&&(d.keyRegexp=!0),i.push(d),o=10,t=t.slice(n[0].length)}return[i,t]}(e)[0]:(e.and&&(e.and=e.and.map(o)),e.or&&(e.or=e.or.map(o)),e)}e=function(){"use strict";function t(e){_classCallCheck2(this,t),this.def=o(e)}return _createClass2(t,[{key:"uniqId",value:function(){return this._uniqId=(this._uniqId||0)+1,this._uniqId}},{key:"match",value:function(t,e){var r=this;return(e=e||this.def).or?e.or.some(function(e){return r.match(t,e)}):e.and?e.and.every(i.bind(this,t)):e.filter(i.bind(this,t)).length===e.length}},{key:"toString",value:function(e){return this.toQl({},e)}},{key:"toQl",value:function(e,t){var r=this,n=0<arguments.length&&void 0!==e?e:{},i=(i=1<arguments.length?t:void 0)||this.def;if(n.inputSet||(n.inputSet=""),n.outputSet||(n.outputSet=""),i.or)return"("+i.or.map(function(e){var t={inputSet:n.inputSet};return r.toQl(t,e)}).join("")+")"+(n.outputSet?"->"+n.outputSet:"")+";";if(i.and){var o=i.and[0],e=i.and[i.and.length-1],t=i.and.concat().slice(1,i.and.length-1),s=".x"+this.uniqId();return this.toQl({inputSet:n.inputSet,outputSet:s},o)+t.map(function(e){return r.toQl({inputSet:s,outputSet:s},e)}).join("")+this.toQl({inputSet:s,outputSet:n.outputSet},e)}var a,u=i.filter(function(e){return e.type});switch(u.length){case 0:a=["nwr"];break;case 1:a=[u[0].type];break;default:throw new Error("Filter: only one type query allowed!")}var l=c(i.filter(function(e){return!e.type}).map(h)),i=1<l.length?"("+l.map(function(t){return a.map(function(e){return e+n.inputSet+t}).join(";")}).join(";")+";)":1===a.length?a[0]+n.inputSet+l[0]:"("+a.map(function(e){return e+n.inputSet+l[0]}).join(";")+";)";return i+(n.outputSet?"->"+n.outputSet:"")+";"}},{key:"toLokijs",value:function(e,t){var n=this,i=0<arguments.length&&void 0!==e?e:{},t=1<arguments.length?t:void 0;if((t=t||this.def).or){var r=!1,o={$or:t.or.map(function(e){e=n.toLokijs(i,e);return e.needMatch&&(r=!0),delete e.needMatch,e})};return 0<o.$or.filter(function(e){return 0===Object.keys(e).length}).length&&delete o.$or,r&&(o.needMatch=!0),o}if(t.and){var s=!1,o={$and:t.and.map(function(e){e=n.toLokijs(i,e);return e.needMatch&&(s=!0),delete e.needMatch,e})};return s&&(o.needMatch=!0),o}var a={},u=[];return Array.isArray(t)||(t=[t]),t.forEach(function(e){var t,r;e.keyRegexp?(t="needMatch",r=!0):"="===e.op?(t="tags."+e.key,r={$eq:e.value}):"!="===e.op?(t="tags."+e.key,r={$ne:e.value}):"has_key"===e.op?(t="tags."+e.key,r={$exists:!0}):"not_exists"===e.op?(t="tags."+e.key,r={$exists:!1}):"has"===e.op?(t="tags."+e.key,r={$regex:"^(.*;|)"+e.value+"(|;.*)$"}):"~"===e.op||"~i"===e.op?(t="tags."+e.key,r={$regex:new RegExp(e.value,"~i"===e.op?"i":"")}):"!~"===e.op||"!~i"===e.op?(t="tags."+e.key,r={$not:{$regex:new RegExp(e.value,"!~i"===e.op?"i":"")}}):"strsearch"===e.op?(t="tags."+e.key,r={$regex:new RegExp(l(e.value),"i")}):e.type?(t="type",r={$eq:e.type}):e.or?u.push(e.or.map(function(e){e=n.toLokijs(i,e);return e.needMatch&&(a.needMatch=!0,delete e.needMatch),e})):console.log("unknown filter",e),t&&r&&("needMatch"===t?a.needMatch=!0:t in a?("$and"in a[t]||(a[t]={$and:[a[t]]}),a[t].$and.push(r)):a[t]=r)}),1===(u=u.filter(function(e){return Object.keys(e).length})).length?a.$or=u[0]:1<u.length&&(a.$and=u.map(function(e){return{$or:e}})),a}}]),t}();t.exports=e},{"./filterJoin":250,strsearch2regexp:265}],232:[function(w,S,e){(function(E){(function(){var e,t=w("event-emitter"),a=w("async"),l=w("weight-sort"),u=w("boundingbox"),n=w("lokijs"),c=w("./httpLoad"),h=w("./removeNullEntries"),x=w("./OverpassObject"),s=w("./OverpassNode"),p=w("./OverpassWay"),f=w("./OverpassRelation"),i=w("./RequestGet"),d=w("./RequestBBox"),y=w("./RequestMulti"),r=w("./defines"),m=w("./loadOsmFile"),_=w("./copyOsm3sMeta"),k=w("./timestamp"),o=w("./Filter"),g=w("./isGeoJSON"),v=w("./boundsIsFullWorld"),b=function(){"use strict";function w(e,t){for(var r in _classCallCheck2(this,w),this.url=e,this.options={effortPerRequest:1e3,effortNode:1,effortWay:4,effortRelation:64,timeGap:10,timeGap429:500,timeGap429Exp:3,loadChunkSize:1e3},t)this.options[r]=t[r];e=new n;this.db=e.addCollection("osm",{unique:["id"]}),this.clearCache(),this.requests=[],this.requestIsActive=!1,this.errorCount=0,this.pendingNotifyMemberUpdate={},this.pendingUpdateEmit={},this.url.match(/\.(json|osm\.bz2|osm)$/)?(this.localOnly=!0,this.ready=!1,this._loadFile()):(this.remote=!0,this.ready=!0)}return _createClass2(w,[{key:"clearCache",value:function(){this.cacheElements={},this.cacheElementsMemberOf={},this.cacheBBoxQueries={},this.cacheTimestamp=k(),this.db.clear(),this.hasStretchLon180=!1}},{key:"_loadFile",value:function(){var o,s=this;m(this.url,function(e,t){if(e)return console.log("Error loading file",e),s.emit("error",e);o=_(t);for(var r=[],n=0;n<t.elements.length;n+=s.options.loadChunkSize)r.push(t.elements.slice(n,n+s.options.loadChunkSize));var i=[];a.eachLimit(r,1,function(e,t){e.forEach(function(e){e=s.createOrUpdateOSMObject(e,{osm3sMeta:o,properties:w.TAGS|w.META|w.MEMBERS});i.push(e)}),E.setTimeout(t,0)},function(e){return s.pendingNotifies(),i.forEach(function(e){e.properties|=w.ALL,o.bounds?o.bounds.extend(e.bounds):o.bounds=new u(e.bounds)}),e?(console.log("Error loading file",e),s.emit("error",e)):(s.emit("load",o),s.ready=!0,void s._overpassProcess())})})}},{key:"get",value:function(e,t,r,n){n=new i(this,{ids:e,options:t,featureCallback:r,finalCallback:n});return this.requests.push(n),this._next(),n}},{key:"getCached",value:function(e,t){if(void 0===t&&(t={}),void 0===t.properties&&(t.properties=r.DEFAULT),!(e in this.cacheElements))return!1;e=this.cacheElements[e];return e.missingObject?null:(t.properties&e.properties)===t.properties&&e}},{key:"_overpassProcess",value:function(){var t,r=this;if(this.ready&&(this.requests.forEach(function(e){e&&e.timestampPreprocess<r.cacheTimestamp&&(e.preprocess(),e.timestampPreprocess=r.cacheTimestamp,(e.mayFinish()||r.localOnly)&&e.finish())}),this.requests=h(this.requests),!this.requestIsActive&&this.ready&&this.requests.length)){this.requests=l(this.requests,"priority"),this.requestIsActive=!0;for(var e,n,i={bbox:null,todo:{},requests:[],subRequests:[],query:"",minPriority:this.requests[0].priority,minEffort:0,maxEffort:0},o=0;o<this.requests.length&&!((t=this.requests[o]).priority>i.minPriority&&(null===i.maxEffort||i.maxEffort>this.options.effortPerRequest));o++)t.willInclude(i)&&(e=(n=t.minMaxEffort()).minEffort,n=n.maxEffort,0<i.minEffort&&i.minEffort+e>this.options.effortPerRequest||(i.minEffort+=e,null===n?i.maxEffort=null:null!==i.maxEffort&&(i.maxEffort+=n),i.requests.push(t)));var s=this.options.effortPerRequest;for(o=0;o<i.requests.length;o++){t=i.requests[o];var a=i.requests.slice(o).filter(function(e){return e.priority===t.priority});i.maxEffort=Math.ceil(s/a.length);a=t.compileQuery(i);if(0!==a.parts.length){if(i.subRequests.push(a),""!==i.query&&(i.query+="\nout count;\n"),s-=a.effort,i.query+=a.query,s<=0)break}else console.log("subRequest has no parts! Why was willInclude true?",a)}if(""===i.query)return this._next();i.queryOptions="[out:json]",i.bbox&&!v(i.bbox)&&(i.queryOptions+="[bbox:"+i.bbox.toLatLonString()+"]");var u=i.queryOptions+";\n"+i.query;setTimeout(function(){c(this.url,null,u,this._handleResult.bind(this,i)),this.emit("start",{},i)}.bind(this),this.options.timeGap)}}},{key:"_handleResult",value:function(e,t,r){var n=this;this.requestIsActive=!1,null===t&&r.remark&&(t=r.remark);var i,o={};if(null!==t)return this.errorCount++,o.status=t.status,o.errorCount=this.errorCount,void(this.errorCount<=3?429===t.status?(this.requestIsActive=!0,i=Math.pow(this.options.timeGap429Exp,this.errorCount-1)*this.options.timeGap429,o.retry=!0,o.retryTimeout=i,this.emit("reject",o,e),E.setTimeout(function(){n.requestIsActive=!1,n._overpassProcess()},i-this.options.timeGap)):(this.emit("error",t,e),this._overpassProcess()):(429===t.status&&(o.retry=!1,this.emit("reject",o,e)),this.emit("error",o,e),e.subRequests.forEach(function(e){e.request.finish(t)})));this.errorCount=0;var s=_(r);this.emit("load",s,e);var a=0,u=0,l=e.subRequests[0],c=l.request,h=l.parts[0];"count"in h||(h.count=0);for(var p,f,d,y=0;y<r.elements.length;y++){var m=r.elements[y];if("count"in(p=m)||"type"in p&&"count"===p.type)++u>=l.parts.length?(c.finishSubRequest(l),c.mayFinish()&&!c.finished&&c.finish(),a++,u=0,c=(l=e.subRequests[a]).request,"count"in(h=l.parts[0])||(h.count=0)):h=l.parts[u];else{h.osm3sMeta=s;var g=this.createOrUpdateOSMObject(m,h);delete e.todo[g.id];var v=this.cacheElements[g.id].memberIds();if(v)for(var b=0;b<v.length;b++)v[b]in this.cacheElementsMemberOf?this.cacheElementsMemberOf[v[b]].push(this.cacheElements[g.id]):this.cacheElementsMemberOf[v[b]]=[this.cacheElements[g.id]];h.count++,h.receiveObject&&h.receiveObject(g),c.aborted||c.finished||!h.featureCallback||h.checkFeatureCallback&&!h.checkFeatureCallback(g,h)||h.featureCallback(t,g)}}for(f in a!==e.subRequests.length-1&&u!==e.subRequests[a].parts.length-1&&console.log("too many parts!!!!"),e.todo)f in this.cacheElements?((d=this.cacheElements[f]).missingObject=!0,this.db.update(d.dbInsert())):((d=new x).id=f,d.type={n:"node",w:"way",r:"relation"}[f.substr(0,1)],d.osm_id=f.substr(1),d.properties=w.ALL,d.missingObject=!0,this.cacheElements[f]=d,this.db.insert(d.dbInsert()));this.cacheTimestamp=k(),this.pendingNotifies(),c.finishSubRequest(l),this._next()}},{key:"BBoxQuery",value:function(e,t,r,n,i){var o,s,a=new u(t);return g(t)||(t=a),i=a.minlon>a.maxlon?((o=new u(a)).maxlon=180,(s=new u(a)).minlon=-180,new y(this,{featureCallback:n,finalCallback:i},[new d(this,{query:e,bbox:o,bounds:t,options:r,doneFeatures:{}}),new d(this,{query:e,bbox:s,bounds:t,options:r,doneFeatures:{}})])):new d(this,{query:e,bbox:a,bounds:t,options:r,doneFeatures:{},featureCallback:n,finalCallback:i}),this.requests.push(i),this._next(),i}},{key:"clearBBoxQuery",value:function(e){e=new o(e).toString();delete this.cacheBBoxQueries[e]}},{key:"_abortRequest",value:function(e){e=this.requests.indexOf(e);-1!==e&&(this.requests[e]=null)}},{key:"_finishRequest",value:function(e){this.requests[this.requests.indexOf(e)]=null}},{key:"_next",value:function(){a.setImmediate(function(){this._overpassProcess()}.bind(this))}},{key:"abortAllRequests",value:function(){for(var e=0;e<this.requests.length;e++)null!==this.requests[e]&&this.requests[e].abort();this.requests=[]}},{key:"removeFromCache",value:function(r){var n=this;"string"==typeof r&&(r=[r]);for(var i=0;i<r.length;i++)r[i]in this.cacheElements&&function(){var t=n.cacheElements[r[i]];t.members&&t.members.forEach(function(e){e=n.cacheElements[e.id];e.memberOf=e.memberOf.filter(function(e){return e.id!==t.id})});var e=n.cacheElements[r[i]].dbData;delete n.cacheElements[r[i]],n.db.remove(e)}()}},{key:"notifyMemberUpdates",value:function(){var e,t=this.pendingNotifyMemberUpdate;for(e in this.pendingNotifyMemberUpdate={},t){var r=this.cacheElements[e];r.notifyMemberUpdate(t[e]),this.pendingUpdateEmit[r.id]=r}}},{key:"pendingNotifies",value:function(){var t=this;this.notifyMemberUpdates();var e=Object.values(this.pendingUpdateEmit);this.pendingUpdateEmit={},e.forEach(function(e){e.emit("update",e),t.db.update(e.dbInsert())})}},{key:"createOrUpdateOSMObject",value:function(e,t){var r=this,n=e.type.substr(0,1)+e.id,i=null,o=!0;if(n in this.cacheElements&&!this.cacheElements[n]&&console.log("why can this be null?",n),n in this.cacheElements&&this.cacheElements[n]){if(o=!1,~(i=this.cacheElements[n]).properties&0===t.properties)return i}else i=new("relation"===e.type?f:"way"===e.type?p:"node"===e.type?s:x)(n);return i.overpass=this,i.updateData(e,t),i.memberOf.forEach(function(e){e.id in r.pendingNotifyMemberUpdate?r.pendingNotifyMemberUpdate[e.id].push(i):r.pendingNotifyMemberUpdate[e.id]=[i]}),this.pendingUpdateEmit[i.id]=i,o?this.db.insert(i.dbInsert()):this.db.update(i.dbInsert()),this.cacheElements[n]=i}},{key:"regexpEscape",value:function(e){return e.replace("\\","\\\\").replace(".","\\.").replace("|","\\|").replace("[","\\[").replace("]","\\]").replace("(","\\(").replace(")","\\)").replace("{","\\{").replace("}","\\}").replace("?","\\?").replace("+","\\+").replace("*","\\*").replace("^","\\^").replace("$","\\$")}}]),w}();for(e in r)b[e]=r[e];t(b.prototype),b.Filter=o,S.exports=b}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Filter":231,"./OverpassNode":233,"./OverpassObject":234,"./OverpassRelation":235,"./OverpassWay":236,"./RequestBBox":238,"./RequestGet":240,"./RequestMulti":242,"./boundsIsFullWorld":245,"./copyOsm3sMeta":248,"./defines":249,"./httpLoad":252,"./isGeoJSON":253,"./loadOsmFile":255,"./removeNullEntries":257,"./timestamp":258,async:230,boundingbox:74,"event-emitter":94,lokijs:224,"weight-sort":273}],233:[function(e,t,r){var n=e("./OverpassObject"),o=e("boundingbox"),s=e("./defines"),a={booleanIntersects:e("@turf/boolean-intersects").default},e=function(){"use strict";_inherits(i,n);var e=_createSuper(i);function i(){return _classCallCheck2(this,i),e.apply(this,arguments)}return _createClass2(i,[{key:"GeoJSON",value:function(){var e={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.geometry&&(e.geometry={type:"Point",coordinates:[this.geometry.lon,this.geometry.lat]}),e}},{key:"exportOSMXML",value:function(e,t,r){var n=this;_get(_getPrototypeOf(i.prototype),"exportOSMXML",this).call(this,e,t,function(e,t){return e?r(e):t?(t.setAttribute("lat",n.geometry.lat),t.setAttribute("lon",n.geometry.lon),void r(null,t)):r(null)})}},{key:"exportOSMJSON",value:function(e,t,r){var n=this;_get(_getPrototypeOf(i.prototype),"exportOSMJSON",this).call(this,e,t,function(e,t){return e?r(e):t?(t.lat=n.geometry.lat,t.lon=n.geometry.lon,void r(null,t)):r(null)})}},{key:"updateData",value:function(e,t){_get(_getPrototypeOf(i.prototype),"updateData",this).call(this,e,t),e.lat&&(this.geometry={lat:e.lat,lon:e.lon},this.bounds=new o(e),this.center=this.bounds.getCenter(),this.properties=this.properties|s.GEOM|s.BBOX|s.CENTER),this.properties|=s.MEMBERS}},{key:"leafletFeature",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!this.geometry)return null;"shiftWorld"in t||(t.shiftWorld=[0,0]);var r={lat:this.geometry.lat,lon:this.geometry.lon+t.shiftWorld[this.geometry.lon<0?0:1]};switch("nodeFeature"in t?t.nodeFeature:null){case"Marker":return L.marker(r,t);case"Circle":return L.circle(r,t.radius,t);case"CircleMarker":default:return L.circleMarker(r,t)}}},{key:"intersects",value:function(e){return this.bounds?e.intersects?e.intersects(this.bounds)?2:0:a.booleanIntersects(this.GeoJSON(),e)?2:0:1}}]),i}();t.exports=e},{"./OverpassObject":234,"./defines":249,"@turf/boolean-intersects":19,boundingbox:74}],234:[function(e,t,r){var n=e("event-emitter"),i=e("boundingbox"),o=e("./defines"),s=e("./isGeoJSON"),a={booleanIntersects:e("@turf/boolean-intersects").default,difference:e("@turf/difference"),intersect:e("@turf/intersect").default},u=e("./booleanWithin"),e=function(){"use strict";function e(){_classCallCheck2(this,e),this.data={},this.properties=0,this.memberOf=[]}return _createClass2(e,[{key:"memberIds",value:function(){return[]}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassObject.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"notifyMemberOf",value:function(e,t,r){this.memberOf.push({id:e.id,role:t,sequence:r})}},{key:"updateData",value:function(e,t){for(var r in void 0===this.id&&(this.id=e.type.substr(0,1)+e.id,this.type=e.type,this.osm_id=e.id),this.osm3sMeta=t.osm3sMeta,e)this.data[r]=e[r];e.bounds?(this.bounds=new i(e.bounds),this.center=this.bounds.getCenter(),this.diagonalLength=this.bounds.diagonalLength()):e.center&&(this.bounds=new i(e.center),this.center=this.bounds.getCenter()),!t.bounds||!this.bounds||t.bounds.intersects(this.bounds)?this.properties=this.properties|t.properties:this.properties=this.properties|o.BBOX|o.CENTER,t.boundsNoMatch&&this.bounds&&(void 0===this.boundsPossibleMatch&&(this.boundsPossibleMatch=this.bounds.toGeoJSON()),this.boundsPossibleMatch=a.difference(this.boundsPossibleMatch,t.bounds.toGeoJSON())),this.geometry&&delete this.boundsPossibleMatch,t.properties&o.TAGS?void 0===e.tags?this.tags={}:this.tags=e.tags:e.tags&&(this.tags=e.tags,this.properties|=o.TAGS),this.errors=[],e.timestamp&&(this.meta={timestamp:e.timestamp,version:e.version,changeset:e.changeset,user:e.user,uid:e.uid},this.properties|=o.META)}},{key:"notifyMemberUpdate",value:function(){}},{key:"title",value:function(){return this.tags&&(this.tags.name||this.tags.operator||this.tags.ref)||this.id}},{key:"GeoJSON",value:function(){return{type:"Feature",id:this.type+"/"+this.osm_id,geometry:null,properties:this.GeoJSONProperties()}}},{key:"GeoJSONProperties",value:function(){var e,t={};if(t["@id"]=this.type+"/"+this.osm_id,this.tags)for(e in this.tags)t[e]=this.tags[e];if(this.meta)for(e in this.meta)t["@"+e]=this.meta[e];for(e in this.osm3sMeta)t["@osm3s:"+e]=this.osm3sMeta[e];return t}},{key:"exportGeoJSON",value:function(t,r){var n=this;this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META|o.GEOM},function(){},function(e){return e?r(e):void r(null,n.GeoJSON(t))})}},{key:"exportOSMXML",value:function(t,r,n){var i=this;return r._alreadyIncluded||(r._alreadyIncluded={}),this.id in r._alreadyIncluded?n(null):(r._alreadyIncluded[this.id]=!0,(this.properties&(o.TAGS|o.MEMBERS|o.META))!=(o.TAGS|o.MEMBERS|o.META)?this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META},function(){},function(e){return e?n(e):void i._exportOSMXML(t,r,n)}):void this._exportOSMXML(t,r,n))}},{key:"_exportOSMXML",value:function(e,t,r){var n=t.ownerDocument.createElement(this.type);if(n.setAttribute("id",this.osm_id),this.meta&&(n.setAttribute("version",this.meta.version),n.setAttribute("timestamp",this.meta.timestamp),n.setAttribute("changeset",this.meta.changeset),n.setAttribute("uid",this.meta.uid),n.setAttribute("user",this.meta.user)),this.tags)for(var i in this.tags){var o=t.ownerDocument.createElement("tag");o.setAttribute("k",i),o.setAttribute("v",this.tags[i]),n.appendChild(o)}t.appendChild(n),r(null,n)}},{key:"exportOSMJSON",value:function(t,r,n){var i=this;return this.id in r?n(null):(r[this.id]={},(this.properties&(o.TAGS|o.MEMBERS|o.META))!=(o.TAGS|o.MEMBERS|o.META)?this.overpass.get(this.id,{properties:o.TAGS|o.MEMBERS|o.META},function(){},function(e){return e?n(e):void i._exportOSMJSON(t,r,n)}):void this._exportOSMJSON(t,r,n))}},{key:"_exportOSMJSON",value:function(e,t,r){t=t[this.id];t.type=this.type,t.id=this.osm_id,this.meta&&(t.version=this.meta.version,t.timestamp=this.meta.timestamp,t.changeset=this.meta.changeset,t.uid=this.meta.uid,t.user=this.meta.user),this.tags&&Object.keys(this.tags).length&&(t.tags=this.tags),r(null,t)}},{key:"intersects",value:function(e){if(this.bounds)if(e.intersects){if(!e.intersects(this.bounds))return 0;if(this.bounds.within(e))return 2}else{var t=this.bounds.toGeoJSON();if(!a.booleanIntersects(t,e))return 0;if(u(t,e))return 2}if(this.boundsPossibleMatch){e=a.intersect(s(e)?e:e.toGeoJSON(),this.boundsPossibleMatch);return e&&"Polygon"===e.geometry.type?1:0}return 1}},{key:"leafletFeature",value:function(){return null}},{key:"dbInsert",value:function(){return this.dbData||(this.dbData={}),this.dbData.tags=this.tags,this.dbData.osmMeta=this.meta,this.dbData.id=this.id,this.dbData.type=this.type,this.bounds&&this.bounds.minlat&&(this.dbData.minlat=this.bounds.minlat,this.dbData.minlon=this.bounds.minlon,this.dbData.maxlat=this.bounds.maxlat,this.dbData.maxlon=this.bounds.maxlon,this.bounds.minlon>this.bounds.maxlon&&(this.dbData.stretchLon180=!0,this.overpass.hasStretchLon180=!0)),this.dbData}}]),e}();n(e.prototype),t.exports=e},{"./booleanWithin":244,"./defines":249,"./isGeoJSON":253,"@turf/boolean-intersects":19,"@turf/difference":38,"@turf/intersect":46,boundingbox:74,"event-emitter":94}],235:[function(e,t,r){var l=e("async"),n=e("boundingbox"),i=e("osmtogeojson"),o=e("./OverpassObject"),a=e("./defines"),s=e("./geojsonShiftWorld"),c={booleanIntersects:e("@turf/boolean-intersects").default},e=function(){"use strict";_inherits(u,o);var e=_createSuper(u);function u(){return _classCallCheck2(this,u),e.apply(this,arguments)}return _createClass2(u,[{key:"updateData",value:function(e,t){var i,o=this;_get(_getPrototypeOf(u.prototype),"updateData",this).call(this,e,t),e.bounds&&(this.bounds=new n(e.bounds),this.center=this.bounds.getCenter(),this.properties|=a.BBOX|a.CENTER),e.center&&(this.center=e.center,this.properties|=a.CENTER),e.members&&(this.members=[],this.properties|=a.MEMBERS,i=!!this.memberFeatures,this.memberFeatures=e.members.map(function(e,t){o.members.push(e),"way"!==e.type||"string"!=typeof e.ref||(n=e.ref.match(/^_fullGeom([0-9]+)$/))&&(e.ref=parseInt(n[1])),e.id=e.type.substr(0,1)+e.ref;var r=JSON.parse(JSON.stringify(e));r.id=r.ref,delete r.ref,delete r.role;var n=a.ID_ONLY;("node"===e.type&&"lat"in e||"way"===e.type&&"geometry"in e)&&(n|=a.GEOM);n=o.overpass.createOrUpdateOSMObject(r,{properties:n});return i||n.notifyMemberOf(o,e.role,t),n}),this.updateGeometry())}},{key:"updateGeometry",value:function(){var r,e,s=this;this.members&&(r=!0,e=[{type:"relation",id:this.osm_id,tags:this.tags,members:this.members.map(function(e){var t={ref:e.ref,type:e.type,role:e.role};if(!(e.id in s.overpass.cacheElements))return r=!1,t;e=s.overpass.cacheElements[e.id];return 0==(e.properties&a.GEOM)&&(r=!1),"node"===e.type?e.geometry&&(t.lat=e.geometry.lat,t.lon=e.geometry.lon):"way"===e.type&&(t.geometry=e.geometry),t})}],this.geometry=i({elements:e}),r&&(this.properties=this.properties|a.GEOM),this.members.forEach(function(e,t){var r,n,i,o;"way"!==e.type||(i=s.overpass.cacheElements[e.id]).members&&"way"===e.type&&(r=i.members[0].id,n=i.members[i.members.length-1].id,i=i.memberOf.filter(function(e){return e.sequence===t&&e.id===s.id})[0],0<t&&("way"===(o=s.overpass.cacheElements[s.members[t-1].id]).type&&o.members&&(r===o.members[0].id||r===o.members[o.members.length-1].id?e.connectedPrev="forward":n===o.members[0].id||n===o.members[o.members.length-1].id?e.connectedPrev="backward":e.connectedPrev="no")),t<s.members.length-1&&("way"===(o=s.overpass.cacheElements[s.members[t+1].id]).type&&o.members&&(r===o.members[0].id||r===o.members[o.members.length-1].id?e.connectedNext="backward":n===o.members[0].id||n===o.members[o.members.length-1].id?e.connectedNext="forward":e.connectedNext="no")),!e.connectedPrev||!e.connectedNext||e.connectedPrev===e.connectedNext?e.dir=e.connectedPrev||e.connectedNext||null:e.dir=null,i?("dir"in e&&(i.dir=e.dir),"connectedPrev"in e&&(i.connectedPrev=e.connectedPrev),"connectedNext"in e&&(i.connectedNext=e.connectedNext)):console.log("Warning: memberOf reference "+e.id+" -> "+s.id+" (#"+t+") does not exist."))}),this.properties&a.BBOX||(this.members.forEach(function(e){e=s.overpass.cacheElements[e.id];e.bounds&&(s.bounds?s.bounds.extend(e.bounds):s.bounds=new n(e.bounds)),s.bounds&&(s.center=s.bounds.getCenter())}),this.bounds&&r&&(this.properties=this.properties|a.BBOX|a.CENTER)))}},{key:"notifyMemberUpdate",value:function(e){_get(_getPrototypeOf(u.prototype),"notifyMemberUpdate",this).call(this,e),this.members&&this.updateGeometry()}},{key:"memberIds",value:function(){if(this._memberIds)return this._memberIds;if(void 0===this.data.members)return null;this._memberIds=[];for(var e=0;e<this.data.members.length;e++){var t=this.data.members[e];this._memberIds.push(t.type.substr(0,1)+t.ref)}return this._memberIds}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassRelation.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"leafletFeature",value:function(e){var r=this,n=0<arguments.length&&void 0!==e?e:{};if(!this.data.members)return null;if("shiftWorld"in n||(n.shiftWorld=[0,0]),!this.geometry){e=L.featureGroup();return e._updateCallbacks=[],e}var i=L.geoJSON(s(this.geometry,n.shiftWorld),{pointToLayer:function(e,t,r){var n;switch(e.nodeFeature){case"Marker":n=L.marker(r,e);break;case"Circle":n=L.circle(r,e.radius,e);break;case"CircleMarker":default:n=L.circleMarker(r,e)}return n}.bind(this,n)});return i.setStyle(n),this.memberFeatures.forEach(function(e,t){e.properties&a.GEOM||e.once("update",function(){i.clearLayers(),i.addData(r.geometry),i.setStyle(n)})}),i}},{key:"GeoJSON",value:function(){var e={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.members&&(1===this.geometry.features.length?e.geometry=this.geometry.features[0].geometry:e.geometry={type:"GeometryCollection",geometries:this.memberFeatures.map(function(e){return e.GeoJSON().geometry}).filter(function(e){return e}).filter(function(e){return"GeometryCollection"!==e.type||e.geometries.length})}),e}},{key:"exportOSMXML",value:function(o,s,t){var a=this;_get(_getPrototypeOf(u.prototype),"exportOSMXML",this).call(this,o,s,function(e,i){return e?t(e):i?void(a.members?l.each(a.members,function(e,t){var r=a.overpass.cacheElements[e.id],n=s.ownerDocument.createElement("member");n.setAttribute("ref",r.osm_id),n.setAttribute("type",r.type),n.setAttribute("role",e.role),i.appendChild(n),r.exportOSMXML(o,s,t)},function(e){t(e,i)}):t(null,i)):t(null)})}},{key:"exportOSMJSON",value:function(i,o,t){var s=this;_get(_getPrototypeOf(u.prototype),"exportOSMJSON",this).call(this,i,o,function(e,n){return e?t(e):n?void(s.members?(n.members=[],l.each(s.members,function(e,t){var r=s.overpass.cacheElements[e.id];n.members.push({ref:r.osm_id,type:r.type,role:e.role}),r.exportOSMJSON(i,o,t)},function(e){t(e,n)})):t(null,n)):t(null)})}},{key:"intersects",value:function(e){var t,r=_get(_getPrototypeOf(u.prototype),"intersects",this).call(this,e);if(0===r||2===r)return r;if(this.geometry){var n=this.geometry,r=e.toGeoJSON?e.toGeoJSON():e;if(this.bounds&&this.bounds.minlon>this.bounds.maxlon&&(n=s(n,[360,0]),r=s(r,[360,0])),c.booleanIntersects(n,r))return 2;for(t=0;t<this.data.members.length;t++)if("relation"===this.data.members[t].type)return 1;return this.properties&a.GEOM?0:1}if(this.members)for(t in this.members){var i=this.members[t].id,i=this.overpass.cacheElements[i];if(i&&2===i.intersects(e))return 2}return 1}}]),u}();t.exports=e},{"./OverpassObject":234,"./defines":249,"./geojsonShiftWorld":251,"@turf/boolean-intersects":19,async:230,boundingbox:74,osmtogeojson:228}],236:[function(e,t,r){var u=e("async"),n=e("boundingbox"),i=e("./OverpassObject"),o=e("./defines"),s={booleanIntersects:e("@turf/boolean-intersects").default},e=function(){"use strict";_inherits(a,i);var e=_createSuper(a);function a(){return _classCallCheck2(this,a),e.apply(this,arguments)}return _createClass2(a,[{key:"updateData",value:function(e,t){if(e.nodes&&(this.nodes=e.nodes),e.geometry&&(this.geometry=e.geometry,this.properties|=o.GEOM),_get(_getPrototypeOf(a.prototype),"updateData",this).call(this,e,t),void 0!==this.data.nodes){this.members=[],this.properties|=o.MEMBERS;for(var r=0;r<this.data.nodes.length;r++){this.members.push({id:"n"+this.data.nodes[r],ref:this.data.nodes[r],type:"node"});var n=o.ID_ONLY,i={id:this.data.nodes[r],type:"node"};e.geometry&&e.geometry[r]&&(n|=o.GEOM,i.lat=e.geometry[r].lat,i.lon=e.geometry[r].lon),this.overpass.createOrUpdateOSMObject(i,{properties:n}).notifyMemberOf(this,null,r)}}this.checkGeometry()}},{key:"notifyMemberUpdate",value:function(e){_get(_getPrototypeOf(a.prototype),"notifyMemberUpdate",this).call(this,e),this.checkGeometry()}},{key:"checkGeometry",value:function(){var t=this;if(this.members&&0==(this.properties&o.GEOM)){if(this.geometry=this.members.map(function(e){e=t.overpass.cacheElements[e.id];return e?e.geometry:null}).filter(function(e){return e}),0===this.geometry.length)return void delete this.geometry;this.geometry.length===this.members.length&&(this.properties=this.properties|o.GEOM)}this.geometry&&0==(this.properties&o.BBOX)&&(this.bounds=new n(this.geometry[0]),this.geometry.slice(1).forEach(function(e){return t.bounds.extend(e)})),this.bounds&&0==(this.properties&o.CENTER)&&(this.center=this.bounds.getCenter()),(this.properties&o.GEOM)===o.GEOM&&(this.properties=this.properties|o.BBOX|o.CENTER)}},{key:"memberIds",value:function(){if(this._memberIds)return this._memberIds;if(!this.nodes)return null;this._memberIds=[];for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];this._memberIds.push("n"+t)}return this._memberIds}},{key:"member_ids",value:function(){return console.log("called deprecated OverpassWay.member_ids() function - replace by memberIds()"),this.memberIds()}},{key:"GeoJSON",value:function(){var e,t,r={type:"Feature",id:this.type+"/"+this.osm_id,properties:this.GeoJSONProperties()};return this.geometry&&(e=this.geometry.filter(function(e){return e}).map(function(e){return[e.lon,e.lat]}),t=this.members&&this.members[0].id===this.members[this.members.length-1].id,r.geometry=t?{type:"Polygon",coordinates:[e]}:{type:"LineString",coordinates:e}),r}},{key:"exportOSMXML",value:function(i,o,t){var s=this;_get(_getPrototypeOf(a.prototype),"exportOSMXML",this).call(this,i,o,function(e,n){return e?t(e):n?void(s.members?u.each(s.members,function(e,t){var r=s.overpass.cacheElements[e.id],e=o.ownerDocument.createElement("nd");e.setAttribute("ref",r.osm_id),n.appendChild(e),r.exportOSMXML(i,o,t)},function(e){t(e,n)}):t(null,n)):t(null)})}},{key:"exportOSMJSON",value:function(n,i,t){var o=this;_get(_getPrototypeOf(a.prototype),"exportOSMJSON",this).call(this,n,i,function(e,r){return e?t(e):r?void(o.members?(r.nodes=[],u.each(o.members,function(e,t){e=o.overpass.cacheElements[e.id];r.nodes.push(e.osm_id),e.exportOSMJSON(n,i,t)},function(e){t(e,r)})):t(null,r)):t(null)})}},{key:"leafletFeature",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};if(!this.geometry)return null;"shiftWorld"in t||(t.shiftWorld=[0,0]);e=this.geometry.filter(function(e){return e}).map(function(e){return{lat:e.lat,lon:e.lon+t.shiftWorld[e.lon<0?0:1]}});return this.geometry[this.geometry.length-1]&&this.geometry[0]&&this.geometry[this.geometry.length-1].lat===this.geometry[0].lat&&this.geometry[this.geometry.length-1].lon===this.geometry[0].lon?L.polygon(e,t):L.polyline(e,t)}},{key:"intersects",value:function(e){var t,r=_get(_getPrototypeOf(a.prototype),"intersects",this).call(this,e);return 0===r||2===r?r:this.geometry?(t=e.toGeoJSON?s.booleanIntersects(this.GeoJSON(),e.toGeoJSON()):s.booleanIntersects(this.GeoJSON(),e),t?2:0):1}}]),a}();t.exports=e},{"./OverpassObject":234,"./defines":249,"@turf/boolean-intersects":19,async:230,boundingbox:74}],237:[function(e,t,r){var n=e("event-emitter"),i=e("./SortedCallbacks"),e=function(){"use strict";function n(e,t){for(var r in _classCallCheck2(this,n),this.overpass=e,t)this[r]=t[r];this.options||(this.options={}),this.priority="priority"in this.options?this.options.priority:0;e=new i(this.options,this.featureCallback,this.finalCallback);this.featureCallback=e.next.bind(e),this.finalCallback=e.final.bind(e),this.callCount=0,this.timestampPreprocess=0}return _createClass2(n,[{key:"abort",value:function(){this.aborted=!0,this.emit("abort"),this.overpass._abortRequest(this)}},{key:"finish",value:function(e){this.aborted||this.finalCallback(e),this.overpass._finishRequest(this),this.finished=!0,this.emit("finish",e)}},{key:"willInclude",value:function(){return!0}},{key:"minMaxEffort",value:function(){return{minEffort:0,maxEffort:0}}},{key:"compileQuery",value:function(e){e=this._compileQuery(e);return this.emit("subrequest-compile",e),this.callCount++,e}},{key:"receiveObject",value:function(){}},{key:"finishSubRequest",value:function(e){this.emit("subrequest-finish",e)}}]),n}();n(e.prototype),t.exports=e},{"./SortedCallbacks":243,"event-emitter":94}],238:[function(e,t,r){var o=e("./Request"),s=e("./overpassOutOptions"),a=e("./defines"),u=e("./knownArea"),l=e("./RequestBBoxMembers"),c=e("./Filter"),h=e("./boundsToLokiQuery"),p=e("./boundsIsFullWorld"),e=function(){"use strict";_inherits(i,o);var n=_createSuper(i);function i(e,t){var r;_classCallCheck2(this,i),(r=n.call(this,e,t)).type="BBoxQuery",void 0===r.options.properties&&(r.options.properties=a.DEFAULT),r.options.properties|=a.BBOX,r.options.minEffort=r.options.minEffort||256,r.query.match(/;\s*$/)||(r.query+=";"),void 0===r.options.filter||r.options.filter instanceof c||(r.options.filter=new c(r.options.filter));e=null;return r.options.filter&&(e=r.options.filter.toString()),"noCacheQuery"in r.options&&r.options.noCacheQuery||(r.filterQuery=new c(r.query),r.lokiQuery=r.filterQuery.toLokijs(),r.lokiQueryNeedMatch=!!r.lokiQuery.needMatch,delete r.lokiQuery.needMatch,r.options.filter&&(t=r.options.filter.toLokijs(),r.lokiQueryFilterNeedMatch=!!t.needMatch,delete t.needMatch,r.lokiQuery={$and:[r.lokiQuery,t]}),p(r.bounds)||(r.lokiQuery={$and:[r.lokiQuery,h(r.bbox,r.overpass)]})),r.loadFinish=!1,"members"in r.options&&l(_assertThisInitialized(r)),r.query in r.overpass.cacheBBoxQueries?(r.cache=r.overpass.cacheBBoxQueries[r.query],e&&("filter"in r.cache||(r.cache.filter={}),e in r.cache.filter||(r.cache.filter[e]=new u),r.cacheFilter=r.cache.filter[e])):(r.overpass.cacheBBoxQueries[r.query]={},r.cache=r.overpass.cacheBBoxQueries[r.query],r.cache.requested=new u,e&&(r.cache.filter={},r.cache.filter[e]=new u,r.cacheFilter=r.cache.filter[e])),r}return _createClass2(i,[{key:"preprocess",value:function(){var e=[];this.lokiQuery&&(e=this.overpass.db.find(this.lokiQuery));for(var t=0;t<e.length;t++){var r,n=e[t].id;n in this.overpass.cacheElements&&(r=this.overpass.cacheElements[n],n in this.doneFeatures||this.lokiQueryNeedMatch&&!this.filterQuery.match(r)||this.lokiQueryFilterNeedMatch&&!this.options.filter.match(r)||r.intersects(this.bounds)<2||(this.options.properties&r.properties)===this.options.properties&&(this.doneFeatures[n]=r,this.featureCallback(null,r)))}}},{key:"willInclude",value:function(e){if(this.loadFinish)return!1;if(e.bbox&&e.bbox.toLatLonString()!==this.bbox.toLatLonString())return!1;for(var t in e.bbox=this.bbox,e.requests){var r=e.requests[t];if(r instanceof i&&r.query===this.query)return!1}return!0}},{key:"minMaxEffort",value:function(){return this.loadFinish?{minEffort:0,maxEffort:0}:{minEffort:this.options.minEffort,maxEffort:null}}},{key:"_compileQuery",value:function(e){if(this.loadFinish||e.bbox&&e.bbox.toLatLonString()!==this.bbox.toLatLonString())return{query:"",request:this,parts:[],effort:0};var t,e=Math.max(e.maxEffort,this.options.minEffort),r="("+this.query+")->.result;\n",n="",i=0;for(t in this.doneFeatures){var o=this.doneFeatures[t];i%1e3==999&&(r+="("+n+")->.done;\n",n=".done;"),n+=o.type+"("+o.osm_id+");",i++}return i&&(r+="("+n+")->.done;\n",r+="(.result; - .done;)->.result;\n"),this.options.filter&&(r+=this.options.filter.toQl({inputSet:".result",outputSet:".result"})),"split"in this.options||(this.options.effortSplit=Math.ceil(e/4)),{query:r+=".result out "+s(this.options)+";",request:this,parts:[{properties:this.options.properties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.featureCallback}],effort:this.options.split?4*this.options.split:e}}},{key:"receiveObject",value:function(e){this.doneFeatures[e.id]=e}},{key:"checkFeatureCallback",value:function(e){return!this.bounds||0!==e.intersects(this.bounds)}},{key:"finishSubRequest",value:function(e){_get(_getPrototypeOf(i.prototype),"finishSubRequest",this).call(this,e),("effortSplit"in this.options&&this.options.effortSplit>e.parts[0].count||this.options.split>e.parts[0].count)&&(this.loadFinish=!0,(this.options.filter?this.cacheFilter:this.cache.requested).add(this.bbox))}},{key:"needLoad",value:function(){return!this.loadFinish&&((!this.options.filter||!this.cacheFilter.check(this.bbox))&&!this.cache.requested.check(this.bbox))}},{key:"mayFinish",value:function(){return!this.needLoad()}}]),i}();t.exports=e},{"./Filter":231,"./Request":237,"./RequestBBoxMembers":239,"./boundsIsFullWorld":245,"./boundsToLokiQuery":246,"./defines":249,"./knownArea":254,"./overpassOutOptions":256}],239:[function(e,t,r){var n=e("./defines"),a=e("./overpassOutOptions"),i=e("lodash/forEach"),u=e("lodash/map"),l=e("lodash/keys"),c=e("boundingbox"),o=e("./SortedCallbacks"),s=e("./isGeoJSON"),h=function(){"use strict";function t(e){_classCallCheck2(this,t),this.master=e,this.options=this.master.options,this.overpass=this.master.overpass,this.options.properties|=n.MEMBERS,this.options.memberProperties=this.options.memberProperties||n.DEFAULT,this.options.memberProperties|=n.BBOX,this.options.memberBounds&&(s(this.options.memberBounds)?this.bounds=this.options.memberBounds:this.bounds=new c(this.options.memberBounds)),this.master._compileQuery=this._compileQuery.bind(this,this.master._compileQuery),this.master.needLoad=this.needLoad.bind(this,this.master.needLoad),this.master.mayFinish=this.mayFinish.bind(this,this.master.mayFinish),this.master.preprocess=this.preprocess.bind(this,this.master.preprocess),this.master.willInclude=this.willInclude.bind(this,this.master.willInclude),this.master.minMaxEffort=this.minMaxEffort.bind(this,this.master.minMaxEffort),this.master.finishSubRequest=this.finishSubRequest.bind(this,this.master.finishSubRequest),this.master.featureCallback=this.receiveMasterObject.bind(this,this.master.featureCallback),this.doneFeatures={},this.relations={},this.currentRelations=[],this.todo={},this.loadFinish=!0;e=new o(this.options,this.options.memberCallback,this.finalCallback);this.options.memberCallback=e.next.bind(e),this.finalCallback=e.final.bind(e)}return _createClass2(t,[{key:"willInclude",value:function(e,t){t=e.call(this.master,t);return!this.loadFinish||t}},{key:"minMaxEffort",value:function(e){var t=e.call(this.master),e=t.minEffort,t=t.maxEffort;return this.loadFinish||(e+=64,t=null),{minEffort:e,maxEffort:t}}},{key:"preprocess",value:function(e){var n=this;e.call(this.master),this.todo={},i(this.relations,function(e){i(e.members,function(e){e.id in n.doneFeatures||(n.todo[e.id]=void 0)})}),i(this.todo,function(e,t){var r;t in n.overpass.cacheElements&&(r=n.overpass.cacheElements[t],n.bounds&&!r.intersects(n.bounds)||(n.options.memberProperties&r.properties)===n.options.memberProperties&&(n.doneFeatures[t]=r,n.options.memberCallback(null,r)))})}},{key:"_compileQuery",value:function(e,t){e=e.call(this.master,t);if(0===l(this.relations).length)return e;var r="(\n";r+=u(this.relations,function(e){return"relation"===e.type?"relation("+e.osm_id+");\n":""}).join(""),r+=")->.result;",this.currentRelations=l(this.relations);t="";this.bounds&&(t="("+new c(this.bounds).toLatLonString()+")"),r+="(\n  node(r.result)"+t+";\n  way(r.result)"+t+";\n  relation(r.result)"+t+";\n)->.resultMembers;\n";var n,i="",o=0;for(n in this.doneFeatures){var s=this.doneFeatures[n];o%1e3==999&&(r+="("+i+")->.doneMembers;\n",i=".doneMembers;"),i+=s.type+"("+s.osm_id+");",o++}return o&&(r+="("+i+")->.doneMembers;\n",r+="(.resultMembers; - .doneMembers;)->.resultMembers;\n"),this.part={properties:this.options.memberProperties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.options.memberCallback,count:0},r+=".resultMembers out "+a(this.part)+";",this.loadFinish=!0,e.parts.length&&(e.query+="\nout count;\n"),e.query+=r,e.parts.push(this.part),e}},{key:"receiveMasterObject",value:function(e,t,r,n){this.relations[r.id]=r,this.loadFinish=!1,e(t,r,n)}},{key:"receiveObject",value:function(e){this.doneFeatures[e.id]=e}},{key:"checkFeatureCallback",value:function(e){return!this.bounds||0!==e.intersects(this.bounds)}},{key:"finishSubRequest",value:function(e,t){e.call(this.master,t),l(this.relations).length!==this.currentRelations.length&&(this.loadFinish=!1)}},{key:"needLoad",value:function(e){return!0===e.call(this.master)||!this.loadFinish}},{key:"mayFinish",value:function(e){return!1!==e.call(this.master)&&this.loadFinish}}]),t}();t.exports=function(e){return new h(e)}},{"./SortedCallbacks":243,"./defines":249,"./isGeoJSON":253,"./overpassOutOptions":256,boundingbox:74,"lodash/forEach":202,"lodash/keys":216,"lodash/map":217}],240:[function(e,t,r){var n=e("./Request"),h=e("./defines"),s=e("boundingbox"),p=e("./overpassOutOptions"),a=e("./RequestGetMembers"),u=e("./isGeoJSON"),e=function(){"use strict";_inherits(o,n);var i=_createSuper(o);function o(e,t){var r;_classCallCheck2(this,o),(r=i.call(this,e,t)).type="get","string"==typeof r.ids?r.ids=[r.ids]:r.ids=r.ids.concat(),void 0===r.options.properties&&(r.options.properties=h.DEFAULT);for(var n=0;n<r.ids.length;n++)r.ids[n]in r.overpass.cacheElements&&!1===r.overpass.cacheElements[r.ids[n]]&&delete r.overpass.cacheElements[r.ids[n]];return r.options.bounds?(u(r.options.bounds)&&(r.geojsonBounds=r.options.bounds),r.options.bounds=new s(r.options.bounds)):r.options.bbox&&(r.options.bounds=new s(r.options.bbox),delete r.options.bbox,console.error('OverpassFrontend.get(): option "bbox" is deprecated, use "bounds" instead')),delete r.options.split,r.done={},"members"in r.options&&a(_assertThisInitialized(r)),r}return _createClass2(o,[{key:"_effortForId",value:function(e){if(!e)return null;switch(e.substr(0,1)){case"n":return this.overpass.options.effortNode;case"w":return this.overpass.options.effortWay;case"r":return this.overpass.options.effortRelation}}},{key:"minMaxEffort",value:function(){var t=this,e=this.ids.filter(function(e){return e});return 0===e.length?{minEffort:0,maxEffort:0}:{minEffort:Math.min.apply(this,e.map(function(e){return t._effortForId(e)})),maxEffort:e.map(function(e){return t._effortForId(e)}).reduce(function(e,t){return e+t})}}},{key:"preprocess",value:function(){this.allFound=!0;for(var e=0;e<this.ids.length;e++){var t=this.ids[e];if(null!==t){if(t in this.overpass.cacheElements){var r=this.overpass.cacheElements[t],n=!0;if(r.missingObject){this.featureCallback(null,null,e),this.ids[e]=null;continue}if(this.options.bounds)if(0===(this.geojsonBounds?r.intersects(this.geojsonBounds):r.intersects(this.options.bounds))||!r.bounds&&r.properties|h.BBOX){this.featureCallback(null,!1,e),this.ids[e]=null;continue}if(!1!==r&&null!==r&&(this.options.properties&r.properties)!==this.options.properties&&(n=!1),n){this.featureCallback(null,r,e),this.ids[e]=null;continue}}else if(null!==t&&!t.match(/^[nwr][0-9]+$/)){this.featureCallback(null,null,e),this.ids[e]=null;continue}this.allFound=!1}}}},{key:"_compileQuery",value:function(e){var t="",r="",n="",i="",o="",s=0;this.options.bounds&&(o="("+this.options.bounds.toLatLonString()+")");for(var a=0;a<this.ids.length;a++){var u=this.ids[a],l=p(this.options);if(s>e.maxEffort)break;if(null!==u&&(!(u in e.todo)&&(!(this.options.bounds&&u in this.overpass.cacheElements&&this.overpass.cacheElements[u].properties&h.BBOX)||this.overpass.cacheElements[u].intersects(this.options.bounds)))){switch(u.substr(0,1)){case"n":r+="node("+u.substr(1)+");\n",s+=this.overpass.options.effortNode;break;case"w":n+="way("+u.substr(1)+");\n",s+=this.overpass.options.effortWay;break;case"r":i+="relation("+u.substr(1)+");\n",s+=this.overpass.options.effortRelation}e.todo[u]=!0}}""!==r&&(t+="(("+r+");)->.n;\n",o&&(t+="(node.n; - node.n"+o+"->.n;);\nout ids bb qt;\n")),""!==n&&(t+="(("+n+");)->.w;\n",o&&(t+="(way.w; - way.w"+o+"->.w;);\nout ids bb qt;\n")),""!==i&&(t+="(("+i+");)->.r;\n",o&&(t+="(relation.r; - relation.r"+o+"->.r;);\nout ids bb qt;\n"));var c=[];return!o||""===r&&""===n&&""===i||(t+="out count;\n",c.push({properties:h.BBOX,bounds:this.options.bounds,boundsNoMatch:!0})),""!==r&&(t+=".n out "+l+";\n"),""!==n&&(t+=".w out "+l+";\n"),""!==i&&(t+=".r out "+l+";\n"),t&&c.push({properties:this.options.properties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this._featureCallback.bind(this,this.featureCallback)}),{query:t,effort:s,request:this,parts:c}}},{key:"checkFeatureCallback",value:function(e){return!this.geojsonBounds||0!==e.intersects(this.geojsonBounds)}},{key:"_featureCallback",value:function(t,e,r){for(var n,i=[];-1!==(n=this.ids.indexOf(r.id));)this.ids[n]=null,i.push(n);!this.options.bounds||r.intersects(this.options.bounds)?i.forEach(function(e){return t(null,r,e)}):i.forEach(function(e){return t(null,!1,e)})}},{key:"needLoad",value:function(){return this.preprocess(),this.allFound}},{key:"mayFinish",value:function(){return this.allFound}}]),o}();t.exports=e},{"./Request":237,"./RequestGetMembers":241,"./defines":249,"./isGeoJSON":253,"./overpassOutOptions":256,boundingbox:74}],241:[function(e,t,r){var n=e("./defines"),a=e("./overpassOutOptions"),i=e("lodash/forEach"),u=e("lodash/map"),l=e("lodash/keys"),c=e("boundingbox"),o=e("./isGeoJSON"),s=function(){"use strict";function t(e){_classCallCheck2(this,t),this.master=e,this.options=this.master.options,this.overpass=this.master.overpass,this.options.properties|=n.MEMBERS,this.options.memberProperties=this.options.memberProperties||n.DEFAULT,this.options.memberProperties|=n.BBOX,this.options.memberBounds&&(o(this.options.memberBounds)?this.bounds=this.options.memberBounds:this.bounds=new c(this.options.memberBounds)),this.master._compileQuery=this._compileQuery.bind(this,this.master._compileQuery),this.master.needLoad=this.needLoad.bind(this,this.master.needLoad),this.master.mayFinish=this.mayFinish.bind(this,this.master.mayFinish),this.master.preprocess=this.preprocess.bind(this,this.master.preprocess),this.master.willInclude=this.willInclude.bind(this,this.master.willInclude),this.master.minMaxEffort=this.minMaxEffort.bind(this,this.master.minMaxEffort),this.master.finishSubRequest=this.finishSubRequest.bind(this,this.master.finishSubRequest),this.master.featureCallback=this.receiveMasterObject.bind(this,this.master.featureCallback),this.doneFeatures={},this.relations={},this.currentRelations=[],this.todo={}}return _createClass2(t,[{key:"willInclude",value:function(e,t){var r=this,e=e.call(this.master,t);return!this.loadFinish&&(!!e&&("extMembersList"in t?this.master.priority<=t.extMembersPriority?(l(this.relations).forEach(function(e){t.extMembersList[e]=r.relations[e]}),t.extMembersRequests.push(this),!1):void 0:(t.extMembersList=this.relations,t.extMembersRequests=[this],t.extMembersPriority=this.master.priority,!0)))}},{key:"minMaxEffort",value:function(e){var t=e.call(this.master),e=t.minEffort,t=t.maxEffort;return this.loadFinish||(e+=64,t=null),{minEffort:e,maxEffort:t}}},{key:"preprocess",value:function(e){var n=this;e.call(this.master),this.todo={},i(this.relations,function(e){i(e.members,function(e){e.id in n.doneFeatures||(n.todo[e.id]=void 0)})}),i(this.todo,function(e,t){var r;t in n.overpass.cacheElements&&(r=n.overpass.cacheElements[t],n.bounds&&!r.intersects(n.bounds)||(n.options.memberProperties&r.properties)===n.options.memberProperties&&(n.doneFeatures[t]=r,n.options.memberCallback(null,r)))})}},{key:"_compileQuery",value:function(e,t){var r=e.call(this.master,t);if(0===l(this.relations).length)return r;var n="(\n";n+=u(t.extMembersList,function(e){return"relation"===e.type?"relation("+e.osm_id+");\n":""}).join(""),n+=")->.result;",this.currentRelations=l(this.relations);e="";this.bounds&&(e="("+new c(this.bounds).toLatLonString()+")"),n+="(\n  node(r.result)"+e+";\n  way(r.result)"+e+";\n  relation(r.result)"+e+";\n)->.resultMembers;\n";var i="",o=0,s={};return t.extMembersRequests.forEach(function(e){for(var t in e.doneFeatures){var r;t in s||(r=e.doneFeatures[t],o%1e3==999&&(n+="("+i+")->.doneMembers;\n",i=".doneMembers;"),i+=r.type+"("+r.osm_id+");",o++,s[t]=!0)}e.loadFinish=!0}),o&&(n+="("+i+")->.doneMembers;\n",n+="(.resultMembers; - .doneMembers;)->.resultMembers;\n"),this.part={properties:this.options.memberProperties,receiveObject:this.receiveObject.bind(this),checkFeatureCallback:this.checkFeatureCallback.bind(this),featureCallback:this.options.memberCallback,count:0},n+=".resultMembers out "+a(this.part)+";",r.parts.length&&(r.query+="\nout count;\n"),r.query+=n,r.parts.push(this.part),r}},{key:"receiveMasterObject",value:function(e,t,r,n){this.relations[r.id]=r,this.loadFinish=!1,e(t,r,n)}},{key:"receiveObject",value:function(e){this.doneFeatures[e.id]=e}},{key:"checkFeatureCallback",value:function(e){return!this.bounds||0!==e.intersects(this.bounds)}},{key:"finishSubRequest",value:function(e,t){e.call(this.master,t),l(this.relations).length!==this.currentRelations.length&&(this.loadFinish=!1)}},{key:"needLoad",value:function(e){return!0===e.call(this.master)||!this.loadFinish}},{key:"mayFinish",value:function(e){return!1!==e.call(this.master)&&this.loadFinish}}]),t}();t.exports=function(e){return new s(e)}},{"./defines":249,"./isGeoJSON":253,"./overpassOutOptions":256,boundingbox:74,"lodash/forEach":202,"lodash/keys":216,"lodash/map":217}],242:[function(e,t,r){var n=e("./Request"),e=function(){"use strict";_inherits(o,n);var i=_createSuper(o);function o(e,t,r){var n;return _classCallCheck2(this,o),(n=i.call(this,e,t)).type="RequestMulti",n.doneFeatures={},n.requests=r,n.requests.forEach(function(e){e.on("finish",function(){n.requests.splice(n.requests.indexOf(e),1)}),e.on("subrequest-compile",function(e){return n.emit("subrequest-compile",e)}),e.on("subrequest-finish",function(e){return n.emit("subrequest-finish",e)}),e.featureCallback=function(e,t){t.id in n.doneFeatures||(n.doneFeatures[t.id]=!0,n.featureCallback(e,t))},e.finalCallback=function(){},n.overpass.requests.push(e)}),n}return _createClass2(o,[{key:"abort",value:function(){this.requests.forEach(function(e){return e.abort()}),_get(_getPrototypeOf(o.prototype),"abort",this).call(this)}},{key:"willInclude",value:function(){return!1}},{key:"preprocess",value:function(){}},{key:"mayFinish",value:function(){return!this.requests.length}}]),o}();t.exports=e},{"./Request":237}],243:[function(e,t,r){var i=e("async"),o=e("weight-sort"),s=e("./defines"),e=function(){"use strict";function n(e,t,r){_classCallCheck2(this,n),this.list=[],this.lastIndex=-1,this.featureCallback=t,this.finalCallback=r,this.options=e,"sort"in this.options&&!1!==this.options.sort||(this.options.sort=null),"sortDir"in this.options||(this.options.sortDir="asc"),!0===this.options.sort&&(this.options.sort="index"),"BBoxDiagonalLength"===this.options.sort&&(this.options.properties|=s.BBOX)}return _createClass2(n,[{key:"next",value:function(e,t,r){void 0===r&&(r=this.list.length),this.list[r]={err:e,feature:t,index:r},(null===this.options.sort||"index"===this.options.sort&&"asc"===this.options.sortDir&&r===this.lastIndex+1)&&(i.setImmediate(function(){this.featureCallback(this.list[r].err,this.list[r].feature,r)}.bind(this)),this.lastIndex=r)}},{key:"final",value:function(t){if("BBoxDiagonalLength"===this.options.sort){for(var e=0;e<this.list.length;e++){var r=this.list[e].feature;r&&r.bounds&&(this.list[e].weight=r.bounds.diagonalLength())}this.list=o(this.list)}"desc"===this.options.sortDir&&this.list.reverse(),i.setImmediate(function(){if(null!==this.options.sort)for(var e=this.lastIndex+1;e<this.list.length;e++)this.list[e]&&this.featureCallback(this.list[e].err,this.list[e].feature,e);this.finalCallback(t)}.bind(this))}}]),n}();t.exports=e},{"./defines":249,async:230,"weight-sort":273}],244:[function(e,t,r){var n={booleanWithin:e("@turf/boolean-within").default};function i(e){return e.geometry&&"MultiPolygon"===e.geometry.type?e.geometry.coordinates.map(function(e){return{type:"Feature",geometry:{type:"Polygon",coordinates:e}}}):[e]}t.exports=function(e,t){var e=i(e),r=i(t),t=e.filter(function(t){return!!r.filter(function(e){return n.booleanWithin(t,e)}).length});return e.length===t.length}},{"@turf/boolean-within":26}],245:[function(e,t,r){t.exports=function(e){return-90===e.minlat&&90===e.maxlat&&-180===e.minlon&&180===e.maxlon}},{}],246:[function(e,t,r){t.exports=function(e,t){if(e.minlon<=e.maxlon)return t.hasStretchLon180?{minlat:{$lte:e.maxlat},maxlat:{$gte:e.minlat},$or:[{minlon:{$lte:e.maxlon},maxlon:{$gte:e.minlon}},{minlon:{$lte:e.maxlon},stretchLon180:{$eq:!0}},{maxlon:{$gte:e.minlon},stretchLon180:{$eq:!0}}]}:{minlat:{$lte:e.maxlat},minlon:{$lte:e.maxlon},maxlat:{$gte:e.minlat},maxlon:{$gte:e.minlon}};e={minlat:{$lte:e.maxlat},maxlat:{$gte:e.minlat},$or:[{minlon:{$gte:0},maxlon:{$gte:e.minlon}},{minlon:{$lte:e.maxlon},maxlon:{$lte:0}}]};return t.hasStretchLon180&&e.$or.push({stretchLon180:{$eq:!0}}),e}},{}],247:[function(e,t,r){t.exports=function(e){var t={version:parseFloat(e.getAttribute("version")),generator:e.getAttribute("generator"),osm3s:{},elements:[]},r=e.getElementsByTagName("note");r.length&&(t.osm3s.copyright=r[0].textContent);r=e.getElementsByTagName("meta");r.length&&(t.osm3s.timestamp_osm_base=r[0].getAttribute("osm_base"),r[0].hasAttribute("areas")&&(t.osm3s.timestamp_areas_base=r[0].getAttribute("areas")));for(var n=e.firstChild;n;){var i={};if("node"===n.nodeName||"way"===n.nodeName||"relation"===n.nodeName){i.type=n.nodeName,i.id=parseInt(n.getAttribute("id")),i.changeset=parseInt(n.getAttribute("changeset")),i.timestamp=n.getAttribute("timestamp"),i.user=n.getAttribute("user"),i.uid=parseInt(n.getAttribute("uid")),i.version=parseInt(n.getAttribute("version")),"node"===i.type?(i.lat=parseFloat(n.getAttribute("lat")),i.lon=parseFloat(n.getAttribute("lon"))):"way"===i.type?i.nodes=[]:"relation"===i.type&&(i.members=[]);for(var o=n.firstChild;o;){if("tag"===o.nodeName)"tags"in i||(i.tags={}),i.tags[o.getAttribute("k")]=o.getAttribute("v");else if("member"===o.nodeName){var s={type:o.getAttribute("type"),ref:parseInt(o.getAttribute("ref")),role:o.getAttribute("role")};o.hasAttribute("lat")&&(s.lat=parseFloat(o.getAttribute("lat")),s.lon=parseFloat(o.getAttribute("lon")));var a=o.firstChild;if("way"===s.type&&a)for(s.geometry=[];a;)"nd"===a.nodeName&&s.geometry.push({lat:parseFloat(a.getAttribute("lat")),lon:parseFloat(a.getAttribute("lon"))}),a=a.nextSibling;i.members.push(s)}else"nd"===o.nodeName&&(i.nodes.push(parseInt(o.getAttribute("ref"))),o.hasAttribute("lat")&&(i.geometry||(i.geometry=[]),i.geometry.push({lat:parseFloat(o.getAttribute("lat")),lon:parseFloat(o.getAttribute("lon"))})));o=o.nextSibling}t.elements.push(i)}n=n.nextSibling}return t}},{}],248:[function(e,t,r){t.exports=function(e){var t,r={};for(t in e)"elements"!==t&&"osm3s"!==t&&(r[t]=e[t]);if(e.osm3s)for(var n in e.osm3s)r[n]=e.osm3s[n];return r}},{}],249:[function(e,t,r){t.exports={ID_ONLY:0,TAGS:1,META:2,MEMBERS:4,BBOX:8,GEOM:16,CENTER:32,ALL:63,DEFAULT:13}},{}],250:[function(e,t,r){t.exports=function n(e){var i=[""];return Array.isArray(e)||(e=[e]),e.forEach(function(t){var e,r;i=t.or?(e=t.or.map(n),r=[],i.forEach(function(t){r=r.concat(e.map(function(e){return t+e}))}),r):i.map(function(e){return e+t})}),i}},{}],251:[function(e,t,r){t.exports=function t(e,r){switch(e.type){case"FeatureCollection":return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,r)})};case"Feature":return{type:"Feature",geometry:t(e.geometry,r),properties:e.properties};case"GeometryCollection":return{type:"GeometryCollection",geometries:e.geometries.map(function(e){return t(e,r)}),properties:e.properties};case"Point":return{type:"Point",coordinates:[e.coordinates[0]+r[e.coordinates[0]<0?0:1],e.coordinates[1]]};case"Polygon":case"MultiLineString":return{type:e.type,coordinates:e.coordinates.map(function(e){return e.map(function(e){return[e[0]+r[e[0]<0?0:1],e[1]]})})};case"MultiPolygon":return{type:"MultiPolygon",coordinates:e.coordinates.map(function(e){return e.map(function(e){return e.map(function(e){return[e[0]+r[e[0]<0?0:1],e[1]]})})})};case"LineString":case"MultiPoint":return{type:e.type,coordinates:e.coordinates.map(function(e){return[e[0]+r[e[0]<0?0:1],e[1]]})};default:console.log(e)}}},{}],252:[function(e,t,r){(function(o){(function(){"undefined"==typeof XMLHttpRequest&&(o.XMLHttpRequest=("undefined"!=typeof window?window.XMLHttpRequest:void 0!==o?o.XMLHttpRequest:null).XMLHttpRequest),t.exports=function(e,t,r,a){var u=new o.XMLHttpRequest;u.onreadystatechange=function(){var e=null,t=null;if(4===u.readyState)if(200===u.status){try{e=JSON.parse(u.responseText)}catch(t){}a(t,e)}else try{t=new Error(JSON.parse(u.responseText))}catch(t){if(-1!==u.responseText.search("OSM3S Response")){for(var r=u.responseText.split(/\n/),n="",i=0;i<r.length;i++){var o=r[i].match(/<p><strong style="color:#FF0000">Error<\/strong>: (.*)<\/p>/);o&&(n+=o[1]+"\n")}""===n&&(n="Got error "+u.status);var s=new Error(n);s.status=u.status,a(s,null)}else{s=new Error(u.responseText);s.status=u.status,a(s,null)}}};var n="GET",i=null;r&&(n="POST",i=r),"//"===e.substr(0,2)&&(e="undefined"==typeof location?"https:"+e:location.protocol+e),u.open(n,e,!0);try{u.send(i)}catch(e){a(e,null)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],253:[function(e,t,r){t.exports=function(e){return e&&("Feature"===e.type||"FeatureCollection"===e.type)}},{}],254:[function(e,t,r){var n=e("boundingbox"),i=e("./turf"),e=function(){"use strict";function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck2(this,t),this.area=e}return _createClass2(t,[{key:"add",value:function(e){e=new n(e).toGeoJSON(),null===this.area?this.area=e:this.area=i.union(e,this.area)}},{key:"check",value:function(e){return null!==this.area&&(e=new n(e).toGeoJSON(),!i.difference(e,this.area))}},{key:"toGeoJSON",value:function(){return this.area}}]),t}();t.exports=e},{"./turf":259,boundingbox:74}],255:[function(e,t,r){var s=e("fs"),a=e("xmldom").DOMParser,u=e("bzip2"),l=e("./convertFromXML");t.exports=function(i,o){var n;"undefined"!=typeof location||i.match(/^(http:|https:|)\/\//)?((n=new window.XMLHttpRequest).onreadystatechange=function(){if(4===n.readyState)if(200===n.status){if(i.match(/\.osm\.bz2$/)){for(var e=new Uint8Array(n.response),t=u.simple(u.array(e)),e="",r=0;r<t.byteLength;r++)e+=String.fromCharCode(t[r]);e=decodeURIComponent(escape(e)),t=(new a).parseFromString(e.toString(),"text/xml"),t=l(t.getElementsByTagName("osm")[0])}else t=n.responseXML?l(n.responseXML.firstChild):JSON.parse(n.responseText);o(null,t)}else o(n)},"//"===i.substr(0,2)&&(i="undefined"==typeof location?"https:"+i:window.location.protocol+i),i.match(/\.osm\.bz2$/)&&(n.responseType="arraybuffer"),n.overrideMimeType("text/xml"),n.open("GET",i),n.send()):s.readFile(i,function(e,t){var r;if(e)return o(e);if(i.match(/\.osm(\.bz2)?$/)){if(i.match(/\.osm\.bz2$/)){r=u.simple(u.array(t)),t="";for(var n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);t=decodeURIComponent(escape(t))}r=(new a).parseFromString(t.toString(),"text/xml"),r=l(r.getElementsByTagName("osm")[0])}else r=JSON.parse(t);o(null,r)})}},{"./convertFromXML":247,bzip2:78,fs:77,xmldom:275}],256:[function(e,t,r){var n=e("./defines");t.exports=function(e,t){var r="";return"split"in e&&0<e.split?r+=e.split+" ":"effortSplit"in e&&(r+=e.effortSplit+" "),e.properties&n.META?r+="meta ":e.properties&n.TAGS?e.properties&n.MEMBERS?r+="body ":r+="tags ":e.properties&n.MEMBERS?r+="skel ":r+="ids ",e.properties&n.GEOM?r+="geom ":e.properties&n.BBOX?r+="bb ":e.properties&n.CENTER&&(r+="center "),r+="qt"}},{"./defines":249}],257:[function(e,t,r){t.exports=function(e){for(var t;-1!==(t=e.indexOf(null));)e.splice(t,1);return e}},{}],258:[function(e,t,r){t.exports=function(){return(new Date).getTime()}},{}],259:[function(e,t,r){t.exports={difference:e("@turf/difference"),union:e("@turf/union").default}},{"@turf/difference":38,"@turf/union":71}],260:[function(e,t,r){(function(s){(function(){"use strict";function p(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function o(e,t){for(var r,n="",i=0,o=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(o!==a-1&&1!==s)if(o!==a-1&&2===s){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(2<n.length){var u=n.lastIndexOf("/");if(u!==n.length-1){i=-1===u?(n="",0):(n=n.slice(0,u)).length-1-n.lastIndexOf("/"),o=a,s=0;continue}}else if(2===n.length||1===n.length){n="",o=a,s=i=0;continue}t&&(0<n.length?n+="/..":n="..",i=2)}else 0<n.length?n+="/"+e.slice(o+1,a):n=e.slice(o+1,a),i=a-o-1;o=a,s=0}else 46===r&&-1!==s?++s:s=-1}return n}var f={resolve:function(){for(var e,t="",r=!1,n=arguments.length-1;-1<=n&&!r;n--){var i=0<=n?arguments[n]:(void 0===e&&(e=s.cwd()),e);p(i),0!==i.length&&(t=i+"/"+t,r=47===i.charCodeAt(0))}return t=o(t,!r),r?0<t.length?"/"+t:"/":0<t.length?t:"."},normalize:function(e){if(p(e),0===e.length)return".";var t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0!==(e=o(e,!t)).length||t||(e="."),0<e.length&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return p(e),0<e.length&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];p(r),0<r.length&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":f.normalize(e)},relative:function(e,t){if(p(e),p(t),e===t)return"";if((e=f.resolve(e))===(t=f.resolve(t)))return"";for(var r=1;r<e.length&&47===e.charCodeAt(r);++r);for(var n=e.length,i=n-r,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var s=t.length-o,a=i<s?i:s,u=-1,l=0;l<=a;++l){if(l===a){if(a<s){if(47===t.charCodeAt(o+l))return t.slice(o+l+1);if(0===l)return t.slice(o+l)}else a<i&&(47===e.charCodeAt(r+l)?u=l:0===l&&(u=0));break}var c=e.charCodeAt(r+l);if(c!==t.charCodeAt(o+l))break;47===c&&(u=l)}for(var h="",l=r+u+1;l<=n;++l)l!==n&&47!==e.charCodeAt(l)||(0===h.length?h+="..":h+="/..");return 0<h.length?h+t.slice(o+u):(o+=u,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(p(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,o=e.length-1;1<=o;--o)if(47===e.charCodeAt(o)){if(!i){n=o;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');p(e);var r=0,n=-1,i=!0;if(void 0!==t&&0<t.length&&t.length<=e.length){if(t.length===e.length&&t===e)return"";for(var o=t.length-1,s=-1,a=e.length-1;0<=a;--a){var u=e.charCodeAt(a);if(47===u){if(!i){r=a+1;break}}else-1===s&&(i=!1,s=a+1),0<=o&&(u===t.charCodeAt(o)?-1==--o&&(n=a):(o=-1,n=s))}return r===n?n=s:-1===n&&(n=e.length),e.slice(r,n)}for(a=e.length-1;0<=a;--a)if(47===e.charCodeAt(a)){if(!i){r=a+1;break}}else-1===n&&(i=!1,n=a+1);return-1===n?"":e.slice(r,n)},extname:function(e){p(e);for(var t=-1,r=0,n=-1,i=!0,o=0,s=e.length-1;0<=s;--s){var a=e.charCodeAt(s);if(47===a){if(i)continue;r=s+1;break}-1===n&&(i=!1,n=s+1),46===a?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1)}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(null===e||"object"!==_typeof3(e))throw new TypeError('The "pathObject" argument must be of type Object. Received type '+_typeof3(e));return t="/",n=(r=e).dir||r.root,e=r.base||(r.name||"")+(r.ext||""),n?n===r.root?n+e:n+t+e:e;var t,r,n},parse:function(e){p(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;for(var r=e.charCodeAt(0),n=47===r,i=n?(t.root="/",1):0,o=-1,s=0,a=-1,u=!0,l=e.length-1,c=0;i<=l;--l){if(47===(r=e.charCodeAt(l))){if(u)continue;s=l+1;break}-1===a&&(u=!1,a=l+1),46===r?-1===o?o=l:1!==c&&(c=1):-1!==o&&(c=-1)}return-1===o||-1===a||0===c||1===c&&o===a-1&&o===s+1?-1!==a&&(t.base=t.name=0===s&&n?e.slice(1,a):e.slice(s,a)):(0===s&&n?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(s,o),t.base=e.slice(s,a)),t.ext=e.slice(o,a)),0<s?t.dir=e.slice(0,s-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};f.posix=f,t.exports=f}).call(this)}).call(this,e("_process"))},{_process:262}],261:[function(e,r,n){(function(O){(function(){var e,t;e=this,t=function(){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var l=function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null};function t(e,t){return t<e?1:e<t?-1:0}function s(e,t,r){for(var n=new l(null,null),i=n,o=n;;){var s=r(e,t.key);if(s<0){if(null===t.left)break;if(r(e,t.left.key)<0){var a=t.left;if(t.left=a.right,a.right=t,null===(t=a).left)break}o.left=t,t=(o=t).left}else{if(!(0<s))break;if(null===t.right)break;if(0<r(e,t.right.key)){a=t.right;if(t.right=a.left,a.left=t,null===(t=a).right)break}i.right=t,t=(i=t).right}}return i.right=t.left,o.left=t.right,t.left=n.right,t.right=n.left,t}function a(e,t,r,n){t=new l(e,t);if(null===r)return t.left=t.right=null,t;n=n(e,(r=s(e,r,n)).key);return n<0?(t.left=r.left,(t.right=r).left=null):0<=n&&(t.right=r.right,(t.left=r).right=null),t}function c(e,t,r){var n=null,i=null;return t&&(0===(e=r((t=s(e,t,r)).key,e))?(n=t.left,i=t.right):e<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)),{left:n,right:i}}var M=(e.prototype.insert=function(e,t){return this._size++,this._root=a(e,t,this._root,this._comparator)},e.prototype.add=function(e,t){var r=new l(e,t);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var n=this._comparator,t=s(e,this._root,n),e=n(e,t.key);return 0===e?this._root=t:(e<0?(r.left=t.left,(r.right=t).left=null):0<e&&(r.right=t.right,(r.left=t).right=null),this._size++,this._root=r),this._root},e.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},e.prototype._remove=function(e,t,r){var n;return null===t?null:0===r(e,(t=s(e,t,r)).key)?(null===t.left?n=t.right:(n=s(e,t.left,r)).right=t.right,this._size--,n):t},e.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=s(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},e.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},e.prototype.find=function(e){return this._root&&(this._root=s(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},e.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},e.prototype.forEach=function(e,t){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),e.call(t,r),r=r.right):i=!0;return this},e.prototype.range=function(e,t,r,n){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(0<o((s=i.pop()).key,t))break;if(0<=o(s.key,e)&&r.call(n,s))return this;s=s.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(e){e=e.key;return t.push(e)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(e){e=e.data;return t.push(e)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},e.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},e.prototype.at=function(e){for(var t=this._root,r=!1,n=0,i=[];!r;)if(t)i.push(t),t=t.left;else if(0<i.length){if(t=i.pop(),n===e)return t;n++,t=t.right}else r=!0;return null},e.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;t=i<0?(r=t).left:t.right}return r},e.prototype.prev=function(e){var t=this._root,r=null;if(null!==e.left){for(r=e.left;r.right;)r=r.right;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;t=i<0?t.left:(r=t).right}return r},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return function(e){var t=e,r=[],n=!1,e=new l(null,null),i=e;for(;!n;)t?(r.push(t),t=t.left):0<r.length?t=(t=i=i.next=r.pop()).right:n=!0;return i.next=null,e.next}(this._root)},e.prototype.load=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var n=e.length,i=this._comparator;return r&&function e(t,r,n,i,o){if(i<=n)return;var s=t[n+i>>1];var a=n-1;var u=i+1;for(;;){for(;a++,o(t[a],s)<0;);for(;u--,0<o(t[u],s););if(u<=a)break;var l=t[a];t[a]=t[u],t[u]=l,l=r[a],r[a]=r[u],r[u]=l}e(t,r,n,u,o);e(t,r,u+1,i,o)}(e,t,0,n-1,i),null===this._root?(this._root=function e(t,r,n,i){var o=i-n;if(0<o){var s=n+Math.floor(o/2),a=t[s],o=r[s],o=new l(a,o);return o.left=e(t,r,n,s),o.right=e(t,r,s+1,i),o}return null}(e,t,0,n),this._size=n):(i=function(e,t,r){var n=new l(null,null),i=n,o=e,s=t;for(;null!==o&&null!==s;)r(o.key,s.key)<0?o=(i.next=o).next:s=(i.next=s).next,i=i.next;null!==o?i.next=o:null!==s&&(i.next=s);return n.next}(this.toList(),function(e,t){for(var r=new l(null,null),n=r,i=0;i<e.length;i++)n=n.next=new l(e[i],t[i]);return n.next=null,r.next}(e,t),i),n=this._size+n,this._root=function e(t,r,n){var i=n-r;if(0<i){var o=r+Math.floor(i/2),i=e(t,r,o),r=t.head;return r.left=i,t.head=t.head.next,r.right=e(t,o+1,n),r}return null}({head:i},0,n)),this},e.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return function e(t,r,n,i,o){t&&(i(r+(n?"âââ ":"âââ ")+o(t)+"\n"),n=r+(n?"    ":"â   "),t.left&&e(t.left,n,!1,i,o),t.right&&e(t.right,n,!0,i,o))}(this._root,"",!0,function(e){return t.push(e)},e),t.join("")},e.prototype.update=function(e,t,r){var n=this._comparator,i=c(e,this._root,n),o=i.left,i=i.right;n(e,t)<0?i=a(t,r,i,n):o=a(t,r,o,n),this._root=(o=o,n=n,null===(i=i)?o:(null===o||((i=s(o.key,i,n)).left=o),i))},e.prototype.split=function(e){return c(e,this._root,this._comparator)},e);function e(e){void 0===e&&(e=t),this._root=null,this._size=0,this._comparator=e}function h(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y}function P(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var r=(e.ll.x<t.ll.x?t:e).ll.x,n=(e.ur.x<t.ur.x?e:t).ur.x;return{ll:{x:r,y:(e.ll.y<t.ll.y?t:e).ll.y},ur:{x:n,y:(e.ur.y<t.ur.y?e:t).ur.y}}}var o=Number.EPSILON;void 0===o&&(o=Math.pow(2,-52));function p(e,t){if(-o<e&&e<o&&-o<t&&t<o)return 0;var r=e-t;return r*r<b*e*t?0:e<t?-1:1}function f(e,t){return e.x*t.y-e.y*t.x}function d(e,t){return e.x*t.x+e.y*t.y}function y(e,t,r){return t={x:t.x-e.x,y:t.y-e.y},e={x:r.x-e.x,y:r.y-e.y},e=f(t,e),p(e,0)}function m(e){return Math.sqrt(d(e,e))}function g(e,t,r){return 0===t.y?null:{x:e.x+t.x/t.y*(r-e.y),y:r}}function v(e,t,r){return 0===t.x?null:{x:r,y:e.y+t.y/t.x*(r-e.x)}}var b=o*o,r=function(){function e(){u(this,e),this.reset()}return i(e,[{key:"reset",value:function(){this.xRounder=new w,this.yRounder=new w}},{key:"round",value:function(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}]),e}(),w=function(){function e(){u(this,e),this.tree=new M,this.round(0)}return i(e,[{key:"round",value:function(e){var t=this.tree.add(e),r=this.tree.prev(t);if(null!==r&&0===p(t.key,r.key))return this.tree.remove(e),r.key;r=this.tree.next(t);return null!==r&&0===p(t.key,r.key)?(this.tree.remove(e),r.key):e}}]),e}(),j=new r,T=function(){function n(e,t){u(this,n),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return i(n,null,[{key:"compare",value:function(e,t){var r=n.comparePoints(e.point,t.point);return 0!==r?r:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:_.compare(e.segment,t.segment))}},{key:"comparePoints",value:function(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}}]),i(n,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var t=e.point.events,r=0,n=t.length;r<n;r++){var i=t[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,t=0;t<e;t++){var r=this.point.events[t];if(void 0===r.segment.consumedBy)for(var n=t+1;n<e;n++){var i=this.point.events[n];void 0===i.consumedBy&&r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],t=0,r=this.point.events.length;t<r;t++){var n=this.point.events[t];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&e.push(n)}return e}},{key:"getLeftmostComparator",value:function(r){function i(e){var t=e.otherSE;o.set(e,{sine:function(e,t,r){t={x:t.x-e.x,y:t.y-e.y},e={x:r.x-e.x,y:r.y-e.y};return f(e,t)/m(e)/m(t)}(n.point,r.point,t.point),cosine:function(e,t,r){t={x:t.x-e.x,y:t.y-e.y},e={x:r.x-e.x,y:r.y-e.y};return d(e,t)/m(e)/m(t)}(n.point,r.point,t.point)})}var n=this,o=new Map;return function(e,t){o.has(e)||i(e),o.has(t)||i(t);var r=o.get(e),n=r.sine,e=r.cosine,r=o.get(t),t=r.sine,r=r.cosine;return 0<=n&&0<=t?e<r?1:r<e?-1:0:n<0&&t<0?e<r?-1:r<e?1:0:t<n?-1:n<t?1:0}}}]),n}(),x=0,_=function(){function l(e,t,r,n){u(this,l),this.id=++x,(this.leftSE=e).segment=this,e.otherSE=t,(this.rightSE=t).segment=this,t.otherSE=e,this.rings=r,this.windings=n}return i(l,null,[{key:"compare",value:function(e,t){var r=e.leftSE.point.x,n=t.leftSE.point.x,i=e.rightSE.point.x,o=t.rightSE.point.x;if(o<r)return 1;if(i<n)return-1;var s=e.leftSE.point.y,a=t.leftSE.point.y,u=e.rightSE.point.y,l=t.rightSE.point.y;if(r<n){if(a<s&&a<u)return 1;if(s<a&&u<a)return-1;var c=e.comparePoint(t.leftSE.point);if(c<0)return 1;if(0<c)return-1;c=t.comparePoint(e.rightSE.point);return 0!==c?c:-1}if(n<r){if(s<a&&s<l)return-1;if(a<s&&l<s)return 1;c=t.comparePoint(e.leftSE.point);if(0!==c)return c;c=e.comparePoint(t.rightSE.point);return c<0?1:0<c?-1:1}if(s<a)return-1;if(a<s)return 1;if(i<o){var h=t.comparePoint(e.rightSE.point);if(0!==h)return h}if(o<i){h=e.comparePoint(t.rightSE.point);if(h<0)return 1;if(0<h)return-1}if(i!==o){s=u-s,r=i-r,a=l-a,n=o-n;if(r<s&&a<n)return 1;if(s<r&&n<a)return-1}return o<i?1:i<o||u<l?-1:l<u?1:e.id<t.id?-1:e.id>t.id?1:0}}]),i(l,[{key:"replaceRightSE",value:function(e){this.rightSE=e,(this.rightSE.segment=this).rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:t<e?e:t}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var t=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(t.x===r.x)return e.x===t.x?0:e.x<t.x?1:-1;r=(e.y-t.y)/n.y,r=t.x+r*n.x;if(e.x===r)return 0;r=(e.x-t.x)/n.x,n=t.y+r*n.y;return e.y===n?0:e.y<n?-1:1}},{key:"getIntersection",value:function(e){var t=this.bbox(),r=e.bbox(),n=P(t,r);if(null===n)return null;var i=this.leftSE.point,o=this.rightSE.point,s=e.leftSE.point,a=e.rightSE.point,u=h(t,s)&&0===this.comparePoint(s),l=h(r,i)&&0===e.comparePoint(i),t=h(t,a)&&0===this.comparePoint(a),r=h(r,o)&&0===e.comparePoint(o);if(l&&u)return r&&!t?o:!r&&t?a:null;if(l)return t&&i.x===a.x&&i.y===a.y?null:i;if(u)return r&&o.x===s.x&&o.y===s.y?null:s;if(r&&t)return null;if(r)return o;if(t)return a;e=function(e,t,r,n){if(0===t.x)return v(r,n,e.x);if(0===n.x)return v(e,t,r.x);if(0===t.y)return g(r,n,e.y);if(0===n.y)return g(e,t,r.y);var i=f(t,n);if(0==i)return null;var o={x:r.x-e.x,y:r.y-e.y},s=f(o,t)/i,i=f(o,n)/i;return{x:(e.x+i*t.x+(r.x+s*n.x))/2,y:(e.y+i*t.y+(r.y+s*n.y))/2}}(i,this.vector(),s,e.vector());return null!==e&&h(n,e)?j.round(e.x,e.y):null}},{key:"split",value:function(e){var t=[],r=void 0!==e.events,n=new T(e,!0),i=new T(e,!1),e=this.rightSE;this.replaceRightSE(i),t.push(i),t.push(n);e=new l(n,e,this.rings.slice(),this.windings.slice());return 0<T.comparePoints(e.leftSE.point,e.rightSE.point)&&e.swapEvents(),0<T.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),r&&(n.checkForConsuming(),i.checkForConsuming()),t}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var t=0,r=this.windings.length;t<r;t++)this.windings[t]*=-1}},{key:"consume",value:function(e){for(var t=this,r=e;t.consumedBy;)t=t.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var n,e=l.compare(t,r);if(0!==e){0<e&&(n=t,t=r,r=n),t.prev===r&&(n=t,t=r,r=n);for(var i=0,o=r.rings.length;i<o;i++){var s=r.rings[i],a=r.windings[i],u=t.rings.indexOf(s);-1===u?(t.rings.push(s),t.windings.push(a)):t.windings[u]+=a}r.rings=null,r.windings=null,r.consumedBy=t,r.leftSE.consumedBy=t.leftSE,r.rightSE.consumedBy=t.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this.prev?(e=this.prev.consumedBy||this.prev,this._beforeState=e.afterState()):this._beforeState={rings:[],windings:[],multiPolys:[]}),this._beforeState;var e}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var t=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],u=t.indexOf(s);-1===u?(t.push(s),r.push(a)):r[u]+=a}for(var l,c,h=[],p=[],f=0,d=t.length;f<d;f++)0!==r[f]&&(l=(c=t[f]).poly,-1===p.indexOf(l)&&(c.isExterior?h.push(l):(-1===p.indexOf(l)&&p.push(l),-1!==(c=h.indexOf(c.poly))&&h.splice(c,1))));for(var y=0,m=h.length;y<m;y++){var g=h[y].multiPoly;-1===n.indexOf(g)&&n.push(g)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(D.type){case"union":var r=0===e.length,n=0===t.length;this._isInResult=r!=n;break;case"intersection":var i,n=e.length<t.length?(i=e.length,t.length):(i=t.length,e.length);this._isInResult=n===D.numMultiPolys&&i<n;break;case"xor":var o=Math.abs(e.length-t.length);this._isInResult=o%2==1;break;case"difference":o=function(e){return 1===e.length&&e[0].isSubject};this._isInResult=o(e)!==o(t);break;default:throw new Error("Unrecognized operation type found ".concat(D.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,t,r){var n,i,o,s=T.comparePoints(e,t);if(s<0)n=e,i=t,o=1;else{if(!(0<s))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));n=t,i=e,o=-1}return new l(new T(n,!0),new T(i,!1),[r],[o])}}]),l}(),k=function(){function a(e,t,r){if(u(this,a),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=r,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");r=j.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var n=r,i=1,o=e.length;i<o;i++){if("number"!=typeof e[i][0]||"number"!=typeof e[i][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var s=j.round(e[i][0],e[i][1]);s.x===n.x&&s.y===n.y||(this.segments.push(_.fromRing(n,s,this)),s.x<this.bbox.ll.x&&(this.bbox.ll.x=s.x),s.y<this.bbox.ll.y&&(this.bbox.ll.y=s.y),s.x>this.bbox.ur.x&&(this.bbox.ur.x=s.x),s.y>this.bbox.ur.y&&(this.bbox.ur.y=s.y),n=s)}r.x===n.x&&r.y===n.y||this.segments.push(_.fromRing(n,r,this))}return i(a,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.segments.length;t<r;t++){var n=this.segments[t];e.push(n.leftSE),e.push(n.rightSE)}return e}}]),a}(),E=function(){function o(e,t){if(u(this,o),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new k(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,n=e.length;r<n;r++){var i=new k(e[r],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=t}return i(o,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),t=0,r=this.interiorRings.length;t<r;t++)for(var n=this.interiorRings[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),o}(),C=function(){function o(e,t){if(u(this,o),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(e){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,n=e.length;r<n;r++){var i=new E(e[r],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=t}return i(o,[{key:"getSweepEvents",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++)for(var n=this.polys[t].getSweepEvents(),i=0,o=n.length;i<o;i++)e.push(n[i]);return e}}]),o}(),I=function(){function v(e){u(this,v);for(var t=0,r=(this.events=e).length;t<r;t++)e[t].segment.ringOut=this;this.poly=null}return i(v,null,[{key:"factory",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];if(i.isInResult()&&!i.ringOut){for(var o,s=i.leftSE,a=i.rightSE,u=[s],l=s.point,c=[];o=s,s=a,u.push(s),s.point!==l;)for(;;){var h=s.getAvailableLinkedEvents();if(0===h.length){var p=u[0].point,f=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(f.x,", ").concat(f.y,"]."))}if(1===h.length){a=h[0].otherSE;break}for(var d=null,y=0,m=c.length;y<m;y++)if(c[y].point===s.point){d=y;break}if(null===d){c.push({index:u.length,point:s.point});var g=s.getLeftmostComparator(o),a=h.sort(g)[0].otherSE;break}g=c.splice(d)[0],g=u.splice(g.index);g.unshift(g[0].otherSE),t.push(new v(g.reverse()))}t.push(new v(u))}}return t}}]),i(v,[{key:"getGeom",value:function(){for(var e=this.events[0].point,t=[e],r=1,n=this.events.length-1;r<n;r++){var i=this.events[r].point,o=this.events[r+1].point;0!==y(i,e,o)&&(t.push(i),e=i)}if(1===t.length)return null;var s=t[0],a=t[1];0===y(s,e,a)&&t.shift(),t.push(t[0]);for(var u=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:t.length-1,l=this.isExteriorRing()?t.length:-1,c=[],h=a;h!=l;h+=u)c.push([t[h].x,t[h].y]);return c}},{key:"isExteriorRing",value:function(){var e;return void 0===this._isExteriorRing&&(e=this.enclosingRing(),this._isExteriorRing=!e||!e.isExteriorRing()),this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],t=1,r=this.events.length;t<r;t++){var n=this.events[t];0<T.compare(e,n)&&(e=n)}for(var i=e.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),v}(),S=function(){function t(e){u(this,t),((this.exteriorRing=e).poly=this).interiorRings=[]}return i(t,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(var t=0,r=this.interiorRings.length;t<r;t++){var n=this.interiorRings[t].getGeom();null!==n&&e.push(n)}return e}}]),t}(),N=function(){function t(e){u(this,t),this.rings=e,this.polys=this._composePolys(e)}return i(t,[{key:"getGeom",value:function(){for(var e=[],t=0,r=this.polys.length;t<r;t++){var n=this.polys[t].getGeom();null!==n&&e.push(n)}return e}},{key:"_composePolys",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i,o=e[r];o.poly||(o.isExteriorRing()?t.push(new S(o)):((i=o.enclosingRing()).poly||t.push(new S(i)),i.poly.addInterior(o)))}return t}}]),t}(),L=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:_.compare;u(this,r),this.queue=e,this.tree=new M(t),this.segments=[]}return i(r,[{key:"process",value:function(e){var t=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(t),r;var n=e.isLeft?this.tree.insert(t):this.tree.find(t);if(!n)throw new Error("Unable to find segment #".concat(t.id," ")+"[".concat(t.leftSE.point.x,", ").concat(t.leftSE.point.y,"] -> ")+"[".concat(t.rightSE.point.x,", ").concat(t.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=n,o=n,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(e.isLeft){n=null;if(s){var u=s.getIntersection(t);if(null!==u&&(t.isAnEndpoint(u)||(n=u),!s.isAnEndpoint(u)))for(var l=this._splitSafely(s,u),c=0,h=l.length;c<h;c++)r.push(l[c])}u=null;if(a){var p=a.getIntersection(t);if(null!==p&&(t.isAnEndpoint(p)||(u=p),!a.isAnEndpoint(p)))for(var f=this._splitSafely(a,p),d=0,y=f.length;d<y;d++)r.push(f[d])}if(null!==n||null!==u){p=null;p=null!==n&&(null===u||T.comparePoints(n,u)<=0)?n:u,this.queue.remove(t.rightSE),r.push(t.rightSE);for(var m=t.split(p),g=0,v=m.length;g<v;g++)r.push(m[g])}0<r.length?(this.tree.remove(t),r.push(e)):(this.segments.push(t),t.prev=s)}else{if(s&&a){e=s.getIntersection(a);if(null!==e){if(!s.isAnEndpoint(e))for(var b=this._splitSafely(s,e),w=0,x=b.length;w<x;w++)r.push(b[w]);if(!a.isAnEndpoint(e))for(var _=this._splitSafely(a,e),k=0,E=_.length;k<E;k++)r.push(_[k])}}this.tree.remove(t)}return r}},{key:"_splitSafely",value:function(e,t){this.tree.remove(e);var r=e.rightSE;this.queue.remove(r);t=e.split(t);return t.push(r),void 0===e.consumedBy&&this.tree.insert(e),t}}]),r}(),F=void 0!==O&&O.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,R=void 0!==O&&O.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,D=new(function(){function e(){u(this,e)}return i(e,[{key:"run",value:function(e,t,r){D.type=e,j.reset();for(var n=[new C(t,!0)],i=0,o=r.length;i<o;i++)n.push(new C(r[i],!1));if(D.numMultiPolys=n.length,"difference"===D.type)for(var s=n[0],a=1;a<n.length;)null!==P(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===D.type)for(var u=0,l=n.length;u<l;u++)for(var c=n[u],h=u+1,p=n.length;h<p;h++)if(null===P(c.bbox,n[h].bbox))return[];for(var f=new M(T.compare),d=0,y=n.length;d<y;d++)for(var m=n[d].getSweepEvents(),g=0,v=m.length;g<v;g++)if(f.insert(m[g]),f.size>F)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var b=new L(f),w=f.size,x=f.pop();x;){var _=x.key;if(f.size===w){var k=_.segment;throw new Error("Unable to pop() ".concat(_.isLeft?"left":"right"," SweepEvent ")+"[".concat(_.point.x,", ").concat(_.point.y,"] from segment #").concat(k.id," ")+"[".concat(k.leftSE.point.x,", ").concat(k.leftSE.point.y,"] -> ")+"[".concat(k.rightSE.point.x,", ").concat(k.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(f.size>F)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(b.segments.length>R)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var E=b.process(_),S=0,O=E.length;S<O;S++){var A=E[S];void 0===A.consumedBy&&f.insert(A)}w=f.size,x=f.pop()}j.reset();t=I.factory(b.segments);return new N(t).getGeom()}}]),e}());return{union:function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return D.run("union",e,r)},intersection:function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return D.run("intersection",e,r)},xor:function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return D.run("xor",e,r)},difference:function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return D.run("difference",e,r)}}},"object"===_typeof3(n)&&void 0!==r?r.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).polygonClipping=t()}).call(this)}).call(this,e("_process"))},{_process:262}],262:[function(e,t,r){var n,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,l=[],c=!1,h=-1;function p(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var e=a(p);c=!0;for(var t=l.length;t;){for(u=l,l=[];++h<t;)u&&u[h].run();h=-1,t=l.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new d(e,t)),1!==l.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=y,t.addListener=y,t.once=y,t.off=y,t.removeListener=y,t.removeAllListeners=y,t.emit=y,t.prependListener=y,t.prependOnceListener=y,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],263:[function(e,t,r){var n,i;n=this,i=function(){"use strict";function d(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function o(e,t){return e<t?-1:t<e?1:0}return function(e,t,r,n,i){!function e(t,r,n,i,o){for(;n<i;){var s,a,u,l,c;600<i-n&&(s=i-n+1,a=r-n+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1),l=Math.max(n,Math.floor(r-a*u/s+c)),c=Math.min(i,Math.floor(r+(s-a)*u/s+c)),e(t,r,l,c,o));var h=t[r],p=n,f=i;for(d(t,n,r),0<o(t[i],h)&&d(t,n,i);p<f;){for(d(t,p,f),p++,f--;o(t[p],h)<0;)p++;for(;0<o(t[f],h);)f--}0===o(t[n],h)?d(t,n,f):d(t,++f,i),f<=r&&(n=f+1),r<=f&&(i=f-1)}}(e,t,r||0,n||e.length-1,i||o)}},"object"===_typeof3(r)&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):n.quickselect=i()},{}],264:[function(e,t,r){"use strict";t.exports=n,t.exports.default=n;var a=e("quickselect");function n(e,t){if(!(this instanceof n))return new n(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function f(e,t){d(e,0,e.children.length,t,e)}function d(e,t,r,n,i){(i=i||m(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,s=t;s<r;s++)o=e.children[s],c(i,e.leaf?n(o):o);return i}function c(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function o(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function y(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function h(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function l(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,t,r,n,i){for(var o,s=[t,r];s.length;)(r=s.pop())-(t=s.pop())<=n||(o=t+Math.ceil((r-t)/n/2)*n,a(e,o,t,r,i),s.push(t,o,o,r))}n.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],n=this.toBBox;if(!l(e,t))return r;for(var i,o,s,a,u=[];t;){for(i=0,o=t.children.length;i<o;i++)s=t.children[i],l(e,a=t.leaf?n(s):s)&&(t.leaf?r.push(s):p(e,a)?this._all(s,r):u.push(s));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!l(e,t))return!1;for(var n,i,o,s,a=[];t;){for(n=0,i=t.children.length;n<i;n++)if(o=t.children[n],l(e,s=t.leaf?r(o):o)){if(t.leaf||p(e,s))return!0;a.push(o)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n,i=this._build(e.slice(),0,e.length-1,0);return this.data.children.length?this.data.height===i.height?this._splitRoot(this.data,i):(this.data.height<i.height&&(n=this.data,this.data=i,i=n),this._insert(i,this.data.height-i.height-1,!0)):this.data=i,this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var r,n,i,o,s=this.data,a=this.toBBox(e),u=[],l=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],r=l.pop(),o=!0),s.leaf&&-1!==(i=function(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}(e,s.children,t)))return s.children.splice(i,1),u.push(s),this._condense(u),this;o||s.leaf||!p(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(u.push(s),l.push(r),r=0,s=(n=s).children[0])}return this},toBBox:function(e){return e},compareMinX:o,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var i,o=r-t+1,s=this._maxEntries;if(o<=s)return f(i=m(e.slice(t,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(i=m([])).leaf=!1,i.height=n;var a,u,l,c,h=Math.ceil(o/s),p=h*Math.ceil(Math.sqrt(s));for(g(e,t,r,p,this.compareMinX),a=t;a<=r;a+=p)for(g(e,a,l=Math.min(a+p-1,r),h,this.compareMinY),u=a;u<=l;u+=h)c=Math.min(u+h-1,l),i.children.push(this._build(e,u,c,n-1));return f(i,this.toBBox),i},_chooseSubtree:function(e,t,r,n){for(var i,o,s,a,u,l,c,h,p;n.push(t),!t.leaf&&n.length-1!==r;){for(l=c=1/0,i=0,o=t.children.length;i<o;i++)u=y(s=t.children[i]),h=e,p=s,(h=(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-u)<c?(c=h,l=u<l?u:l,a=s):h===c&&u<l&&(l=u,a=s);t=a||t.children[0]}return t},_insert:function(e,t,r){var n=this.toBBox,r=r?e:n(e),i=[],n=this._chooseSubtree(r,this.data,t,i);for(n.children.push(e),c(n,r);0<=t&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(r,i,t)},_split:function(e,t){var r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);n=this._chooseSplitIndex(r,i,n),n=m(r.children.splice(n,r.children.length-n));n.height=r.height,n.leaf=r.leaf,f(r,this.toBBox),f(n,this.toBBox),t?e[t-1].children.push(n):this._splitRoot(r,n)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){for(var n,i,o,s,a,u,l,c,h,p=o=1/0,f=t;f<=r-t;f++)n=d(e,0,f,this.toBBox),i=d(e,f,r,this.toBBox),a=n,u=i,h=c=l=void 0,l=Math.max(a.minX,u.minX),c=Math.max(a.minY,u.minY),h=Math.min(a.maxX,u.maxX),u=Math.min(a.maxY,u.maxY),c=Math.max(0,h-l)*Math.max(0,u-c),i=y(n)+y(i),c<p?(p=c,s=f,o=i<o?i:o):c===p&&i<o&&(o=i,s=f);return s},_chooseSplitAxis:function(e,t,r){var n=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)},_allDistMargin:function(e,t,r,n){e.children.sort(n);for(var i,o=this.toBBox,s=d(e,0,t,o),a=d(e,r-t,r,o),u=h(s)+h(a),l=t;l<r-t;l++)i=e.children[l],c(s,e.leaf?o(i):i),u+=h(s);for(l=r-t-1;t<=l;l--)i=e.children[l],c(a,e.leaf?o(i):i),u+=h(a);return u},_adjustParentBBoxes:function(e,t,r){for(var n=r;0<=n;n--)c(t[n],e)},_condense:function(e){for(var t,r=e.length-1;0<=r;r--)0===e[r].children.length?0<r?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():f(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},{quickselect:263}],265:[function(e,t,r){t.exports=function(e){return e.replace(".","\\.").replace(" ",".*").replace("a","[aÃ Ã¡Ã¢Ã£Ã¤Ã¥]").replace("A","[AÃÃÃÃÃÃ]").replace("C","[CÃ]").replace("c","[cÃ§]").replace("E","[EÃÃÃ]").replace("I","[IÃÃÃÃ]").replace("D","[DÃ]").replace("N","[NÃ]").replace("O","[OÃÃÃÃÃÃ]").replace("X","[XÃ]").replace("U","[UÃÃÃÃ]").replace("Y","[YÃ]").replace("s","[sÃ]").replace("e","[eÃ¨eÃ©ÃªÃ«Ä]").replace("i","[iÃ¬Ã­Ã®Ã¯]").replace("d","[dÃ°]").replace("n","[nÃ±]").replace("o","[oÃ²Ã³Ã´ÃµÃ¶Ã¸]").replace("u","[uÃ¹ÃºÃ»Ã¼]").replace("y","[yÃ½Ã¿]")}},{}],266:[function(u,e,l){(function(r,a){(function(){var n=u("process/browser.js").nextTick,e=Function.prototype.apply,i=Array.prototype.slice,o={},s=0;function t(e,t){this._id=e,this._clearFn=t}l.setTimeout=function(){return new t(e.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new t(e.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(e){e.close()},t.prototype.unref=t.prototype.ref=function(){},t.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},l.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},l._unrefActive=l.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},l.setImmediate="function"==typeof r?r:function(e){var t=s++,r=!(arguments.length<2)&&i.call(arguments,1);return o[t]=!0,n(function(){o[t]&&(r?e.apply(null,r):e.call(null),l.clearImmediate(t))}),t},l.clearImmediate="function"==typeof a?a:function(e){delete o[e]}}).call(this)}).call(this,u("timers").setImmediate,u("timers").clearImmediate)},{"process/browser.js":262,timers:266}],267:[function(o,n,i){(function(r){(function(){var e,t;e=r,t=function(){return n={},i.m=r=[function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(t,e){function r(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=r=function(e){return typeof e}:t.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.exports=r},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t,r){"use strict";e.exports=function(){function m(e,t,r,n){return r=r||" ",r=e.length>=t?"":new Array(1+t-e.length>>>0).join(r),n?e+r:r+e}function g(e,t,r,n,i){var o=n-e.length;return 0<o&&(e=r||"0"!==i?m(e,n,i,r):[e.slice(0,t.length),m("",o,"0",!0),e.slice(t.length)].join("")),e}function v(e,t,r,n,i,o){return e=m((e>>>0).toString(t),i||0,"0",!1),g(e,"",r,n,o)}function b(e,t,r,n,i){return null!=n&&(e=e.slice(0,n)),g(e,"",t,r,i)}var w=arguments,x=0,e=w[x++];try{return e.replace(/%%|%(?:(\d+)\$)?((?:[-+#0 ]|'[\s\S])*)(\d+)?(?:\.(\d*))?([\s\S])/g,function(e,t,r,n,i,o){var s,a,u,l,c;if("%%"===e)return"%";for(var h=" ",p=!1,f="",d=0,y=r.length;d<y;d++)switch(r.charAt(d)){case" ":case"0":h=r.charAt(d);break;case"+":f="+";break;case"-":p=!0;break;case"'":d+1<y&&(h=r.charAt(d+1),d++)}if(n=n?+n:0,!isFinite(n))throw new Error("Width must be finite");if(i=i?+i:"d"===o?0:-1<"fFeE".indexOf(o)?6:void 0,t&&0==+t)throw new Error("Argument number must be greater than zero");if(t&&w.length<=+t)throw new Error("Too few arguments");switch(c=t?w[+t]:w[x++],o){case"%":return"%";case"s":return b(c+"",p,n,i,h);case"c":return b(String.fromCharCode(+c),p,n,i,h);case"b":return v(c,2,p,n,i,h);case"o":return v(c,8,p,n,i,h);case"x":return v(c,16,p,n,i,h);case"X":return v(c,16,p,n,i,h).toUpperCase();case"u":return v(c,10,p,n,i,h);case"i":case"d":return s=+c||0,c=(a=(s=Math.round(s-s%1))<0?"-":f)+m(String(Math.abs(s)),i,"0",!1),p&&"0"===h&&(h=" "),g(c,a,p,n,h);case"e":case"E":case"f":case"F":case"g":case"G":return a=(s=+c)<0?"-":f,u=["toExponential","toFixed","toPrecision"]["efg".indexOf(o.toLowerCase())],l=["toString","toUpperCase"]["eEfFgG".indexOf(o)%2],c=a+Math.abs(s)[u](i),g(c,a,p,n,h)[l]();default:return""}})}catch(e){return!1}}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return _typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof3(e)};e.exports=function(e){switch(void 0===e?"undefined":n(e)){case"number":return isNaN(e)||!isFinite(e)?0:e<0?Math.ceil(e):Math.floor(e);case"string":return parseInt(e,10)||0;case"boolean":default:return+!!e}}},function(e,t){e.exports=o("path")},function(e,t,r){"use strict";e.exports=r(8)()},function(e,t,r){"use strict";e.exports=function e(){var t={VERSION:"1.14.0"};return r(9)(t),r(10)(t),r(11)(t),r(18)(t),r(19)(t),r(20)(t),r(31)(t),r(32)(t),r(34)(t),r(35)(t),r(36)(t),r(37)(t),r(38)(t),r(39)(t),r(40)(t),t.exports.factory=e,t.exports}},function(e,t,r){"use strict";var n=r(0)(r(2));function i(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){(0,n.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}e.exports=function(v){function h(e,t){if(e.template.options.rethrow)throw"string"==typeof t&&(t=new v.Error(t)),"TwigException"!==t.type||t.file||(t.file=e.template.id),t;if(v.log.error("Error parsing twig template "+e.template.id+": "),t.stack?v.log.error(t.stack):v.log.error(t.toString()),v.debug)return t.toString()}return v.trace=!1,v.debug=!1,v.cache=!0,v.noop=function(){},v.merge=function(t,r,n){return Object.keys(r).forEach(function(e){(!n||e in t)&&(t[e]=r[e])}),t},v.Error=function(e,t){this.message=e,this.name="TwigException",this.type="TwigException",this.file=t},v.Error.prototype.toString=function(){return this.name+": "+this.message},v.log={trace:function(){if(v.trace&&console){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.log(Array.prototype.slice.call(t))}},debug:function(){if(v.debug&&console){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];console.log(Array.prototype.slice.call(t))}}},"undefined"==typeof console?v.log.error=function(){}:void 0!==console.error?v.log.error=function(){var e;(e=console).error.apply(e,arguments)}:void 0!==console.log&&(v.log.error=function(){var e;(e=console).log.apply(e,arguments)}),v.token={},v.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw",outputWhitespacePre:"output_whitespace_pre",outputWhitespacePost:"output_whitespace_post",outputWhitespaceBoth:"output_whitespace_both",logicWhitespacePre:"logic_whitespace_pre",logicWhitespacePost:"logic_whitespace_post",logicWhitespaceBoth:"logic_whitespace_both"},v.token.definitions=[{type:v.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:v.token.type.raw,open:"{% verbatim %}",close:"{% endverbatim %}"},{type:v.token.type.outputWhitespacePre,open:"{{-",close:"}}"},{type:v.token.type.outputWhitespacePost,open:"{{",close:"-}}"},{type:v.token.type.outputWhitespaceBoth,open:"{{-",close:"-}}"},{type:v.token.type.logicWhitespacePre,open:"{%-",close:"%}"},{type:v.token.type.logicWhitespacePost,open:"{%",close:"-%}"},{type:v.token.type.logicWhitespaceBoth,open:"{%-",close:"-%}"},{type:v.token.type.output,open:"{{",close:"}}"},{type:v.token.type.logic,open:"{%",close:"%}"},{type:v.token.type.comment,open:"{#",close:"#}"}],v.token.strings=['"',"'"],v.token.findStart=function(e){for(var t,r,n,i={position:null,def:null},o=null,s=v.token.definitions.length,a=0;a<s;a++)t=v.token.definitions[a],r=e.indexOf(t.open),n=e.indexOf(t.close),v.log.trace("Twig.token.findStart: ","Searching for ",t.open," found at ",r),0<=r&&t.open.length!==t.close.length&&n<0||(0<=r&&(null===i.position||r<i.position)?(i.position=r,i.def=t,o=n):0<=r&&null!==i.position&&r===i.position&&(t.open.length>i.def.open.length?(i.position=r,i.def=t,o=n):t.open.length===i.def.open.length&&(t.close.length,i.def.close.length,0<=n&&n<o&&(i.position=r,i.def=t,o=n))));return i},v.token.findEnd=function(e,t,r){for(var n,i,o,s,a,u=null,l=!1,c=0,h=null,p=null,f=null;!l;){if(p=h=null,!(0<=(n=e.indexOf(t.close,c))))throw new v.Error("Unable to find closing bracket '"+t.close+"' opened near template position "+r);if(u=n,l=!0,t.type===v.token.type.comment)break;if(t.type===v.token.type.raw)break;for(a=v.token.strings.length,s=0;s<a;s+=1)0<(i=e.indexOf(v.token.strings[s],c))&&i<n&&(null===h||i<h)&&(h=i,p=v.token.strings[s]);if(null!==h)for(f=h+1,u=null,l=!1;;){if((o=e.indexOf(p,f))<0)throw v.Error("Unclosed string in template");if("\\"!==e.slice(o-1,o)){c=o+1;break}f=o+1}}return u},v.tokenize=function(e){for(var t,r=[],n=0,i=null;0<e.length;)if(t=v.token.findStart(e),v.log.trace("Twig.tokenize: ","Found token: ",t),null===t.position)r.push({type:v.token.type.raw,value:e}),e="";else{if(0<t.position&&r.push({type:v.token.type.raw,value:e.slice(0,Math.max(0,t.position))}),e=e.slice(t.position+t.def.open.length),n+=t.position+t.def.open.length,i=v.token.findEnd(e,t.def,n),v.log.trace("Twig.tokenize: ","Token ends at ",i),r.push({type:t.def.type,value:e.slice(0,Math.max(0,i)).trim()}),"\n"===e.slice(i+t.def.close.length,i+t.def.close.length+1))switch(t.def.type){case"logic_whitespace_pre":case"logic_whitespace_post":case"logic_whitespace_both":case"logic":i+=1}e=e.slice(i+t.def.close.length),n+=i+t.def.close.length}return r},v.compile=function(e){var t=this;try{for(var r,n,i,o,s,a,u=[],l=[],c=[],h=null,p=null,f=null,d=null,y=null,m=function(e){v.expression.compile.call(t,e),(0<l.length?c:u).push(e)},g=function(e){if(n=v.logic.compile.call(t,e),o=n.type,s=v.logic.handler[o].open,a=v.logic.handler[o].next,v.log.trace("Twig.compile: ","Compiled logic token to ",n," next is: ",a," open is : ",s),void 0!==s&&!s){if(h=l.pop(),!v.logic.handler[h.type].next.includes(o))throw new Error(o+" not expected after a "+h.type);h.output=h.output||[],h.output=h.output.concat(c),c=[],y={type:v.token.type.logic,token:h},(0<l.length?c:u).push(y)}void 0!==a&&0<a.length?(v.log.trace("Twig.compile: ","Pushing ",n," to logic stack."),0<l.length&&((h=l.pop()).output=h.output||[],h.output=h.output.concat(c),l.push(h),c=[]),l.push(n)):void 0!==s&&s&&(y={type:v.token.type.logic,token:n},(0<l.length?c:u).push(y))};0<e.length;){switch(r=e.shift(),p=u[u.length-1],f=c[c.length-1],d=e[0],v.log.trace("Compiling token ",r),r.type){case v.token.type.raw:(0<l.length?c:u).push(r);break;case v.token.type.logic:g.call(t,r);break;case v.token.type.comment:break;case v.token.type.output:m.call(t,r);break;case v.token.type.logicWhitespacePre:case v.token.type.logicWhitespacePost:case v.token.type.logicWhitespaceBoth:case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:switch(r.type!==v.token.type.outputWhitespacePost&&r.type!==v.token.type.logicWhitespacePost&&(p&&p.type===v.token.type.raw&&(u.pop(),p.value=p.value.trimEnd(),u.push(p)),f&&f.type===v.token.type.raw&&(c.pop(),f.value=f.value.trimEnd(),c.push(f))),r.type){case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:m.call(t,r);break;case v.token.type.logicWhitespacePre:case v.token.type.logicWhitespacePost:case v.token.type.logicWhitespaceBoth:g.call(t,r)}r.type!==v.token.type.outputWhitespacePre&&r.type!==v.token.type.logicWhitespacePre&&d&&d.type===v.token.type.raw&&(e.shift(),d.value=d.value.trimStart(),e.unshift(d))}v.log.trace("Twig.compile: "," Output: ",u," Logic Stack: ",l," Pending Output: ",c)}if(0<l.length)throw i=l.pop(),new Error("Unable to find an end tag for "+i.type+", expecting one of "+i.next);return u}catch(e){if(t.options.rethrow)throw"TwigException"!==e.type||e.file||(e.file=t.id),e;v.log.error("Error compiling twig template "+t.id+": "),e.stack?v.log.error(e.stack):v.log.error(e.toString())}},v.prepare=function(e){v.log.debug("Twig.prepare: ","Tokenizing ",e);e=v.tokenize.call(this,e);v.log.debug("Twig.prepare: ","Compiling ",e);e=v.compile.call(this,e);return v.log.debug("Twig.prepare: ","Compiled ",e),e},v.output=function(e){var t=this.options.autoescape;if(!t)return e.join("");var r="string"==typeof t?t:"html",e=e.map(function(e){return!e||!0===e.twigMarkup||e.twigMarkup===r||"html"===r&&"html_attr"===e.twigMarkup||(e=v.filters.escape(e,[r])),e});if(0===e.length)return"";e=e.join("");return 0===e.length?"":new v.Markup(e,!0)},v.Templates={loaders:{},parsers:{},registry:{}},v.validateId=function(e){if("prototype"===e)throw new v.Error(e+" is not a valid twig identifier");if(v.cache&&Object.hasOwnProperty.call(v.Templates.registry,e))throw new v.Error("There is already a template with the ID "+e);return!0},v.Templates.registerLoader=function(e,t,r){if("function"!=typeof t)throw new v.Error("Unable to add loader for "+e+": Invalid function reference given.");r&&(t=t.bind(r)),this.loaders[e]=t},v.Templates.unRegisterLoader=function(e){this.isRegisteredLoader(e)&&delete this.loaders[e]},v.Templates.isRegisteredLoader=function(e){return Object.hasOwnProperty.call(this.loaders,e)},v.Templates.registerParser=function(e,t,r){if("function"!=typeof t)throw new v.Error("Unable to add parser for "+e+": Invalid function regerence given.");r&&(t=t.bind(r)),this.parsers[e]=t},v.Templates.unRegisterParser=function(e){this.isRegisteredParser(e)&&delete this.parsers[e]},v.Templates.isRegisteredParser=function(e){return Object.hasOwnProperty.call(this.parsers,e)},v.Templates.save=function(e){if(void 0===e.id)throw new v.Error("Unable to save template with no id");v.Templates.registry[e.id]=e},v.Templates.load=function(e){return Object.hasOwnProperty.call(v.Templates.registry,e)?v.Templates.registry[e]:null},v.Templates.loadRemote=function(e,t,r,n){var i=void 0===t.id?e:t.id,o=v.Templates.registry[i];return v.cache&&void 0!==o?("function"==typeof r&&r(o),o):(t.parser=t.parser||"twig",t.id=i,void 0===t.async&&(t.async=!0),(this.loaders[t.method]||this.loaders.fs).call(this,e,t,r,n))},v.Block=function(e,t){this.template=e,this.token=t},v.Block.prototype.render=function(t,r){var n=t.template;return t.template=this.template,(this.token.expression?v.expression.parseAsync.call(t,this.token.output,r):t.parseAsync(this.token.output,r)).then(function(e){return v.expression.parseAsync.call(t,{type:v.expression.type.string,value:e},r)}).then(function(e){return t.template=n,e})},v.ParseState=function(e,t){this.renderedBlocks={},this.overrideBlocks=void 0===t?{}:t,this.context={},this.macros={},this.nestingStack=[],this.template=e},v.ParseState.prototype.getBlock=function(e,t){var r;return!0!==t&&(r=this.overrideBlocks[e]),void 0===r&&(r=this.template.getBlock(e,t)),void 0===r&&null!==this.template.parentTemplate&&(r=this.template.parentTemplate.getBlock(e)),r},v.ParseState.prototype.getBlocks=function(e){var t={};return!1!==e&&null!==this.template.parentTemplate&&this.template.parentTemplate!==this.template&&(t=this.template.parentTemplate.getBlocks()),t=o(o(o({},t),this.template.getBlocks()),this.overrideBlocks)},v.ParseState.prototype.getNestingStackToken=function(t){var r;return this.nestingStack.forEach(function(e){void 0===r&&e.type===t&&(r=e)}),r},v.ParseState.prototype.parse=function(e,t,r){var n,i=this,o=[],s=null,a=!0,u=!0;function l(e){o.push(e)}function c(e){void 0!==e.chain&&(u=e.chain),void 0!==e.context&&(i.context=e.context),void 0!==e.output&&o.push(e.output)}if(t&&(i.context=t),n=v.async.forEach(e,function(e){switch(v.log.debug("Twig.ParseState.parse: ","Parsing token: ",e),e.type){case v.token.type.raw:o.push(v.filters.raw(e.value));break;case v.token.type.logic:return v.logic.parseAsync.call(i,e.token,i.context,u).then(c);case v.token.type.comment:break;case v.token.type.outputWhitespacePre:case v.token.type.outputWhitespacePost:case v.token.type.outputWhitespaceBoth:case v.token.type.output:return v.log.debug("Twig.ParseState.parse: ","Output token: ",e.stack),v.expression.parseAsync.call(i,e.stack,i.context).then(l)}}).then(function(){return o=v.output.call(i.template,o),a=!1,o}).catch(function(e){r&&h(i,e),s=e}),r)return n;if(null!==s)return h(i,s);if(a)throw new v.Error("You are using Twig.js in sync mode in combination with async extensions.");return o},v.Template=function(e){var t=e.data,r=e.id,n=e.base,i=e.path,o=e.url,s=e.name,a=e.method,e=e.options;this.base=n,this.blocks={defined:{},imported:{}},this.id=r,this.method=a,this.name=s,this.options=e,this.parentTemplate=null,this.path=i,this.url=o,e="String",i=t,o=Object.prototype.toString.call(i).slice(8,-1),this.tokens=null!=i&&o===e?v.prepare.call(this,t):t,void 0!==r&&v.Templates.save(this)},v.Template.prototype.getBlock=function(e,t){var r,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return!0!==t&&(r=this.blocks.defined[e]),n&&void 0===r&&(r=this.blocks.imported[e]),void 0===r&&null!==this.parentTemplate&&(r=this.parentTemplate.getBlock(e,t,!1)),r},v.Template.prototype.getBlocks=function(){return o(o(o({},{}),this.blocks.imported),this.blocks.defined)},v.Template.prototype.render=function(e,i,t){var o=this;return i=i||{},v.async.potentiallyAsync(o,t,function(){var n=new v.ParseState(o,i.blocks);return n.parseAsync(o.tokens,e).then(function(e){var t,r;return null!==o.parentTemplate?(o.options.allowInlineIncludes&&(t=v.Templates.load(o.parentTemplate))&&(t.options=o.options),t||(r=v.path.parsePath(o,o.parentTemplate),t=v.Templates.loadRemote(r,{method:o.getLoaderMethod(),base:o.base,async:!1,id:r,options:o.options})),o.parentTemplate=t,o.parentTemplate.renderAsync(n.context,{blocks:n.getBlocks(!1),isInclude:!0})):!0===i.isInclude?e:e.valueOf()})})},v.Template.prototype.importFile=function(e){var t,r=null;if(this.url||!this.options.allowInlineIncludes)return r=v.path.parsePath(this,e),t=v.Templates.loadRemote(r,{method:this.getLoaderMethod(),base:this.base,async:!1,options:this.options,id:r});if(e=this.path?v.path.parsePath(this,e):e,t=v.Templates.load(e),!t&&!(t=v.Templates.loadRemote(r,{id:e,method:this.getLoaderMethod(),async:!1,path:e,options:this.options})))throw new v.Error("Unable to find the template "+e);return t.options=this.options,t},v.Template.prototype.getLoaderMethod=function(){return this.path?"fs":this.url?"ajax":this.method||"fs"},v.Template.prototype.compile=function(e){return v.compiler.compile(this,e)},v.Markup=function(e,t){if("string"!=typeof e)return e;e=new String(e);return e.twigMarkup=void 0===t||t,e},v}},function(e,t,r){"use strict";e.exports=function(i){return i.compiler={module:{}},i.compiler.compile=function(e,t){var r=JSON.stringify(e.tokens),n=e.id,e=null;if(t.module){if(void 0===i.compiler.module[t.module])throw new i.Error("Unable to find module type "+t.module);e=i.compiler.module[t.module](n,r,t.twig)}else e=i.compiler.wrap(n,r);return e},i.compiler.module={amd:function(e,t,r){return'define(["'+r+'"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = '+i.compiler.wrap(e,t)+"\n\treturn templates;\n});"},node:function(e,t){return'var twig = require("twig").twig;\nexports.template = '+i.compiler.wrap(e,t)},cjs2:function(e,t,r){return'module.declare([{ twig: "'+r+'" }], function (require, exports, module) {\n\tvar twig = require("twig").twig;\n\texports.template = '+i.compiler.wrap(e,t)+"\n});"}},i.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},i}},function(e,t,r){"use strict";var n=r(0),c=n(r(1)),s=n(r(12));e.exports=function(f){function l(e,t,r){return t?f.expression.parseAsync.call(e,t,r):f.Promise.resolve(!1)}for(f.expression={},r(17)(f),f.expression.reservedWords=["true","false","null","TRUE","FALSE","NULL","_context","and","b-and","or","b-or","b-xor","in","not in","if","matches","starts","ends","with"],f.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",slice:"Twig.expression.type.slice",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},subexpression:{start:"Twig.expression.type.subexpression.start",end:"Twig.expression.type.subexpression.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},f.expression.set={operations:[f.expression.type.filter,f.expression.type.operator.unary,f.expression.type.operator.binary,f.expression.type.array.end,f.expression.type.object.end,f.expression.type.parameter.end,f.expression.type.subexpression.end,f.expression.type.comma,f.expression.type.test],expressions:[f.expression.type._function,f.expression.type.bool,f.expression.type.string,f.expression.type.variable,f.expression.type.number,f.expression.type._null,f.expression.type.context,f.expression.type.parameter.start,f.expression.type.array.start,f.expression.type.object.start,f.expression.type.subexpression.start,f.expression.type.operator.unary]},f.expression.set.operationsExtended=f.expression.set.operations.concat([f.expression.type.key.period,f.expression.type.key.brackets,f.expression.type.slice]),f.expression.fn={compile:{push:function(e,t,r){r.push(e)},pushBoth:function(e,t,r){r.push(e),t.push(e)}},parse:{push:function(e,t){t.push(e)},pushValue:function(e,t){t.push(e.value)}}},f.expression.definitions=[{type:f.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_]\w*(\s?as)?)/,next:f.expression.set.operations.concat([f.expression.type.parameter.start]),compile:function(e,t,r){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,r.push(e)},parse:function(t,r,e){var n=r.pop();return l(this,t.params,e).then(function(e){e=f.test(t.filter,n,e);"not"===t.modifier?r.push(!e):r.push(e)})}},{type:f.expression.type.comma,regex:/^,/,next:f.expression.set.expressions.concat([f.expression.type.array.end,f.expression.type.object.end]),compile:function(e,t,r){var n,i=t.length-1;for(delete e.match,delete e.value;0<=i;i--){if((n=t.pop()).type===f.expression.type.object.start||n.type===f.expression.type.parameter.start||n.type===f.expression.type.array.start){t.push(n);break}r.push(n)}r.push(e)}},{type:f.expression.type.number,regex:/^-?\d+(\.\d+)?/,next:f.expression.set.operations,compile:function(e,t,r){e.value=Number(e.value),r.push(e)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.operator.binary,regex:/(^\?\?|^\?:|^(b-and)|^(b-or)|^(b-xor)|^[+\-~%?]|^[:](?!\d\])|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^(and)[(|\s+]|^(or)[(|\s+]|^(in)[(|\s+]|^(not in)[(|\s+]|^(matches)|^(starts with)|^(ends with)|^\.\.)/,next:f.expression.set.expressions,transform:function(e,t){switch(e[0]){case"and(":case"or(":case"in(":case"not in(":return t[t.length-1].value=e[2],e[0];default:return""}},compile:function(e,t,r){delete e.match,e.value=e.value.trim();var n=e.value,i=f.expression.operator.lookup(n,e);for(f.log.trace("Twig.expression.compile: ","Operator: ",i," from ",n);0<t.length&&(t[t.length-1].type===f.expression.type.operator.unary||t[t.length-1].type===f.expression.type.operator.binary)&&(i.associativity===f.expression.operator.leftToRight&&i.precidence>=t[t.length-1].precidence||i.associativity===f.expression.operator.rightToLeft&&i.precidence>t[t.length-1].precidence);){var o=t.pop();r.push(o)}if(":"===n){if(!t[t.length-1]||"?"!==t[t.length-1].value){n=r.pop();if(n.type===f.expression.type.string||n.type===f.expression.type.variable)e.key=n.value;else if(n.type===f.expression.type.number)e.key=n.value.toString();else{if(!n.expression||n.type!==f.expression.type.parameter.end&&n.type!==f.expression.type.subexpression.end)throw new f.Error("Unexpected value before ':' of "+n.type+" = "+n.value);e.params=n.params}r.push(e)}}else t.push(i)},parse:function(t,r,n){if(t.key)r.push(t);else{if(t.params)return f.expression.parseAsync.call(this,t.params,n).then(function(e){t.key=e,r.push(t),n.loop||delete t.params});f.expression.operator.parse(t.value,r)}}},{type:f.expression.type.operator.unary,regex:/(^not\s+)/,next:f.expression.set.expressions,compile:function(e,t,r){delete e.match,e.value=e.value.trim();var n=e.value,i=f.expression.operator.lookup(n,e);for(f.log.trace("Twig.expression.compile: ","Operator: ",i," from ",n);0<t.length&&(t[t.length-1].type===f.expression.type.operator.unary||t[t.length-1].type===f.expression.type.operator.binary)&&(i.associativity===f.expression.operator.leftToRight&&i.precidence>=t[t.length-1].precidence||i.associativity===f.expression.operator.rightToLeft&&i.precidence>t[t.length-1].precidence);){var o=t.pop();r.push(o)}t.push(i)},parse:function(e,t){f.expression.operator.parse(e.value,t)}},{type:f.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,next:f.expression.set.operationsExtended,compile:function(e,t,r){var n=e.value;delete e.match,n='"'===n.slice(0,1)?n.replace('\\"','"'):n.replace("\\'","'"),e.value=n.slice(1,-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),f.log.trace("Twig.expression.compile: ","String value: ",e.value),r.push(e)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.subexpression.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.subexpression.end]),compile:function(e,t,r){e.value="(",r.push(e),t.push(e)},parse:f.expression.fn.parse.push},{type:f.expression.type.subexpression.end,regex:/^\)/,next:f.expression.set.operationsExtended,validate:function(e,t){for(var r=t.length-1,n=!1,i=!1,o=0;!n&&0<=r;){var s=t[r];(n=s.type===f.expression.type.subexpression.start)&&i&&(n=i=!1),s.type===f.expression.type.parameter.start?o++:s.type===f.expression.type.parameter.end?o--:s.type===f.expression.type.subexpression.end&&(i=!0),r--}return n&&0===o},compile:function(e,t,r){for(var n=e,i=t.pop();0<t.length&&i.type!==f.expression.type.subexpression.start;)r.push(i),i=t.pop();for(var o=[];e.type!==f.expression.type.subexpression.start;)o.unshift(e),e=r.pop();o.unshift(e),void 0===(i=t[t.length-1])||i.type!==f.expression.type._function&&i.type!==f.expression.type.filter&&i.type!==f.expression.type.test&&i.type!==f.expression.type.key.brackets?(n.expression=!0,o.pop(),o.shift(),n.params=o,r.push(n)):(n.expression=!1,i.params=o)},parse:function(e,t,r){if(e.expression)return f.expression.parseAsync.call(this,e.params,r).then(function(e){t.push(e)});throw new f.Error("Unexpected subexpression end when token is not marked as an expression")}},{type:f.expression.type.parameter.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.parameter.end]),validate:function(e,t){t=t[t.length-1];return t&&!f.expression.reservedWords.includes(t.value.trim())},compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.parameter.end,regex:/^\)/,next:f.expression.set.operationsExtended,compile:function(e,t,r){for(var n=e,i=t.pop();0<t.length&&i.type!==f.expression.type.parameter.start;)r.push(i),i=t.pop();for(var o=[];e.type!==f.expression.type.parameter.start;)o.unshift(e),e=r.pop();o.unshift(e),void 0===(e=r[r.length-1])||e.type!==f.expression.type._function&&e.type!==f.expression.type.filter&&e.type!==f.expression.type.test&&e.type!==f.expression.type.key.brackets?(n.expression=!0,o.pop(),o.shift(),n.params=o,r.push(n)):(n.expression=!1,e.params=o)},parse:function(e,t,r){var n,i=[],o=!1;if(e.expression)return f.expression.parseAsync.call(this,e.params,r).then(function(e){t.push(e)});for(;0<t.length;){if((n=t.pop())&&n.type&&n.type===f.expression.type.parameter.start){o=!0;break}i.unshift(n)}if(!o)throw new f.Error("Expected end of parameter set.");t.push(i)}},{type:f.expression.type.slice,regex:/^\[(\d*:\d*)\]/,next:f.expression.set.operationsExtended,compile:function(e,t,r){var n=e.match[1].split(":"),i=n[0]?parseInt(n[0],10):void 0,n=n[1]?parseInt(n[1],10):void 0;e.value="slice",e.params=[i,n],n||(e.params=[i]),r.push(e)},parse:function(e,t){var r=t.pop(),n=e.params;t.push(f.filter.call(this,e.value,r,n))}},{type:f.expression.type.array.start,regex:/^\[/,next:f.expression.set.expressions.concat([f.expression.type.array.end]),compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.array.end,regex:/^\]/,next:f.expression.set.operationsExtended,compile:function(e,t,r){for(var n,i=t.length-1;0<=i&&(n=t.pop()).type!==f.expression.type.array.start;i--)r.push(n);r.push(e)},parse:function(e,t){for(var r,n=[],i=!1;0<t.length;){if((r=t.pop())&&r.type&&r.type===f.expression.type.array.start){i=!0;break}n.unshift(r)}if(!i)throw new f.Error("Expected end of array.");t.push(n)}},{type:f.expression.type.object.start,regex:/^\{/,next:f.expression.set.expressions.concat([f.expression.type.object.end]),compile:f.expression.fn.compile.pushBoth,parse:f.expression.fn.parse.push},{type:f.expression.type.object.end,regex:/^\}/,next:f.expression.set.operationsExtended,compile:function(e,t,r){for(var n,i=t.length-1;0<=i&&(!(n=t.pop())||n.type!==f.expression.type.object.start);i--)r.push(n);r.push(e)},parse:function(e,t){for(var r,n={},i=!1,o=!1,s=null;0<t.length;){if((r=t.pop())&&r.type&&r.type===f.expression.type.object.start){i=!0;break}if(r&&r.type&&(r.type===f.expression.type.operator.binary||r.type===f.expression.type.operator.unary)&&r.key){if(!o)throw new f.Error("Missing value for key '"+r.key+"' in object definition.");n[r.key]=s,void 0===n._keys&&(n._keys=[]),n._keys.unshift(r.key),s=null,o=!1}else o=!0,s=r}if(!i)throw new f.Error("Unexpected end of object.");t.push(n)}},{type:f.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_-]*)/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(e,t,r){e.value=e.match[1],r.push(e)},parse:function(t,r,e){var n=r.pop(),i=this;return l(i,t.params,e).then(function(e){return f.filter.call(i,t.value,n,e)}).then(function(e){r.push(e)})}},{type:f.expression.type._function,regex:/^([a-zA-Z_]\w*)\s*\(/,next:f.expression.type.parameter.start,validate:function(e){return e[1]&&!f.expression.reservedWords.includes(e[1])},transform:function(){return"("},compile:function(e,t,r){var n=e.match[1];e.fn=n,delete e.match,delete e.value,r.push(e)},parse:function(e,t,r){var n,i=this,o=e.fn;return l(i,e.params,r).then(function(e){if(f.functions[o])n=f.functions[o].apply(i,e);else{if("function"!=typeof r[o])throw new f.Error(o+" function does not exist and is not defined in the context");n=r[o].apply(r,(0,s.default)(e))}return n}).then(function(e){t.push(e)})}},{type:f.expression.type.variable,regex:/^[a-zA-Z_]\w*/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,validate:function(e){return!f.expression.reservedWords.includes(e[0])},parse:function(t,r,e){var n=this;return f.expression.resolveAsync.call(n,e[t.value],e).then(function(e){if(n.template.options.strictVariables&&void 0===e)throw new f.Error('Variable "'+t.value+'" does not exist.');r.push(e)})}},{type:f.expression.type.key.period,regex:/^\.(\w+)/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(e,t,r){e.key=e.match[1],delete e.match,delete e.value,r.push(e)},parse:function(e,t,r,n){var i,o=this,s=e.key,a=t.pop();if(a&&!Object.prototype.hasOwnProperty.call(a,s)&&o.template.options.strictVariables)throw 0<Object.keys(a).length?new f.Error('Key "'+s+'" for object with keys "'+Object.keys(a).join(", ")+'" does not exist.'):new f.Error('Key "'+s+'" does not exist as the object is empty.');return l(o,e.params,r).then(function(e){var t;return i=null==a?void 0:(t=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},"object"===(0,c.default)(a)&&s in a?a[s]:a["get"+t(s)]?a["get"+t(s)]:a["is"+t(s)]?a["is"+t(s)]:void 0),f.expression.resolveAsync.call(o,i,r,e,n,a)}).then(function(e){t.push(e)})}},{type:f.expression.type.key.brackets,regex:/^\[([^\]:]*)\]/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:function(e,t,r){var n=e.match[1];delete e.value,delete e.match,e.stack=f.expression.compile({value:n}).stack,r.push(e)},parse:function(t,r,n,i){var o,s,a=this,u=null;return l(a,t.params,n).then(function(e){return u=e,f.expression.parseAsync.call(a,t.stack,n)}).then(function(e){if((o=r.pop())&&!Object.prototype.hasOwnProperty.call(o,e)&&a.template.options.strictVariables){var t=Object.keys(o);throw 0<t.length?new f.Error('Key "'+e+'" for array with keys "'+t.join(", ")+'" does not exist.'):new f.Error('Key "'+e+'" does not exist as the array is empty.')}return null==o?null:(s="object"===(0,c.default)(o)&&e in o?o[e]:null,f.expression.resolveAsync.call(a,s,o,u,i))}).then(function(e){r.push(e)})}},{type:f.expression.type._null,regex:/^(null|NULL|none|NONE)/,next:f.expression.set.operations,compile:function(e,t,r){delete e.match,e.value=null,r.push(e)},parse:f.expression.fn.parse.pushValue},{type:f.expression.type.context,regex:/^_context/,next:f.expression.set.operationsExtended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,parse:function(e,t,r){t.push(r)}},{type:f.expression.type.bool,regex:/^(true|TRUE|false|FALSE)/,next:f.expression.set.operations,compile:function(e,t,r){e.value="true"===e.match[0].toLowerCase(),delete e.match,r.push(e)},parse:f.expression.fn.parse.pushValue}],f.expression.resolveAsync=function(t,r,e,n,i){var o=this;if("function"!=typeof t)return f.Promise.resolve(t);e=f.Promise.resolve(e);return n&&n.type===f.expression.type.parameter.end&&(e=e.then(function(){return n.params&&f.expression.parseAsync.call(o,n.params,r,!0)}).then(function(e){return n.cleanup=!0,e})),e.then(function(e){return t.apply(i||r,e||[])})},f.expression.resolve=function(e,t,r,n,i){return f.async.potentiallyAsync(this,!1,function(){return f.expression.resolveAsync.call(this,e,t,r,n,i)})},f.expression.handler={},f.expression.extendType=function(e){f.expression.type[e]="Twig.expression.type."+e},f.expression.extend=function(e){if(!e.type)throw new f.Error("Unable to extend logic definition. No type provided for "+e);f.expression.handler[e.type]=e};0<f.expression.definitions.length;)f.expression.extend(f.expression.definitions.shift());return f.expression.tokenize=function(e){function t(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=arguments.length-2,i=new Array(n);0<n--;)i[n]=t[n];if(f.log.trace("Twig.expression.tokenize","Matched a ",s," regular expression of ",i),h&&!h.includes(s))return p.push(s+" cannot follow a "+l[l.length-1].type+" at template:"+c+" near '"+i[0].slice(0,20)+"...'"),i[0];var o=f.expression.handler[s];return o.validate&&!o.validate(i,l)?i[0]:(p=[],l.push({type:s,value:i[0],match:i}),u=!0,h=a,c+=i[0].length,o.transform?o.transform(i,l):"")}var s,r,n,a,u,l=[],c=0,h=null,p=[];for(f.log.debug("Twig.expression.tokenize","Tokenizing expression ",e);0<e.length;){for(s in e=e.trim(),f.expression.handler)if(Object.hasOwnProperty.call(f.expression.handler,s)){if(a=f.expression.handler[s].next,r=f.expression.handler[s].regex,f.log.trace("Checking type ",s," on ",e),u=!1,Array.isArray(r))for(n=r.length;0<n--;)e=e.replace(r[n],t);else e=e.replace(r,t);if(u)break}if(!u)throw 0<p.length?new f.Error(p.join(" OR ")):new f.Error("Unable to parse '"+e+"' at template position"+c)}return f.log.trace("Twig.expression.tokenize","Tokenized to ",l),l},f.expression.compile=function(e){var t,r=e.value,n=f.expression.tokenize(r),i=[],o=[],s=null;for(f.log.trace("Twig.expression.compile: ","Compiling ",r);0<n.length;)t=n.shift(),s=f.expression.handler[t.type],f.log.trace("Twig.expression.compile: ","Compiling ",t),s.compile(t,o,i),f.log.trace("Twig.expression.compile: ","Stack is",o),f.log.trace("Twig.expression.compile: ","Output is",i);for(;0<o.length;)i.push(o.pop());return f.log.trace("Twig.expression.compile: ","Final output is",i),e.stack=i,delete e.value,e},f.expression.parse=function(o,s,n,e){var a=this;Array.isArray(o)||(o=[o]);var u=[],l=[],c=f.expression.type.operator.binary;return f.async.potentiallyAsync(a,e,function(){return f.async.forEach(o,function(e,t){var r,n=null,i=null;if(!e.cleanup)return o.length>t+1&&(i=o[t+1]),(n=f.expression.handler[e.type]).parse&&(r=n.parse.call(a,e,u,s,i)),e.type===c&&s.loop&&l.push(e),r}).then(function(){for(var e,t=l.length,r=null;0<t--;)(r=l[t]).params&&r.key&&delete r.key;return n&&(e=u.splice(0),u.push(e)),u.pop()})})},f}},function(e,t,r){var n=r(13),i=r(14),o=r(15),s=r(16);e.exports=function(e){return n(e)||i(e)||o(e)||s()}},function(e,t,r){var n=r(3);e.exports=function(e){if(Array.isArray(e))return n(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t,r){var n=r(3);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){"use strict";e.exports=function(a){a.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};function u(e,t){if(null==t)return null;if(void 0!==t.indexOf)return(e===t||""!==e)&&t.includes(e);for(var r in t)if(Object.hasOwnProperty.call(t,r)&&t[r]===e)return!0;return!1}return a.expression.operator.lookup=function(e,t){switch(e){case"..":t.precidence=20,t.associativity=a.expression.operator.leftToRight;break;case",":t.precidence=18,t.associativity=a.expression.operator.leftToRight;break;case"?:":case"?":case":":t.precidence=16,t.associativity=a.expression.operator.rightToLeft;break;case"??":t.precidence=15,t.associativity=a.expression.operator.rightToLeft;break;case"or":t.precidence=14,t.associativity=a.expression.operator.leftToRight;break;case"and":t.precidence=13,t.associativity=a.expression.operator.leftToRight;break;case"b-or":t.precidence=12,t.associativity=a.expression.operator.leftToRight;break;case"b-xor":t.precidence=11,t.associativity=a.expression.operator.leftToRight;break;case"b-and":t.precidence=10,t.associativity=a.expression.operator.leftToRight;break;case"==":case"!=":t.precidence=9,t.associativity=a.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":case"not in":case"in":t.precidence=8,t.associativity=a.expression.operator.leftToRight;break;case"~":case"+":case"-":t.precidence=6,t.associativity=a.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":t.precidence=5,t.associativity=a.expression.operator.leftToRight;break;case"not":t.precidence=3,t.associativity=a.expression.operator.rightToLeft;break;case"matches":case"starts with":case"ends with":t.precidence=8,t.associativity=a.expression.operator.leftToRight;break;default:throw new a.Error("Failed to lookup operator: "+e+" is an unknown operator.")}return t.operator=e,t},a.expression.operator.parse=function(e,t){var r,n,i,o,s;switch(a.log.trace("Twig.expression.operator.parse: ","Handling ",e),"?"===e&&(n=t.pop()),s=t.pop(),"not"!==e&&(r=t.pop()),"in"!==e&&"not in"!==e&&"??"!==e&&(r&&Array.isArray(r)&&(r=r.length),"?"!==e&&s&&Array.isArray(s)&&(s=s.length)),"matches"===e&&s&&"string"==typeof s&&(i=(o=s.match(/^\/(.*)\/([gims]?)$/))[1],o=o[2],s=new RegExp(i,o)),e){case":":break;case"??":void 0===r&&(r=s,s=n,n=void 0),null!=r?t.push(r):t.push(s);break;case"?:":a.lib.boolval(r)?t.push(r):t.push(s);break;case"?":void 0===r&&(r=s,s=n,n=void 0),a.lib.boolval(r)?t.push(s):t.push(n);break;case"+":s=parseFloat(s),r=parseFloat(r),t.push(r+s);break;case"-":s=parseFloat(s),r=parseFloat(r),t.push(r-s);break;case"*":s=parseFloat(s),r=parseFloat(r),t.push(r*s);break;case"/":s=parseFloat(s),r=parseFloat(r),t.push(r/s);break;case"//":s=parseFloat(s),r=parseFloat(r),t.push(Math.floor(r/s));break;case"%":s=parseFloat(s),r=parseFloat(r),t.push(r%s);break;case"~":t.push((null!=r?r.toString():"")+(null!=s?s.toString():""));break;case"not":case"!":t.push(!a.lib.boolval(s));break;case"<":t.push(r<s);break;case"<=":t.push(r<=s);break;case">":t.push(s<r);break;case">=":t.push(s<=r);break;case"===":t.push(r===s);break;case"==":t.push(r==s);break;case"!==":t.push(r!==s);break;case"!=":t.push(r!=s);break;case"or":t.push(a.lib.boolval(r)||a.lib.boolval(s));break;case"b-or":t.push(r|s);break;case"b-xor":t.push(r^s);break;case"and":t.push(a.lib.boolval(r)&&a.lib.boolval(s));break;case"b-and":t.push(r&s);break;case"**":t.push(Math.pow(r,s));break;case"not in":t.push(!u(r,s));break;case"in":t.push(u(r,s));break;case"matches":t.push(s.test(r));break;case"starts with":t.push("string"==typeof r&&0===r.indexOf(s));break;case"ends with":t.push("string"==typeof r&&r.includes(s,r.length-s.length));break;case"..":t.push(a.functions.range(r,s));break;default:throw new a.Error("Failed to parse operator: "+e+" is an unknown operator.")}},a}},function(e,t,r){"use strict";var i=r(0)(r(1));e.exports=function(m){function o(e,t){var r=Object.prototype.toString.call(t).slice(8,-1);return null!=t&&r===e}return m.filters={upper:function(e){return"string"!=typeof e?e:e.toUpperCase()},lower:function(e){return"string"!=typeof e?e:e.toLowerCase()},capitalize:function(e){return"string"!=typeof e?e:e.slice(0,1).toUpperCase()+e.toLowerCase().slice(1)},title:function(e){return"string"!=typeof e?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,r){return t+r.toUpperCase()})},length:function(e){return m.lib.is("Array",e)||"string"==typeof e?e.length:m.lib.is("Object",e)?(void 0===e._keys?Object.keys(e):e._keys).length:0},reverse:function(e){if(o("Array",e))return e.reverse();if(o("String",e))return e.split("").reverse().join("");if(o("Object",e)){var t=e._keys||Object.keys(e).reverse();return e._keys=t,e}},sort:function(i){if(o("Array",i))return i.sort();if(o("Object",i)){delete i._keys;var e=Object.keys(i).sort(function(e,t){var r,n;return i[e]>i[t]==!(i[e]<=i[t])?i[e]>i[t]?1:i[e]<i[t]?-1:0:isNaN(r=parseFloat(i[e]))||isNaN(n=parseFloat(i[t]))?"string"==typeof i[e]?i[e]>i[t].toString()?1:i[e]<i[t].toString()?-1:0:"string"==typeof i[t]?i[e].toString()>i[t]?1:i[e].toString()<i[t]?-1:0:null:n<r?1:r<n?-1:0});return i._keys=e,i}},keys:function(t){if(null!=t){var e=t._keys||Object.keys(t),r=[];return e.forEach(function(e){"_keys"!==e&&Object.hasOwnProperty.call(t,e)&&r.push(e)}),r}},url_encode:function(e){if(null!=e)return m.lib.is("Object",e)?function r(n,i){var o=[];return(n._keys||Object.keys(n)).forEach(function(e){var t;Object.prototype.hasOwnProperty.call(n,e)&&(t=i?i+"["+e+"]":e,e=n[e],o.push(m.lib.is("Object",e)||Array.isArray(e)?r(e,t):encodeURIComponent(t)+"="+encodeURIComponent(e)))}),o.join("&amp;")}(e):encodeURIComponent(e).replace("'","%27")},join:function(t,e){if(null!=t){var r="",n=[];return e&&e[0]&&(r=e[0]),o("Array",t)?n=t:(t._keys||Object.keys(t)).forEach(function(e){"_keys"!==e&&Object.hasOwnProperty.call(t,e)&&n.push(t[e])}),n.join(r)}},default:function(e,t){if(void 0!==t&&1<t.length)throw new m.Error("default filter expects one argument");return null==e||""===e?void 0===t?"":t[0]:e},json_encode:function(t){if(null==t)return"null";if("object"===(0,i.default)(t)&&o("Array",t)){var r=[];return t.forEach(function(e){r.push(m.filters.json_encode(e))}),"["+r.join(",")+"]"}if("object"===(0,i.default)(t)&&o("Date",t))return'"'+t.toISOString()+'"';if("object"!==(0,i.default)(t))return JSON.stringify(t);var e=t._keys||Object.keys(t),n=[];return e.forEach(function(e){n.push(JSON.stringify(e)+":"+m.filters.json_encode(t[e]))}),"{"+n.join(",")+"}"},merge:function(t,e){var r=[],n=0;if(o("Array",t)?e.forEach(function(e){o("Array",e)||(r={})}):r={},o("Array",r)||(r._keys=[]),o("Array",t)?t.forEach(function(e){r._keys&&r._keys.push(n),r[n]=e,n++}):(t._keys||Object.keys(t)).forEach(function(e){r[e]=t[e],r._keys.push(e);e=parseInt(e,10);!isNaN(e)&&n<=e&&(n=e+1)}),e.forEach(function(t){o("Array",t)?t.forEach(function(e){r._keys&&r._keys.push(n),r[n]=e,n++}):(t._keys||Object.keys(t)).forEach(function(e){r[e]||r._keys.push(e),r[e]=t[e];e=parseInt(e,10);!isNaN(e)&&n<=e&&(n=e+1)})}),0===e.length)throw new m.Error("Filter merge expects at least one parameter");return r},date:function(e,t){var r=m.functions.date(e),t=t&&Boolean(t.length)?t[0]:"F j, Y H:i";return m.lib.date(t.replace(/\\\\/g,"\\"),r)},date_modify:function(e,t){if(null!=e){if(void 0===t||1!==t.length)throw new m.Error("date_modify filter expects 1 argument");var r,t=t[0];return m.lib.is("Date",e)&&(r=m.lib.strtotime(t,e.getTime()/1e3)),m.lib.is("String",e)&&(r=m.lib.strtotime(t,m.lib.strtotime(e))),m.lib.is("Number",e)&&(r=m.lib.strtotime(t,e)),new Date(1e3*r)}},replace:function(e,t){if(null!=e){var r,n=t[0];for(r in n)Object.hasOwnProperty.call(n,r)&&"_keys"!==r&&(e=m.lib.replaceAll(e,r,n[r]));return e}},format:function(e,t){if(null!=e)return m.lib.vsprintf(e,t)},striptags:function(e,t){if(null!=e)return m.lib.stripTags(e,t)},escape:function(e,t){if(null!=e&&""!==e){var r="html";if(t&&Boolean(t.length)&&!0!==t[0]&&(r=t[0]),"html"===r){var n=e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return new m.Markup(n,"html")}if("js"===r){for(var i,o,s=e.toString(),a="",u=0;u<s.length;u++)s[u].match(/^[a-zA-Z0-9,._]$/)?a+=s[u]:(i=s.charAt(u),o=s.charCodeAt(u),a+={"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"}[i]||m.lib.sprintf("\\u%04s",o.toString(16).toUpperCase()));return new m.Markup(a,"js")}if("css"===r){for(var l=e.toString(),c="",h=0;h<l.length;h++)l[h].match(/^[a-zA-Z0-9]$/)?c+=l[h]:c+="\\"+l.charCodeAt(h).toString(16).toUpperCase()+" ";return new m.Markup(c,"css")}if("url"===r){n=m.filters.url_encode(e);return new m.Markup(n,"url")}if("html_attr"!==r)throw new m.Error("escape strategy unsupported");for(var p,f=e.toString(),d="",y=0;y<f.length;y++)f[y].match(/^[a-zA-Z0-9,.\-_]$/)?d+=f[y]:f[y].match(/^[&<>"]$/)?d+=f[y].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):d+=(p=f.charCodeAt(y))<=31&&9!==p&&10!==p&&13!==p?"&#xFFFD;":p<128?m.lib.sprintf("&#x%02s;",p.toString(16).toUpperCase()):m.lib.sprintf("&#x%04s;",p.toString(16).toUpperCase());return new m.Markup(d,"html_attr")}},e:function(e,t){return m.filters.escape(e,t)},nl2br:function(e){if(null!=e&&""!==e){var t="BACKSLASH_n_replace",r="<br />"+t;return e=m.filters.escape(e).replace(/\r\n/g,r).replace(/\r/g,r).replace(/\n/g,r),e=m.lib.replaceAll(e,t,"\n"),new m.Markup(e)}},number_format:function(e,t){var r=e,n=t&&t[0]?t[0]:void 0,i=t&&void 0!==t[1]?t[1]:".",e=t&&void 0!==t[2]?t[2]:",",r=String(r).replace(/[^0-9+\-Ee.]/g,""),t=isFinite(Number(r))?Number(r):0,r=isFinite(Number(n))?Math.abs(n):0,n="";return 3<(n=(r?function(e,t){t=Math.pow(10,t);return String(Math.round(e*t)/t)}(t,r):String(Math.round(t))).split("."))[0].length&&(n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,e)),(n[1]||"").length<r&&(n[1]=n[1]||"",n[1]+=new Array(r-n[1].length+1).join("0")),n.join(i)},trim:function(e,t){if(null!=e){for(var r=String(e),n=t&&t[0]?String(t[0]):" \n\r\t\f\vÂ ââââââââââââ\u2028\u2029ã",i=0;i<r.length;i++)if(!n.includes(r.charAt(i))){r=r.slice(Math.max(0,i));break}for(var o=r.length-1;0<=o;o--)if(!n.includes(r.charAt(o))){r=r.slice(0,Math.max(0,o+1));break}return n.includes(r.charAt(0))?"":r}},truncate:function(e,t){var r=30,n=!1,i="...";if(e=String(e),t&&(t[0]&&(r=t[0]),t[1]&&(n=t[1]),t[2]&&(i=t[2])),e.length>r){if(n&&-1===(r=e.indexOf(" ",r)))return e;e=e.slice(0,r)+i}return e},slice:function(e,t){if(null!=e){if(void 0===t||0===t.length)throw new m.Error("slice filter expects at least 1 argument");var r=t[0]||0,n=1<t.length?t[1]:e.length,i=0<=r?r:Math.max(e.length+r,0);if(m.lib.is("Array",e)){for(var o=[],s=i;s<i+n&&s<e.length;s++)o.push(e[s]);return o}if(m.lib.is("String",e))return e.slice(i,i+n);throw new m.Error("slice filter expects value to be an array or string")}},abs:function(e){if(null!=e)return Math.abs(e)},first:function(e){if(o("Array",e))return e[0];if(o("Object",e)){if("_keys"in e)return e[e._keys[0]]}else if("string"==typeof e)return e.slice(0,1)},split:function(e,t){if(null!=e){if(void 0===t||0===t.length||2<t.length)throw new m.Error("split filter expects 1 or 2 argument");if(m.lib.is("String",e)){var r=t[0],n=t[1],i=e.split(r);if(void 0===n)return i;if(n<0)return e.split(r,i.length+n);var o=[];if(""===r)for(;0<i.length;){for(var s="",a=0;a<n&&0<i.length;a++)s+=i.shift();o.push(s)}else{for(var u=0;u<n-1&&0<i.length;u++)o.push(i.shift());0<i.length&&o.push(i.join(r))}return o}throw new m.Error("split filter expects value to be a string")}},last:function(e){if(m.lib.is("Object",e)){var t=void 0===e._keys?Object.keys(e):e._keys;return e[t[t.length-1]]}return m.lib.is("Number",e)?e.toString().slice(-1):e[e.length-1]},raw:function(e){return new m.Markup(e||"")},batch:function(e,t){var r,n,i=t.shift(),o=t.shift();if(!m.lib.is("Array",e))throw new m.Error("batch filter expects items to be an array");if(!m.lib.is("Number",i))throw new m.Error("batch filter expects size to be a number");i=Math.ceil(i);t=m.lib.chunkArray(e,i);if(o&&e.length%i!=0){for(n=i-(r=t.pop()).length;n--;)r.push(o);t.push(r)}return t},round:function(e,t){var r=0<(t=t||[]).length?t[0]:0,t=1<t.length?t[1]:"common";if(e=parseFloat(e),r&&!m.lib.is("Number",r))throw new m.Error("round filter expects precision to be a number");if("common"===t)return m.lib.round(e,r);if(!m.lib.is("Function",Math[t]))throw new m.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[t](e*Math.pow(10,r))/Math.pow(10,r)},spaceless:function(e){return e.replace(/>\s+</g,"><").trim()}},m.filter=function(e,t,r){if(!m.filters[e])throw new m.Error("Unable to find filter "+e);return m.filters[e].call(this,t,r)},m.filter.extend=function(e,t){m.filters[e]=t},m}},function(a,e,t){"use strict";var l=t(0)(t(1));a.exports=function(s){return s.functions={range:function(e,t,r){var n,i=[],o=r||1,s=!1,a=isNaN(e)||isNaN(t)?isNaN(e)&&isNaN(t)?(s=!0,n=e.charCodeAt(0),t.charCodeAt(0)):(n=isNaN(e)?0:e,isNaN(t)?0:t):(n=parseInt(e,10),parseInt(t,10));if(!(a<n))for(;n<=a;)i.push(s?String.fromCharCode(n):n),n+=o;else for(;a<=n;)i.push(s?String.fromCharCode(n):n),n-=o;return i},cycle:function(e,t){return e[t%e.length]},dump:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];function n(e){for(var t="";0<e;)e--,t+="  ";return t}function i(e){a+=n(s),"object"===(0,l.default)(e)?u(e):"function"==typeof e?a+="function()\n":"string"==typeof e?a+="string("+e.length+') "'+e+'"\n':"number"==typeof e?a+="number("+e+")\n":"boolean"==typeof e&&(a+="bool("+e+")\n")}var o=[].concat(t),s=0,a="",u=function(e){if(null===e)a+="NULL\n";else if(void 0===e)a+="undefined\n";else if("object"===(0,l.default)(e)){for(var t in a+=n(s)+(0,l.default)(e),s++,a+="("+function(e){var t,r=0;for(t in e)Object.hasOwnProperty.call(e,t)&&r++;return r}(e)+") {\n",e)Object.hasOwnProperty.call(e,t)&&(a+=n(s)+"["+t+"]=> \n",i(e[t]));a+=n(--s)+"}\n"}else i(e)};return 0===o.length&&o.push(this.context),o.forEach(function(e){u(e)}),a},date:function(e){var t;if(null==e||""===e)t=new Date;else if(s.lib.is("Date",e))t=e;else if(s.lib.is("String",e))t=e.match(/^\d+$/)?new Date(1e3*e):new Date(1e3*s.lib.strtotime(e));else{if(!s.lib.is("Number",e))throw new s.Error("Unable to parse date "+e);t=new Date(1e3*e)}return t},block:function(e){var t=this.getBlock(e);if(void 0!==t)return t.render(this,this.context)},parent:function(){return this.getBlock(this.getNestingStackToken(s.logic.type.block).blockName,!0).render(this,this.context)},attribute:function(e,t,r){return s.lib.is("Object",e)&&Object.hasOwnProperty.call(e,t)?"function"==typeof e[t]?e[t].apply(void 0,r):e[t]:e&&e[t]||void 0},max:function(e){if(s.lib.is("Object",e))return delete e._keys,s.lib.max(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Reflect.apply(s.lib.max,null,[e].concat(r))},min:function(e){if(s.lib.is("Object",e))return delete e._keys,s.lib.min(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Reflect.apply(s.lib.min,null,[e].concat(r))},template_from_string:function(e){return void 0===e&&(e=""),s.Templates.parsers.twig({options:this.template.options,data:e})},random:function(e){var n=2147483648;function t(e){var t=Math.floor(Math.random()*n),r=Math.min.call(null,0,e),e=Math.max.call(null,0,e);return r+Math.floor((e-r+1)*t/n)}if(s.lib.is("Number",e))return t(e);if(s.lib.is("String",e))return e.charAt(t(e.length-1));if(s.lib.is("Array",e))return e[t(e.length-1)];if(s.lib.is("Object",e)){var r=Object.keys(e);return e[r[t(r.length-1)]]}return t(n-1)},source:function(e,t){var r,n=!1,i=void 0!==a.exports&&"undefined"==typeof window?"fs":"ajax",o={id:e,path:e,method:i,parser:"source",async:!1,fetchTemplateSource:!0};void 0===t&&(t=!1);try{null==(r=s.Templates.loadRemote(e,o))?r="":n=!0}catch(e){s.log.debug("Twig.functions.source: ","Problem loading template  ",e)}return n||t?r:'Template "{name}" is not defined.'.replace("{name}",e)}},s._function=function(e,t,r){if(!s.functions[e])throw new s.Error("Unable to find function "+e);return s.functions[e](t,r)},s._function.extend=function(e,t){s.functions[e]=t},s}},function(e,t,r){"use strict";e.exports=function(e){return e.lib={},e.lib.sprintf=r(4),e.lib.vsprintf=r(21),e.lib.round=r(22),e.lib.max=r(24),e.lib.min=r(25),e.lib.stripTags=r(26),e.lib.strtotime=r(28),e.lib.date=r(29),e.lib.boolval=r(30),e.lib.is=function(e,t){if(null==t)return!1;switch(e){case"Array":return Array.isArray(t);case"Date":return t instanceof Date;case"String":return"string"==typeof t||t instanceof String;case"Number":return"number"==typeof t||t instanceof Number;case"Function":return"function"==typeof t;case"Object":return t instanceof Object;default:return!1}},e.lib.replaceAll=function(e,t,r){t=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return e.replace(new RegExp(t,"g"),r)},e.lib.chunkArray=function(e,t){var r=[],n=0,i=e.length;if(t<1||!Array.isArray(e))return[];for(;n<i;)r.push(e.slice(n,n+=t));return r},e}},function(e,t,r){"use strict";e.exports=function(e,t){return r(4).apply(this,[e].concat(t))}},function(e,t,o){"use strict";function s(e,t){var r=Math.floor(Math.abs(e)+.5);return("PHP_ROUND_HALF_DOWN"===t&&e===r-.5||"PHP_ROUND_HALF_EVEN"===t&&e===.5+2*Math.floor(r/2)||"PHP_ROUND_HALF_ODD"===t&&e===.5+2*Math.floor(r/2)-1)&&--r,e<0?-r:r}e.exports=function(e,t,r){var n=1<arguments.length&&void 0!==t?t:0,i=2<arguments.length&&void 0!==r?r:"PHP_ROUND_HALF_UP",t=o(23),r=o(5);if(e=t(e),n=r(n),t=Math.pow(10,n),isNaN(e)||!isFinite(e))return e;if(Math.trunc(e)===e&&0<=n)return e;r=14-Math.floor(Math.log10(Math.abs(e)));return n<r&&r-15<n?(e=s(e*Math.pow(10,r),i),e/=Math.pow(10,Math.abs(n-r))):e*=t,(e=s(e,i))/t}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return _typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof3(e)};e.exports=function(e){switch(void 0===e?"undefined":n(e)){case"number":return e;case"string":return parseFloat(e)||0;case"boolean":default:return r(5)(e)}}},function(e,t,r){"use strict";var l="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return _typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof3(e)};e.exports=function(){function a(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(e[t]);return r}function u(e,t){var r,n,i,o,s=0;if(e===t)return 0;if("object"!==(void 0===e?"undefined":l(e)))return"object"===(void 0===t?"undefined":l(t))?1:isNaN(t)&&!isNaN(e)?0===e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0===t?0:0<t?1:-1:t===e?0:e<t?1:-1;if("object"!==(void 0===t?"undefined":l(t)))return-1;if(e=a(e),t=a(t),(o=e.length)<(i=t.length))return 1;if(i<o)return-1;for(s=0,r=o;s<r;++s){if(1===(n=u(e[s],t[s])))return 1;if(-1===n)return-1}return 0}var e,t,r,n=0,i=arguments,o=i.length;if(0===o)throw new Error("At least one value should be passed to max()");if(1===o){if("object"!==l(i[0]))throw new Error("Wrong parameter count for max()");if(0===(e=a(i[0])).length)throw new Error("Array must contain at least one element for max()")}else e=i;for(t=e[0],n=1,r=e.length;n<r;++n)1===u(t,e[n])&&(t=e[n]);return t}},function(e,t,r){"use strict";var l="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return _typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof3(e)};e.exports=function(){function a(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(e[t]);return r}function u(e,t){var r,n,i,o,s=0;if(e===t)return 0;if("object"!==(void 0===e?"undefined":l(e)))return"object"===(void 0===t?"undefined":l(t))?1:isNaN(t)&&!isNaN(e)?0===e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0===t?0:0<t?1:-1:t===e?0:e<t?1:-1;if("object"!==(void 0===t?"undefined":l(t)))return-1;if(e=a(e),t=a(t),(o=e.length)<(i=t.length))return 1;if(i<o)return-1;for(s=0,r=o;s<r;++s){if(1===(n=u(e[s],t[s])))return 1;if(-1===n)return-1}return 0}var e,t,r,n=0,i=arguments,o=i.length;if(0===o)throw new Error("At least one value should be passed to min()");if(1===o){if("object"!==l(i[0]))throw new Error("Wrong parameter count for min()");if(0===(e=a(i[0])).length)throw new Error("Array must contain at least one element for min()")}else e=i;for(t=e[0],n=1,r=e.length;n<r;++n)-1===u(t,e[n])&&(t=e[n]);return t}},function(e,t,a){"use strict";e.exports=function(e,r){var t=a(27);r=(((r||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z0-9]*)\b[^>]*>?/gi,i=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;for(s="<"===(s=t(e)).substring(s.length-1)?s.substring(0,s.length-1):s;;){var o=s,s=o.replace(i,"").replace(n,function(e,t){return-1<r.indexOf("<"+t.toLowerCase()+">")?e:""});if(o===s)return s}}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return _typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof3(e)};e.exports=function(e){switch(void 0===e?"undefined":n(e)){case"boolean":return e?"1":"";case"string":return e;case"number":return isNaN(e)?"NAN":isFinite(e)?e+"":(e<0?"-":"")+"INF";case"undefined":return"";case"object":return Array.isArray(e)?"Array":null!==e?"Object":"";case"function":default:throw new Error("Unsupported value type")}}},function(e,t,r){"use strict";var n="[ \\t]+",i="[ \\t]*",o="(?:([ap])\\.?m\\.?([\\t ]|$))",s="(2[0-4]|[01]?[0-9])",a="([01][0-9]|2[0-4])",u="(0?[1-9]|1[0-2])",l="([0-5]?[0-9])",c="([0-5][0-9])",h="(60|[0-5]?[0-9])",p="(60|[0-5][0-9])",f="(?:\\.([0-9]+))",d="sunday|monday|tuesday|wednesday|thursday|friday|saturday",y="sun|mon|tue|wed|thu|fri|sat",m=d+"|"+y+"|weekdays?",g="first|second|third|fourth|fifth|sixth|seventh|eighth?|ninth|tenth|eleventh|twelfth",v="next|last|previous|this",b="(?:second|sec|minute|min|hour|day|fortnight|forthnight|month|year)s?|weeks|"+m,w="([0-9]{1,4})",x="([0-9]{4})",_="(1[0-2]|0?[0-9])",k="(0[0-9]|1[0-2])",E="(?:(3[01]|[0-2]?[0-9])(?:st|nd|rd|th)?)",S="(0[0-9]|[1-2][0-9]|3[01])",O="january|february|march|april|may|june|july|august|september|october|november|december",A="jan|feb|mar|apr|may|jun|jul|aug|sept?|oct|nov|dec",M="("+O+"|"+A+"|i[vx]|vi{0,3}|xi{0,2}|i{1,3})",P="((?:GMT)?([+-])"+s+":?"+l+"?)",j=M+"[ .\\t-]*"+E+"[,.stndrh\\t ]*";function T(e,t){switch(t=t&&t.toLowerCase()){case"a":e+=12===e?-12:0;break;case"p":e+=12!==e?12:0}return e}function C(e){var t=+e;return e.length<4&&t<100&&(t+=t<70?2e3:1900),t}function I(e){return{jan:0,january:0,i:0,feb:1,february:1,ii:1,mar:2,march:2,iii:2,apr:3,april:3,iv:3,may:4,v:4,jun:5,june:5,vi:5,jul:6,july:6,vii:6,aug:7,august:7,viii:7,sep:8,sept:8,september:8,ix:8,oct:9,october:9,x:9,nov:10,november:10,xi:10,dec:11,december:11,xii:11}[e.toLowerCase()]}function N(e,t){t=1<arguments.length&&void 0!==t?t:0;return{mon:1,monday:1,tue:2,tuesday:2,wed:3,wednesday:3,thu:4,thursday:4,fri:5,friday:5,sat:6,saturday:6,sun:0,sunday:0}[e.toLowerCase()]||t}function L(e,t){if(!(e=e&&e.match(/(?:GMT)?([+-])(\d+)(:?)(\d{0,2})/i)))return t;var r="-"===e[1]?1:-1,n=+e[2],t=+e[4];return e[4]||e[3]||(t=Math.floor(n%100),n=Math.floor(n/100)),r*(60*n+t)}var F={yesterday:{regex:/^yesterday/i,name:"yesterday",callback:function(){return--this.rd,this.resetTime()}},now:{regex:/^now/i,name:"now"},noon:{regex:/^noon/i,name:"noon",callback:function(){return this.resetTime()&&this.time(12,0,0,0)}},midnightOrToday:{regex:/^(midnight|today)/i,name:"midnight | today",callback:function(){return this.resetTime()}},tomorrow:{regex:/^tomorrow/i,name:"tomorrow",callback:function(){return this.rd+=1,this.resetTime()}},timestamp:{regex:/^@(-?\d+)/i,name:"timestamp",callback:function(e,t){return this.rs+=+t,this.y=1970,this.m=0,this.d=1,this.dates=0,this.resetTime()&&this.zone(0)}},firstOrLastDay:{regex:/^(first|last) day of/i,name:"firstdayof | lastdayof",callback:function(e,t){"first"===t.toLowerCase()?this.firstOrLastDayOfMonth=1:this.firstOrLastDayOfMonth=-1}},backOrFrontOf:{regex:RegExp("^(back|front) of "+s+i+o+"?","i"),name:"backof | frontof",callback:function(e,t,r,n){var i=+r,r=15;return"back"===t.toLowerCase()||(--i,r=45),i=T(i,n),this.resetTime()&&this.time(i,r,0,0)}},weekdayOf:{regex:RegExp("^("+g+"|"+v+")"+n+"("+d+"|"+y+")"+n+"of","i"),name:"weekdayof"},mssqltime:{regex:RegExp("^"+u+":"+c+":"+p+"[:.]([0-9]+)"+o,"i"),name:"mssqltime",callback:function(e,t,r,n,i,o){return this.time(T(+t,o),+r,+n,+i.substr(0,3))}},timeLong12:{regex:RegExp("^"+u+"[:.]"+l+"[:.]"+p+i+o,"i"),name:"timelong12",callback:function(e,t,r,n,i){return this.time(T(+t,i),+r,+n,0)}},timeShort12:{regex:RegExp("^"+u+"[:.]"+c+i+o,"i"),name:"timeshort12",callback:function(e,t,r,n){return this.time(T(+t,n),+r,0,0)}},timeTiny12:{regex:RegExp("^"+u+i+o,"i"),name:"timetiny12",callback:function(e,t,r){return this.time(T(+t,r),0,0,0)}},soap:{regex:RegExp("^"+x+"-"+k+"-"+S+"T"+a+":"+c+":"+p+f+P+"?","i"),name:"soap",callback:function(e,t,r,n,i,o,s,a,u){return this.ymd(+t,r-1,+n)&&this.time(+i,+o,+s,+a.substr(0,3))&&this.zone(L(u))}},wddx:{regex:RegExp("^"+x+"-"+_+"-"+E+"T"+s+":"+l+":"+h),name:"wddx",callback:function(e,t,r,n,i,o,s){return this.ymd(+t,r-1,+n)&&this.time(+i,+o,+s,0)}},exif:{regex:RegExp("^"+x+":"+k+":"+S+" "+a+":"+c+":"+p,"i"),name:"exif",callback:function(e,t,r,n,i,o,s){return this.ymd(+t,r-1,+n)&&this.time(+i,+o,+s,0)}},xmlRpc:{regex:RegExp("^"+x+k+S+"T"+s+":"+c+":"+p),name:"xmlrpc",callback:function(e,t,r,n,i,o,s){return this.ymd(+t,r-1,+n)&&this.time(+i,+o,+s,0)}},xmlRpcNoColon:{regex:RegExp("^"+x+k+S+"[Tt]"+s+c+p),name:"xmlrpcnocolon",callback:function(e,t,r,n,i,o,s){return this.ymd(+t,r-1,+n)&&this.time(+i,+o,+s,0)}},clf:{regex:RegExp("^"+E+"/("+A+")/"+x+":"+a+":"+c+":"+p+n+P,"i"),name:"clf",callback:function(e,t,r,n,i,o,s,a){return this.ymd(+n,I(r),+t)&&this.time(+i,+o,+s,0)&&this.zone(L(a))}},iso8601long:{regex:RegExp("^t?"+s+"[:.]"+l+"[:.]"+h+f,"i"),name:"iso8601long",callback:function(e,t,r,n,i){return this.time(+t,+r,+n,+i.substr(0,3))}},dateTextual:{regex:RegExp("^"+M+"[ .\\t-]*"+E+"[,.stndrh\\t ]+"+w,"i"),name:"datetextual",callback:function(e,t,r,n){return this.ymd(C(n),I(t),+r)}},pointedDate4:{regex:RegExp("^"+E+"[.\\t-]"+_+"[.-]"+x),name:"pointeddate4",callback:function(e,t,r,n){return this.ymd(+n,r-1,+t)}},pointedDate2:{regex:RegExp("^"+E+"[.\\t]"+_+"\\.([0-9]{2})"),name:"pointeddate2",callback:function(e,t,r,n){return this.ymd(C(n),r-1,+t)}},timeLong24:{regex:RegExp("^t?"+s+"[:.]"+l+"[:.]"+h),name:"timelong24",callback:function(e,t,r,n){return this.time(+t,+r,+n,0)}},dateNoColon:{regex:RegExp("^"+x+k+S),name:"datenocolon",callback:function(e,t,r,n){return this.ymd(+t,r-1,+n)}},pgydotd:{regex:RegExp("^"+x+"\\.?(00[1-9]|0[1-9][0-9]|[12][0-9][0-9]|3[0-5][0-9]|36[0-6])"),name:"pgydotd",callback:function(e,t,r){return this.ymd(+t,0,+r)}},timeShort24:{regex:RegExp("^t?"+s+"[:.]"+l,"i"),name:"timeshort24",callback:function(e,t,r){return this.time(+t,+r,0,0)}},iso8601noColon:{regex:RegExp("^t?"+a+c+p,"i"),name:"iso8601nocolon",callback:function(e,t,r,n){return this.time(+t,+r,+n,0)}},iso8601dateSlash:{regex:RegExp("^"+x+"/"+k+"/"+S+"/"),name:"iso8601dateslash",callback:function(e,t,r,n){return this.ymd(+t,r-1,+n)}},dateSlash:{regex:RegExp("^"+x+"/"+_+"/"+E),name:"dateslash",callback:function(e,t,r,n){return this.ymd(+t,r-1,+n)}},american:{regex:RegExp("^"+_+"/"+E+"/"+w),name:"american",callback:function(e,t,r,n){return this.ymd(C(n),t-1,+r)}},americanShort:{regex:RegExp("^"+_+"/"+E),name:"americanshort",callback:function(e,t,r){return this.ymd(this.y,t-1,+r)}},gnuDateShortOrIso8601date2:{regex:RegExp("^"+w+"-"+_+"-"+E),name:"gnudateshort | iso8601date2",callback:function(e,t,r,n){return this.ymd(C(t),r-1,+n)}},iso8601date4:{regex:RegExp("^([+-]?[0-9]{4})-"+k+"-"+S),name:"iso8601date4",callback:function(e,t,r,n){return this.ymd(+t,r-1,+n)}},gnuNoColon:{regex:RegExp("^t?"+a+c,"i"),name:"gnunocolon",callback:function(e,t,r){switch(this.times){case 0:return this.time(+t,+r,0,this.f);case 1:return this.y=100*t+ +r,this.times++,!0;default:return!1}}},gnuDateShorter:{regex:RegExp("^"+x+"-"+_),name:"gnudateshorter",callback:function(e,t,r){return this.ymd(+t,r-1,1)}},pgTextReverse:{regex:RegExp("^(\\d{3,4}|[4-9]\\d|3[2-9])-("+A+")-"+S,"i"),name:"pgtextreverse",callback:function(e,t,r,n){return this.ymd(C(t),I(r),+n)}},dateFull:{regex:RegExp("^"+E+"[ \\t.-]*"+M+"[ \\t.-]*"+w,"i"),name:"datefull",callback:function(e,t,r,n){return this.ymd(C(n),I(r),+t)}},dateNoDay:{regex:RegExp("^"+M+"[ .\\t-]*"+x,"i"),name:"datenoday",callback:function(e,t,r){return this.ymd(+r,I(t),1)}},dateNoDayRev:{regex:RegExp("^"+x+"[ .\\t-]*"+M,"i"),name:"datenodayrev",callback:function(e,t,r){return this.ymd(+t,I(r),1)}},pgTextShort:{regex:RegExp("^("+A+")-"+S+"-"+w,"i"),name:"pgtextshort",callback:function(e,t,r,n){return this.ymd(C(n),I(t),+r)}},dateNoYear:{regex:RegExp("^"+j,"i"),name:"datenoyear",callback:function(e,t,r){return this.ymd(this.y,I(t),+r)}},dateNoYearRev:{regex:RegExp("^"+E+"[ .\\t-]*"+M,"i"),name:"datenoyearrev",callback:function(e,t,r){return this.ymd(this.y,I(r),+t)}},isoWeekDay:{regex:RegExp("^"+x+"-?W(0[1-9]|[1-4][0-9]|5[0-3])(?:-?([0-7]))?"),name:"isoweekday | isoweek",callback:function(e,t,r,n){if(n=n?+n:1,!this.ymd(+t,0,1))return!1;t=0-(4<(t=new Date(this.y,this.m,this.d).getDay())?t-7:t);this.rd+=t+7*(r-1)+n}},relativeText:{regex:RegExp("^("+g+"|"+v+")"+n+"("+b+")","i"),name:"relativetext",callback:function(e,t,r){var t={amount:{last:-1,previous:-1,this:0,first:1,next:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eight:8,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12}[t=(t=t).toLowerCase()],behavior:{this:1}[t]||0},n=t.amount;t.behavior;switch(r.toLowerCase()){case"sec":case"secs":case"second":case"seconds":this.rs+=n;break;case"min":case"mins":case"minute":case"minutes":this.ri+=n;break;case"hour":case"hours":this.rh+=n;break;case"day":case"days":this.rd+=n;break;case"fortnight":case"fortnights":case"forthnight":case"forthnights":this.rd+=14*n;break;case"week":case"weeks":this.rd+=7*n;break;case"month":case"months":this.rm+=n;break;case"year":case"years":this.ry+=n;break;case"mon":case"monday":case"tue":case"tuesday":case"wed":case"wednesday":case"thu":case"thursday":case"fri":case"friday":case"sat":case"saturday":case"sun":case"sunday":this.resetTime(),this.weekday=N(r,7),this.weekdayBehavior=1,this.rd+=7*(0<n?n-1:n)}}},relative:{regex:RegExp("^([+-]*)[ \\t]*(\\d+)[ \\t]*("+b+"|week)","i"),name:"relative",callback:function(e,t,r,n){var t=t.replace(/[^-]/g,"").length,i=+r*Math.pow(-1,t);switch(n.toLowerCase()){case"sec":case"secs":case"second":case"seconds":this.rs+=i;break;case"min":case"mins":case"minute":case"minutes":this.ri+=i;break;case"hour":case"hours":this.rh+=i;break;case"day":case"days":this.rd+=i;break;case"fortnight":case"fortnights":case"forthnight":case"forthnights":this.rd+=14*i;break;case"week":case"weeks":this.rd+=7*i;break;case"month":case"months":this.rm+=i;break;case"year":case"years":this.ry+=i;break;case"mon":case"monday":case"tue":case"tuesday":case"wed":case"wednesday":case"thu":case"thursday":case"fri":case"friday":case"sat":case"saturday":case"sun":case"sunday":this.resetTime(),this.weekday=N(n,7),this.weekdayBehavior=1,this.rd+=7*(0<i?i-1:i)}}},dayText:{regex:RegExp("^("+m+")","i"),name:"daytext",callback:function(e,t){this.resetTime(),this.weekday=N(t,0),2!==this.weekdayBehavior&&(this.weekdayBehavior=1)}},relativeTextWeek:{regex:RegExp("^("+v+")"+n+"week","i"),name:"relativetextweek",callback:function(e,t){switch(this.weekdayBehavior=2,t.toLowerCase()){case"this":this.rd+=0;break;case"next":this.rd+=7;break;case"last":case"previous":this.rd-=7}isNaN(this.weekday)&&(this.weekday=1)}},monthFullOrMonthAbbr:{regex:RegExp("^("+O+"|"+A+")","i"),name:"monthfull | monthabbr",callback:function(e,t){return this.ymd(this.y,I(t),this.d)}},tzCorrection:{regex:RegExp("^"+P,"i"),name:"tzcorrection",callback:function(e){return this.zone(L(e))}},ago:{regex:/^ago/i,name:"ago",callback:function(){this.ry=-this.ry,this.rm=-this.rm,this.rd=-this.rd,this.rh=-this.rh,this.ri=-this.ri,this.rs=-this.rs,this.rf=-this.rf}},year4:{regex:RegExp("^"+x),name:"year4",callback:function(e,t){return this.y=+t,!0}},whitespace:{regex:/^[ .,\t]+/,name:"whitespace"},dateShortWithTimeLong:{regex:RegExp("^"+j+"t?"+s+"[:.]"+l+"[:.]"+h,"i"),name:"dateshortwithtimelong",callback:function(e,t,r,n,i,o){return this.ymd(this.y,I(t),+r)&&this.time(+n,+i,+o,0)}},dateShortWithTimeLong12:{regex:RegExp("^"+j+u+"[:.]"+l+"[:.]"+p+i+o,"i"),name:"dateshortwithtimelong12",callback:function(e,t,r,n,i,o,s){return this.ymd(this.y,I(t),+r)&&this.time(T(+n,s),+i,+o,0)}},dateShortWithTimeShort:{regex:RegExp("^"+j+"t?"+s+"[:.]"+l,"i"),name:"dateshortwithtimeshort",callback:function(e,t,r,n,i){return this.ymd(this.y,I(t),+r)&&this.time(+n,+i,0,0)}},dateShortWithTimeShort12:{regex:RegExp("^"+j+u+"[:.]"+c+i+o,"i"),name:"dateshortwithtimeshort12",callback:function(e,t,r,n,i,o){return this.ymd(this.y,I(t),+r)&&this.time(T(+n,o),+i,0,0)}}},R={y:NaN,m:NaN,d:NaN,h:NaN,i:NaN,s:NaN,f:NaN,ry:0,rm:0,rd:0,rh:0,ri:0,rs:0,rf:0,weekday:NaN,weekdayBehavior:0,firstOrLastDayOfMonth:0,z:NaN,dates:0,times:0,zones:0,ymd:function(e,t,r){return!(0<this.dates)&&(this.dates++,this.y=e,this.m=t,this.d=r,!0)},time:function(e,t,r,n){return!(0<this.times)&&(this.times++,this.h=e,this.i=t,this.s=r,this.f=n,!0)},resetTime:function(){return this.h=0,this.i=0,this.s=0,this.f=0,!(this.times=0)},zone:function(e){return this.zones<=1&&(this.zones++,this.z=e,!0)},toDate:function(e){switch(this.dates&&!this.times&&(this.h=this.i=this.s=this.f=0),isNaN(this.y)&&(this.y=e.getFullYear()),isNaN(this.m)&&(this.m=e.getMonth()),isNaN(this.d)&&(this.d=e.getDate()),isNaN(this.h)&&(this.h=e.getHours()),isNaN(this.i)&&(this.i=e.getMinutes()),isNaN(this.s)&&(this.s=e.getSeconds()),isNaN(this.f)&&(this.f=e.getMilliseconds()),this.firstOrLastDayOfMonth){case 1:this.d=1;break;case-1:this.d=0,this.m+=1}var t,r;isNaN(this.weekday)||((r=new Date(e.getTime())).setFullYear(this.y,this.m,this.d),r.setHours(this.h,this.i,this.s,this.f),t=r.getDay(),2===this.weekdayBehavior?(0===t&&0!==this.weekday&&(this.weekday=-6),0===this.weekday&&0!==t&&(this.weekday=7),this.d-=t,this.d+=this.weekday):(r=this.weekday-t,(this.rd<0&&r<0||0<=this.rd&&r<=-this.weekdayBehavior)&&(r+=7),0<=this.weekday?this.d+=r:this.d-=7-(Math.abs(this.weekday)-t),this.weekday=NaN)),this.y+=this.ry,this.m+=this.rm,this.d+=this.rd,this.h+=this.rh,this.i+=this.ri,this.s+=this.rs,this.f+=this.rf,this.ry=this.rm=this.rd=0,this.rh=this.ri=this.rs=this.rf=0;var n=new Date(e.getTime());switch(n.setFullYear(this.y,this.m,this.d),n.setHours(this.h,this.i,this.s,this.f),this.firstOrLastDayOfMonth){case 1:n.setDate(1);break;case-1:n.setMonth(n.getMonth()+1,0)}return isNaN(this.z)||n.getTimezoneOffset()===this.z||(n.setUTCFullYear(n.getFullYear(),n.getMonth(),n.getDate()),n.setUTCHours(n.getHours(),n.getMinutes()+this.z,n.getSeconds(),n.getMilliseconds())),n}};e.exports=function(e,t){null==t&&(t=Math.floor(Date.now()/1e3));for(var r=[F.yesterday,F.now,F.noon,F.midnightOrToday,F.tomorrow,F.timestamp,F.firstOrLastDay,F.backOrFrontOf,F.timeTiny12,F.timeShort12,F.timeLong12,F.mssqltime,F.timeShort24,F.timeLong24,F.iso8601long,F.gnuNoColon,F.iso8601noColon,F.americanShort,F.american,F.iso8601date4,F.iso8601dateSlash,F.dateSlash,F.gnuDateShortOrIso8601date2,F.gnuDateShorter,F.dateFull,F.pointedDate4,F.pointedDate2,F.dateNoDay,F.dateNoDayRev,F.dateTextual,F.dateNoYear,F.dateNoYearRev,F.dateNoColon,F.xmlRpc,F.xmlRpcNoColon,F.soap,F.wddx,F.exif,F.pgydotd,F.isoWeekDay,F.pgTextShort,F.pgTextReverse,F.clf,F.year4,F.ago,F.dayText,F.relativeTextWeek,F.relativeText,F.monthFullOrMonthAbbr,F.tzCorrection,F.dateShortWithTimeShort12,F.dateShortWithTimeLong12,F.dateShortWithTimeShort,F.dateShortWithTimeLong,F.relative,F.whitespace],n=Object.create(R);e.length;){for(var i=null,o=null,s=0,a=r.length;s<a;s++){var u=r[s],l=e.match(u.regex);l&&(!i||l[0].length>i[0].length)&&(i=l,o=u)}if(!o||o.callback&&!1===o.callback.apply(n,i))return!1;e=e.substr(i[0].length),i=o=null}return Math.floor(n.toDate(new Date(1e3*t))/1e3)}},function(e,t,r){"use strict";e.exports=function(e,t){function r(e,t){return l[e]?l[e]():t}function n(e,t){for(e=String(e);e.length<t;)e="0"+e;return e}var i,o,s,a=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],u=/\\?(.?)/gi,l={d:function(){return n(l.j(),2)},D:function(){return l.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return a[l.w()]+"day"},N:function(){return l.w()||7},S:function(){var e=l.j(),t=e%10;return t<=3&&1===parseInt(e%100/10,10)&&(t=0),["st","nd","rd"][t-1]||"th"},w:function(){return i.getDay()},z:function(){var e=new Date(l.Y(),l.n()-1,l.j()),t=new Date(l.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(l.Y(),l.n()-1,l.j()-l.N()+3),t=new Date(e.getFullYear(),0,4);return n(1+Math.round((e-t)/864e5/7),2)},F:function(){return a[6+l.n()]},m:function(){return n(l.n(),2)},M:function(){return l.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return new Date(l.Y(),l.n(),0).getDate()},L:function(){var e=l.Y();return e%4==0&e%100!=0|e%400==0},o:function(){var e=l.n(),t=l.W();return l.Y()+(12===e&&t<9?1:1===e&&9<t?-1:0)},Y:function(){return i.getFullYear()},y:function(){return l.Y().toString().slice(-2)},a:function(){return 11<i.getHours()?"pm":"am"},A:function(){return l.a().toUpperCase()},B:function(){var e=3600*i.getUTCHours(),t=60*i.getUTCMinutes(),r=i.getUTCSeconds();return n(Math.floor((e+t+r+3600)/86.4)%1e3,3)},g:function(){return l.G()%12||12},G:function(){return i.getHours()},h:function(){return n(l.g(),2)},H:function(){return n(l.G(),2)},i:function(){return n(i.getMinutes(),2)},s:function(){return n(i.getSeconds(),2)},u:function(){return n(1e3*i.getMilliseconds(),6)},e:function(){throw new Error("Not supported (see source code of date() for timezone on how to add support)")},I:function(){return new Date(l.Y(),0)-Date.UTC(l.Y(),0)!=new Date(l.Y(),6)-Date.UTC(l.Y(),6)?1:0},O:function(){var e=i.getTimezoneOffset(),t=Math.abs(e);return(0<e?"-":"+")+n(100*Math.floor(t/60)+t%60,4)},P:function(){var e=l.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-i.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(u,r)},r:function(){return"D, d M Y H:i:s O".replace(u,r)},U:function(){return i/1e3|0}};return o=e,i=void 0===(s=t)?new Date:s instanceof Date?new Date(s):new Date(1e3*s),o.replace(u,r)}},function(e,t,r){"use strict";e.exports=function(e){return!1!==e&&(0!==e&&0!==e&&(""!==e&&"0"!==e&&((!Array.isArray(e)||0!==e.length)&&null!=e)))}},function(e,t,r){"use strict";e.exports=function(l){l.Templates.registerLoader("ajax",function(t,r,n,i){var o,s=r.precompiled,a=this.parsers[r.parser]||this.parser.twig;if("undefined"==typeof XMLHttpRequest)throw new l.Error('Unsupported platform: Unable to do ajax requests because there is no "XMLHTTPRequest" implementation');var u=new XMLHttpRequest;return u.onreadystatechange=function(){var e=null;4===u.readyState&&(200===u.status||window.cordova&&0===u.status?(l.log.debug("Got template ",u.responseText),e=!0===s?JSON.parse(u.responseText):u.responseText,r.url=t,r.data=e,o=a.call(this,r),"function"==typeof n&&n(o)):"function"==typeof i&&i(u))},u.open("GET",t,Boolean(r.async)),u.overrideMimeType("text/plain"),u.send(),!!r.async||o})}},function(e,t,r){"use strict";e.exports=function(c){var h,t;try{h=r(33),t=r(6)}catch(e){console.warn("Missing fs and path modules. "+e)}c.Templates.registerLoader("fs",function(r,n,i,o){var s,e,a=n.precompiled,u=this.parsers[n.parser]||this.parser.twig;if(!h||!t)throw new c.Error('Unsupported platform: Unable to load from file because there is no "fs" or "path" implementation');function l(e,t){e?"function"==typeof o&&o(e):(!0===a&&(t=JSON.parse(t)),n.data=t,n.path=n.path||r,s=u.call(this,n),"function"==typeof i&&i(s))}if(n.path=n.path||r,n.async)return h.stat(n.path,function(e,t){!e&&t.isFile()?h.readFile(n.path,"utf8",l):"function"==typeof o&&o(new c.Error("Unable to find template file "+n.path))}),!0;try{if(!h.statSync(n.path).isFile())throw new c.Error("Unable to find template file "+n.path)}catch(e){throw new c.Error("Unable to find template file "+n.path+". "+e)}return e=h.readFileSync(n.path,"utf8"),l(void 0,e),s})}},function(e,t){e.exports=o("fs")},function(e,t,r){"use strict";var n=r(0)(r(2));function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){(0,n.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}e.exports=function(h){for(h.logic={},h.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",apply:"Twig.logic.type.apply",endapply:"Twig.logic.type.endapply",do:"Twig.logic.type.do",shortblock:"Twig.logic.type.shortblock",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from",embed:"Twig.logic.type.embed",endembed:"Twig.logic.type.endembed",with:"Twig.logic.type.with",endwith:"Twig.logic.type.endwith",deprecated:"Twig.logic.type.deprecated"},h.logic.definitions=[{type:h.logic.type.if_,regex:/^if\s?([\s\S]+)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!0,compile:function(e){var t=e.match[1];return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,r,n){var i=this;return h.expression.parseAsync.call(i,t.stack,r).then(function(e){return n=!0,h.lib.boolval(e)?(n=!1,i.parseAsync(t.output,r)):""}).then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.elseif,regex:/^elseif\s?([^\s].*)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!1,compile:function(e){var t=e.match[1];return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,r,n){var i=this;return h.expression.parseAsync.call(i,t.stack,r).then(function(e){return n&&h.lib.boolval(e)?(n=!1,i.parseAsync(t.output,r)):""}).then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.else_,regex:/^else$/,next:[h.logic.type.endif,h.logic.type.endfor],open:!1,parse:function(e,t,r){var n=h.Promise.resolve("");return r&&(n=this.parseAsync(e.output,t)),n.then(function(e){return{chain:r,output:e}})}},{type:h.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:h.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([\S\s]+?)(?:\s+if\s+([^\s].*))?$/,next:[h.logic.type.else_,h.logic.type.endfor],open:!0,compile:function(e){var t=e.match[1],r=e.match[2],n=e.match[3],i=null;if(e.keyVar=null,e.valueVar=null,t.includes(",")){if(2!==(i=t.split(",")).length)throw new h.Error("Invalid expression in for loop: "+t);e.keyVar=i[0].trim(),e.valueVar=i[1].trim()}else e.valueVar=t.trim();return e.expression=h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack,n&&(e.conditional=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack),delete e.match,e},parse:function(i,o){function r(e,t){var r,n=p({},o);return n[i.valueVar]=t,i.keyVar&&(n[i.keyVar]=e),n.loop=(r=s,{index:(t=u)+1,index0:t,revindex:(e=void 0!==c)?void 0:r-t,revindex0:e?void 0:r-t-1,first:0===t,last:e?void 0:t===r-1,length:e?void 0:r,parent:o}),(void 0===c?h.Promise.resolve(!0):h.expression.parseAsync.call(l,c,n)).then(function(e){if(e)return l.parseAsync(i.output,n).then(function(e){a.push(e),u+=1})}).then(function(){delete n.loop,delete n[i.valueVar],delete n[i.keyVar],h.merge(o,n,!0)})}var s,e,a=[],u=0,l=this,c=i.conditional;return h.expression.parseAsync.call(l,i.expression,o).then(function(t){return Array.isArray(t)?(s=t.length,h.async.forEach(t,function(e){return r(u,e)})):h.lib.is("Object",t)?(e=void 0===t._keys?Object.keys(t):t._keys,s=e.length,h.async.forEach(e,function(e){if("_keys"!==e)return r(e,t[e])})):void 0}).then(function(){return{chain:0===a.length,context:o,output:h.output.call(l.template,a)}})}},{type:h.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:h.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim(),r=e.match[2],r=h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack;return e.key=t,e.expression=r,delete e.match,e},parse:function(e,t,r){var n=e.key;return h.expression.parseAsync.call(this,e.expression,t).then(function(e){return e===t&&(e=p({},e)),t[n]=e,{chain:r,context:t}})}},{type:h.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[h.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(e,t,r){var n=this,i=e.key;return n.parseAsync(e.output,t).then(function(e){return n.context[i]=e,t[i]=e,{chain:r,context:t}})}},{type:h.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:h.logic.type.filter,regex:/^filter\s+(.+)$/,next:[h.logic.type.endfilter],open:!0,compile:function(e){var t="|"+e.match[1].trim();return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,r,n){var i=this;return i.parseAsync(t.output,r).then(function(e){e=[{type:h.expression.type.string,value:e}].concat(t.stack);return h.expression.parseAsync.call(i,e,r)}).then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:h.logic.type.apply,regex:/^apply\s+(.+)$/,next:[h.logic.type.endapply],open:!0,compile:function(e){var t="|"+e.match[1].trim();return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,r,n){var i=this;return i.parseAsync(t.output,r).then(function(e){e=[{type:h.expression.type.string,value:e}].concat(t.stack);return h.expression.parseAsync.call(i,e,r)}).then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.endapply,regex:/^endapply$/,next:[],open:!1},{type:h.logic.type.do,regex:/^do\s+([\S\s]+)$/,next:[],open:!0,compile:function(e){var t=e.match[1],t=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack;return e.expression=t,delete e.match,e},parse:function(e,t,r){return h.expression.parseAsync.call(this,e.expression,t).then(function(){return{chain:r,context:t}})}},{type:h.logic.type.block,regex:/^block\s+(\w+)$/,next:[h.logic.type.endblock],open:!0,compile:function(e){return e.blockName=e.match[1].trim(),delete e.match,e},parse:function(e,t,r){var n=h.Promise.resolve();return this.template.blocks.defined[e.blockName]=new h.Block(this.template,e),(null===this.template.parentTemplate||this.template.parentTemplate instanceof h.Template)&&(n=this.getBlock(e.blockName).render(this,t)),n.then(function(e){return{chain:r,output:e}})}},{type:h.logic.type.shortblock,regex:/^block\s+(\w+)\s+(.+)$/,next:[],open:!0,compile:function(e){return e.expression=e.match[2].trim(),e.output=h.expression.compile({type:h.expression.type.expression,value:e.expression}).stack,h.logic.handler[h.logic.type.block].compile.apply(this,[e])},parse:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return h.logic.handler[h.logic.type.block].parse.apply(this,t)}},{type:h.logic.type.endblock,regex:/^endblock(?:\s+(\w+))?$/,next:[],open:!1},{type:h.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim();return delete e.match,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(e,t,r){var n=this;return h.expression.parseAsync.call(n,e.stack,t).then(function(e){var t;return Array.isArray(e)?null!==(t=e.reverse().reduce(function(t,e){try{return{render:n.template.importFile(e),fileName:e}}catch(e){return t}},{render:null,fileName:null})).fileName&&(n.template.parentTemplate=t.fileName):n.template.parentTemplate=e,{chain:r,output:""}})}},{type:h.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim();return delete e.match,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(e,t,r){var n=this;return h.expression.parseAsync.call(n,e.stack,t).then(function(e){var e=n.template.importFile(e),t=new h.ParseState(e);return t.parseAsync(e.tokens).then(function(){n.template.blocks.imported=p(p({},n.template.blocks.imported),t.getBlocks())})}).then(function(){return{chain:r,output:""}})}},{type:h.logic.type.include,regex:/^include\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,next:[],open:!0,compile:function(e){var t=e.match,r=t[1].trim(),n=void 0!==t[2],i=t[3],t=void 0!==t[4]&&t[4].length;return delete e.match,e.only=t,e.ignoreMissing=n,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack,void 0!==i&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:i.trim()}).stack),e},parse:function(e,t,r){var n=e.only?{}:p({},t),i=e.ignoreMissing,o=this,s={chain:r,output:""};return(void 0===e.withStack?h.Promise.resolve():h.expression.parseAsync.call(o,e.withStack,t).then(function(e){n=p(p({},n),e)})).then(function(){return h.expression.parseAsync.call(o,e.stack,t)}).then(function(e){e=Array.isArray(e)?e:[e],e=e.reduce(function(e,t){if(null===e.render){if(t instanceof h.Template)return{render:t.renderAsync(n,{isInclude:!0}),lastError:null};try{return{render:o.template.importFile(t).renderAsync(n,{isInclude:!0}),lastError:null}}catch(e){return{render:null,lastError:e}}}return e},{render:null,lastError:null});if(null!==e.render)return e.render;if(null===e.render&&i)return"";throw e.lastError}).then(function(e){return""!==e&&(s.output=e),s})}},{type:h.logic.type.spaceless,regex:/^spaceless$/,next:[h.logic.type.endspaceless],open:!0,parse:function(e,t,r){return this.parseAsync(e.output,t).then(function(e){e=e.replace(/>\s+</g,"><").trim(),e=new h.Markup(e);return{chain:r,output:e}})}},{type:h.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:h.logic.type.macro,regex:/^macro\s+(\w+)\s*\(\s*((?:\w+(?:\s*=\s*([\s\S]+))?(?:,\s*)?)*)\s*\)$/,next:[h.logic.type.endmacro],open:!0,compile:function(e){var t=e.match[1],r=e.match[2].split(/\s*,\s*/),n=r.map(function(e){return e.split(/\s*=\s*/)[0]}),i=n.length;if(1<i)for(var o={},s=0;s<i;s++){var a=n[s];if(o[a])throw new h.Error("Duplicate arguments for parameter: "+a);o[a]=1}return e.macroName=t,e.parameters=n,e.defaults=r.reduce(function(e,t){var r=t.split(/\s*=\s*/),t=r[0],r=r[1];return e[t]=r?h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack:void 0,e},{}),delete e.match,e},parse:function(i,o,e){var s=this;return s.macros[i.macroName]=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=p(p({},o),{},{_self:s.macros});return h.async.forEach(i.parameters,function(t,e){return void 0!==r[e]?(n[t]=r[e],!0):void 0!==i.defaults[t]?h.expression.parseAsync.call(this,i.defaults[t],o).then(function(e){return n[t]=e,h.Promise.resolve()}):!(n[t]=void 0)}).then(function(){return s.parseAsync(i.output,n)})},{chain:e,output:""}}},{type:h.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:h.logic.type.import_,regex:/^import\s+(.+)\s+as\s+(\w+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim(),r=e.match[2].trim();return delete e.match,e.expression=t,e.contextName=r,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(r,n,e){var t=this,i={chain:e,output:""};return"_self"===r.expression?(n[r.contextName]=t.macros,i):h.expression.parseAsync.call(t,r.stack,n).then(function(e){return t.template.importFile(e||r.expression)}).then(function(e){var t=new h.ParseState(e);return t.parseAsync(e.tokens).then(function(){return n[r.contextName]=t.macros,i})})}},{type:h.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim(),r={},n=s(e.match[2].trim().split(/\s*,\s*/));try{for(n.s();!(o=n.n()).done;){var i=o.value,o=i.match(/^(\w+)\s+as\s+(\w+)$/);o?r[o[1].trim()]=o[2].trim():i.match(/^(\w+)$/)&&(r[i]=i)}}catch(e){n.e(e)}finally{n.f()}return delete e.match,e.expression=t,e.macroNames=r,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(r,n,i){var t=this,e="_self"===r.expression?h.Promise.resolve(t.macros):h.expression.parseAsync.call(t,r.stack,n).then(function(e){return t.template.importFile(e||r.expression)}).then(function(e){var t=new h.ParseState(e);return t.parseAsync(e.tokens).then(function(){return t.macros})});return e.then(function(e){for(var t in r.macroNames)void 0!==e[t]&&(n[r.macroNames[t]]=e[t]);return{chain:i,output:""}})}},{type:h.logic.type.embed,regex:/^embed\s+(.+?)(?:\s+(ignore missing))?(?:\s+with\s+([\S\s]+?))?(?:\s+(only))?$/,next:[h.logic.type.endembed],open:!0,compile:function(e){var t=e.match,r=t[1].trim(),n=void 0!==t[2],i=t[3],t=void 0!==t[4]&&t[4].length;return delete e.match,e.only=t,e.ignoreMissing=n,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack,void 0!==i&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:i.trim()}).stack),e},parse:function(r,e,t){var n={},i=h.Promise.resolve(),o=this;return r.only||(n=p({},e)),void 0!==r.withStack&&(i=h.expression.parseAsync.call(o,r.withStack,e).then(function(e){n=p(p({},n),e)})),i.then(function(){return h.expression.parseAsync.call(o,r.stack,n)}).then(function(e){var t=new h.Template({data:r.output,id:o.template.id,base:o.template.base,path:o.template.path,url:o.template.url,name:o.template.name,method:o.template.method,options:o.template.options});try{t.importFile(e)}catch(e){if(r.ignoreMissing)return"";throw o=null,e}return t.parentTemplate=e,t.renderAsync(n,{isInclude:!0})}).then(function(e){return{chain:t,output:e}})}},{type:h.logic.type.endembed,regex:/^endembed$/,next:[],open:!1},{type:h.logic.type.with,regex:/^(?:with\s+([\S\s]+?))(?:\s|$)(only)?$/,next:[h.logic.type.endwith],open:!0,compile:function(e){var t=e.match,r=t[1],t=void 0!==t[2]&&t[2].length;return delete e.match,e.only=t,void 0!==r&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:r.trim()}).stack),e},parse:function(e,t,r){var n,i={},o=this,s=h.Promise.resolve();return e.only||(i=p({},t)),void 0!==e.withStack&&(s=h.expression.parseAsync.call(o,e.withStack,t).then(function(e){for(n in e)Object.hasOwnProperty.call(e,n)&&(i[n]=e[n])})),s.then(function(){return o.parseAsync(e.output,i)}).then(function(e){return{chain:r,output:e}})}},{type:h.logic.type.endwith,regex:/^endwith$/,next:[],open:!1},{type:h.logic.type.deprecated,regex:/^deprecated\s+(.+)$/,next:[],open:!0,compile:function(e){return console.warn("Deprecation notice: "+e.match[1]),e},parse:function(){return{}}}],h.logic.handler={},h.logic.extendType=function(e,t){t=t||"Twig.logic.type"+e,h.logic.type[e]=t},h.logic.extend=function(e){if(!e.type)throw new h.Error("Unable to extend logic definition. No type provided for "+e);h.logic.extendType(e.type),h.logic.handler[e.type]=e};0<h.logic.definitions.length;)h.logic.extend(h.logic.definitions.shift());return h.logic.compile=function(e){var t=e.value.trim(),e=h.logic.tokenize.call(this,t),t=h.logic.handler[e.type];return t.compile&&(e=t.compile.call(this,e),h.log.trace("Twig.logic.compile: ","Compiled logic token to ",e)),e},h.logic.tokenize=function(e){var t,r,n,i,o=null,s=null,a=null;for(o in e=e.trim(),h.logic.handler)if(Object.hasOwnProperty.call(h.logic.handler,o))for(t=h.logic.handler[o].type,s=r=h.logic.handler[o].regex,Array.isArray(r)||(s=[r]),n=s.length,a=0;a<n;a++)if(null!==(i=s[a].exec(e)))return h.log.trace("Twig.logic.tokenize: ","Matched a ",t," regular expression of ",i),{type:t,match:i};throw new h.Error("Unable to parse '"+e.trim()+"'")},h.logic.parse=function(r,n,i,e){return h.async.potentiallyAsync(this,e,function(){h.log.debug("Twig.logic.parse: ","Parsing logic token ",r);var e=h.logic.handler[r.type],t=this;return e.parse?(t.nestingStack.unshift(r),e=e.parse.call(t,r,n||{},i),h.isPromise(e)?e=e.then(function(e){return t.nestingStack.shift(),e}):t.nestingStack.shift(),e):""})},h}},function(e,t,r){"use strict";e.exports=function(e){e.Templates.registerParser("source",function(e){return e.data||""})}},function(e,t,r){"use strict";e.exports=function(t){t.Templates.registerParser("twig",function(e){return new t.Template(e)})}},function(e,t,h){"use strict";var u=h(0)(h(1));e.exports=function(c){return c.path={},c.path.parsePath=function(e,t){var r=null,n=e.options.namespaces,i=t||"";if(n&&"object"===(0,u.default)(n))for(r in n)if(i.includes(r)){var o=new RegExp("^"+r+"::"),s=new RegExp("^@"+r+"/"),a=n[r].replace(/([^/])$/,"$1/");if(o.test(i))return i=i.replace(o,a);if(s.test(i))return i=i.replace(s,a)}return c.path.relativePath(e,i)},c.path.relativePath=function(e,t){var r,n,i="/",o=[],s=t||"";if(e.url)a=void 0===e.base?e.url:e.base.replace(/([^/])$/,"$1/");else if(e.path){var a,u=h(6),l=u.sep||i,t=new RegExp("^\\.{1,2}"+l.replace("\\","\\\\")),s=s.replace(/\//g,l);a=(a=void 0!==e.base&&null===s.match(t)?(s=s.replace(e.base,""),e.base+l):u.normalize(e.path)).replace(l+l,l),i=l}else{if(!e.name&&!e.id||!e.method||"fs"===e.method||"ajax"===e.method)throw new c.Error("Cannot extend an inline template.");a=e.base||e.name||e.id}for((r=a.split(i)).pop(),r=r.concat(s.split(i));0<r.length;)"."===(n=r.shift())||(".."===n&&0<o.length&&".."!==o[o.length-1]?o.pop():o.push(n));return o.join(i)},c}},function(e,t,r){"use strict";e.exports=function(n){return n.tests={empty:function(e){if(null==e)return!0;if("number"==typeof e)return!1;if(0<e.length)return!1;for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},odd:function(e){return e%2==1},even:function(e){return e%2==0},divisibleby:function(e,t){return e%t[0]==0},defined:function(e){return void 0!==e},none:function(e){return null===e},null:function(e){return this.none(e)},"same as":function(e,t){return e===t[0]},sameas:function(e,t){return console.warn("`sameas` is deprecated use `same as`"),n.tests["same as"](e,t)},iterable:function(e){return e&&(n.lib.is("Array",e)||n.lib.is("Object",e))}},n.test=function(e,t,r){if(!n.tests[e])throw n.Error("Test "+e+" is not defined.");return n.tests[e](t,r)},n.test.extend=function(e,t){n.tests[e]=t},n}},function(e,t,r){"use strict";e.exports=function(u){return u.ParseState.prototype.parseAsync=function(e,t){return this.parse(e,t,!0)},u.expression.parseAsync=function(e,t,r){return u.expression.parse.call(this,e,t,r,!0)},u.logic.parseAsync=function(e,t,r){return u.logic.parse.call(this,e,t,r,!0)},u.Template.prototype.renderAsync=function(e,t){return this.render(e,t,!0)},u.async={},u.isPromise=function(e){return e&&e.then&&"function"==typeof e.then},u.async.potentiallyAsync=function(e,t,r){return t?u.Promise.resolve(r.call(e)):function(e,t){var r=t.call(e),n=null,i=!0;if(!u.isPromise(r))return r;if(r.then(function(e){r=e,i=!1}).catch(function(e){n=e}),null!==n)throw n;if(i)throw new u.Error("You are using Twig.js in sync mode in combination with async extensions.");return r}(e,r)},u.Thenable=function(e,t,r){this.then=e,this._value=r?t:null,this._state=r||0},u.Thenable.prototype.catch=function(e){return 1===this._state?this:this.then(null,e)},u.Thenable.resolvedThen=function(e){try{return u.Promise.resolve(e(this._value))}catch(e){return u.Promise.reject(e)}},u.Thenable.rejectedThen=function(e,t){if(!t||"function"!=typeof t)return this;var r,n=this._value;try{r=t(n)}catch(e){r=u.Promise.reject(e)}return u.Promise.resolve(r)},u.Promise=function(e){var r=0,n=null,t=function(e,t){r=e,n=t};return function(e,t,r){try{e(t,r)}catch(e){r(e)}}(e,function(e){t(1,e)},function(e){t(2,e)}),1===r?u.Promise.resolve(n):2===r?u.Promise.reject(n):(t=new u.FullPromise).promise},u.FullPromise=function(){var r=null;function n(e){e(a._value)}function i(e,t){t(a._value)}var s=function(e,t){e=[e,e=t,-2],(t=r)?-2===t[2]?t=[t,e]:t.push(e):t=e,r=t};function e(e,t){if(!a._state&&(a._value=t,a._state=e,s=1===e?n:i,r)){if(-2===r[2])return s(r[0],r[1]),void(r=null);r.forEach(function(e){s(e[0],e[1])}),r=null}}var a=new u.Thenable(function(n,i){var e="function"==typeof n;if(1===a._state&&!e)return u.Promise.resolve(a._value);if(1===a._state)try{return u.Promise.resolve(n(a._value))}catch(e){return u.Promise.reject(e)}var o="function"==typeof i;return new u.Promise(function(t,r){s(e?function(e){try{t(n(e))}catch(e){r(e)}}:t,o?function(e){try{t(i(e))}catch(e){r(e)}}:r)})});return e.promise=a,e},u.Promise.defaultResolved=new u.Thenable(u.Thenable.resolvedThen,void 0,1),u.Promise.emptyStringResolved=new u.Thenable(u.Thenable.resolvedThen,"",1),u.Promise.resolve=function(e){return 0===arguments.length||void 0===e?u.Promise.defaultResolved:u.isPromise(e)?e:""===e?u.Promise.emptyStringResolved:new u.Thenable(u.Thenable.resolvedThen,e,1)},u.Promise.reject=function(e){return new u.Thenable(u.Thenable.rejectedThen,e,2)},u.Promise.all=function(e){var r=new Array(e.length);return u.async.forEach(e,function(e,t){if(u.isPromise(e)){if(1!==e._state)return e.then(function(e){r[t]=e});r[t]=e._value}else r[t]=e}).then(function(){return r})},u.async.forEach=function(r,n){var i=r?r.length:0,o=0;return function e(){var t=null;do{if(o===i)return u.Promise.resolve()}while(t=n(r[o],o),o++,!t||!u.isPromise(t)||1===t._state);return t.then(e)}()},u}},function(e,t,r){"use strict";e.exports=function(a){return a.exports={VERSION:a.VERSION},a.exports.twig=function(e){var t=e.id,r={strictVariables:e.strict_variables||!1,autoescape:null!==e.autoescape&&e.autoescape||!1,allowInlineIncludes:e.allowInlineIncludes||!1,rethrow:e.rethrow||!1,namespaces:e.namespaces};if(a.cache&&t&&a.validateId(t),void 0!==e.debug&&(a.debug=e.debug),void 0!==e.trace&&(a.trace=e.trace),void 0!==e.data)return a.Templates.parsers.twig({data:e.data,path:Object.hasOwnProperty.call(e,"path")?e.path:void 0,module:e.module,id:t,options:r});if(void 0!==e.ref){if(void 0!==e.id)throw new a.Error("Both ref and id cannot be set on a twig.js template.");return a.Templates.load(e.ref)}if(void 0===e.method)return void 0!==e.href?a.Templates.loadRemote(e.href,{id:t,method:"ajax",parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:r},e.load,e.error):void 0!==e.path?a.Templates.loadRemote(e.path,{id:t,method:"fs",parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:r},e.load,e.error):void 0;if(!a.Templates.isRegisteredLoader(e.method))throw new a.Error('Loader for "'+e.method+'" is not defined.');return a.Templates.loadRemote(e.name||e.href||e.path||t||void 0,{id:t,method:e.method,parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:r},e.load,e.error)},a.exports.extendFilter=function(e,t){a.filter.extend(e,t)},a.exports.extendFunction=function(e,t){a._function.extend(e,t)},a.exports.extendTest=function(e,t){a.test.extend(e,t)},a.exports.extendTag=function(e){a.logic.extend(e)},a.exports.extend=function(e){e(a)},a.exports.compile=function(e,t){var r=t.filename,n=t.filename,i=new a.Template({data:e,path:n,id:r,options:t.settings["twig options"]});return function(e){return i.render(e)}},a.exports.renderFile=function(e,t,r){"function"==typeof t&&(r=t,t={});var n=(t=t||{}).settings||{},i=n["twig options"],o={path:e,base:n.views,load:function(e){i&&i.allowAsync?e.renderAsync(t).then(function(e){return r(null,e)},r):r(null,String(e.render(t)))},error:function(e){r(e)}};if(i)for(var s in i)Object.hasOwnProperty.call(i,s)&&(o[s]=i[s]);a.exports.twig(o)},a.exports.__express=a.exports.renderFile,a.exports.cache=function(e){a.cache=e},a.exports.path=a.path,a.exports.filters=a.filters,a.exports.tests=a.tests,a.exports.functions=a.functions,a.exports.Promise=a.Promise,a}}],i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===_typeof3(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=7);function i(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var r,n},"object"===_typeof3(i)&&"object"===_typeof3(n)?n.exports=t():"function"==typeof define&&define.amd?define([],t):"object"===_typeof3(i)?i.Twig=t():e.Twig=t()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{fs:75,path:260}],268:[function(e,t,r){"use strict";var n=e("../prototype/is");t.exports=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!n(e)}},{"../prototype/is":271}],269:[function(e,t,r){"use strict";var n=e("../value/is"),i={object:!0,function:!0,undefined:!0};t.exports=function(e){return!!n(e)&&hasOwnProperty.call(i,_typeof3(e))}},{"../value/is":272}],270:[function(e,t,r){"use strict";var n=e("../function/is"),i=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(e){return!!n(e)&&!i.test(o.call(e))}},{"../function/is":268}],271:[function(e,t,r){"use strict";var n=e("../object/is");t.exports=function(e){if(!n(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch(e){return!1}}},{"../object/is":269}],272:[function(e,t,r){"use strict";t.exports=function(e){return null!=e}},{}],273:[function(e,t,r){function n(e,t){function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}var n,i={};"key"in(t="string"==typeof t?{key:t}:t||{key:"weight"})||(t.key="weight"),"compareFunction"in t||(t.compareFunction=function(e,t){return e===t?0:r(e)&&r(t)?parseFloat(e)<parseFloat(t)?-1:1:e<t?-1:1});var o=!1;if(void 0===e.length){var s=[],o=!0;for(p in e)e[p].__weightSort_index=p,s.push(e[p]);e=s}for(p=0;p<e.length;p++){var a,u=e[p],u=u.length?(a=u[0],u[1]):(a=u[t.key],u);"function"==typeof a&&(a=a()),i[a=a||0]||(i[a]=[]),i[a].push(u)}var l,c=[];for(l in i)c.push(l);c.sort(t.compareFunction),t.reverse&&c.reverse();for(var h=[],p=0;p<c.length;p++)for(n=0;n<i[c[p]].length;n++)h.push(i[c[p]][n]);if(o){for(s={},p=0;p<h.length;p++){var f=h[p],d=f.__weightSort_index;delete f.__weightSort_index,s[d]=f}h=s}return h}void 0!==t&&t.exports&&(t.exports=n),"undefined"!=typeof window&&(window.weightSort=n,window.weight_sort=n)},{}],274:[function(e,t,r){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},{}],275:[function(e,t,r){function n(e){this.options=e||{locator:{}}}function l(){this.cdata=!1}function c(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function h(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function i(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function p(e,t){(e.currentElement||e.doc).appendChild(t)}n.prototype.parseFromString=function(e,t){var r=this.options,n=new f,i=r.domBuilder||new l,o=r.errorHandler,s=r.locator,a=r.xmlns||{},u={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return s&&i.setDocumentLocator(s),n.errorHandler=function(n,e,i){if(!n){if(e instanceof l)return e;n=e}var o={},s=n instanceof Function;function t(t){var r=n[t];!r&&s&&(r=2==n.length?function(e){n(t,e)}:n),o[t]=r?function(e){r("[xmldom "+t+"]\t"+e+h(i))}:function(){}}return i=i||{},t("warning"),t("error"),t("fatalError"),o}(o,i,s),n.domBuilder=r.domBuilder||i,/\/x?html?$/.test(t)&&(u.nbsp="Â ",u.copy="Â©",a[""]="http://www.w3.org/1999/xhtml"),a.xml=a.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,a,u):n.errorHandler.error("invalid doc source"),i.doc},l.prototype={startDocument:function(){this.doc=(new o).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var i=this.doc,o=i.createElementNS(e,r||t),s=n.length;p(this,o),this.currentElement=o,this.locator&&c(this.locator,o);for(var a=0;a<s;a++){var e=n.getURI(a),u=n.getValue(a),r=n.getQName(a),l=i.createAttributeNS(e,r);this.locator&&c(n.getLocator(a),l),l.value=l.nodeValue=u,o.setAttributeNode(l)}},endElement:function(){var e=this.currentElement;e.tagName;this.currentElement=e.parentNode},startPrefixMapping:function(){},endPrefixMapping:function(){},processingInstruction:function(e,t){t=this.doc.createProcessingInstruction(e,t);this.locator&&c(this.locator,t),p(this,t)},ignorableWhitespace:function(){},characters:function(e,t,r){var n;(e=i.apply(this,arguments))&&(n=this.cdata?this.doc.createCDATASection(e):this.doc.createTextNode(e),this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&c(this.locator,n))},skippedEntity:function(){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=i.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&c(this.locator,n),p(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;n&&n.createDocumentType&&(r=n.createDocumentType(e,t,r),this.locator&&c(this.locator,r),p(this,r))},warning:function(e){console.warn("[xmldom warning]\t"+e,h(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,h(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,h(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){l.prototype[e]=function(){return null}});var f=e("./sax").XMLReader,o=r.DOMImplementation=e("./dom").DOMImplementation;r.XMLSerializer=e("./dom").XMLSerializer,r.DOMParser=n},{"./dom":276,"./sax":277}],276:[function(e,t,r){function i(e,t){for(var r in e)t[r]=e[r]}function n(e,t){var r,n=e.prototype;Object.create&&(r=Object.create(t.prototype),n.__proto__=r),n instanceof t||((r=function(){}).prototype=t.prototype,i(n,r=new r),e.prototype=n=r),n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}var o,y="http://www.w3.org/1999/xhtml",s={},m=s.ELEMENT_NODE=1,g=s.ATTRIBUTE_NODE=2,v=s.TEXT_NODE=3,b=s.CDATA_SECTION_NODE=4,w=s.ENTITY_REFERENCE_NODE=5,x=(s.ENTITY_NODE=6,s.PROCESSING_INSTRUCTION_NODE=7),_=s.COMMENT_NODE=8,k=s.DOCUMENT_NODE=9,E=s.DOCUMENT_TYPE_NODE=10,S=s.DOCUMENT_FRAGMENT_NODE=11,a=(s.NOTATION_NODE=12,{}),u={};a.INDEX_SIZE_ERR=(u[1]="Index size error",1),a.DOMSTRING_SIZE_ERR=(u[2]="DOMString size error",2),a.HIERARCHY_REQUEST_ERR=(u[3]="Hierarchy request error",3),a.WRONG_DOCUMENT_ERR=(u[4]="Wrong document",4),a.INVALID_CHARACTER_ERR=(u[5]="Invalid character",5),a.NO_DATA_ALLOWED_ERR=(u[6]="No data allowed",6),a.NO_MODIFICATION_ALLOWED_ERR=(u[7]="No modification allowed",7),a.NOT_FOUND_ERR=(u[8]="Not found",8),a.NOT_SUPPORTED_ERR=(u[9]="Not supported",9),a.INUSE_ATTRIBUTE_ERR=(u[10]="Attribute in use",10),a.INVALID_STATE_ERR=(u[11]="Invalid state",11),a.SYNTAX_ERR=(u[12]="Syntax error",12),a.INVALID_MODIFICATION_ERR=(u[13]="Invalid modification",13),a.NAMESPACE_ERR=(u[14]="Invalid namespace",14),a.INVALID_ACCESS_ERR=(u[15]="Invalid access",15);function l(e,t){var r;return t instanceof Error?r=t:(r=this,Error.call(this,u[e]),this.message=u[e],Error.captureStackTrace&&Error.captureStackTrace(this,l)),r.code=e,t&&(this.message=this.message+": "+t),r}function p(){}function c(e,t){this._node=e,this._refresh=t,h(this)}function h(e){var t,r=e._node._inc||e._node.ownerDocument._inc;e._inc!=r&&(t=e._refresh(e._node),Z(e,"length",t.length),i(t,e),e._inc=r)}function f(){}function d(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function O(e,t,r,n){n?t[d(t,n)]=r:t[t.length++]=r,!e||(t=(r.ownerElement=e).ownerDocument)&&(n&&I(t,e,n),e=e,r=r,(t=t)&&t._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&(e._nsMap[r.prefix?r.localName:""]=r.value))}function A(e,t,r){var n=d(t,r);if(!(0<=n))throw l(8,new Error(e.tagName+"@"+r));for(var i,o=t.length-1;n<o;)t[n]=t[++n];t.length=o,!e||(i=e.ownerDocument)&&(I(i,e,r),r.ownerElement=null)}function M(e){if(this._features={},e)for(var t in e)this._features=e[t]}function P(){}function j(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function T(e,t){if(t(e))return 1;if(e=e.firstChild)do{if(T(e,t))return 1}while(e=e.nextSibling)}function C(){}function I(e,t,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&delete t._nsMap[r.prefix?r.localName:""]}function N(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var i=t.firstChild,o=0;i;)i=(n[o++]=i).nextSibling;n.length=o}}}function L(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,N(e.ownerDocument,e),t}function F(e,t,r){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===S){var i=t.firstChild;if(null==i)return t;var o=t.lastChild}else i=o=t;n=r?r.previousSibling:e.lastChild;for(i.previousSibling=n,o.nextSibling=r,n?n.nextSibling=i:e.firstChild=i,null==r?e.lastChild=o:r.previousSibling=o;i.parentNode=e,i!==o&&(i=i.nextSibling););return N(e.ownerDocument||e,e),t.nodeType==S&&(t.firstChild=t.lastChild=null),t}function R(){this._nsMap={}}function D(){}function q(){}function B(){}function z(){}function $(){}function G(){}function U(){}function W(){}function J(){}function V(){}function X(){}function H(){}function Y(e,t){var r,n=[],i=9==this.nodeType?this.documentElement:this,o=i.prefix,s=i.namespaceURI;return s&&null==o&&null==(o=i.lookupPrefix(s))&&(r=[{namespace:s,prefix:null}]),Q(this,n,e,t,r),n.join("")}function K(e,t,r){var n=e.prefix||"",i=e.namespaceURI;if((n||i)&&("xml"!==n||"http://www.w3.org/XML/1998/namespace"!==i)&&"http://www.w3.org/2000/xmlns/"!=i){for(var o=r.length;o--;){var s=r[o];if(s.prefix==n)return s.namespace!=i}return 1}}function Q(e,t,r,n,i){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case m:i=i||[];var o=e.attributes,s=o.length,a=e.firstChild,u=e.tagName;r=y===e.namespaceURI||r,t.push("<",u);for(var l=0;l<s;l++)"xmlns"==(c=o.item(l)).prefix?i.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&i.push({prefix:"",namespace:c.value});for(var c,h,p,f,l=0;l<s;l++)K(c=o.item(l),0,i)&&(h=c.prefix||"",p=c.namespaceURI,f=h?" xmlns:"+h:" xmlns",t.push(f,'="',p,'"'),i.push({prefix:h,namespace:p})),Q(c,t,r,n,i);if(K(e,0,i)&&(h=e.prefix||"",p=e.namespaceURI,f=h?" xmlns:"+h:" xmlns",t.push(f,'="',p,'"'),i.push({prefix:h,namespace:p})),a||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(t.push(">"),r&&/^script$/i.test(u))for(;a;)a.data?t.push(a.data):Q(a,t,r,n,i),a=a.nextSibling;else for(;a;)Q(a,t,r,n,i),a=a.nextSibling;t.push("</",u,">")}else t.push("/>");return;case k:case S:for(a=e.firstChild;a;)Q(a,t,r,n,i),a=a.nextSibling;return;case g:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,j),'"');case v:return t.push(e.data.replace(/[<&]/g,j));case b:return t.push("<![CDATA[",e.data,"]]>");case _:return t.push("\x3c!--",e.data,"--\x3e");case E:var d=e.publicId,u=e.systemId;return t.push("<!DOCTYPE ",e.name),void(d?(t.push(' PUBLIC "',d),u&&"."!=u&&t.push('" "',u),t.push('">')):u&&"."!=u?t.push(' SYSTEM "',u,'">'):((u=e.internalSubset)&&t.push(" [",u,"]"),t.push(">")));case x:return t.push("<?",e.target," ",e.data,"?>");case w:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function Z(e,t,r){e[t]=r}l.prototype=Error.prototype,i(a,l),p.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)Q(this[n],r,e,t);return r.join("")}},c.prototype.item=function(e){return h(this),this[e]},n(c,p),f.prototype={length:0,item:p.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new l(10);t=this.getNamedItem(e.nodeName);return O(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new l(10);return t=this.getNamedItemNS(e.namespaceURI,e.localName),O(this._ownerElement,this,e,t),t},removeNamedItem:function(e){e=this.getNamedItem(e);return A(this._ownerElement,this,e),e},removeNamedItemNS:function(e,t){t=this.getNamedItemNS(e,t);return A(this._ownerElement,this,t),t},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},M.prototype={hasFeature:function(e,t){e=this._features[e.toLowerCase()];return!(!e||t&&!(t in e))},createDocument:function(e,t,r){var n=new C;return n.implementation=this,n.childNodes=new p,(n.doctype=r)&&n.appendChild(r),t&&(t=n.createElementNS(e,t),n.appendChild(t)),n},createDocumentType:function(e,t,r){var n=new G;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=r,n}},P.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return F(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return L(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,r,n){var i=new r.constructor;for(var o in r){var s=r[o];"object"!=_typeof3(s)&&s!=i[o]&&(i[o]=s)}r.childNodes&&(i.childNodes=new p);i.ownerDocument=t;switch(i.nodeType){case m:var a=r.attributes,u=i.attributes=new f,l=a.length;u._ownerElement=i;for(var c=0;c<l;c++)i.setAttributeNode(e(t,a.item(c),!0));break;case g:n=!0}if(n)for(var h=r.firstChild;h;)i.appendChild(e(t,h,n)),h=h.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==v&&e.nodeType==v?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(r[n]==e)return n;t=t.nodeType==g?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&e in r)return r[e];t=t.nodeType==g?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},i(s,P),i(s,P.prototype),C.prototype={nodeName:"#document",nodeType:k,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=S)return null==this.documentElement&&e.nodeType==m&&(this.documentElement=e),F(this,e,t),e.ownerDocument=this,e;for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),L(this,e)},importNode:function(e,t){return function e(t,r,n){var i;switch(r.nodeType){case m:(i=r.cloneNode(!1)).ownerDocument=t;case S:break;case g:n=!0}i=i||r.cloneNode(!1);i.ownerDocument=t;i.parentNode=null;if(n)for(var o=r.firstChild;o;)i.appendChild(e(t,o,n)),o=o.nextSibling;return i}(this,e,t)},getElementById:function(t){var r=null;return T(this.documentElement,function(e){if(e.nodeType==m&&e.getAttribute("id")==t)return r=e,!0}),r},createElement:function(e){var t=new R;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new p,(t.attributes=new f)._ownerElement=t},createDocumentFragment:function(){var e=new V;return e.ownerDocument=this,e.childNodes=new p,e},createTextNode:function(e){var t=new B;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new z;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new X;return r.ownerDocument=this,r.tagName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new D;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new J;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new R,n=t.split(":"),i=r.attributes=new f;return r.childNodes=new p,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,i._ownerElement=r},createAttributeNS:function(e,t){var r=new D,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},n(C,P),C.prototype.getElementsByTagName=(R.prototype={nodeType:m,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){e=this.getAttributeNode(e);return e&&e.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){e=this.ownerDocument.createAttribute(e);e.value=e.nodeValue=""+t,this.setAttributeNode(e)},removeAttribute:function(e){e=this.getAttributeNode(e);e&&this.removeAttributeNode(e)},appendChild:function(e){return e.nodeType===S?this.insertBefore(e,null):function(e,t){var r=t.parentNode;r&&(n=e.lastChild,r.removeChild(t),n=e.lastChild);var n=e.lastChild;return t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,N(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){t=this.getAttributeNodeNS(e,t);t&&this.removeAttributeNode(t)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){t=this.getAttributeNodeNS(e,t);return t&&t.value||""},setAttributeNS:function(e,t,r){t=this.ownerDocument.createAttributeNS(e,t);t.value=t.nodeValue=""+r,this.setAttributeNode(t)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(n){return new c(this,function(t){var r=[];return T(t,function(e){e===t||e.nodeType!=m||"*"!==n&&e.tagName!=n||r.push(e)}),r})},getElementsByTagNameNS:function(n,i){return new c(this,function(t){var r=[];return T(t,function(e){e===t||e.nodeType!==m||"*"!==n&&e.namespaceURI!==n||"*"!==i&&e.localName!=i||r.push(e)}),r})}}).getElementsByTagName,C.prototype.getElementsByTagNameNS=R.prototype.getElementsByTagNameNS,n(R,P),D.prototype.nodeType=g,n(D,P),q.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(){throw new Error(u[3])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},n(q,P),B.prototype={nodeName:"#text",nodeType:v,splitText:function(e){var t=(r=this.data).substring(e),r=r.substring(0,e);this.data=this.nodeValue=r,this.length=r.length;t=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling),t}},n(B,q),z.prototype={nodeName:"#comment",nodeType:_},n(z,q),$.prototype={nodeName:"#cdata-section",nodeType:b},n($,q),G.prototype.nodeType=E,n(G,P),U.prototype.nodeType=12,n(U,P),W.prototype.nodeType=6,n(W,P),J.prototype.nodeType=w,n(J,P),V.prototype.nodeName="#document-fragment",V.prototype.nodeType=S,n(V,P),X.prototype.nodeType=x,n(X,P),H.prototype.serializeToString=function(e,t,r){return Y.call(e,t,r)},P.prototype.toString=Y;try{Object.defineProperty&&(o=function e(t){switch(t.nodeType){case m:case S:var r=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}},Object.defineProperty(c.prototype,"length",{get:function(){return h(this),this.$$length}}),Object.defineProperty(P.prototype,"textContent",{get:function(){return o(this)},set:function(e){switch(this.nodeType){case m:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Z=function(e,t,r){e["$$"+t]=r})}catch(e){}r.DOMImplementation=M,r.XMLSerializer=H},{}],277:[function(e,t,r){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,i=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+n.source+i.source+"*(?::"+n.source+i.source+"*)?$"),M=0,P=1,j=2,T=3,C=4,I=5,N=6,L=7;function s(){}function F(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function R(e,t,r){for(var n=e.tagName,i=null,o=e.length;o--;){var s=e[o],a=s.qName,u=s.value,a=0<(c=a.indexOf(":"))?(l=s.prefix=a.slice(0,c),h=a.slice(c+1),"xmlns"===l&&h):(l=null,"xmlns"===(h=a)&&"");s.localName=h,!1!==a&&(null==i&&(i={},f(r,r={})),r[a]=i[a]=u,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(a,u))}for(var l,o=e.length;o--;)(l=(s=e[o]).prefix)&&("xml"===l&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(s.uri=r[l||""]));var c,h=0<(c=n.indexOf(":"))?(l=e.prefix=n.slice(0,c),e.localName=n.slice(c+1)):(l=null,e.localName=n),p=e.uri=r[l||""];if(t.startElement(p,h,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=i,1;if(t.endElement(p,h,n),i)for(l in i)t.endPrefixMapping(l)}function f(e,t){for(var r in e)t[r]=e[r]}function D(e){}function a(e,t){return e.__proto__=t,e}s.prototype={parse:function(e,A,t){var r=this.domBuilder;r.startDocument(),f(A,A={}),function(r,n,i,o){function s(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(65535<e){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function e(e){var t;f<e&&(t=r.substring(f,e).replace(/&#?\w+;/g,s),h&&a(f),i.characters(t,0,e-f),f=e)}function a(e,t){for(;l<=e&&(t=c.exec(r));)u=t.index,l=u+t[0].length,h.lineNumber++;h.columnNumber=e-u+1}for(var u=0,l=0,c=/.*(?:\r\n?|\n)|.*$/g,h=i.locator,t=[{currentNSMap:A}],p={},f=0;;){try{var d,y,m=r.indexOf("<",f);if(m<0)return r.substr(f).match(/^\s*$/)||(d=i.doc,y=d.createTextNode(r.substr(f)),d.appendChild(y),i.currentElement=y);switch(f<m&&e(m),r.charAt(m+1)){case"/":var g=r.indexOf(">",m+3),v=r.substring(m+2,g),b=t.pop();g<0?(v=r.substring(m+2).replace(/[\s<].*/,""),o.error("end tag name: "+v+" is not complete:"+b.tagName),g=m+1+v.length):v.match(/\s</)&&(v=v.replace(/[\s<].*/,""),o.error("end tag name: "+v+" maybe not complete"),g=m+1+v.length);var w=b.localNSMap,x=b.tagName==v;if(x||b.tagName&&b.tagName.toLowerCase()==v.toLowerCase()){if(i.endElement(b.uri,b.localName,v),w)for(var _ in w)i.endPrefixMapping(_);x||o.fatalError("end tag name: "+v+" is not match the current start tagName:"+b.tagName)}else t.push(b);g++;break;case"?":h&&a(m),g=function(e,t,r){var n=e.indexOf("?>",t);if(n){t=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(t){t[0].length;return r.processingInstruction(t[1],t[2]),n+2}return-1}return-1}(r,m,i);break;case"!":h&&a(m),g=function(e,t,r,n){{if("-"===e.charAt(t+2)){if("-"!==e.charAt(t+3))return-1;var i=e.indexOf("--\x3e",t+4);return t<i?(r.comment(e,t+4,i-t-4),i+3):(n.error("Unclosed comment"),-1)}if("CDATA["==e.substr(t+3,6)){i=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,i-t-9),r.endCDATA(),i+3}var o=function(e,t){var r,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;r=i.exec(e);)if(n.push(r),r[1])return n}(e,t),n=o.length;if(1<n&&/!doctype/i.test(o[0][0])){i=o[1][0],e=3<n&&/^public$/i.test(o[2][0])&&o[3][0],t=4<n&&o[4][0],n=o[n-1];return r.startDTD(i,e&&e.replace(/^(['"])(.*?)\1$/,"$2"),t&&t.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),n.index+n[0].length}}return-1}(r,m,i,o);break;default:h&&a(m);var k=new D,v=t[t.length-1].currentNSMap,g=function(e,t,r,n,i,o){var s,a=++t,u=M;for(;;){var l=e.charAt(a);switch(l){case"=":if(u===P)s=e.slice(t,a),u=T;else{if(u!==j)throw new Error("attribute equal must after attrName");u=T}break;case"'":case'"':if(u===T||u===P){if(u===P&&(o.warning('attribute value must after "="'),s=e.slice(t,a)),t=a+1,!(0<(a=e.indexOf(l,t))))throw new Error("attribute value no end '"+l+"' match");c=e.slice(t,a).replace(/&#?\w+;/g,i),r.add(s,c,t-1),u=I}else{if(u!=C)throw new Error('attribute value must after "="');c=e.slice(t,a).replace(/&#?\w+;/g,i),r.add(s,c,t),o.warning('attribute "'+s+'" missed start quot('+l+")!!"),t=a+1,u=I}break;case"/":switch(u){case M:r.setTagName(e.slice(t,a));case I:case N:case L:u=L,r.closed=!0;case C:case P:case j:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),u==M&&r.setTagName(e.slice(t,a)),a;case">":switch(u){case M:r.setTagName(e.slice(t,a));case I:case N:case L:break;case C:case P:"/"===(c=e.slice(t,a)).slice(-1)&&(r.closed=!0,c=c.slice(0,-1));case j:u===j&&(c=s),u==C?(o.warning('attribute "'+c+'" missed quot(")!!'),r.add(s,c.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===n[""]&&c.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),r.add(c,c,t));break;case T:throw new Error("attribute value missed!!")}return a;case"Â":l=" ";default:if(l<=" ")switch(u){case M:r.setTagName(e.slice(t,a)),u=N;break;case P:s=e.slice(t,a),u=j;break;case C:var c=e.slice(t,a).replace(/&#?\w+;/g,i);o.warning('attribute "'+c+'" missed quot(")!!'),r.add(s,c,t);case I:u=N}else switch(u){case j:r.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&s.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),r.add(s,s,t),t=a,u=P;break;case I:o.warning('attribute space is required"'+s+'"!!');case N:u=P,t=a;break;case T:u=C,t=a;break;case L:throw new Error("elements closed character '/' and '>' must be connected to")}}a++}}(r,m,k,v,s,o),E=k.length;if(!k.closed&&function(e,t,r,n){var i=n[r];null==i&&((i=e.lastIndexOf("</"+r+">"))<t&&(i=e.lastIndexOf("</"+r)),n[r]=i);return i<t}(r,g,k.tagName,p)&&(k.closed=!0,n.nbsp||o.warning("unclosed xml attribute")),h&&E){for(var b=F(h,{}),S=0;S<E;S++){var O=k[S];a(O.offset),O.locator=F(h,{})}i.locator=b,R(k,i,v)&&t.push(k),i.locator=h}else R(k,i,v)&&t.push(k);"http://www.w3.org/1999/xhtml"!==k.uri||k.closed?g++:g=function(e,t,r,n,i){if(/^(?:script|textarea)$/i.test(r)){var o=e.indexOf("</"+r+">",t),e=e.substring(t+1,o);if(/[&<]/.test(e))return/^script$/i.test(r)||(e=e.replace(/&#?\w+;/g,n)),i.characters(e,0,e.length),o}return t+1}(r,g,k.tagName,s,i)}}catch(e){o.error("element parse error: "+e),g=-1}f<g?f=g:e(Math.max(m,f)+1)}}(e,t,r,this.errorHandler),r.endDocument()}},D.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!o.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},a({},a.prototype),r.XMLReader=s},{}],278:[function(e,t,r){var n=e("./isTrue"),d=e("./styleToLeaflet"),i=e("./parseLength"),e=function(){"use strict";function t(e){_classCallCheck2(this,t),this.layer=e,L.polylineDecorator&&(this.layer.on("update",this.processObject.bind(this)),this.layer.on("remove",this.removeObject.bind(this)))}return _createClass2(t,[{key:"parseType",value:function(e,t,r){switch(e){case"polygon":case"rotate":return n(t);case"pixelSize":case"repeat":case"offset":case"endOffset":case"lineOffset":return i(t,r.map.metersPerPixel);case"angleCorrection":case"headAngle":return parseFloat(t);default:return t}}},{key:"processObject",value:function(e,c){var h,p=this;for(h in c.patternFeatures||(c.patternFeatures={}),c.features){var f="default"===h?c.data.style:c.data["style:"+h];c.styles.includes(h)?function(){var e,t,n={},i=[],o={};for(e in f){var r=e.match(/^pattern([^-]*)$/);r&&(n[r[1]]=f[e],i[r[1]]={},o[r[1]]={})}for(t in f){var s=t.match(/^pattern([^-]*)-path-(.*)$/),a=t.match(/^pattern([^-]*)-(.*)$/);s?o[s[1]][s[2]]=f[t]:a&&(i[a[1]][a[2]]=p.parseType(a[2],f[t],c.twigData))}var u=Object.keys(n),l=[];u.forEach(function(e){var t,r=i[e];switch(n[e]){case"dash":r.pathOptions=d(o[e],c.twigData),t=L.Symbol.dash(r);break;case"streak":r.pathOptions=d(o[e],c.twigData),t=L.Symbol.streak(r);break;case"arrowHead":r.pathOptions=d(o[e],c.twigData),t=L.Symbol.arrowHead(r);break;case"marker":r.markerOptions=o[e],t=L.Symbol.marker(r)}t&&(i[e].symbol=t,l.push(i[e]))}),c.patternFeatures[h]||(c.patternFeatures[h]=L.polylineDecorator(c.features[h]),c.patternFeatures[h].addTo(p.layer.map)),c.patternFeatures[h].setPatterns(l),p.layer._shallBindPopupToStyle(h)&&c.patternFeatures[h].bindPopup(c.popup)}():c.patternFeatures[h]&&(this.layer.map.removeLayer(c.patternFeatures[h]),delete c.patternFeatures[h])}}},{key:"removeObject",value:function(e,t){if(t.patternFeatures)for(var r in t.features)t.patternFeatures[r]&&(this.layer.map.removeLayer(t.patternFeatures[r]),delete t.patternFeatures[r])}}]),t}();t.exports=e},{"./isTrue":288,"./parseLength":289,"./styleToLeaflet":292}],279:[function(e,t,r){var n=e("./Sublayer"),e=function(){"use strict";_inherits(s,n);var r=_createSuper(s);function s(e,t){return _classCallCheck2(this,s),(t=r.call(this,e,t)).masterlayer=t.master.mainlayer,t.masterlayer.on("add",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.masterlayer.on("remove",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.masterlayer.on("update",t.featureOnMainModified.bind(_assertThisInitialized(t))),t.on("add",t.featureMemberModified.bind(_assertThisInitialized(t))),t.on("remove",t.featureMemberModified.bind(_assertThisInitialized(t))),t}return _createClass2(s,[{key:"featureMemberModified",value:function(e){var t=this;e.memberOf.forEach(function(e){t.masterlayer.scheduleReprocess(e.id)})}},{key:"featureOnMainModified",value:function(e){var t=this;e.members&&e.members.forEach(function(e){e.id in t.visibleFeatures&&t.scheduleReprocess(e.id)})}},{key:"twigData",value:function(n,e){var t,i=this,o=_get(_getPrototypeOf(s.prototype),"twigData",this).call(this,n,e);for(t in this.masterlayer.visibleFeatures)!function(){var r=i.masterlayer.visibleFeatures[t];r.object.members&&r.object.members.forEach(function(e,t){e.id===n.id&&("masters"in o||(o.masters=[]),o.masters.push({id:r.id,type:r.object.type,osm_id:r.object.osm_id,tags:r.object.tags,meta:r.object.meta,role:e.role,dir:e.dir,connectedPrev:e.connectedPrev,connectedNext:e.connectedNext,flags:r.flags,sequence:t}))})}();return o}}]),s}();t.exports=e},{"./Sublayer":284}],280:[function(e,t,r){var n=".leaflet-popup-content {\n  max-height: 250px;\n  overflow: auto;\n}\n.leaflet-popup-content pre {\n  font-size: 8px;\n}\n.overpass-layer-icon > img,\n.overpass-layer-icon > svg {\n  display: block;\n}\n.overpass-layer-icon div.sign {\n  position: relative;\n  font-size: 12px;\n  text-align: center;\n  transform: translate(-50%, -50%);\n  display: flex;\n  justify-content: center;\n}\n/*  top: -37px; */\n";e("browserify-css").createStyle(n,{href:"src/OverpassLayer.css"},{insertAt:"bottom"}),t.exports=n},{"browserify-css":76}],281:[function(l,f,e){(function(u){(function(){l("./OverpassLayer.css");var e=l("event-emitter"),c=l("boundingbox"),r=l("twig"),h=l("overpass-frontend"),n=l("html-escape"),p={intersect:l("@turf/intersect").default},i=l("./Sublayer"),o=l("./Memberlayer"),s=l("./compileFeature"),a=l("./compileTemplate"),t=function(){"use strict";function t(e){_classCallCheck2(this,t),e=e||{},this.options=e,this.overpassFrontend=("overpassFrontend"in this.options?this.options:u).overpassFrontend,this.options.minZoom="minZoom"in this.options?this.options.minZoom:16,this.options.maxZoom="maxZoom"in this.options?this.options.maxZoom:void 0,this.options.feature="feature"in this.options?this.options.feature:{},this.options.feature.style="style"in this.options.feature?this.options.feature.style:{},this.options.feature.title="title"in this.options.feature?this.options.feature.title:function(e){return n(e.tags.name||e.tags.operator||e.tags.ref||e.id)},this.options.feature.body="body"in this.options.feature?this.options.feature.body:"",this.options.feature.markerSymbol="markerSymbol"in this.options.feature?this.options.feature.markerSymbol:'<img anchorX="13" anchorY="42" width="25" height="42" signAnchorX="0" signAnchorY="-30" src="img/map_pointer.png">',this.options.feature.markerSign="markerSign"in this.options.feature?this.options.feature.markerSign:null,this.options.queryOptions="queryOptions"in this.options?this.options.queryOptions:{},"properties"in this.options.queryOptions||(this.options.queryOptions.properties=h.ALL),this.options.styleNoBindPopup=this.options.styleNoBindPopup||[],this.options.stylesNoAutoShow=this.options.stylesNoAutoShow||[],this.options.layouts=this.options.layouts||{},this.options.layouts.popup=this.options.layouts.popup||'<h1>{{ object.popupTitle|default(object.title) }}</h1>{% if object.popupDescription or object.description %}<div class="description">{{ object.popupDescription|default(object.description) }}</div>{% endif %}{% if object.popupBody or object.body %}<div class="body">{{ object.popupBody|default(object.body) }}</div>{% endif %}',s(this.options.feature,r,{autoescape:!0}),s(this.options.layouts,r,{autoescape:!1}),this.currentRequest=null,this.lastZoom=null,this.mainlayer=new i(this,e),this.subLayers={main:this.mainlayer},this.options.members&&(this.options.queryOptions.properties=h.TAGS|h.META|h.MEMBERS|h.BBOX,this.options.queryOptions.memberProperties=h.ALL,this.options.queryOptions.members=!0,e={id:this.options.id,sublayer_id:"member",minZoom:this.options.minZoom,maxZoom:this.options.maxZoom,feature:this.options.memberFeature,styleNoBindPopup:this.options.styleNoBindPopup||[],stylesNoAutoShow:this.options.stylesNoAutoShow||[],layouts:this.options.layouts,const:this.options.const},this.options.updateAssets&&(e.updateAssets=this.options.updateAssets),s(e.feature,r),this.memberlayer=new o(this,e),this.subLayers.member=this.memberlayer)}return _createClass2(t,[{key:"setBounds",value:function(e){this.options.bounds=e,this.check_update_map()}},{key:"setLayout",value:function(e,t){this.options.layouts[e]=a(t,r,{autoescape:!1})}},{key:"_layerAdd",value:function(e){this.addTo(e.target)}},{key:"onRemove",value:function(){this.remove()}},{key:"fire",value:function(){}},{key:"addTo",value:function(e){for(var t in this.map=e,this.map.on("moveend",this.check_update_map,this),this.subLayers)this.subLayers[t].addTo(e);this.check_update_map(),this.map.createPane("hover"),this.map.getPane("hover").style.zIndex=499}},{key:"remove",value:function(){for(var e in this.subLayers)this.subLayers[e].hideAll(!0),this.subLayers[e].remove();this.abortRequest(),this.map.off("moveend",this.check_update_map,this),this.map=null}},{key:"abortRequest",value:function(){this.currentRequest&&(this.onLoadEnd&&this.onLoadEnd({request:this.currentRequest,error:null}),this.currentRequest.abort(),this.currentRequest=null)}},{key:"setFilter",value:function(e){this.filter=e,this.check_update_map()}},{key:"calcGlobalTwigData",value:function(){this.globalTwigData={map:{zoom:this.map.getZoom(),metersPerPixel:40075016.686*Math.abs(Math.cos(this.map.getCenter().lat/180*Math.PI))/Math.pow(2,this.map.getZoom()+8)}},this.emit("globalTwigData",this.globalTwigData)}},{key:"check_update_map",value:function(){var r=this;if(this.map&&this.map._loaded){var e=JSON.parse(JSON.stringify(this.options.queryOptions)),t=new c(this.map.getBounds());if(!this.options.bounds||(t=p.intersect(t.toGeoJSON(),this.options.bounds)))if(this.map.getZoom()<this.options.minZoom||void 0!==this.options.maxZoom&&this.map.getZoom()>this.options.maxZoom){for(var n in this.subLayers)this.subLayers[n].hideAll();this.abortRequest()}else{for(var i in this.subLayers)this.subLayers[i].hideNonVisible(t);var o,s=this.options.query;if("object"===_typeof3(s)&&(s=s[Object.keys(s).filter(function(e){return e<=this.map.getZoom()}.bind(this)).reverse()[0]]),s!==this.lastQuery&&(o=new h.Filter(s),this.mainlayer.hideNonVisibleFilter(o),this.lastQuery=s),e.filter=this.filter,this.filter!==this.lastFilter&&(o=new h.Filter(this.filter),this.mainlayer.hideNonVisibleFilter(o),this.lastFilter=this.filter),this.lastZoom!==this.map.getZoom()){for(var a in this.calcGlobalTwigData(),this.subLayers)this.subLayers[a].zoomChange();this.lastZoom=this.map.getZoom()}if(this.abortRequest(),s){for(var u in this.subLayers)this.subLayers[u].startAdding();this.options.members&&(e.memberBounds=t,e.memberCallback=function(e,t){if(e)return console.error("unexpected error",e);r.memberlayer.add(t)}),this.currentRequest=this.overpassFrontend.BBoxQuery(s,t,e,function(e,t){e&&console.log("unexpected error",e),r.mainlayer.add(t)},function(e){for(var t in this.onLoadEnd&&this.onLoadEnd({request:this.currentRequest,error:e}),this.subLayers)this.subLayers[t].finishAdding();this.currentRequest=null}.bind(this)),this.onLoadStart&&this.onLoadStart({request:this.currentRequest})}}else for(var l in this.subLayers)this.subLayers[l].hideAll()}}},{key:"recalc",value:function(){for(var e in this.calcGlobalTwigData(),this.subLayers)this.subLayers[e].recalc()}},{key:"scheduleReprocess",value:function(e){for(var t in this.subLayers)this.subLayers[t].scheduleReprocess(e)}},{key:"updateAssets",value:function(e,t){for(var r in this.subLayers)this.subLayers[r].updateAssets(e,t)}},{key:"get",value:function(e,r){var n=!1;this.overpassFrontend.get(e,{properties:h.ALL},function(e,t){null===e&&r(e,t),n=!0},function(e){n||r(e,null)})}},{key:"show",value:function(e,t,r){var n=this.mainlayer;t.sublayer_id&&(n=this.subLayers[t.sublayer_id]);r=n.show(e,t,r);return{id:e,sublayer_id:t.sublayer_id,options:t,hide:r.hide}}},{key:"hide",value:function(e){this.mainlayer.hide(e)}},{key:"openPopupOnObject",value:function(e,t){t=1<arguments.length&&void 0!==t?t:"main";this.subLayers[t].openPopupOnObject(e)}},{key:"getShiftWorld",value:function(){return[360*Math.floor((this.map.getCenter().lng+270)/360),360*Math.floor((this.map.getCenter().lng+90)/360)]}}]),t}();e(t.prototype),t.twig=r,f.exports=t}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Memberlayer":279,"./OverpassLayer.css":280,"./Sublayer":284,"./compileFeature":286,"./compileTemplate":287,"@turf/intersect":46,boundingbox:74,"event-emitter":94,"html-escape":98,"overpass-frontend":232,twig:267}],282:[function(e,t,r){var n="ul.overpass-layer-list {\n  margin-top: 0;\n  margin-bottom: 0;\n  padding-left: 0;\n}\nul.overpass-layer-list > li {\n  position: relative;\n  list-style: none;\n  min-height: 30px;\n  padding-left: 40px;\n}\nul.overpass-layer-list > li.selected {\n  background: #e0e0e0;\n}\nul.overpass-layer-list > li > .marker {\n  position: absolute;\n  margin-left: -35px;\n  width: 30px;\n  height: 30px;\n  text-align: center;\n  display: block;\n  color: black;\n  text-decoration: none;\n}\n\nul.overpass-layer-list > li > .marker > .sign {\n  text-align: center;\n  position: absolute;\n  top: 3px;\n  font-size: 15px;\n  left: 0;\n  right: 0;\n  z-index: 1;\n  display: inline-block;\n}\nul.overpass-layer-list > li > .content > a.title {\n  display: inline-block;\n  color: black;\n  text-decoration: none;\n}\nul.overpass-layer-list > li > .content > a.title:hover,\nul.overpass-layer-list > li > .content > a.title:active {\n  text-decoration: underline;\n}\nul.overpass-layer-list > li > .content > div.description {\n  font-style: italic;\n  color: #707070;\n  float: right;\n  text-align: right;\n}\nul.overpass-layer-list > li:after {\n  content: '';\n  display: table;\n  clear: both;\n}\n.hoverable {\n  cursor: pointer;\n}\n";e("browserify-css").createStyle(n,{href:"src/OverpassLayerList.css"},{insertAt:"bottom"}),t.exports=n},{"browserify-css":76}],283:[function(e,t,r){e("./OverpassLayerList.css");var o=e("./isTrue"),e=function(){"use strict";function i(e,t){var r,n=this;_classCallCheck2(this,i),1<arguments.length&&"OverpassLayer"===t.constructor.name&&(r=arguments[0],e=t,console.error('overpass-layer: class OverpassLayerList() accepts only one parameter, "layer"')),this.dom=document.createElement("ul"),this.dom.className="overpass-layer-list",this.layer=e,this.options=t||{},this.options.prefix=this.options.prefix||"list",this.selectedId=null;t=this.options.prefix;t in this.layer.options.layouts||this.layer.setLayout(t,'<div class="marker">{% if object.'+t+'MarkerSymbol or object.markerSymbol %}<div class="symbol">{{ object.'+t+'MarkerSymbol|default(object.markerSymbol) }}</div>{% elseif object.marker and object.marker.iconUrl %}<img class="symbol" src="{{ object.marker.iconUrl|e }}">{% endif %}{% if object.'+t+'MarkerSign or object.markerSign %}<div class="sign">{{ object.'+t+'MarkerSign|default(object.markerSign) }}</div>{% endif %}</div><div class="content"><a class="title" href="{{ object.appUrl|default("#") }}">{{ object.'+t+"Title|default(object.title) }}</a>{% if object."+t+'Description or object.description %}<div class="description">{{ object.'+t+"Description|default(object.description) }}</div>{% endif %}</div>"),this.layer.on("add",function(e,t){return n.addObject(t)}),this.layer.on("update",function(e,t){return n.updateObject(t)}),this.layer.on("remove",function(e,t){return n.delObject(t)}),this.layer.on("selectObject",function(e,t){n.selectedId=e.id,n.updateObject(t)}),this.layer.on("unselectObject",function(e,t){n.selectedId=null,n.updateObject(t)}),this.items={},r&&this.addTo(r)}return _createClass2(i,[{key:"addTo",value:function(e){e.appendChild(this.dom)}},{key:"addObject",value:function(e){if(!(o(e.data[this.options.prefix+"Exclude"])||e.id in this.items)){var t=document.createElement("li");this.selectedId===e.id&&t.classList.add("selected"),this.items[e.id]=t,e[this.options.prefix+"Item"]=t;var r=e.layouts[this.options.prefix]||e.layouts.list||"";t.innerHTML=r,t.currentHTML=r,t.priority="priority"in e.data?parseFloat(e.data.priority):0;for(var n=this.dom.firstChild;n&&n.priority<=t.priority;)n=n.nextSibling;n?this.dom.insertBefore(t,n):this.dom.appendChild(t),e.sublayer.updateAssets(t,e.data),t.onmouseover=function(e,t){this.currentHover&&this.currentHover.hide(),this.currentHover=this.layer.show(e,{styles:["hover"],flags:["hover"],sublayer_id:t},function(){})}.bind(this,e.id,e.sublayer_id),t.onmouseout=function(e,t){this.currentHover&&this.currentHover.hide(),this.currentHover=null}.bind(this,e.id,e.sublayer_id),t.onclick=function(e){return this.layer.openPopupOnObject(e),!1}.bind(this,e)}}},{key:"updateObject",value:function(e){var t=o(e.data[this.options.prefix+"Exclude"]);if(e.id in this.items||t){if(t)return this.delObject(e);var r=this.items[e.id];this.selectedId===e.id?r.classList.add("selected"):r.classList.remove("selected"),"content"===r.className&&(t=e.layouts[this.options.prefix]||e.layouts.list||"",r.currentHTML!==t&&(r.innerHTML=t,r.currentHTML=t)),e.sublayer.updateAssets(r,e.data)}}},{key:"delObject",value:function(e){var t=this.items[e.id];t&&this.dom.removeChild(t),delete this.items[e.id],delete e[this.options.prefix+"Item"]}},{key:"remove",value:function(){for(;this.dom.firstChild;)this.dom.removeChild(this.dom.lastChild);for(var e in this.items)delete this.items[e][this.options.prefix+"Item"];this.items={}}}]),i}();t.exports=e},{"./OverpassLayerList.css":282,"./isTrue":288}],284:[function(e,t,r){var n=e("event-emitter"),l=e("overpass-frontend"),o=e("nearest-point-on-geometry"),s=e("boundingbox"),p=e("./styleToLeaflet"),a=e("./strToStyle"),u=e("./SublayerFeature"),f=e("./pointOnFeature"),i=[e("./DecoratorPattern")],e=function(){"use strict";function n(e,t){var r=this;_classCallCheck2(this,n),this.master=e,t.sublayer_id=t.sublayer_id||"main",this.options=t,this.visibleFeatures={},this.shownFeatures={},this.shownFeatureOptions={},this.lastZoom=null,this._scheduledReprocesses={},t.feature["style:hover"]||(t.feature["style:hover"]={color:"black",width:3,opacity:1,radius:12,pane:"hover"}),t.styleNoBindPopup?t.styleNoBindPopup.push("hover"):t.styleNoBindPopup=["hover"],t.stylesNoAutoShow?t.stylesNoAutoShow.push("hover"):t.stylesNoAutoShow=["hover"],i.forEach(function(e){return new e(r)})}return _createClass2(n,[{key:"addTo",value:function(e){this.map=e,this.map.on("popupopen",this._popupOpen.bind(this)),this.map.on("popupclose",this._popupClose.bind(this))}},{key:"_popupOpen",value:function(e){var t;e.popup.sublayer===this&&(t=e.popup.object,this.emit("selectObject",t.object,t),this.master.emit("selectObject",t.object,t),this.updateAssets(e.popup._contentNode))}},{key:"_popupClose",value:function(e){var t;e.popup.sublayer===this&&(t=e.popup.object,this.emit("unselectObject",t.object,t),this.master.emit("unselectObject",t.object,t),this.updateAssets(e.popup._contentNode))}},{key:"domUpdateHooks",value:function(e){var t,r,n,i=this;!e.getAttribute||(t=e.getAttribute("data-object"))&&(r=e.getAttribute("data-sublayer")||"main",e.classList.add("hoverable"),n={properties:l.ALL},this.master.overpassFrontend.getCached(t,n)||this.master.overpassFrontend.get(t,n,function(){},function(){}),e.onmouseover=function(){if(i.currentHover){if(i.currentHover.id===t)return;i.currentHover.hide()}i.currentHover=i.master.subLayers[r].show(t,{styles:["hover"]},function(){})},e.onmouseout=function(){i.currentHover&&i.currentHover.hide(),i.currentHover=null},e.onclick=function(){i.currentHover&&i.currentHover.hide(),i.master.subLayers[r].openPopupOnObject(t)});for(var o=e.firstChild;o;)this.domUpdateHooks(o),o=o.nextSibling}},{key:"remove",value:function(){this.map.off("popupopen",this._popupOpen.bind(this)),this.map=null}},{key:"startAdding",value:function(){this.currentRequestFeatures={}}},{key:"add",value:function(e){var t;this.currentRequestFeatures[e.id]=!0,e.id in this.visibleFeatures||(t=new u(e,this),e.id in this.shownFeatures?t=this.shownFeatures[e.id]:(this._processObject(t),this._show(t)),this.visibleFeatures[e.id]=t,this.master.onAppear&&this.master.onAppear(t),this.master.emit("add",e,t),this.emit("add",e,t))}},{key:"finishAdding",value:function(){for(var e in this.visibleFeatures)e in this.currentRequestFeatures||(e in this.shownFeatures||this._hide(this.visibleFeatures[e]),delete this.visibleFeatures[e])}},{key:"hideAll",value:function(e){for(var t in this.visibleFeatures){var r=this.visibleFeatures[t];!e&&r.id in this.shownFeatures||this._hide(r)}this.visibleFeatures={}}},{key:"hideNonVisible",value:function(e){for(var t in this.visibleFeatures){var r=this.visibleFeatures[t];r.object.intersects(e)||(r.id in this.shownFeatures||this._hide(r),delete this.visibleFeatures[t])}}},{key:"hideNonVisibleFilter",value:function(e){for(var t in this.visibleFeatures){var r=this.visibleFeatures[t];e.match(r.object)||(r.id in this.shownFeatures||this._hide(r),delete this.visibleFeatures[t])}}},{key:"get",value:function(r,e,n){var i=this,o=!1,s=!1,t={id:r,options:e,abort:function(){s?console.log("abort called, although done"):(s=o=!0,t.request&&t.request.abort())}};return r in this.visibleFeatures?window.setTimeout(function(){s=!0,o||n(null,i.visibleFeatures[r])},0):r in this.shownFeatures?window.setTimeout(function(){s=!0,o||n(null,i.shownFeatures[r])},0):t.request=this.master.get(r,function(e,t){if(s=!0,e)return n(e);if(!o){if(null===t)return console.log("object does not exist",r);t=r in i.visibleFeatures?i.visibleFeatures[r]:r in i.shownFeatures?i.shownFeatures[r]:new u(t,i);n(null,t)}}),t}},{key:"show",value:function(r,t,n){function i(){s=r.id,u.id=s,o.shownFeatures[s]=r,s in o.shownFeatureOptions||(o.shownFeatureOptions[s]=[]),o.shownFeatureOptions[s].push(t),r.isShown=!0,r.updateFlags(),o._processObject(r),o._show(r),n(null,r.object,r)}var o=this,s="string"==typeof r?r:r.id,a=!1,u={options:t,hide:function(){if(a&&console.log("already hidden"),a=!0,u.request)return u.request.abort(),void delete u.request;var e;s in o.shownFeatures&&(-1!==(e=o.shownFeatureOptions[s].indexOf(t))&&o.shownFeatureOptions[s].splice(e,1),r.updateFlags(),0===o.shownFeatureOptions[s].length?o.hide(r):o._processObject(o.shownFeatures[s]))}};return t.priority=-1,t.properties=l.ALL,"string"==typeof r?u.request=this.get(r,t,function(e,t){delete u.request,a||(e?n(e):(r=t,i()))}):i(),u}},{key:"hide",value:function(e){var t;"object"===_typeof3(e)&&(e=e.id),e in this.shownFeatures&&(t=this.shownFeatures[e],delete this.shownFeatures[e],delete this.shownFeatureOptions[e],e in this.visibleFeatures?this._processObject(t):this._hide(t))}},{key:"zoomChange",value:function(){for(var e in this.recalc(),this.visibleFeatures){var t=this.visibleFeatures[e];this.master.emit("zoomChange",t.object,t),this.emit("zoomChange",t.object,t),this.master.onZoomChange&&this.master.onZoomChange(t)}this.lastZoom=this.map.getZoom()}},{key:"recalc",value:function(){for(var e in this.visibleFeatures)this._processObject(this.visibleFeatures[e])}},{key:"_processObject",value:function(e){var t,r=e.object,n={styles:[]},i={shiftWorld:this.master.getShiftWorld()};r.id in this.shownFeatureOptions&&this.shownFeatureOptions[r.id].forEach(function(e){"styles"in e&&(n.styles=n.styles.concat(e.styles))});var o,s,a,u=this.evaluate(e);for(t in e.feature||(e.feature=r.leafletFeature(Object.assign({weight:0,opacity:0,fillOpacity:0,radius:0},i))),u){var l,c=t.match(/^style(|:(.*))$/);c&&(l=void 0===c[2]?"default":c[2],c=p(u[t],this.master.globalTwigData),e.features[l]?e.features[l].setStyle(c):e.features[l]=r.leafletFeature(Object.assign(c,i)),"text"in c&&"setText"in e.features[l]&&(e.features[l].setText(null),e.features[l].setText(c.text,{repeat:c.textRepeat,offset:c.textOffset,below:c.textBelow,attributes:{fill:c.textFill,"fill-opacity":c.textFillOpacity,"font-weight":c.textFontWeight,"font-size":c.textFontSize,"letter-spacing":c.textLetterSpacing}})),"offset"in c&&"setOffset"in e.features[l]&&e.features[l].setOffset(c.offset))}if("styles"in n&&(u.styles=u.styles.concat(n.styles)),u.marker={html:"",iconAnchor:[0,0],iconSize:[0,0],signAnchor:[0,0],popupAnchor:[0,0]},u.markerSymbol&&(u.marker.html+=u.markerSymbol,(s=document.createElement("div")).innerHTML=u.markerSymbol,s.firstChild&&(o=s.firstChild,u.marker.iconSize=[o.offsetWidth,o.offsetHeight],o.hasAttribute("width")&&(u.marker.iconSize[0]=parseFloat(o.getAttribute("width"))),o.hasAttribute("height")&&(u.marker.iconSize[1]=parseFloat(o.getAttribute("height"))),u.marker.iconAnchor=[u.marker.iconSize[0]/2,u.marker.iconSize[1]/2],o.hasAttribute("anchorx")&&(u.marker.iconAnchor[0]=parseFloat(o.getAttribute("anchorx"))),o.hasAttribute("anchory")&&(u.marker.iconAnchor[1]=parseFloat(o.getAttribute("anchory"))),o.hasAttribute("signanchorx")&&(u.marker.signAnchor[0]=parseFloat(o.getAttribute("signanchorx"))),o.hasAttribute("signanchory")&&(u.marker.signAnchor[1]=parseFloat(o.getAttribute("signanchory"))),o.hasAttribute("popupanchory")&&(u.marker.popupAnchor[0]=parseFloat(o.getAttribute("popupanchorx"))),o.hasAttribute("popupanchory")&&(u.marker.popupAnchor[1]=parseFloat(o.getAttribute("popupanchory")))),this.updateAssets(s,u)),u.markerSign&&(o=u.marker.iconAnchor[0]+u.marker.signAnchor[0],s=-u.marker.iconSize[1]+u.marker.iconAnchor[1]+u.marker.signAnchor[1],u.marker.html+='<div class="sign" style="margin-left: '+o+"px; margin-top: "+s+'px;">'+u.markerSign+"</div>"),u.marker.html&&(u.marker.className="overpass-layer-icon",h=L.divIcon(u.marker),e.featureMarker?(e.featureMarker.setIcon(h),e.featureMarker._icon&&this.updateAssets(e.featureMarker._icon)):(e.pointOnFeature||(e.pointOnFeature=f(r,i)),e.pointOnFeature&&(e.featureMarker=L.marker(e.pointOnFeature,{icon:h})))),e.isShown)for(t in e.features)e.feature.addTo(this.map),u.styles&&-1!==u.styles.indexOf(t)&&e.styles&&-1===e.styles.indexOf(t)&&e.features[t].addTo(this.map),u.styles&&-1===u.styles.indexOf(t)&&e.styles&&-1!==e.styles.indexOf(t)&&this.map.removeLayer(e.features[t]);for(a in e.styles=u.styles,e.layouts={},this.options.layouts)"function"==typeof this.options.layouts[a]?e.layouts[a]=this.options.layouts[a]({object:u}):e.layouts[a]=this.options.layouts[a];var h=e.layouts.popup;if(e.popup)e.popup._contentNode?null===h||e.popup.currentHTML!==h&&(e.popup._contentNode.innerHTML=h,this.updateAssets(e.popup._contentNode,u)):null!==h&&e.popup.setContent(h),e.popup.currentHTML=h;else{for(t in e.popup=L.popup(),(e.popup.object=e).popup.sublayer=this,null!==h&&e.popup.setContent(h),e.feature.bindPopup(e.popup),e.features)this._shallBindPopupToStyle(t)&&e.features[t].bindPopup(e.popup);e.featureMarker&&e.featureMarker.bindPopup(e.popup)}e.id=r.id,e.layer_id=this.options.id,e.sublayer_id=this.options.sublayer_id,e.data=u,this.master.onUpdate&&this.master.onUpdate(e),this.master.emit("update",e.object,e),this.emit("update",e.object,e)}},{key:"evaluate",value:function(e){var t,r=e.object;e.twigData=this.twigData(r,e);var n={};for(t in this.options.feature)"function"==typeof this.options.feature[t]?n[t]=this.options.feature[t](e.twigData):n[t]=this.options.feature[t];var i=[];for(t in n){var o,s=t.match(/^style(|:(.*))$/);s&&(o=n[t],s=void 0===s[2]?"default":s[2],("string"==typeof o||"twig_markup"in o)&&(n[t]=a(o)),-1===this.options.stylesNoAutoShow.indexOf(s)&&i.push(s))}return"features"in e||(e.features={}),n.styles="styles"in n?n.styles:"styles"in this.options?this.options.styles:i,("string"==typeof n.styles||"twig_markup"in n.styles)&&(r=n.styles.trim(),n.styles=""===r?[]:r.split(/,/).map(function(e){return e.trim()})),n}},{key:"twigData",value:function(r,e){var t,n={id:r.id,sublayer_id:this.options.sublayer_id,osm_id:r.osm_id,type:r.type,tags:r.tags,meta:r.meta,flags:e.flags,members:[],const:this.options.const};for(t in r.memberFeatures&&r.memberFeatures.forEach(function(e,t){e={id:e.id,sequence:t,type:e.type,osm_id:e.osm_id,role:r.members[t].role,tags:e.tags,meta:e.meta,dir:e.dir,connectedPrev:e.connectedPrev,connectedNext:e.connectedNext};n.members.push(e)}),this.master.globalTwigData)n[t]=this.master.globalTwigData[t];return this.emit("twigData",r,e,n),this.master.emit("twigData",r,e,n),n}},{key:"_shallBindPopupToStyle",value:function(e){return-1===this.options.styleNoBindPopup.indexOf(e)}},{key:"_show",value:function(e){if(this.map){e.feature.addTo(this.map);for(var t=0;t<e.styles.length;t++){var r=e.styles[t];r in e.features&&e.features[r].addTo(this.map)}e.featureMarker&&(e.featureMarker.addTo(this.map),this.updateAssets(e.featureMarker._icon)),e.object.on("update",this.scheduleReprocess.bind(this,e.id)),e.isShown=!0}}},{key:"_hide",value:function(e){for(var t in this.master.emit("remove",e.object,e),this.emit("remove",e.object,e),this.map.removeLayer(e.feature),e.features)this.map.removeLayer(e.features[t]);e.featureMarker&&this.map.removeLayer(e.featureMarker),this.master.onDisappear&&this.master.onDisappear(e),e.object.off("update",this.scheduleReprocess.bind(this,e.id)),e.isShown=!1}},{key:"scheduleReprocess",value:function(e){var t=this;e in this._scheduledReprocesses||(this._scheduledReprocesses[e]=window.setTimeout(function(){delete t._scheduledReprocesses[e],e in t.visibleFeatures&&t._processObject(t.visibleFeatures[e])},0))}},{key:"updateAssets",value:function(e,t){this.domUpdateHooks(e),this.options.updateAssets&&this.options.updateAssets(e,t,this)}},{key:"openPopupOnObject",value:function(e,r){var n=this;if("string"==typeof e)return this.get(e,r,function(e,t){return e?console.log(e):(n._processObject(t),n._show(t),void n.openPopupOnObject(t,r))});var t=new s(this.map.getBounds());if(.75*new s(e.object.bounds).diagonalLength()<t.diagonalLength())return e.feature.openPopup();var i=this.map.getCenter(),t=e.object.GeoJSON(),i=o(t,{type:"Feature",geometry:{type:"Point",coordinates:[i.lng,i.lat]}});if(i)return i=i.geometry.coordinates,e.feature.openPopup([i[1],i[0]]);e.feature.openPopup()}}]),n}();n(e.prototype),t.exports=e},{"./DecoratorPattern":278,"./SublayerFeature":285,"./pointOnFeature":290,"./strToStyle":291,"./styleToLeaflet":292,boundingbox:74,"event-emitter":94,"nearest-point-on-geometry":225,"overpass-frontend":232}],285:[function(e,t,r){var n=function(){"use strict";function r(e,t){_classCallCheck2(this,r),this.object=e,this.id=e.id,this.sublayer=t,this.isShown=!1,this.flags={}}return _createClass2(r,[{key:"updateFlags",value:function(){var t=this,e=this.sublayer.shownFeatureOptions[this.id];this.flags={},e.forEach(function(e){e.flags&&e.flags.forEach(function(e){t.flags[e]=!0})})}}]),r}();t.exports=n},{}],286:[function(e,t,r){var s=e("./compileTemplate");t.exports=function(t,e){var r,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};for(r in"autoescape"in n||(n.autoescape=!0),t)if("string"==typeof t[r]&&-1!==t[r].search("{"))t[r]=s(t[r],e,n);else if("object"===_typeof3(t[r])&&(-1!==["style"].indexOf(r)||r.match(/^style:/))){var i,o={};for(i in t[r])if("string"==typeof t[r][i]&&-1!==t[r][i].search("{"))try{o[i]=e.twig({data:t[r][i],autoescape:n.autoescape,rethrow:!0})}catch(e){console.error("Can't compile template:\n"+t[r][i]+"\n\n",e.message)}else o[i]=t[r][i];t[r]=function(e,t){var r,n={};for(r in e)"object"===_typeof3(e[r])&&null!==e[r]&&"render"in e[r]?n[r]=e[r].render(t):n[r]=e[r];return n}.bind(this,o)}return t}},{"./compileTemplate":287}],287:[function(e,t,r){t.exports=function(t,e,r){var n,i=2<arguments.length&&void 0!==r?r:{};if("string"!=typeof t||-1===t.search("{"))return t;try{n=e.twig({data:t,autoescape:i.autoescape})}catch(e){return console.log("Error compiling twig template",t,e),t}return function(e){try{return n.render(e)}catch(e){console.log("Error rendering twig template",t,e)}return null}}},{}],288:[function(e,t,r){function n(e){if(null==e)return!1;if("boolean"==typeof e)return e;if("string"==typeof e||"object"===_typeof3(e)&&"twig_markup"in e){if("false"===e.trim())return!1;if("true"===e.trim())return!0}return 0!==e&&"0"!==e.toString()&&""!==e.toString()}window.isTrue=n,t.exports=n},{}],289:[function(e,t,r){t.exports=function(e,t){var r=(""+e).trim().match(/^([+-]?[0-9]+(?:\.[0-9]+)?)\s*(px|m|%)$/);if(r)switch(r[2]){case"%":return e;case"m":return parseFloat(r[1])/t;case"px":default:return parseFloat(r[1])}return parseFloat(e)}},{}],290:[function(e,t,r){var n={along:e("@turf/along").default,length:e("@turf/length").default,pointOnFeature:e("@turf/point-on-feature").default};t.exports=function(e,t){var r,e=e.GeoJSON();if("LineString"===e.geometry.type)r=n.along(e,n.length(e)/2);else{if("GeometryCollection"===e.geometry.type&&0===e.geometry.geometries.length)return null;r=n.pointOnFeature(e)}return{lat:r.geometry.coordinates[1],lon:r.geometry.coordinates[0]+t.shiftWorld[r.geometry.coordinates[0]<0?0:1]}}},{"@turf/along":4,"@turf/length":50,"@turf/point-on-feature":64}],291:[function(e,t,r){t.exports=function(e){var t=e.split("\n");e={};for(var r=0;r<t.length;r++){var n,i=t[r].match(/^\s*([a-zA-Z0-9_]+)\s*:\s*(.*)\s*$/);i&&((n=i[2].trim()).match(/^-?[0-9]+(\.[0-9]+)?/)&&(n=parseFloat(n)),e[i[1]]=n)}return e}},{}],292:[function(e,t,r){var s=e("./isTrue"),a=e("./parseLength"),u={stroke:{type:"boolean"},fill:{type:"boolean"},textRepeat:{type:"boolean"},textBelow:{type:"boolean"},noClip:{type:"boolean"},width:{rename:"weight",type:"length"},opacity:{type:"float"},fillOpacity:{type:"float"},offset:{type:"length"},dashArray:{type:"multiple-length"},dashOffset:{type:"length"}};t.exports=function(e,t){var r,n=JSON.parse(JSON.stringify(e));for(r in n){var i=n[r];if(r in u){var o=u[r];switch(o.type){case"boolean":i=s(n[r]);break;case"float":i=parseFloat(n[r]);break;case"length":i=t&&t.map?a(n[r],t.map.metersPerPixel):parseFloat(n[r]);break;case"multiple-length":i=n[r].split(/,/g).map(function(e){return a(e,t.map.metersPerPixel)}).join(",")}o.rename&&(delete n[r],r=o.rename)}n[r]=i}return n}},{"./isTrue":288,"./parseLength":289}]},{},[1]);
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).togpx=e()}(function(){return function n(o,i,a){function s(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return s(o[t][1][e]||e)},r,r.exports,n,o,i,a)}return i[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){var n=e("jxon");function p(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}n.config({attrPrefix:"@"}),t.exports=function(e,i){var t,r;function a(e,t,r){var n={};n["@lat"]=t[1],n["@lon"]=t[0],void 0!==t[2]&&(n.ele=t[2]);e=i.featureCoordTimes(e);return e&&void 0!==e[r]&&(n.time=e[r]),n}function s(e,t,r){var n,o,o=p((n=e,(o={}).name=i.featureTitle(n.properties),o.desc=i.featureDescription(n.properties),i.featureLink&&(o.link={"@href":i.featureLink(n.properties)}),o),a(e,t,r));return i.transform.wpt&&i.transform.wpt(o,e,t,r)||o}function u(o,e){var t={rtept:e.map(function(e,t){return t=a(r=o,n=e,e=t),i.transform.rtept&&i.transform.rtept(t,r,n,e)||t;var r,n})};return i.transform.rte&&i.transform.rte(t,o,e)||t}function f(o,e){var t={trkseg:e.map(function(e){return{trkpt:e.map(function(e,t){return t=a(r=o,n=e,e=t),i.transform.trkpt&&i.transform.trkpt(t,r,n,e)||t;var r,n})}})};return i.transform.trk&&i.transform.trk(t,o,e)||t}return"string"==typeof(i=p({creator:"togpx",metadata:void 0,featureTitle:function e(t){if(!t)return"";if("object"==typeof t.tags){var r=e(t.tags);if(""!==r)return r}if(t.name)return t.name;if(t.ref)return t.ref;if(t.id)return t.id;return""},featureDescription:function e(t){if(!t)return"";if("object"==typeof t.tags)return e(t.tags);var r="";for(var n in t)"object"!=typeof t[n]&&(r+=n+"="+t[n]+"\n");return r.substr(0,r.length-1)},featureLink:void 0,featureCoordTimes:function(e){return e.properties&&(e.properties.times||e.properties.coordTimes)||null},transform:{},"gpx.wpt":!0,"gpx.trk":!0,"gpx.rte":!1},i||{})).featureCoordTimes&&(t=i.featureCoordTimes,i.featureCoordTimes=function(e){return e.properties[t]}),e="FeatureCollection"===e.type?e.features:"Feature"===e.type?[e]:[{type:"Feature",properties:{},geometry:e}],n.stringify({gpx:(e=e,r={"@xmlns":"http://www.topografix.com/GPX/1/1","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd","@version":"1.1",metadata:null,wpt:[],rte:[],trk:[]},i.creator&&(r["@creator"]=i.creator),i.metadata?r.metadata=i.metadata:delete i.metadata,e.forEach(function(e){!function r(n,o,i){n.hasOwnProperty("properties")||(n.properties={});switch(n.geometry.type){case"Point":case"MultiPoint":var e;o["gpx.wpt"]&&(e=n.geometry.coordinates,"Point"==n.geometry.type&&(e=[e]),e.forEach(function(e,t){var t=s(n,e,t);i.wpt.push(t)}));break;case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":var t,a;switch(n.geometry.type){case"LineString":t=[n.geometry.coordinates];break;case"MultiPolygon":t=[].concat.apply([],n.geometry.coordinates);break;default:t=n.geometry.coordinates}o["gpx.rte"]&&(1===t.length?(a=u(n,t[0]),i.rte.push(a)):t.forEach(function(e){var t={properties:n.properties,geometry:{type:"LineString",coordinates:e}},e=p({},o);e=p(e,{"gpx.trk":!1}),r(t,e,i)})),o["gpx.trk"]&&(a=f(n,t),i.trk.push(a));break;case"GeometryCollection":n.geometry.geometries.forEach(function(e){var e={properties:n.properties,geometry:e};r(e,o,i)});break;default:console.log("warning: unsupported geometry type: "+n.geometry.type)}}(e,i,r)}),i.transform.gpx&&i.transform.gpx(r,e)||r)})}},{jxon:2}],2:[function(e,t,r){var n,o;n=this,o=function(o,e){var r,C={valueKey:"_",attrKey:"$",attrPrefix:"$",lowerCaseTags:!1,trueIsEmpty:!1,autoDate:!1,ignorePrefixedNodes:!1,parseValues:!1},N=[],t=/^\s*$/,n=/^(?:true|false)$/i;return new function(){function P(e){return C.parseValues?t.test(e)?null:n.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):C.autoDate&&isFinite(Date.parse(e))?new Date(e):e:e}function S(){}function k(e,t,r,n){var o,i,a=N.length,s=e.hasChildNodes(),u=e.nodeType===e.ELEMENT_NODE&&e.hasAttributes(),f=Boolean(2&t),p=0,c="",l=f?{}:!!C.trueIsEmpty||"";if(s)for(var m,d=0;d<e.childNodes.length;d++)4===(m=e.childNodes.item(d)).nodeType?c+=m.nodeValue:3===m.nodeType?c+=m.nodeValue.trim():1!==m.nodeType||C.ignorePrefixedNodes&&m.prefix||N.push(m);var g=N.length,y=P(c);if(f||!s&&!u||(l=0===t?null===(s=y)?new S:s instanceof Object?s:new s.constructor(s):{}),u){for(var h,w,x=e.attributes.length,v=n?"":C.attrPrefix,T=n?{}:l,b=0;b<x;p++,b++)w=(h=e.attributes.item(b)).name,C.lowerCaseTags&&(w=w.toLowerCase()),T[v+w]=P(h.value.trim());n&&(r&&Object.freeze(T),l[C.attrKey]=T,p-=x-1)}for(var O=a;O<g;O++)o=N[O].nodeName,C.lowerCaseTags&&(o=o.toLowerCase()),i=k(N[O],t,r,n),l.hasOwnProperty(o)?(l[o].constructor!==Array&&(l[o]=[l[o]]),l[o].push(i)):(l[o]=i,p++);return 3===t||(2===t||1===t&&0<p)&&c?l[C.valueKey]=y:!f&&0===p&&c&&(l=y),r&&(f||0<p)&&Object.freeze(l),N.length=a,l}function f(e,t,r,n){r=function(e,t,r){var n,o=C.attrPrefix+"xmlns",i=t&&t instanceof Object;if(-1!==e.indexOf(":")){if(e=e.split(":")[0],i&&(n=t[o+":"+e]))return n;if(n=r.lookupNamespaceURI(e))return n}return i&&(n=t[o]),n||r.lookupNamespaceURI(null)}(e,t,r),e=r?n.createElementNS(r,e):n.createElement(e);return e}this.config=function(e){for(var t in e)C[t]=e[t];C.parserErrorHandler&&(r=new o.DOMParser({errorHandler:C.parserErrorHandler,locator:{}}))},S.prototype.toString=function(){return"null"},S.prototype.valueOf=function(){return null},this.xmlToJs=this.build=function(e,t,r,n){var o=1<arguments.length&&"number"==typeof t?3&t:1;return k(e,o,r||!1,3<arguments.length?n:3==o)},this.jsToXml=this.unbuild=function(e,t,r,n){n=(o.document&&o.document.implementation||new o.DOMImplementation).createDocument(t||null,r||"",n||null);return function e(t,r,n){var o,i,a;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(r.appendChild(t.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&r.appendChild(t.createTextNode(n.toISOString()));for(a in n)if(o=n[a],void 0!==o&&(null===o&&(o={}),!(isFinite(a)||o instanceof Function)))if(a===C.valueKey)null!==o&&!0!==o&&r.appendChild(t.createTextNode(o.constructor===Date?o.toISOString():String(o)));else if(a===C.attrKey)for(var s in o)r.setAttribute(s,o[s]);else if(0===a.indexOf(C.attrPrefix+"xmlns"))r.setAttributeNS("http://www.w3.org/2000/xmlns/",a.slice(1),o);else if(a.charAt(0)===C.attrPrefix)r.setAttribute(a.slice(1),o);else if(o.constructor===Array)for(var u in o)o.hasOwnProperty(u)&&(i=f(a,o[u],r,t),r.appendChild(i),e(t,i,o[u]||{}));else i=f(a,o,r,t),r.appendChild(i),o instanceof Object?e(t,i,o):null===o||!0===o&&C.trueIsEmpty||i.appendChild(t.createTextNode(o.toString()))}(n,n.documentElement||n,e),n},this.stringToXml=function(e){return(r=r||new o.DOMParser).parseFromString(e,"application/xml")},this.xmlToString=function(e){return void 0!==e.xml?e.xml:(new o.XMLSerializer).serializeToString(e)},this.stringToJs=function(e){e=this.stringToXml(e);return this.xmlToJs(e)},this.jsToString=this.stringify=function(e,t,r,n){return this.xmlToString(this.jsToXml(e,t,r,n))},this.each=function(e,t,r){(e instanceof Array?e:[e]).forEach(t,r)}}},"object"==typeof r?"object"==typeof window&&window.DOMImplementation&&window.XMLSerializer&&window.DOMParser?t.exports=o(window):t.exports=o(e("xmldom")):n.JXON=o(window)},{xmldom:3}],3:[function(e,t,r){},{}]},{},[1])(1)});
!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).tokml=e()}(function(){return function n(o,i,u){function a(r,e){if(!i[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}t=i[r]={exports:{}};o[r][0].call(t.exports,function(e){var t=o[r][1][e];return a(t||e)},t,t.exports,n,o,i,u)}return i[r].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,t,r){var e=e("strxml"),s=e.tag,l=e.encode;function n(a,c){return function(e){if(!e.properties||!p.valid(e.geometry))return"";var t=p.any(e.geometry);if(!t)return"";var r,n,o,i="",u="";return!a.simplestyle||(o=function(e){var t="";e["marker-symbol"]&&(t=t+"ms"+e["marker-symbol"]);e["marker-color"]&&(t=t+"mc"+e["marker-color"].replace("#",""));e["marker-size"]&&(t=t+"ms"+e["marker-size"]);e.stroke&&(t=t+"s"+e.stroke.replace("#",""));e["stroke-width"]&&(t=t+"sw"+e["stroke-width"].toString().replace(".",""));e["stroke-opacity"]&&(t=t+"mo"+e["stroke-opacity"].toString().replace(".",""));e.fill&&(t=t+"f"+e.fill.replace("#",""));e["fill-opacity"]&&(t=t+"fo"+e["fill-opacity"].toString().replace(".",""));return t}(e.properties))&&(p.isPoint(e.geometry)&&!!((n=e.properties)["marker-size"]||n["marker-symbol"]||n["marker-color"])?(-1===c.indexOf(o)&&(r=e.properties,n=o,i=s("Style",s("IconStyle",s("Icon",s("href",function(e){var t=e["marker-size"]||"medium",r=e["marker-symbol"]?"-"+e["marker-symbol"]:"",e=(e["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+t.charAt(0)+r+"+"+e+".png"}(r))))+s("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",n]]),c.push(o)),u=s("styleUrl","#"+o)):(p.isPolygon(e.geometry)||p.isLine(e.geometry))&&function(e){for(var t in e)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[t])return!0}(e.properties)&&(-1===c.indexOf(o)&&(i=function(e,t){var r=s("LineStyle",[s("color",m(e.stroke,e["stroke-opacity"])||"ff555555")+s("width",void 0===e["stroke-width"]?2:e["stroke-width"])]),n="";(e.fill||e["fill-opacity"])&&(n=s("PolyStyle",[s("color",m(e.fill,e["fill-opacity"])||"88555555")]));return s("Style",r+n,[["id",t]])}(e.properties,o),c.push(o)),u=s("styleUrl","#"+o))),i+s("Placemark",((o=e.properties)[(i=a).name]?s("name",l(o[i.name])):"")+((o=e.properties)[(i=a).description]?s("description",l(o[i.description])):"")+(i=e.properties,s("ExtendedData",function(e){var t,r=[];for(t in e)r.push([t,e[t]]);return r}(i).map(f).join("")))+((i=e.properties)[(e=a).timestamp]?s("TimeStamp",s("when",l(i[e.timestamp]))):"")+t+u)}}t.exports=function(e,t){return'<?xml version="1.0" encoding="UTF-8"?>'+s("kml",s("Document",(void 0!==(r=t=t||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"}).documentName?s("name",r.documentName):"")+(void 0!==(r=t).documentDescription?s("description",r.documentDescription):"")+function(e,t){if(!e.type)return"";var r=[];switch(e.type){case"FeatureCollection":return e.features?e.features.map(n(t,r)).join(""):"";case"Feature":return n(t,r)(e);default:return n(t,r)({type:"Feature",geometry:e,properties:{}})}}(e,t)),[["xmlns","http://www.opengis.net/kml/2.2"]]);var r};var p={Point:function(e){return s("Point",s("coordinates",e.coordinates.join(",")))},LineString:function(e){return s("LineString",s("coordinates",o(e.coordinates)))},Polygon:function(e){if(!e.coordinates.length)return"";var t=e.coordinates[0],e=e.coordinates.slice(1),t=s("outerBoundaryIs",s("LinearRing",s("coordinates",o(t)))),e=e.map(function(e){return s("innerBoundaryIs",s("LinearRing",s("coordinates",o(e))))}).join("");return s("Polygon",t+e)},MultiPoint:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.Point({coordinates:e})}).join("")):""},MultiPolygon:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.Polygon({coordinates:e})}).join("")):""},MultiLineString:function(e){return e.coordinates.length?s("MultiGeometry",e.coordinates.map(function(e){return p.LineString({coordinates:e})}).join("")):""},GeometryCollection:function(e){return s("MultiGeometry",e.geometries.map(p.any).join(""))},valid:function(e){return e&&e.type&&(e.coordinates||"GeometryCollection"===e.type&&e.geometries&&e.geometries.every(p.valid))},any:function(e){return p[e.type]?p[e.type](e):""},isPoint:function(e){return"Point"===e.type||"MultiPoint"===e.type},isPolygon:function(e){return"Polygon"===e.type||"MultiPolygon"===e.type},isLine:function(e){return"LineString"===e.type||"MultiLineString"===e.type}};function o(e){return e.map(function(e){return e.join(",")}).join(" ")}function f(e){return s("Data",s("value",l(e[1])),[["name",l(e[0])]])}function m(e,t){if("string"!=typeof e)return"";if(3===(e=e.replace("#","").toLowerCase()).length)e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2];else if(6!==e.length)return"";var r=e[0]+e[1],n=e[2]+e[3],o=e[4]+e[5],e="ff";return"number"==typeof t&&0<=t&&t<=1&&(-1<(e=(255*t).toString(16)).indexOf(".")&&(e=e.substr(0,e.indexOf("."))),e.length<2&&(e="0"+e)),e+o+n+r}},{strxml:2}],2:[function(e,t,r){function n(e){return e&&e.length?" "+e.map(function(e){return e[0]+'="'+e[1]+'"'}).join(" "):""}t.exports.attr=n,t.exports.tagClose=function(e,t){return"<"+e+n(t)+"/>"},t.exports.tag=function(e,t,r){return"<"+e+n(r)+">"+t+"</"+e+">"},t.exports.encode=function(e){return(null===e?"":e.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{}]},{},[1])(1)});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).topojson=t.topojson||{})}(this,function(t){"use strict";function e(t){return t}function s(t){if(null==t)return e;var a,c,i=t.scale[0],u=t.scale[1],f=t.translate[0],s=t.translate[1];return function(t,e){e||(a=c=0);var r=2,n=t.length,o=new Array(n);for(o[0]=(a+=t[0])*i+f,o[1]=(c+=t[1])*u+s;r<n;)o[r]=t[r],++r;return o}}function g(t){var e,o=s(t.transform),a=1/0,c=a,i=-a,u=-a;function r(t){(t=o(t))[0]<a&&(a=t[0]),t[0]>i&&(i=t[0]),t[1]<c&&(c=t[1]),t[1]>u&&(u=t[1])}function n(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(n);break;case"Point":r(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(r)}}for(e in t.arcs.forEach(function(t){for(var e,r=-1,n=t.length;++r<n;)(e=o(t[r],r))[0]<a&&(a=e[0]),e[0]>i&&(i=e[0]),e[1]<c&&(c=e[1]),e[1]>u&&(u=e[1])}),t.objects)n(t.objects[e]);return[a,c,i,u]}function r(t,e){var r=e.id,n=e.bbox,o=null==e.properties?{}:e.properties,e=a(t,e);return null==r&&null==n?{type:"Feature",properties:o,geometry:e}:null==n?{type:"Feature",id:r,properties:o,geometry:e}:{type:"Feature",id:r,bbox:n,properties:o,geometry:e}}function a(t,e){var a=s(t.transform),c=t.arcs;function o(t,e){e.length&&e.pop();for(var r=c[t<0?~t:t],n=0,o=r.length;n<o;++n)e.push(a(r[n],n));t<0&&function(t){for(var e,r=t.length,n=r-o;n<--r;)e=t[n],t[n++]=t[r],t[r]=e}(e)}function i(t){return a(t)}function u(t){for(var e=[],r=0,n=t.length;r<n;++r)o(t[r],e);return e.length<2&&e.push(e[0]),e}function r(t){for(var e=u(t);e.length<4;)e.push(e[0]);return e}function f(t){return t.map(r)}return function t(e){var r,n=e.type;switch(n){case"GeometryCollection":return{type:n,geometries:e.geometries.map(t)};case"Point":r=i(e.coordinates);break;case"MultiPoint":r=e.coordinates.map(i);break;case"LineString":r=u(e.arcs);break;case"MultiLineString":r=e.arcs.map(u);break;case"Polygon":r=f(e.arcs);break;case"MultiPolygon":r=e.arcs.map(f);break;default:return null}return{type:n,coordinates:r}}(e)}function y(c,n){var o={},i={},u={},a=[],f=-1;function t(t,e){for(var r in t){var n=t[r];delete e[n.start],delete n.start,delete n.end,n.forEach(function(t){o[t<0?~t:t]=1}),a.push(n)}}return n.forEach(function(t,e){var r=c.arcs[t<0?~t:t];r.length<3&&!r[1][0]&&!r[1][1]&&(r=n[++f],n[f]=t,n[e]=r)}),n.forEach(function(t){var e,r,n=function(t){var e,r=c.arcs[t<0?~t:t],n=r[0];c.transform?(e=[0,0],r.forEach(function(t){e[0]+=t[0],e[1]+=t[1]})):e=r[r.length-1];return t<0?[e,n]:[n,e]}(t),o=n[0],a=n[1];(n=u[o])?(delete u[n.end],n.push(t),n.end=a,(e=i[a])?(delete i[e.start],r=e===n?n:n.concat(e),i[r.start=n.start]=u[r.end=e.end]=r):i[n.start]=u[n.end]=n):(n=i[a])?(delete i[n.start],n.unshift(t),n.start=o,(e=u[o])?(delete u[e.end],r=e===n?n:e.concat(n),i[r.start=e.start]=u[r.end=n.end]=r):i[n.start]=u[n.end]=n):i[(n=[t]).start=o]=u[n.end=a]=n}),t(u,i),t(i,u),n.forEach(function(t){o[t<0?~t:t]||a.push([t])}),a}function n(t,e,r){var n,o,a,c,i,u,f;if(1<arguments.length)c=r,u=[],f=[],function t(e){switch(i=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":l(e.arcs);break;case"MultiLineString":case"Polygon":h(e.arcs);break;case"MultiPolygon":p(e.arcs)}}(e),f.forEach(null==c?function(t){u.push(t[0].i)}:function(t){c(t[0].g,t[t.length-1].g)&&u.push(t[0].i)}),n=u;else for(o=0,n=new Array(a=t.arcs.length);o<a;++o)n[o]=o;function s(t){var e=t<0?~t:t;(f[e]||(f[e]=[])).push({i:t,g:i})}function l(t){t.forEach(s)}function h(t){t.forEach(l)}function p(t){t.forEach(h)}return{type:"MultiLineString",arcs:y(t,n)}}function o(i,t){var u={},r=[],n=[];function o(e){e.forEach(function(t){t.forEach(function(t){(u[t=t<0?~t:t]||(u[t]=[])).push(e)})}),r.push(e)}function f(t){return function(t){for(var e,r=-1,n=t.length,o=t[n-1],a=0;++r<n;)e=o,o=t[r],a+=e[0]*o[1]-e[1]*o[0];return Math.abs(a)}(a(i,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o)}}),r.forEach(function(t){if(!t._){var e=[],r=[t];for(t._=1,n.push(e);t=r.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),r.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:n.map(function(t){var e,r=[];if(t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].length<2&&r.push(t)})})}),1<(e=(r=y(i,r)).length))for(var n,o,a=1,c=f(r[0]);a<e;++a)(n=f(r[a]))>c&&(o=r[0],r[0]=r[a],r[a]=o,c=n);return r}).filter(function(t){return 0<t.length})}}function d(t,e){for(var r=0,n=t.length;r<n;){var o=r+n>>>1;t[o]<e?r=1+o:n=o}return r}function m(t){if(null==t)return e;var c,i,u=t.scale[0],f=t.scale[1],s=t.translate[0],l=t.translate[1];return function(t,e){e||(c=i=0);var r=2,n=t.length,o=new Array(n),a=Math.round((t[0]-s)/u),e=Math.round((t[1]-l)/f);for(o[0]=a-c,c=a,o[1]=e-i,i=e;r<n;)o[r]=t[r],++r;return o}}t.bbox=g,t.feature=function(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return r(e,t)})}:r(e,t)},t.merge=function(t){return a(t,o.apply(this,arguments))},t.mergeArcs=o,t.mesh=function(t){return a(t,n.apply(this,arguments))},t.meshArcs=n,t.neighbors=function(t){var n={},e=t.map(function(){return[]});function r(t,r){t.forEach(function(t){t<0&&(t=~t);var e=n[t];e?e.push(r):n[t]=[r]})}function o(t,e){t.forEach(function(t){r(t,e)})}var a,c={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(t,e){t.forEach(function(t){o(t,e)})}};for(a in t.forEach(function e(t,r){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,r)}):t.type in c&&c[t.type](t.arcs,r)}),n)for(var i=n[a],u=i.length,f=0;f<u;++f)for(var s=f+1;s<u;++s){var l,h=i[f],p=i[s];(l=e[h])[a=d(l,p)]!==p&&l.splice(a,0,p),(l=e[p])[a=d(l,h)]!==h&&l.splice(a,0,h)}return e},t.quantize=function(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)i=t.bbox;else{if(!(2<=(r=Math.floor(e))))throw new Error("n must be â¥2");var r,n=(i=t.bbox||g(t))[0],o=i[1],a=i[2],c=i[3];e={scale:[a-n?(a-n)/(r-1):1,c-o?(c-o)/(r-1):1],translate:[n,o]}}var i,u,f=m(e),s=t.objects,l={};function h(t){return f(t)}function p(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(p)};break;case"Point":e={type:"Point",coordinates:h(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(h)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(u in s)l[u]=p(s[u]);return{type:"Topology",bbox:i,transform:e,objects:l,arcs:t.arcs.map(function(t){var e,r=0,n=1,o=t.length,a=new Array(o);for(a[0]=f(t[0],0);++r<o;)((e=f(t[r],r))[0]||e[1])&&(a[n++]=e);return 1===n&&(a[n++]=[0,0]),a.length=n,a})}},t.transform=s,t.untransform=m,Object.defineProperty(t,"__esModule",{value:!0})});
!function(){var n=(a=null,"maxTouchPoints"in navigator?a=0<navigator.maxTouchPoints:window.matchMedia&&window.matchMedia("(any-pointer:coarse),(any-pointer:fine),(any-pointer:none)").matches?a=window.matchMedia("(any-pointer:coarse)").matches:"msMaxTouchPoints"in navigator&&(a=0<navigator.msMaxTouchPoints),a),o=null!==n,a=o?n:L.Browser.touch;BR.Browser={touchScreen:n,touchScreenDetectable:o,touch:a,download:"Blob"in window&&"FileReader"in window&&"readAsDataURL"in FileReader.prototype&&"download"in document.createElement("a")}}();
BR.WhatsNew={newOnly:void 0,init:function(){var e=this;e.dismissableMessage=new BR.Message("whats_new_message",{onClosed:function(){document.getElementsByClassName("version")[0].classList.remove("version-new"),BR.Util.localStorageAvailable()&&localStorage.setItem("changelogVersion",e.getLatestVersion())}}),$("#whatsnew").on("shown.bs.modal",function(){e.dismissableMessage.hide()}),$("#whatsnew").on("hidden.bs.modal",function(){e.prepare(!1)}),!e.getCurrentVersion()&&BR.Util.localStorageAvailable()&&localStorage.setItem("changelogVersion",e.getLatestVersion()),e.prepare(e.hasNewVersions()),e.hasNewVersions()&&(e.dismissableMessage.showInfo(i18next.t("whatsnew.new-version")),document.getElementsByClassName("version")[0].classList.add("version-new"))},getLatestVersion:function(){return BR.changelog.match('<h2 id="(.*)">')[1]},getCurrentVersion:function(){return BR.Util.localStorageAvailable()?localStorage.getItem("changelogVersion"):null},hasNewVersions:function(){return this.getCurrentVersion()&&this.getCurrentVersion()!==this.getLatestVersion()},prepare:function(e){var s,n;e!==this.newOnly&&(this.newOnly=e,s=document.querySelector("#whatsnew .modal-body"),n=BR.changelog,e&&this.getCurrentVersion()&&(e='<h2 id="'+this.getCurrentVersion()+'">',0<=(e=n.indexOf(e))&&(n=n.substring(0,e))),s.innerHTML=n)}};
BR.Util={get:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){200!==n.status&&0!==n.status||!n.responseText?t(BR.Util.getError(n)):t(null,n.responseText)},n.onerror=function(){t(BR.Util.getError(n))};try{n.send()}catch(e){t(e)}},getError:function(e){var t=i18next.t("warning.no-response");return e.responseText?t=e.responseText:(e.status||e.statusText)&&(t=e.status+": "+e.statusText),new Error(t)},getJson:function(e,r,o){BR.Util.get(e,function(e,t){if(e)return BR.message.showError("Error getting "+r+": "+e),o(e);try{var n=JSON.parse(t);o(null,n)}catch(e){BR.message.showError("Error parsing "+r+": "+e),console.error(e),o(e)}})},getGeoJson:function(e,t,r){BR.Util.getJson(e,t,function(e,t){if(e)return r(e);var n=t;t&&t.type&&"Topology"===t.type&&(e=Object.keys(t.objects)[0],n=topojson.feature(t,t.objects[e])),r(null,n)})},localStorageAvailable:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}},getResponsiveBreakpoint:function(){var e={"1xs":"d-none","2sm":"d-sm-none","3md":"d-md-none","4lg":"d-lg-none","5xl":"d-xl-none"},t="",n=$("<div>");n.appendTo($("body"));for(var r=Object.keys(e).length-1;0<=r&&(t=Object.keys(e)[r],n.addClass(e[t]),!n.is(":hidden"));r--);return n.remove(),t},keyboardShortcutsAllowed:function(e){return!e.repeat&&("number"!=document.activeElement.type&&"text"!=document.activeElement.type&&"textarea"!=document.activeElement.type&&(!(e.ctrlKey||e.metaKey||e.altKey)&&(!$(".modal.show").length&&!$(".dropdown.show").length)))},sanitizeHTMLContent:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},isCountry:function(e,t){var n=i18next.languages[0].split("-");return 1<n.length?n[1]===e:!!t&&n[0]===t}};
function _createForOfIteratorHelper(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,i=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return n=t.done,t},e:function(t){i=!0,a=t},f:function(){try{n||null==o.return||o.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}BR.Map={initMap:function(){var t,a;L.setOptions(this,{shortcut:{locate:76}}),BR.keys=BR.keys||{};BR.Browser.touch&&(L.Draggable.prototype.options.clickTolerance=10),t=new L.Map("map",{zoomControl:!1,worldCopyJump:!0,minZoom:0,maxZoom:19}),"3md"<=BR.Util.getResponsiveBreakpoint()&&L.control.zoom({zoomInTitle:i18next.t("keyboard.generic-shortcut",{action:"$t(map.zoomInTitle)",key:"+"}),zoomOutTitle:i18next.t("keyboard.generic-shortcut",{action:"$t(map.zoomOutTitle)",key:"-"})}).addTo(t),t.restoreView()||t.setView(BR.conf.initialMapLocation||[50.99,9.86],BR.conf.initialMapZoom||5);var e=400<=$(t.getContainer()).outerWidth()?i18next.t("map.attribution-osm-long"):i18next.t("map.attribution-osm-short"),o=BR.conf.privacyPolicyUrl||"https://brouter.de/privacypolicy.html";t.attributionControl.setPrefix('&copy; <a target="_blank" href="https://www.openstreetmap.org/copyright">'+e+'</a> &middot; <a href="" data-toggle="modal" data-target="#credits">'+i18next.t("map.copyright")+'</a> &middot; <a target="_blank" href="'+o+'">'+i18next.t("map.privacy")+"</a>"),$("#credits").on("show.bs.modal",function(t){BR.Map._renderLayerCredits(a._layers);var e,o=new URL(BR.conf.overpassBaseUrl||"https://overpass-api.de").origin,r=_createForOfIteratorHelper(document.getElementsByClassName("overpass-url"));try{for(r.s();!(e=r.n()).done;)e.value.href=o}catch(t){r.e(t)}finally{r.f()}}),(new L.Control.PermalinkAttribution).addTo(t),t.attributionControl.setPrefix(!1);var r,e=BR.layersConfig(t),n=e.getBaseLayers(),l=e.getOverlays();for(i in BR.keys.bing&&(n[i18next.t("map.layer.bing")]=new BR.BingLayer(BR.keys.bing)),BR.keys.digitalGlobe&&(o=new L.tileLayer("https://{s}.tiles.mapbox.com/v4/digitalglobe.nal0g75k/{z}/{x}/{y}.png?access_token="+BR.keys.digitalGlobe,{minZoom:1,maxZoom:19,attribution:'&copy; <a href="https://www.digitalglobe.com/platforms/mapsapi">DigitalGlobe</a> (<a href="https://bit.ly/mapsapiview">Terms of Use</a>)'}),n[i18next.t("map.layer.digitalglobe")]=o),BR.conf.clearBaseLayers&&(n={}),BR.conf.baseLayers)BR.conf.baseLayers.hasOwnProperty(i)&&(n[i]=L.tileLayer(BR.conf.baseLayers[i]));for(i in BR.conf.overlays)BR.conf.overlays.hasOwnProperty(i)&&(l[i]=L.tileLayer(BR.conf.overlays[i]));return a=BR.layersTab(e,n,l).addTo(t),("isSecureContext"in window?isSecureContext:"https:"===location.protocol)&&(r=L.control.locate({strings:{title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.locate-me)",key:"L"})},icon:"fa fa-location-arrow",iconLoading:"fa fa-spinner fa-pulse"}).addTo(t),L.DomEvent.addListener(document,"keydown",function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.locate&&(r._active?r.stop():r.start())},this)),L.control.scale().addTo(t),(new BR.Layers).init(t,a,n,l),BR.debug=BR.debug||{},{map:BR.debug.map=t,layersControl:a}},_renderLayerCredits:function(t){var e,o,r,a,n=document.getElementById("credits-maps");for(L.DomUtil.empty(n),e=0;e<t.length;e++)(o=t[e]).layer.options.attribution&&((r=document.createElement("dt")).innerHTML=o.name,(a=document.createElement("dd")).innerHTML=o.layer.options.attribution,n.appendChild(r),n.appendChild(a))}};
function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,r){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var t,n,o=[],s=!0,i=!1;try{for(a=a.call(e);!(s=(t=a.next()).done)&&(o.push(t.value),!r||o.length!==r);s=!0);}catch(e){i=!0,n=e}finally{try{s||null==a.return||a.return()}finally{if(i)throw n}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,r){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){a&&(e=a);var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,n=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw n}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var a=0,t=new Array(r);a<r;a++)t[a]=e[a];return t}BR.LayersConfig=L.Class.extend({overpassFrontend:new OverpassFrontend(BR.conf.overpassBaseUrl||"//overpass-api.de/api/interpreter"),defaultBaseLayers:BR.confLayers.defaultBaseLayers,defaultOverlays:BR.confLayers.defaultOverlays,legacyNameToIdMap:BR.confLayers.legacyNameToIdMap,builtInLayers:["route-quality"],initialize:function(e){this._map=e,this._overpassLoadingIndicator=new BR.Message("overpass_loading_indicator",{alert:!1}),this._overpassActiveRequestCount=0,this._addLeafletProvidersLayers(),this._customizeLayers(),this.loadDefaultLayers(),this._addLanguageDefaultLayer()},loadDefaultLayers:function(){var e;!BR.Util.localStorageAvailable()||(e=localStorage.getItem("map/defaultLayers"))&&(e=JSON.parse(e),this.defaultBaseLayers=this._replaceLegacyIds(e.baseLayers),this.defaultOverlays=this._replaceLegacyIds(e.overlays))},storeDefaultLayers:function(e,r){BR.Util.localStorageAvailable()&&(r={baseLayers:e,overlays:r},localStorage.setItem("map/defaultLayers",JSON.stringify(r)))},_replaceLegacyIds:function(e){var r=this;return e.map(function(e){return e in r.legacyNameToIdMap?r.legacyNameToIdMap[e]:e})},_addLeafletProvidersLayers:function(){for(var e=BR.confLayers.leafletProvidersIncludeList,r=0;r<e.length;r++){var a=e[r],t={geometry:null,properties:{id:a,name:a.replace("."," "),dataSource:"leaflet-providers"},type:"Feature"};BR.layerIndex[a]=t}},_customizeLayers:function(){var e,r=BR.confLayers.getPropertyOverrides();for(e in r){var a=BR.layerIndex[e];if(a){var t,n=r[e];for(t in n){var o=n[t];a.properties[t]=o}}else console.error("Layer not found: "+e)}BR.layerIndex.MtbMap.geometry=BR.confLayers.europeGeofabrik,BR.layerIndex[1069].geometry=BR.confLayers.europeGeofabrik,BR.layerIndex["OpenStreetMap.CH"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex["swisstopo-landeskarte"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex["swisstopo-aerial"].geometry=BR.confLayers.switzerlandPadded,BR.layerIndex[1017].geometry=BR.confLayers.osmapaPl},_addLanguageDefaultLayer:function(){for(var e={},r=0;r<BR.confLayers.languageDefaultLayers.length;r++){var a=BR.confLayers.languageDefaultLayers[r],t=BR.layerIndex[a];!t||(t=t.properties.language_code||t.properties.pseudo_language_code)&&(e[t]=a)}for(r=0;r<i18next.languages.length;r++){var n=e[i18next.languages[r]];if(n){this.defaultBaseLayers.unshift(n);break}}},isDefaultLayer:function(e,r){return r?-1<this.defaultOverlays.indexOf(e):-1<this.defaultBaseLayers.indexOf(e)},getBaseLayers:function(){return this._getLayers(this.defaultBaseLayers)},getOverlays:function(){return this._getLayers(this.defaultOverlays)},_getLayers:function(e){for(var r={},a=0;a<e.length;a++){var t,n=e[a],o=BR.layerIndex[n];o?(!(t=this.getKeyName(o.properties.url))||t&&BR.keys[t.name])&&(r[o.properties.name]=this.createLayer(o)):console.error("Layer not found: "+n)}return r},getKeyName:function(e){var r=null,a=new RegExp("{keys_([^}]*)}");return e&&(a=e.match(a))&&(r={name:a=a[1],urlVar:"keys_"+a}),r},_showOverpassLoadingIndicator:function(){this._overpassActiveRequestCount++,this._overpassLoadingIndicator.showLoading(i18next.t("layers.overpass-loading-indicator"))},_hideOverpassLoadingIndicator:function(){0==--this._overpassActiveRequestCount&&this._overpassLoadingIndicator.hide()},getOverpassIconUrl:function(e){var r=/^(maki|temaki|fas)-/,a=null;return e&&r.test(e)&&(r=e.replace(r,""),a="dist/images/".concat(r,".svg")),a},createOverpassLayer:function(e,r){var a='<i class="fa fa-search icon-white" style="width: 25px;"></i>',r=this.getOverpassIconUrl(r);return r&&(a='<img class="icon-invert" src="'.concat(r,'" width="11" />')),Object.assign(new OverpassLayer({overpassFrontend:this.overpassFrontend,query:e,minZoom:12,feature:{title:"{{ tags.name }}",body:'<table class="overpass-tags">{% for k, v in tags %}{% if k[:5] != "addr:" %}<tr><th>{{ k }}</th><td>{% if k matches "/email/" %}<a href="mailto:{{ v }}">{{ v }}</a>{% elseif v matches "/^http/" %}<a href="{{ v }}">{{ v }}</a>{% elseif v matches "/^www/" %}<a href="http://{{ v }}">{{ v }}</a>{% else %}{{ v }}{% endif %}</td></tr>{% endif %}{% endfor %}</table>',markerSymbol:'<svg width="25px" height="41px" anchorX="12" anchorY="41" viewBox="0 0 32 52" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M16,1 C7.7146,1 1,7.65636364 1,15.8648485 C1,24.0760606 16,51 16,51 C16,51 31,24.0760606 31,15.8648485 C31,7.65636364 24.2815,1 16,1 L16,1 Z" fill="#436978"></path></svg>',markerSign:a,style:function(e){return{color:"node"===e.type?"#00000000":"cyclosm"===(null===(e=this.defaultBaseLayers)||void 0===e?void 0:e[0])?"darkorange":"#3388ff"}}.bind(this)}}),{onLoadStart:this._showOverpassLoadingIndicator.bind(this),onLoadEnd:this._hideOverpassLoadingIndicator.bind(this)})},createOpenStreetMapNotesLayer:function(){return new leafletOsmNotes},createMvtLayer:function(e,r){var a=null===(a=e.url)||void 0===a?void 0:a.split("?")[0];return a in BR.layerIndex?(r.style=BR.layerIndex[a],this._replaceMvtTileKey(r.style)):r.style=e.url,BR.maplibreGlLazyLoader(r)},_replaceMvtTileKey:function(e){if(e)for(var r=0,a=Object.values(e.sources);r<a.length;r++){var t,n=a[r];if(!n.url||(t=this.getKeyName(n.url))&&BR.keys[t.name]&&(n.url=n.url.replace("{".concat(t.urlVar,"}"),BR.keys[t.name])),n.tiles){var o=n.tiles,s=_createForOfIteratorHelper(null==o?void 0:o.entries());try{for(s.s();!(u=s.n()).done;){var i=_slicedToArray(u.value,2),l=i[0],u=i[1],i=this.getKeyName(u);i&&BR.keys[i.name]&&(o[l]=u.replace("{".concat(i.urlVar,"}"),BR.keys[i.name]))}}catch(e){s.e(e)}finally{s.f()}}}},createLayer:function(e){var r=e.properties,a=r.url;var t={maxZoom:this._map.getMaxZoom(),bounds:e.geometry&&!r.worldTiles?L.geoJson(e.geometry).getBounds():null};r.mapUrl&&(t.mapLink='<a target="_blank" href="'+r.mapUrl+'">'+(r.nameShort||r.name)+"</a>"),r.attribution&&(t.attribution=r.attribution);var n,o,s,i,l,u,y,e=this.getKeyName(a);e&&BR.keys[e.name]&&(t[e.urlVar]=BR.keys[e.name]),"leaflet-providers"===r.dataSource?(o=L.tileLayer.provider(r.id),e=L.Util.extend(t,{maxNativeZoom:o.options.maxZoom}),L.setOptions(o,e)):"LayersCollection"===r.dataSource?(o=L.tileLayer(a,L.Util.extend(t,{minZoom:r.minZoom||0,maxNativeZoom:r.maxZoom})),r.subdomains&&(o.subdomains=r.subdomains)):o="OverpassAPI"===r.dataSource?this.createOverpassLayer(r.query,r.icon):"OpenStreetMapNotesAPI"===r.dataSource?this.createOpenStreetMapNotesLayer():"mvt"===r.type?this.createMvtLayer(r,t):(a=(n=a).replace(/{switch:[^}]*}/,"{s}").replace(/{zoom}/g,"{z}"),t=L.Util.extend(t,{minZoom:r.min_zoom||0,maxNativeZoom:r.max_zoom,subdomains:(y="abc",(u=(u=n).match(/{switch:([^}]*)}/))&&(y=u[1].split(",")),y),attribution:(i="",(l=(s=r).attribution)&&(l.html?i=l.html:l.url&&l.text?i='<a href="'+l.url+'" target="_blank" rel="noopener">'+l.text+"</a>":l.text&&(i=l.text)),i||console.warn("No attribution: "+s.id),i)}),r.type&&"wms"===r.type?L.tileLayer.wms(a,L.Util.extend(t,{layers:r.layers,format:r.format})):L.tileLayer(a,t));return o.getAttribution=function(){return this.options.mapLink},o.id=r.id,o}}),BR.layersConfig=function(e){return new BR.LayersConfig(e)};
function _createForOfIteratorHelper(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,i=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){i=!0,r=t},f:function(){try{s||null==o.return||o.return()}finally{if(i)throw r}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}L.BRouter=L.Class.extend({statics:{URL_TEMPLATE:"/brouter?lonlats={lonlats}&profile={profile}&alternativeidx={alternativeidx}&format={format}&nogos={nogos}&polylines={polylines}&polygons={polygons}",URL_PROFILE_UPLOAD:BR.conf.host+"/brouter/profile",PRECISION:6,NUMBER_SEPARATOR:",",GROUP_SEPARATOR:"|",ABORTED_ERROR:"aborted",CUSTOM_PREFIX:"custom_",isCustomProfile:function(t){return t&&t.substring(0,7)===L.BRouter.CUSTOM_PREFIX}},options:{},initialize:function(t){L.setOptions(this,t),this.queue=async.queue(L.bind(function(t,e){this.getRoute(t.segment,e)},this),1)},setOptions:function(t){L.setOptions(this,t)},getUrlParams:function(t,e,o,n,r){return params={},null!=this._getLonLatsString(t)&&(params.lonlats=this._getLonLatsString(t)),e&&0<e.length&&(0<(e=this._getBeelineString(e)).length&&(params.straight=e)),this.options.nogos&&0<this._getNogosString(this.options.nogos).length&&(params.nogos=this._getNogosString(this.options.nogos)),this.options.polylines&&0<this._getNogosPolylinesString(this.options.polylines).length&&(params.polylines=this._getNogosPolylinesString(this.options.polylines)),this.options.polygons&&0<this._getNogosPolygonsString(this.options.polygons).length&&(params.polygons=this._getNogosPolygonsString(this.options.polygons)),null!=this.options.profile&&(params.profile=this.options.profile),o&&null!=this._getLonLatsNameString(o)&&(params.pois=this._getLonLatsNameString(o)),n&&(params.circlego=n),params.alternativeidx=this.options.alternative,null!=r?params.format=r:(params.profile===BR.conf.profiles[0]&&delete params.profile,0==params.alternativeidx&&delete params.alternativeidx,params.profile&&L.BRouter.isCustomProfile(params.profile)&&delete params.profile),params},parseUrlParams:function(t){var e={};return t.lonlats&&(e.lonlats=this._parseLonLats(t.lonlats)),t.straight&&(e.beelineFlags=this._parseBeelines(t.straight,e.lonlats)),t.nogos&&(e.nogos=this._parseNogos(t.nogos)),t.polylines&&(e.polylines=this._parseNogosPolylines(t.polylines)),t.polygons&&(e.polygons=this._parseNogosPolygons(t.polygons)),t.alternativeidx&&(e.alternative=t.alternativeidx),t.profile&&(e.profile=this._parseProfile(t.profile)),t.pois&&(e.pois=this._parseLonLatNames(t.pois)),!t.ringgo&&!t.circlego||3==(t=(t.ringgo||t.circlego).split(",")).length&&(t=[Number.parseFloat(t[0]),Number.parseFloat(t[1]),Number.parseInt(t[2])],e.circlego=t),e},getUrl:function(t,e,o,n,r,s,i){o=this.getUrlParams(t,e,o,n,r),n=[];return null!=o.lonlats&&0<o.lonlats.length&&n.push(L.Util.template("lonlats={lonlats}",o)),null!=o.straight&&n.push(L.Util.template("straight={straight}",o)),null!=o.pois&&0<o.pois.length&&n.push(L.Util.template("pois={pois}",o)),null!=o.circlego&&n.push(L.Util.template("ringgo={circlego}",o)),null!=o.nogos&&n.push(L.Util.template("nogos={nogos}",o)),null!=o.polylines&&n.push(L.Util.template("polylines={polylines}",o)),null!=o.polygons&&n.push(L.Util.template("polygons={polygons}",o)),null!=o.profile&&n.push(L.Util.template("profile={profile}",o)),null!=o.alternativeidx&&n.push(L.Util.template("alternativeidx={alternativeidx}",o)),null!=o.format&&n.push(L.Util.template("format={format}",o)),s&&n.push(L.Util.template("trackname={trackname}",{trackname:s})),i&&n.push("exportWaypoints=1"),(null!=r?BR.conf.host:"")+"/brouter?"+n.join("&")},getRoute:function(t,e){var o=this.getUrl(t,null,null,null,"geojson"),t=new XMLHttpRequest;if(!o)return e(new Error(i18next.t("warning.cannot-get-route")));t.open("GET",o,!0),t.onload=L.bind(this._handleRouteResponse,this,t,e),t.onerror=L.bind(function(t,e){e(BR.Util.getError(t))},this,t,e),t.send()},_handleRouteResponse:function(e,o){var t;if(200===e.status&&e.responseText&&"application/vnd.geo+json"===e.getResponseHeader("Content-Type").split(";")[0])try{return t=JSON.parse(e.responseText),o(null,this._assignFeatures(L.geoJSON(t).getLayers()[0]))}catch(t){return console.error(t,e.responseText),o(t)}else o(BR.Util.getError(e))},getRouteSegment:function(t,e,o){this.queue.push({segment:[t,e]},o)},uploadProfile:function(t,e,o){var n=L.BRouter.URL_PROFILE_UPLOAD;xhr=new XMLHttpRequest,t&&(n+="/"+t),xhr.open("POST",n,!0),xhr.onload=L.bind(this._handleProfileResponse,this,xhr,o),xhr.onerror=function(t){o(i18next.t("warning.upload-error",{error:this.statusText}))},xhr.send(e)},_assignFeatures:function(t){if(t.feature.properties.messages)for(var e=t.feature.properties.messages,o=t.getLatLngs(),n=o.length,r=0,s=1;s<e.length;s++)for(var i=this._getFeatureLatLng(e[s]),l=r;l<n;l++){var a=o[l],g=e[s];if(a.feature=BR.TrackEdges.getFeature(g),a.message=g,i.equals(o[l])){r=l+1;break}}return t},_getFeatureLatLng:function(t){var e=t[0]/1e6,t=t[1]/1e6;return L.latLng(t,e)},_handleProfileResponse:function(t,e){200===t.status&&t.responseText&&0<t.responseText.length?e((t=JSON.parse(t.responseText)).error,t.profileid):e(i18next.t("warning.profile-error"))},_getLonLatsString:function(t){for(var e="",o=0;o<t.length;o++)e+=this._formatLatLng(t[o]),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR);return e},_parseLonLats:function(t){var e,o,n=[];if(!t)return n;e=t.split(L.BRouter.GROUP_SEPARATOR);for(var r=0;r<e.length;r++)o=e[r].split(L.BRouter.NUMBER_SEPARATOR),n.push(L.latLng(o[1],o[0]));return n},_getBeelineString:function(t){for(var e=[],o=0;o<t.length;o++)t[o]&&e.push(o);return e.join(",")},_parseBeelines:function(t,e){if(!e||e.length<2)return[];var o=new Array(e.length-1);o.fill(!1);var n,r=_createForOfIteratorHelper(t.split(","));try{for(r.s();!(n=r.n()).done;)o[n.value]=!0}catch(t){r.e(t)}finally{r.f()}return o},_getLonLatsNameString:function(t){for(var e="",o=0;o<t.length;o++)e+=this._formatLatLng(t[o].latlng),e+=L.BRouter.NUMBER_SEPARATOR,e+=encodeURIComponent(t[o].name),o<t.length-1&&(e+=L.BRouter.GROUP_SEPARATOR);return e},_parseLonLatNames:function(t){var e,o,n=[];if(!t)return n;e=t.split(L.BRouter.GROUP_SEPARATOR);for(var r=0;r<e.length;r++)o=e[r].split(L.BRouter.NUMBER_SEPARATOR),n.push({latlng:L.latLng(o[1],o[0]),name:decodeURIComponent(o[2])});return n},_getNogosString:function(t){for(var e,o="",n=0;n<t.length;n++)e=t[n],o+=this._formatLatLng(e.getLatLng()),o+=L.BRouter.NUMBER_SEPARATOR,o+=Math.round(e.getRadius()),void 0!==e.options.nogoWeight&&null!==e.options.nogoWeight&&-1!==e.options.nogoWeight&&(o+=L.BRouter.NUMBER_SEPARATOR,o+=e.options.nogoWeight),n<t.length-1&&(o+=L.BRouter.GROUP_SEPARATOR);return o},_parseNogos:function(t){var e,o,n=[];if(!t)return n;e=t.split(L.BRouter.GROUP_SEPARATOR);for(var r=0;r<e.length;r++){var s={radius:(o=e[r].split(L.BRouter.NUMBER_SEPARATOR))[2]};3<o.length&&(s.nogoWeight=o[3]),n.push(L.circle([o[1],o[0]],s))}return n},_getNogosPolylinesString:function(t){for(var e,o,n="",r=0;r<t.length;r++){o=(e=t[r]).getLatLngs();for(var s=0;s<o.length;s++)0<s&&(n+=L.BRouter.NUMBER_SEPARATOR),n+=this._formatLatLng(o[s]);void 0!==e.options.nogoWeight&&null!==e.options.nogoWeight&&-1!==e.options.nogoWeight&&(n+=L.BRouter.NUMBER_SEPARATOR,n+=e.options.nogoWeight),r<t.length-1&&(n+=L.BRouter.GROUP_SEPARATOR)}return n},_parseNogosPolylines:function(t){for(var e,o,n=[],r=t.split(L.BRouter.GROUP_SEPARATOR),s=0;s<r.length;s++)if(1<(e=r[s].split(L.BRouter.NUMBER_SEPARATOR)).length){o=[];for(var i,l=0;l<e.length-1;){var a=Number.parseFloat(e[l++]),g=Number.parseFloat(e[l++]);o.push([g,a])}l<e.length&&(i=Number.parseFloat(e[l++]));var p=L.extend(BR.NogoAreas.prototype.polylineOptions,{nogoWeight:i});n.push(L.polyline(o,p))}return n},_getNogosPolygonsString:function(t){for(var e,o,n="",r=0;r<t.length;r++){o=(e=t[r]).getLatLngs()[0];for(var s=0;s<o.length;s++)0<s&&(n+=L.BRouter.NUMBER_SEPARATOR),n+=this._formatLatLng(o[s]);void 0!==e.options.nogoWeight&&null!==e.options.nogoWeight&&-1!==e.options.nogoWeight&&(n+=L.BRouter.NUMBER_SEPARATOR,n+=e.options.nogoWeight),r<t.length-1&&(n+=L.BRouter.GROUP_SEPARATOR)}return n},_parseNogosPolygons:function(t){for(var e,o,n=[],r=t.split(L.BRouter.GROUP_SEPARATOR),s=0;s<r.length;s++)if(1<(e=r[s].split(L.BRouter.NUMBER_SEPARATOR)).length){o=[];for(var i,l=0;l<e.length-1;){var a=Number.parseFloat(e[l++]),g=Number.parseFloat(e[l++]);o.push([g,a])}l<e.length&&(i=Number.parseFloat(e[l++])),n.push(L.polygon(o,{nogoWeight:i}))}return n},_parseProfile:function(t){var e;return null!==(e=BR.conf.profilesRename)&&void 0!==e&&e[t]?BR.conf.profilesRename[t]:t},_formatLatLng:function(t){var e="";return e+=L.Util.formatNum(t.lng||t[1],L.BRouter.PRECISION),e+=L.BRouter.NUMBER_SEPARATOR,e+=L.Util.formatNum(t.lat||t[0],L.BRouter.PRECISION)}}),L.bRouter=function(t){return new L.BRouter(t)};
function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var _=e[i];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(t,_.key,_)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}btools={},function(t){var e;e=t.util||(t.util={}),(t=function(){"use strict";function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"__static_initialize",value:function(){r.__static_initialized||(r.__static_initialized=!0,r.__static_initializer_0())}},{key:"DEG_TO_RAD_$LI$",value:function(){return r.__static_initialize(),null==r.DEG_TO_RAD&&(r.DEG_TO_RAD=Math.PI/180),r.DEG_TO_RAD}},{key:"SCALE_CACHE_$LI$",value:function(){return r.__static_initialize(),null==r.SCALE_CACHE&&(r.SCALE_CACHE=function(t){for(var e=[];0<t--;)e.push(null);return e}(r.SCALE_CACHE_LENGTH)),r.SCALE_CACHE}},{key:"__static_initializer_0",value:function(){for(var t=0;t<r.SCALE_CACHE_LENGTH;t++)r.SCALE_CACHE_$LI$()[t]=r.calcKxKyFromILat(t*r.SCALE_CACHE_INCREMENT+(r.SCALE_CACHE_INCREMENT/2|0))}},{key:"calcKxKyFromILat",value:function(t){var e=r.DEG_TO_RAD_$LI$()*(t*r.ILATLNG_TO_LATLNG-90),i=Math.cos(e),_=2*i*i-1,n=2*i*_-i,a=2*i*n-_,t=2*i*a-n,e=[0,0];return e[0]=(111.41513*i-.09455*n+12e-5*t)*r.ILATLNG_TO_LATLNG*r.KILOMETERS_TO_METERS,e[1]=(111.13209-.56605*_+.0012*a)*r.ILATLNG_TO_LATLNG*r.KILOMETERS_TO_METERS,e}},{key:"getLonLatToMeterScales",value:function(t){return r.SCALE_CACHE_$LI$()[t/r.SCALE_CACHE_INCREMENT|0]}},{key:"distance",value:function(t,e,i,_){var n=r.getLonLatToMeterScales(e+_>>1),i=(t-i)*n[0],n=(e-_)*n[1];return Math.sqrt(n*n+i*i)}}]),r}()).__static_initialized=!1,t.ILATLNG_TO_LATLNG=1e-6,t.KILOMETERS_TO_METERS=1e3,t.SCALE_CACHE_LENGTH=1800,t.SCALE_CACHE_INCREMENT=1e5,(e.CheapRuler=t).__class="btools.util.CheapRuler"}(btools=btools||{}),btools.util.CheapRuler.__static_initialize(),btools.util.CheapRuler.toIntegerLngLat=function(t){return[Math.round(1e6*(t[0]+180)),Math.round(1e6*(t[1]+90))]},btools.util.CheapRuler.calcDistance=function(t,e,i,_){_=btools.util.CheapRuler.distance(t,e,i,_);return Math.trunc(_+1)};
BR.ClickTolerantBoxZoom=L.Map.BoxZoom.extend({clickTolerance:L.Draggable.prototype.options.clickTolerance,dragTolerance:15,tolerant:!0,_preMoved:!1,moved:function(){return this._preMoved||this._moved},_resetState:function(){L.Map.BoxZoom.prototype._resetState.call(this),this._preMoved=!1},_onMouseMove:function(e){if(!this._moved){var t=this._map.mouseEventToContainerPoint(e).clone()._subtract(this._startPoint),t=Math.abs(t.x||0)+Math.abs(t.y||0);if(this.tolerant&&t<this.dragTolerance)return void(!this._preMoved&&t>=this.clickTolerance&&(this._preMoved=!0))}L.Map.BoxZoom.prototype._onMouseMove.call(this,e)},_onMouseUp:function(e){L.Map.BoxZoom.prototype._onMouseUp.call(this,e),!this._moved&&this._preMoved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(L.Util.bind(this._resetState,this),0))}});
L.Draggable.prototype._onMoveOrig=L.Draggable.prototype._onMove,L.Draggable.prototype._onMove=function(t){var o=!this._moved;this._onMoveOrig.call(this,t),o&&this._moved&&(o=this._newPos.subtract(this._startPos),this._startPos=this._startPos.add(o),this._newPos=this._newPos.add(o))};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return a};var a={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function i(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(t){i=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,i,a,c,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),n=new w(n||[]);return e._invoke=(o=t,i=r,a=n,c="suspendedStart",function(t,e){if("executing"===c)throw new Error("Generator is already running");if("completed"===c){if("throw"===t)throw e;return b()}for(a.method=t,a.arg=e;;){var r=a.delegate;if(r){var n=function t(e,r){var n=e.iterator[r.method];if(void 0===n){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return l;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}n=s(n,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,l;var n=n.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,l):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,l)}(r,a);if(n){if(n===l)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===c)throw c="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c="executing";n=s(o,i,a);if("normal"===n.type){if(c=a.done?"completed":"suspendedYield",n.arg===l)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(c="completed",a.method="throw",a.arg=n.arg)}}),e}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}a.wrap=c;var l={};function h(){}function f(){}function p(){}var y={};i(y,n,function(){return this});e=Object.getPrototypeOf,e=e&&e(e(x([])));e&&e!==t&&u.call(e,n)&&(y=e);var d=p.prototype=h.prototype=Object.create(y);function v(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function g(a,c){var e;this._invoke=function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){t=s(a[t],a,r);if("throw"!==t.type){var i=t.arg,r=i.value;return r&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){i.value=t,n(i)},function(t){return e("throw",t,n,o)})}o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return t.next=t}}return{next:b}}function b(){return{value:void 0,done:!0}}return i(d,"constructor",f.prototype=p),i(p,"constructor",f),f.displayName=i(p,o,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,i(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t},a.awrap=function(t){return{__await:t}},v(g.prototype),i(g.prototype,r,function(){return this}),a.AsyncIterator=g,a.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var i=new g(c(t,e,r,n),o);return a.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},v(d),i(d,o,"Generator"),i(d,n,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),a.keys=function(r){var t,n=[];for(t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},a.values=x,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return i.type="throw",i.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n,o=r.completion;return"throw"===o.type&&(n=o.arg,L(r)),n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},a}function asyncGeneratorStep(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,a=arguments;return new Promise(function(e,r){var n=c.apply(t,a);function o(t){asyncGeneratorStep(n,e,r,o,i,"next",t)}function i(t){asyncGeneratorStep(n,e,r,o,i,"throw",t)}o(void 0)})}}!function(){var t,e,r=(null===(t=document.currentScript)||void 0===t?void 0:t.src.split("/").slice(0,-1).join("/"))||window.location.origin+"/dist",a=function(t){return new URL(t,r+"/").href};function n(i){return new Promise(function(e,r){try{new Function('return import("'+i+'")')().then(function(){return e()})}catch(t){var n=a(i),o=document.createElement("script");o.onload=function(){e()},o.onerror=function(){r(new Error('Error importing: "'.concat(n,'"'))),o.remove()},o.src=n,document.body.appendChild(o)}})}BR.MaplibreGlLazyLoader=L.Layer.extend({initialize:function(t){this.options=t},onAdd:function(){return"maplibreGL"in L?this._addGlLayer():this._load(),this},onRemove:function(){return this.glLayer&&this._map.removeLayer(this.glLayer),this.glLayer=null,this},setZIndex:function(t){return this.options.zIndex=t,this},setOpacity:function(t){var e;this.glLayer&&((e=this.glLayer.getMaplibreMap()).getLayer("hillshading")?e.setPaintProperty("hillshading","hillshade-exaggeration",t):e.getCanvas().style.opacity=t)},_load:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("./maplibre-gl.js");case 2:return t.next=4,n("./leaflet-maplibre-gl.js");case 4:this._addGlLayer();case 5:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)}),_addGlLayer:function(){this.glLayer=L.maplibreGL(this.options),this.glLayer.getAttribution=function(){return this.options.mapLink},this._map.addLayer(this.glLayer),this._updateZIndex()},_updateZIndex:function(){this.glLayer&&this.glLayer.getContainer()&&null!=this.options.zIndex&&(this.glLayer.getContainer().style.zIndex=this.options.zIndex)}}),BR.maplibreGlLazyLoader=function(t){return new BR.MaplibreGlLazyLoader(t)}}();
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(){var a=function(){"use strict";function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:45,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;_classCallCheck(this,a),this.maxspeed=e,this.costfactor=t}return _createClass(a,[{key:"getMaxspeed",value:function(){return this.maxspeed}},{key:"getCostfactor",value:function(){return this.costfactor}}]),a}(),i=function(){"use strict";function t(e){_classCallCheck(this,t),this.profile=e}return _createClass(t,[{key:"getVariableValue",value:function(e,t){var a,t=null!==(e=null===(a=this.profile)||void 0===a?void 0:a.getProfileVar(e))&&void 0!==e?e:t;return"true"===t?t=1:"false"===t&&(t=0),+t}}]),t}(),e=_createClass(function e(t){"use strict";_classCallCheck(this,e),this.expctxGlobal=new i(t),this.expctxWay=new a,this.bikeMode=0!==this.expctxGlobal.getVariableValue("validForBikes",0),this.footMode=0!==this.expctxGlobal.getVariableValue("validForFoot",0),this.totalMass=this.expctxGlobal.getVariableValue("totalMass",90),this.maxSpeed=this.expctxGlobal.getVariableValue("maxSpeed",this.footMode?6:45)/3.6,this.S_C_x=this.expctxGlobal.getVariableValue("S_C_x",.225),this.defaultC_r=this.expctxGlobal.getVariableValue("C_r",.01),this.bikerPower=this.expctxGlobal.getVariableValue("bikerPower",100)}),t=function(){"use strict";function o(){_classCallCheck(this,o),this.totalTime=0,this.totalEnergy=0,this.elevation_buffer=0}return _createClass(o,[{key:"resetState",value:function(){this.totalTime=0,this.totalEnergy=0,this.elevation_buffer=0}},{key:"calcIncline",value:function(e){if(3<this.elevation_buffer)a=-3;else{if(!(this.elevation_buffer<3))return 0;a=-3}var t=o.exp(-e/100),a=(this.elevation_buffer+a)*t-a,e=(this.elevation_buffer-a)/e;return this.elevation_buffer=a,e}},{key:"computeKinematic",value:function(e,t,a,i){var l,r;i&&(this.elevation_buffer+=a,l=this.calcIncline(t),0===(i=e.expctxWay.getMaxspeed()/3.6)&&(i=e.maxSpeed),i=Math.min(i,e.maxSpeed),a=e.totalMass*o.GRAVITY*(e.defaultC_r+l),i=t/(r=e.footMode||4.9<e.expctxWay.getCostfactor()?(r=3.6*e.maxSpeed)*o.exp(-3.5*Math.abs(l+.05))/3.6:e.bikeMode?(r=o.solveCubic(e.S_C_x,a,e.bikerPower),Math.min(r,i)):i),this.totalTime+=i,0<(a=t*(e.S_C_x*r*r+a))&&(this.totalEnergy+=a))}},{key:"getTotalTime",value:function(){return this.totalTime}},{key:"getTotalEnergy",value:function(){return this.totalEnergy}}],[{key:"exp",value:function(e){for(var t=e,a=1;e<-1;)e+=1,a*=.367879;return a*(1+t*(1+t*(.5+t*(.166667+.0416667*t))))}},{key:"solveCubic",value:function(e,t,a){for(var i=8,l=!0,r=0;r<10;r++){var o=(e*i*i+t)*i-a;if(o<.1){if(l){i*=2;continue}break}l=!1,i-=o/(3*e*i*i+t)}return i}}]),o}();t.GRAVITY=9.81,BR.StdPath=t,BR.RoutingContext=e,BR.BExpressionContextWay=a}();
BR.Track={getGeoJsonOptions:function(t){return{style:function(){return{color:"cyclosm"===t.getActiveBaseLayer().layer.id?"yellow":"blue",weight:4}},interactive:!1,filter:function(t){return!BR.Track.isPoiPoint(t)},pointToLayer:function(t,e){return L.marker(e,{interactive:!1,opacity:.7,zIndexOffset:-1e3})},pane:"tracks"}},addPoiMarkers:function(i,t){turf.featureEach(t,function(t,e){var r,o;BR.Track.isPoiPoint(t)&&(o=turf.getCoord(t),r=L.GeoJSON.coordsToLatLng(o),o="",t.properties&&t.properties.name&&(o=t.properties.name),i.addMarker(r,o))})},isRouteWaypoint:function(t){t=t.properties;if(t&&t.type){t=t.type;if("from"===t||"via"===t||"to"===t)return!0}return!1},isPoiPoint:function(t){return"Point"===turf.getType(t)&&!BR.Track.isRouteWaypoint(t)}};
BR.TrackEdges=L.Class.extend({statics:{getFeature:function(e){return{cost:{perKm:parseInt(e[4]),elev:parseInt(e[5]),turn:parseInt(e[6]),node:parseInt(e[7]),initial:parseInt(e[8])},distance:parseInt(e[3]),wayTags:e[9],nodeTags:e[10]}}},edges:[],initialize:function(e){this.edges=this.getTrackEdges(e)},getTrackEdges:function(e){for(var t,s,n,a,r,g,i,u=0,o=[],c=0;c<e.length;c++){for(t=e[c].feature.properties.messages,n=(s=e[c].getLatLngs()).length,i=0,a=1;a<t.length;a++){for(r=this.getMessageLatLng(t[a]),g=i;g<n&&!r.equals(s[g]);g++);g===n&&(g=n-1),i=g+1,o.push(u+g)}u+=n}return o},getMessageLatLng:function(e){var t=e[0]/1e6,e=e[1]/1e6;return L.latLng(e,t)}});
function _createForOfIteratorHelper(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=_unsupportedIterableToArray(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0,t=function(){};return{s:t,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){e=e.call(r)},n:function(){var r=e.next();return a=r.done,r},e:function(r){i=!0,o=r},f:function(){try{a||null==e.return||e.return()}finally{if(i)throw o}}}}function _unsupportedIterableToArray(r,t){if(r){if("string"==typeof r)return _arrayLikeToArray(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}BR.Csv={format:function(r){var t,e="",n=_createForOfIteratorHelper(r.features[0].properties.messages);try{for(n.s();!(t=n.n()).done;)e+=t.value.join("\t")+"\n"}catch(r){n.e(r)}finally{n.f()}return e}};
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}BR.Gpx={format:function(e,t,r){var n=1<arguments.length&&void 0!==t?t:0,o=2<arguments.length&&void 0!==r?r:"bike";if(null==e||!e.features)return"";var i,a=function(){"use strict";function r(e){var t=this;_classCallCheck(this,r),this.voiceHintsTransform=e,this.comment=(null==e?void 0:e.comment)||"",this.voiceHintsTransform&&Object.keys(this.voiceHintsTransform).forEach(function(e){r.prototype.hasOwnProperty(e)||(t[e]=t.voiceHintsTransform[e])})}return _createClass(r,[{key:"wpt",value:function(e,t,r,n){e=(null===i||void 0===i?void 0:i.wpt)&&i.wpt(e,t,r,n)||e,t.properties.name&&(e.name=t.properties.name);t=t.properties.type;return t&&"poi"!==t&&(e.type=t),e}},{key:"trk",value:function(e,t,r){return e=(null===i||void 0===i?void 0:i.trk)&&i.trk(e,t,r)||e,Object.assign({name:t.properties.name},e)}}]),r}();1<n&&(i=BR.voiceHints(e,n,o).getGpxTransform());o=new a(i),a=togpx(e,{creator:"BRouter-Web "+BR.version,featureTitle:function(){},featureDescription:function(){},featureCoordTimes:function(){},transform:o}),a='<?xml version="1.0" encoding="UTF-8"?>'+BR.Gpx._statsComment(e)+o.comment+a;return a=BR.Xml.pretty(a)},_statsComment:function(e){e=null===(t=e.features)||void 0===t?void 0:t[0].properties;if(!e)return"";var t="\x3c!--";return t+=" track-length = "+e["track-length"],t+=" filtered ascend = "+e["filtered ascend"],t+=" plain-ascend = "+e["plain-ascend"],t+=" cost="+e.cost,e["total-energy"]&&(t+=" energy="+(e["total-energy"]/36e5).toFixed(1)+"kwh"),e["total-time"]&&(t+=" time="+BR.Gpx.formatTime(e["total-time"])),t+=" --\x3e"},formatTime:function(e){var t=Math.trunc(e/3600),r=Math.trunc((e-3600*t)/60),n="";return 0!=t&&(n+=t+"h "),0!=r&&(n+=r+"m "),0!=(e=e-3600*t-60*r)&&(n+=e+"s"),n}};
BR.Kml={format:function(e){return e.features[0].properties={name:e.features[0].properties.name},BR.Xml.pretty(tokml(e))}};
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){var t=_createClass(function t(e,r,n,o,i){"use strict";_classCallCheck(this,t),this.name=e,this.locus=r,this.orux=n,this.symbol=o,this.message=i}),n=function(){"use strict";_inherits(n,t);var r=_createSuper(n);function n(t,e){return _classCallCheck(this,n),r.call(this,t.name+e,t.locus+e,t.orux+e,t.symbol+e,t.message+e)}return _createClass(n)}(),i=function(){"use strict";_inherits(n,t);var r=_createSuper(n);function n(t,e){return _classCallCheck(this,n),r.call(this,t.name+-e,t.locus+-e,t.orux+e,t.symbol+-e,t.message+-e)}return _createClass(n)}(),o=function(){"use strict";function o(t,e,r){var n;_classCallCheck(this,o),this.geoJson=t,this.turnInstructionMode=e,this.transportMode=r,this.track=null===(t=t.features)||void 0===t?void 0:t[0],this.voicehints=null===(t=this.track)||void 0===t||null===(n=t.properties)||void 0===n?void 0:n.voicehints}return _createClass(o,[{key:"getGpxTransform",value:function(){var t={comment:"",trk:function(t,e,r){var n=this._getTrk();return Object.assign(n,t)}.bind(this)};return this._addToTransform(t),t}},{key:"_getDuration",value:function(t){var e=this.track.properties.times;if(!e)return 0;var r=e[this.voicehints[t][0]];return e[t<this.voicehints.length-1?this.voicehints[t+1][0]:e.length-1]-r}},{key:"_loopHints",value:function(t){if(this.voicehints){var e=_createForOfIteratorHelper(this.voicehints.entries());try{for(e.s();!(u=e.n()).done;){var r=_slicedToArray(u.value,2),n=r[0],o=r[1],i=_slicedToArray(o,6),s=i[0],a=i[1],u=i[2],r=i[3],i={indexInTrack:s,commandId:a,exitNumber:u,distance:r,angle:i[4],geometry:i[5]};i.time=this._getDuration(n),0<i.time&&(i.speed=r/i.time);s=this.track.geometry.coordinates[s],u=this.getCommand(a,u);u?t(i,u,s):console.error("no voicehint command for id: ".concat(a," (").concat(o,")"))}}catch(t){e.e(t)}finally{e.f()}}}},{key:"getCommand",value:function(t,e){var r=o.commands[t];return 13===t?r=new n(r,e):14===t&&(r=new i(r,e)),r}},{key:"_addToTransform",value:function(){}},{key:"_getTrk",value:function(){return{}}}]),o}();o.commands={1:new t("C",1,1002,"Straight","straight"),2:new t("TL",4,1e3,"Left","left"),3:new t("TSLL",3,1017,"TSLL","slight left"),4:new t("TSHL",5,1019,"TSHL","sharp left"),5:new t("TR",7,1001,"Right","right"),6:new t("TSLR",6,1016,"TSLR","slight right"),7:new t("TSHR",8,1018,"TSHR","sharp right"),8:new t("KL",9,1015,"TSLL","keep left"),9:new t("KR",10,1014,"TSLR","keep right"),10:new t("TU",13,1003,"TU","u-turn"),11:new t("TRU",14,1003,"TU","u-turn"),12:new t("OFFR"),13:new t("RNDB",26,1008,"RNDB","Take exit "),14:new t("RNLB",26,1008,"RNLB","Take exit ")};var r=function(){"use strict";_inherits(e,o);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return this._addWaypoints(t),t}.bind(this)}},{key:"_addWaypoints",value:function(t){var n=this,o=[];this._loopHints(function(t,e,r){e=n._getWpt(t,e,r),e=n._createWpt(r,e);o.push(e)}),(t=t.wpt).unshift.apply(t,o)}},{key:"_createWpt",value:function(t,e){return Object.assign({"@lat":t[1],"@lon":t[0]},e)}},{key:"_getWpt",value:function(){return{}}}]),e}(),s=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_getWpt",value:function(t,e){return{name:e.message,sym:e.symbol.toLowerCase(),type:e.symbol}}}]),e}(),a=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_getWpt",value:function(t,e,r){e={ele:r[2],extensions:{"om:oruxmapsextensions":{"@xmlns:om":"http://www.oruxmaps.com/oruxmapsextensions/1/0","om:ext":{"@type":"ICON","@subtype":0,_:e.orux}}}};return void 0!==e.ele&&null!==e.ele||delete e.ele,e}}]),e}(),u=function(){"use strict";_inherits(e,r);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return t=Object.assign({"@xmlns":t["@xmlns"],"@xmlns:xsi":t["@xmlns:xsi"],"@xmlns:locus":"http://www.locusmap.eu"},t),this._addWaypoints(t),t}.bind(this)}},{key:"_getWpt",value:function(t,e,r){var n={};n["locus:rteDistance"]=t.distance,0<t.time&&(n["locus:rteTime"]=t.time.toFixed(3),n["locus:rteSpeed"]=t.speed.toFixed(3)),n["locus:rtePointAction"]=e.locus;n={ele:r[2],name:e.message,extensions:n};return void 0!==n.ele&&null!==n.ele||delete n.ele,n}},{key:"_getTrk",value:function(){return{extensions:{"locus:rteComputeType":this._getLocusRouteType(this.transportMode),"locus:rteSimpleRoundabouts":1}}}},{key:"_getLocusRouteType",value:function(t){switch(t){case"car":return 0;case"bike":return 5;default:return 3}}}]),e}(),c=function(){"use strict";_inherits(e,o);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){var i="\n\x3c!-- $transport-mode$".concat(this.transportMode,"$ --\x3e\n\x3c!--          cmd    idx        lon        lat d2next  geometry --\x3e\n\x3c!-- $turn-instruction-start$");this._loopHints(function(t,e,r){function n(t,e){return e=1<arguments.length?e:void 0,new String(0<arguments.length&&void 0!==t?t:"").padStart(e)+";"}var o="";o+=n(e.name,6),o+=n(t.indexInTrack,6),o+=n(r[0],10),o+=n(r[1],10),o+=n(t.distance,6),o+=t.geometry,i+="\n     $turn$".concat(o,"$")}),i+="\n    $turn-instruction-end$ --\x3e\n",t.comment=i}}]),e}(),l=function(){"use strict";_inherits(e,o);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.apply(this,arguments)}return _createClass(e,[{key:"_addToTransform",value:function(t){t.gpx=function(t,e){return t["@creator"]="OsmAndRouter",t.rte.push({rtept:this._createRoutePoints(t)}),t}.bind(this)}},{key:"_createRoutePoints",value:function(t){var n=[],e=t.trk[0].trkseg[0],r={"@lat":(i=e.trkpt[0])["@lat"],"@lon":i["@lon"],desc:"start"},o=null===(t=this.track)||void 0===t||null===(o=t.properties)||void 0===o?void 0:o.times;this.voicehints&&o&&(o=o[this.voicehints[0][0]],r.extensions={time:Math.round(o),offset:0}),n.push(r),this._loopHints(function(t,e,r){e={"@lat":r[1],"@lon":r[0],desc:e.message,extensions:{time:Math.round(t.time),turn:e.name,"turn-angle":t.angle,offset:t.indexInTrack}};0===t.time&&delete properties.extensions.time,n.push(e)});var r=e.trkpt.length-1,i=e.trkpt[r];return n.push({"@lat":i["@lat"],"@lon":i["@lon"],desc:"destination",extensions:{time:0,offset:r}}),n}}]),e}();BR.voiceHints=function(t,e,r){switch(e){case 2:return new u(t,e,r);case 3:return new l(t,e,r);case 4:return new c(t,e,r);case 5:return new s(t,e,r);case 6:return new a(t,e,r);default:return console.error("unhandled turnInstructionMode: "+e),new o(t,e,r)}}}();
function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,a,o=[],i=!0,l=!1;try{for(t=t.call(r);!(i=(n=t.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(r){l=!0,a=r}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0,e=function(){};return{s:e,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){t=t.call(r)},n:function(){var r=t.next();return o=r.done,r},e:function(r){i=!0,a=r},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}BR.Xml={pretty:function(r,e){var n=" ".repeat(1<arguments.length&&void 0!==e?e:1),t="\n";r=(r=r.replace(/>\s*(\r\n|\n|\r)\s*</gm,"><").replace(/>\s+</g,"><")).replace("<metadata/>","");for(var a=/><(\/?)([\w!?][^ />]*)/g,o=["trkpt","wpt"],i=[],l=null,u=0;null!==(f=a.exec(r));){var c,f,y=f[2];l?l===y&&(l=null):(o.includes(y)&&(c=r.indexOf(">",f.index+1),"/"===r.charAt(c-1)||(l=y)),f=f.index+1,i.push(r.substring(u,f)),u=f)}i.push(r.substring(u));var s=/.+<\/\w[^>]*>$/,p=/^<\/\w/,d=/^<\w[^>]*[^\/]>.*$/,b=0,h=_createForOfIteratorHelper((i=i.map(function(r,e){var t=0;return r.match(s)?t=0:r.match(p)&&0<b?--b:t=r.match(d)?1:0,b+=t,n.repeat(b-t)+r})).entries());try{for(h.s();!(v=h.n()).done;){var m=_slicedToArray(v.value,2),v=m[0],m=m[1];if(m.includes("<gpx ")&&!m.includes(t)){i[v]=m.replace(/ (\w[^=" ]*=")/g," ".concat(t).concat(n,"$1"));break}}}catch(r){h.e(r)}finally{h.f()}return i.join(t)}};
BR.BingLayer=L.BingLayer.extend({options:{maxZoom:19,attribution:'<a target="_blank" href="https://www.bing.com/maps/">Bing Maps</a> (<a target="_blank" href="https://go.microsoft.com/?linkid=9710837">TOU</a>)'},initialize:function(o,i){L.BingLayer.prototype.initialize.call(this,o,i),this._logo=L.control({position:"bottomleft"}),this._logo.onAdd=function(o){return this._div=L.DomUtil.create("div","bing-logo"),this._div.innerHTML='<img src="https://www.microsoft.com/maps/images/branding/Bing%20logo%20white_50px-19px.png">',this._div}},onAdd:function(o){L.BingLayer.prototype.onAdd.call(this,o),o.addControl(this._logo)},onRemove:function(o){L.BingLayer.prototype.onRemove.call(this,o),o.removeControl(this._logo)}});
BR.CircleGoArea=L.Control.extend({radius:null,circleLayer:null,boundaryLayer:null,maskRenderer:L.svg({padding:2}),countries:null,countriesMask:null,states:null,statesLoading:!1,options:{countriesUrl:BR.conf.countriesUrl||"dist/boundaries/countries.topo.json",statesUrl:BR.conf.statesUrl||"dist/boundaries/germany-states.topo.json",overpassDataUrl:(BR.conf.overpassBaseUrl||"https://overpass-api.de/api/interpreter")+"?data=",shortcut:{draw:{enable:73,disable:27}}},initialize:function(t,e,o,i){this.routing=t,this.nogos=e,this.pois=o,L.setOptions(this,i)},onAdd:function(t){var e=this;return this.map=t,this.circleLayer=L.layerGroup([]).addTo(t),this.drawButton=L.easyButton({states:[{stateName:"activate-circlego",icon:"fa-circle-o",onClick:function(){e.draw(!0)},title:i18next.t("keyboard.generic-shortcut",{action:i18next.t("map.draw-circlego-start"),key:"I"})},{stateName:"deactivate-circlego",icon:"fa-circle-o active",onClick:function(){e.draw(!1)},title:i18next.t("keyboard.generic-shortcut",{action:i18next.t("map.draw-circlego-stop"),key:"$t(keyboard.escape)"})}]}),this.drawButton.disable(),this.once("countries:loaded",function(){this.drawButton.enable(),this.marker&&!this.marker.dragging.enabled()&&this.marker.dragging.enable()},this),this._loadCountries(),t.on("routing:draw-start",function(){e.draw(!1)}),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),new L.DomUtil.create("div")},draw:function(t){this.drawButton.state(t?"deactivate-circlego":"activate-circlego"),t?(this.routing.draw(!1),this.pois.draw(!1),this.map.on("click",this.onMapClick,this),this.countriesMask&&this.map.addLayer(this.countriesMask),this._unlockOutsideArea(),L.DomUtil.addClass(this.map.getContainer(),"circlego-draw-enabled")):(this.map.off("click",this.onMapClick,this),this.countriesMask&&this.map.hasLayer(this.countriesMask)&&this.map.removeLayer(this.countriesMask),this._lockOutsideArea(),L.DomUtil.removeClass(this.map.getContainer(),"circlego-draw-enabled"))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this.draw(!1):t.keyCode===this.options.shortcut.draw.enable&&this.draw(!0))},_getBoundary:function(o,i,t){i=i||8;var e="[out:json]; is_in("+o[1]+", "+o[0]+')->.a;(area.a[admin_level="'+i+'"];)->.p; relation(pivot.p); out geom;';t&&(e+='(area.a[admin_level="'+t+'"];)->.p; relation(pivot.p); out geom;');e=this.options.overpassDataUrl+encodeURIComponent(e);this.marker.setIcon(this.iconSpinner),BR.Util.getJson(e,'boundary for coordinate "'+o+'"',L.bind(function(t,e){if(!t){if(0===e.elements.length)return void(8===i||7===i?this._getBoundary(o,6):BR.message.showError('No boundary found for coordinate "'+o+'"'));e=osmtogeojson(e);this._setBoundary(e)}this.marker.setIcon(this.icon)},this))},_setBoundary:function(t){t.features=t.features.filter(function(t){return"Point"!==t.geometry.type});var e=turf.polygonToLine(t.features[0]);this.boundaryLayer=L.geoJson(e,{style:function(){return{weight:1,color:"black",opacity:.6,interactive:!1}}}).addTo(this.map);e=turf.buffer(t,this.radius,{units:"meters"}),t=turf.polygonToLine(e.features[0]);"FeatureCollection"!==t.type&&(t=turf.featureCollection([t]));e=turf.lineChunk(t,62,{units:"kilometers"});this._setNogo(e),this.setOutsideArea(t)},_getPolygonForPoint:function(t,e){for(var o=null,i=turf.point(t),n=e.features,s=0;s<n.length;s++){var r=n[s];if(turf.booleanPointInPolygon(i,r)){o=r;break}}return o},_getState:function(t){return this._getPolygonForPoint(t,this.states)},_getCountry:function(t){return this._getPolygonForPoint(t,this.countries)},_applyStateRules:function(t){var e,o=this._getState(t);o?(e=o.properties.all_tags.ref,-1!==["MV","NDS","SL","SN"].indexOf(e)?this._setNogoCircle(t):"ST"===e?this._getBoundary(t,7,8):"BB"===e?this._getBoundary(t,6):"HH"===e||-62422===o.properties.id?this._setBoundary(turf.featureCollection([o])):(console.error("unhandled state: "+e+", id: "+o.properties.id),this._getBoundary(t))):this._getBoundary(t)},_applyCountryRules:function(t){var e=this._getCountry(t);e?"Germany"===(e=e.properties.name)?(this.radius=15e3,this.states?this._applyStateRules(t):(this.marker.setIcon(this.iconSpinner),this.once("states:loaded",function(){this.marker.setIcon(this.icon),this.states&&this._applyStateRules(t)},this),this._loadStates())):"Metropolitan France"===e?(this.radius=1e4,this._setNogoCircle(t)):(console.error("unhandled country: "+e),this.radius=null):this.radius=null},_logStates:function(t){for(var e=0;e<t.features.length;e++){var o=t.features[e];console.log(o.properties.all_tags.ref+", "+o.properties.all_tags.name+", "+o.properties.id)}},_addGeoJsonLayer:function(t,e){setTimeout(L.bind(function(){L.geoJson(t,{style:function(){return L.extend({weight:1,color:"navy",opacity:.8,fill:!1,interactive:!1},e)}}).addTo(this.map)},this),100)},_loadStates:function(){this.statesLoading||(this.statesLoading=!0,BR.Util.getGeoJson(this.options.statesUrl,"states",L.bind(function(t,e){t||(this.states=e),this.statesLoading=!1,this.fire("states:loaded")},this)))},_loadCountries:function(){BR.Util.getJson(this.options.countriesUrl,"countries",L.bind(function(t,e){t||(t=Object.keys(e.objects)[0],this.countries=topojson.feature(e,e.objects[t]),t=topojson.merge(e,[e.objects[t]]),this.countriesMask=L.geoJson(t,{renderer:this.maskRenderer,invert:!0,style:function(){return{weight:1,color:"darkgreen",opacity:.8,fillColor:"#020",fillOpacity:.2,className:"circlego-outside"}}}),this.countriesMask.on("click",L.DomEvent.stop),this.countriesMask.bindTooltip(i18next.t("map.not-applicable-here"),{sticky:!0,offset:[10,0],direction:"right",opacity:.8}),this.fire("countries:loaded"))},this))},_setNogo:function(t){this.nogoPolylines=L.geoJson(t,BR.NogoAreas.prototype.polylineOptions),this.nogos.addNogos(null,this.nogoPolylines.getLayers(),null)},_removeNogo:function(){this.nogoPolylines&&(this.nogos.removeNogos(null,this.nogoPolylines.getLayers(),null),this.nogoPolylines=null)},_setNogoCircle:function(t){t=this.circleToPolygon(t,this.radius);this._setNogo(t),this.setOutsideArea(t)},setNogoRing:function(t){this._clearLayers(),this._removeNogo(),t&&(this.countries?this._applyCountryRules(t):(this.marker.setIcon(this.iconSpinner),this.once("countries:loaded",function(){this.marker.setIcon(this.icon),this._applyCountryRules(t)},this)))},_lockOutsideArea:function(){this.outsideArea&&(this.outsideArea.eachLayer(function(t){t._path.classList.add("circlego-outside")}),this.outsideArea.on("click",L.DomEvent.stop))},_unlockOutsideArea:function(){this.outsideArea&&(this.outsideArea.eachLayer(function(t){t._path.classList.remove("circlego-outside")}),this.outsideArea.off("click",L.DomEvent.stop))},setOutsideArea:function(t){t=turf.mask(turf.polygonize(t));this.outsideArea=L.geoJson(t,{renderer:this.maskRenderer,style:function(){return{weight:4,color:"black",opacity:.4,fillColor:"black",fillOpacity:.4}},smoothFactor:.5}).addTo(this.map),this._lockOutsideArea()},onMapClick:function(t){this.setCircle([t.latlng.lng,t.latlng.lat])},setOptions:function(t){this.radius=t.circlego[2],t.polylines&&(this.nogoPolylines=L.featureGroup(t.polylines,BR.NogoAreas.prototype.polylineOptions)),this.setCircle([t.circlego[0],t.circlego[1]],t.polylines)},setCircle:function(t,e){var o=this.marker=this._createMarker(t);if(this.clear(),o.addTo(this.circleLayer),this.countries||o.dragging.disable(),e){for(var i=[],n=0;n<e.length;n++)i.push(e[n].toGeoJSON());o=turf.featureCollection(i);this.setOutsideArea(o)}else this.setNogoRing(t);this.draw(!1)},_createMarker:function(t){var e=this,o=this.icon=L.VectorMarkers.icon({icon:"home",markerColor:BR.conf.markerColors.circlego});this.iconSpinner=L.VectorMarkers.icon({icon:"spinner",spin:!0,markerColor:BR.conf.markerColors.circlego});var i='<button id="remove-ringgo-marker" class="btn btn-secondary"><i class="fa fa-trash"></i></button>',n=L.marker([t[1],t[0]],{icon:o,draggable:!0,zIndexOffset:-500}).bindPopup(i).on("dragend",function(t){e.setNogoRing([t.target.getLatLng().lng,t.target.getLatLng().lat])}).on("click",function(){"deactivate-circlego"==e.drawButton.state()&&(e.circleLayer.removeLayer(n),e.setNogoRing(void 0))}).on("popupopen",function(t){this._onPopupOpen(t.popup,i)},this).on("popupclose",this._onPopupClose,this);return n},_onPopupOpen:function(t,e){var o,i="",n="<p>";this.radius?(this.boundaryLayer&&(i+=(o=this.boundaryLayer.getLayers()[0].feature.properties.name)+" + ",n+=BR.Util.sanitizeHTMLContent(o)+"<br />+ "),i+=(o=(this.radius/1e3).toFixed())+" km",n+=o+"&#8239;km",this.nogoPolylines&&(n+="</p><p>",n+='<a id="ringgo-download-gpx" href="javascript:;" download="radius.gpx">'+i18next.t("export.format_gpx")+"</a>",n+="<br />",n+='<a id="ringgo-download-geojson" href="javascript:;" download="radius.geojson">'+i18next.t("export.format_geojson")+"</a>")):n+=i18next.t("map.not-applicable-here"),n+="</p>",t.setContent(n+e),this.nogoPolylines&&(n=location.href.replace(/&polylines=[^&]*/,""),e=this.nogoPolylines.toGeoJSON(),n=togpx(e,{metadata:{name:i,link:n}}),this._setDownloadUrl(n,"application/gpx+xml","ringgo-download-gpx"),this._setDownloadUrl(JSON.stringify(e,null,2),"application/vnd.geo+json","ringgo-download-geojson")),$("#remove-ringgo-marker").on("click",L.bind(function(t){t.preventDefault(),this.circleLayer.removeLayer(this.marker),this.setNogoRing(void 0)},this))},_onPopupClose:function(){this._revokeDownloadUrl("ringgo-download-gpx"),this._revokeDownloadUrl("ringgo-download-geojson")},_setDownloadUrl:function(t,e,o){e=new Blob([t],{type:e+";charset=utf-8"}),e=URL.createObjectURL(e);document.getElementById(o).href=e},_revokeDownloadUrl:function(t){t=document.getElementById(t);t&&URL.revokeObjectURL(t.href)},_clearLayers:function(){this.outsideArea&&(this.map.removeLayer(this.outsideArea),this.outsideArea=null),this.boundaryLayer&&(this.map.removeLayer(this.boundaryLayer),this.boundaryLayer=null)},clear:function(){this.circleLayer.clearLayers(),this._clearLayers()},getButton:function(){return this.drawButton},getCircle:function(){var t=this.circleLayer.getLayers().map(function(t){return t.getLatLng()});return t&&t.length?[t[0].lng.toFixed(6),t[0].lat.toFixed(6),this.radius].join(","):null},toRadians:function(t){return t*Math.PI/180},toDegrees:function(t){return 180*t/Math.PI},offset:function(t,e,o){var i=this.toRadians(t[0]),n=this.toRadians(t[1]),t=e/6378137,e=Math.asin(Math.sin(n)*Math.cos(t)+Math.cos(n)*Math.sin(t)*Math.cos(o)),n=i+Math.atan2(Math.sin(o)*Math.sin(t)*Math.cos(n),Math.cos(t)-Math.sin(n)*Math.sin(e));return[this.toDegrees(n),this.toDegrees(e)]},circleToPolygon:function(t,e,o){for(var i=o||64,n=[],s=0;s<i;++s)n.push(this.offset(t,e,2*Math.PI*-s/i));return n.push(n[0]),{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n.slice(i/2)}},{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n.slice(0,i/2+1)}}]}}}),BR.CircleGoArea.include(L.Evented.prototype),BR.circleGoArea=function(t,e,o){return new BR.CircleGoArea(t,e,o)};
BR.Heightgraph=function(t,e,o,i){return Heightgraph=L.Control.Heightgraph.extend({options:{width:$("#map").outerWidth(),margins:{top:15,right:30,bottom:30,left:70},expandControls:!1,mappings:{gradient:{"-5":{text:"- 16%+",color:"#028306"},"-4":{text:"- 10-15%",color:"#2AA12E"},"-3":{text:"- 7-9%",color:"#53BF56"},"-2":{text:"- 4-6%",color:"#7BDD7E"},"-1":{text:"- 1-3%",color:"#A4FBA6"},0:{text:"0%",color:"#ffcc99"},1:{text:"1-3%",color:"#F29898"},2:{text:"4-6%",color:"#E07575"},3:{text:"7-9%",color:"#CF5352"},4:{text:"10-15%",color:"#BE312F"},5:{text:"16%+",color:"#AD0F0C"}}},shortcut:{toggle:69}},addBelow:function(t){var e;this.options.width=$("#content").outerWidth(),null!=this.getContainer()&&this.remove(t),this.addTo(t),e=this.getContainer(),document.getElementById("elevation-chart").appendChild(e),this._mouseMoveHandlerBound=this.mapMousemoveHandler.bind(this),this._mouseoutHandlerBound=this._mouseoutHandler.bind(this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),this.initCollapse(t);var o=this,i=$("#elevation-chart");$(window).resize(function(){i.is(":visible")&&o.resize({width:i.width(),height:i.height()})}),i.on("shown.bs.collapse",function(){o.resize({width:i.width(),height:i.height()})}),this.update()},initCollapse:function(t){var e=this;$("#elevation-chart").on("hidden.bs.collapse",function(){$("#elevation-btn").removeClass("active"),t._onResize(),this.id&&BR.Util.localStorageAvailable()&&!e.shouldRestoreChart&&localStorage.removeItem(this.id)}).on("shown.bs.collapse",function(){$("#elevation-btn").addClass("active"),this.id&&BR.Util.localStorageAvailable()&&(localStorage[this.id]="true")}).each(function(){this.id&&BR.Util.localStorageAvailable()&&"true"===localStorage[this.id]&&(e.shouldRestoreChart=!0)})},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggle&&$("#elevation-btn").click()},update:function(t,e){var o;this._mouseHeightFocus&&(o=this._mouseHeightFocus._groups[0][0].parentNode).parentNode.appendChild(o),t&&0<t.getLatLngs().length?(0==t.getLatLngs().filter(function(t){return void 0!==t.alt}).length?$("#no-elevation-data").show():$("#no-elevation-data").hide(),t=geoDataExchange.buildGeojsonFeatures(t.getLatLngs()),this.addData(t),e&&(e.on("mousemove",this._mouseMoveHandlerBound),e.on("mouseout",this._mouseoutHandlerBound)),!0===this.shouldRestoreChart&&$("#elevation-chart").collapse("show"),this.shouldRestoreChart=void 0):(this._removeMarkedSegmentsOnMap(),this._resetDrag(),this.addData([]),e&&(e.off("mousemove",this._mouseMoveHandlerBound),e.off("mouseout",this._mouseoutHandlerBound)),$("#elevation-chart").hasClass("show")&&(this.shouldRestoreChart=!0),$("#elevation-chart").collapse("hide"))}}),new Heightgraph};
BR.NogoAreas=L.Control.extend({options:{shortcut:{draw:{enable:78,disable:27},import:78}},statics:{MSG_BUTTON:"Draw no-go area (circle)",MSG_BUTTON_CANCEL:"Cancel drawing no-go area",MSG_CREATE:"Click and drag to draw circle",MSG_DISABLED:"Click to edit",MSG_ENABLED:'&square; = move / resize, <span class="fa fa-trash-o"></span> = delete,<br>click nogo to quit editing',STATE_CREATE:"no-go-create",STATE_CANCEL:"cancel-no-go-create"},style:{color:"#f06eaa",weight:4,opacity:.5,fillColor:null,fillOpacity:.2,dashArray:null},editStyle:{color:"#fe57a1",opacity:.6,dashArray:"10, 10",fillOpacity:.1},polylineOptions:{smoothFactor:.5},initialize:function(){this._wasRouteDrawing=!1},onAdd:function(t){var o=this;$("#submitNogos").on("click",L.bind(this.uploadNogos,this)),this.drawnItems=(new L.FeatureGroup).addTo(t),this.drawnItems.on("click",function(t){L.DomEvent.stop(t),t.layer.toggleEdit()});var i=this.editTools=t.editTools=new BR.Editable(t,{circleEditorClass:BR.DeletableCircleEditor,editLayer:(new L.FeatureGroup).addTo(t),featuresLayer:this.drawnItems});return this.startDrawing=function(t){var e=L.extend({radius:0},o.style);i.startCircle(null,e),t.state("cancel-no-go-create")},this.stopDrawing=function(t){i.stopDrawing(),t.state("no-go-create")},this.button=L.easyButton({states:[{stateName:BR.NogoAreas.STATE_CREATE,icon:"fa-ban",title:BR.NogoAreas.MSG_BUTTON,onClick:this.startDrawing},{stateName:BR.NogoAreas.STATE_CANCEL,icon:"fa-ban active",title:BR.NogoAreas.MSG_BUTTON_CANCEL,onClick:this.stopDrawing}]}),L.DomEvent.addListener(this.button.button,"pointerdown",L.DomEvent.stop),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomUtil.get("nogoFile").onchange=L.bind(this.onFileChanged,this),this.editTools.on("editable:drawing:end",function(t){o.button.state(BR.NogoAreas.STATE_CREATE),setTimeout(L.bind(function(){t.layer.disableEdit()},this),0)},this),this.editTools.on("editable:vertex:dragend editable:vertex:deleted editable:deleted",function(t){this._fireUpdate()},this),this.editTools.on("editable:enable",function(t){t.layer.setStyle(this.editStyle)},this),this.editTools.on("editable:disable",function(t){t.layer.setStyle(this.style)},this),this.tooltip=new BR.EditingTooltip(t,i,this.button),this.tooltip.enable(),L.DomUtil.create("div")},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(!0!==t.shiftKey||t.keyCode!==this.options.shortcut.import?t.keyCode===this.options.shortcut.draw.disable&&this.button.state()===BR.NogoAreas.STATE_CANCEL?this.stopDrawing(this.button):t.keyCode===this.options.shortcut.draw.enable&&this.button.state()===BR.NogoAreas.STATE_CREATE&&this.startDrawing(this.button):$("#loadNogos").modal("show"))},displayUploadError:function(t){$("#nogoError").text(t||""),$("#nogoError").css("display",t?"block":"none")},onFileChanged:function(t){t.target.files[0]&&$(t.target).next("label").text(t.target.files[0].name)},uploadNogos:function(){var t,n=this,e=$("#nogoJSON").val(),o=$("#nogoURL").val(),i=$("#nogoFile")[0].files[0];if(e)t=Promise.resolve(JSON.parse(e)),$("#nogoJSON").val(void 0);else if(o)t=fetch(o).then(function(t){return t.json()});else{if(!i)return n.displayUploadError(i18next.t("loadNogos.error.missing-file-url")),!1;t=new Promise(function(t,e){var o=new FileReader;o.onload=function(){t(o.result)},o.onerror=function(){n.displayUploadError(i18next.t("loadNogos.error.loading-file-error",{err:o.error.message}))},o.readAsText(i)}).then(function(t){return JSON.parse(t)})}var a=parseFloat($("#nogoWeight").val());if(isNaN(a))return n.displayUploadError(i18next.t("loadNogos.error.missing-default-nogo-weight")),!1;var s=parseFloat($("#nogoRadius").val());if(isNaN(s)||s<0)return n.displayUploadError(i18next.t("loadNogos.error.invalid-default-nogo-radius")),!1;var r=parseFloat($("#nogoBuffer").val());return isNaN(r)?n.displayUploadError(i18next.t("loadNogos.error.invalid-nogo-buffering-radius")):t.then(function(t){var e=[];if(turf.flattenEach(t,function(t){turf.getGeom(t)&&(t=t,0!==r&&(t=turf.buffer(t,r,{units:"meters"})),e.push(t))}),0===e.length)return n.displayUploadError(i18next.t("loadNogos.error.no-valid-area")),!1;var o=L.geoJson(turf.featureCollection(e),{onEachFeature:function(t,e){e.options.nogoWeight=t.properties.nogoWeight||a,"LineString"===t.geometry.type&&L.setOptions(e,n.polylineOptions)}}),i=o.getLayers().filter(function(t){return"Point"===t.feature.geometry.type});i=(i=i.map(function(t){var e=t.feature.properties.radius||s;return 0<e?L.circle(t.getLatLng(),{radius:e}):null})).filter(function(t){return t});try{n.setOptions({nogos:i,polygons:o.getLayers().filter(function(t){return"Polygon"===t.feature.geometry.type}),polylines:o.getLayers().filter(function(t){return"LineString"===t.feature.geometry.type})}),n._fireUpdate(),n.displayUploadError(void 0),$("#loadNogos").modal("hide")}catch(t){"NS_ERROR_MALFORMED_URI"===t.name?n.displayUploadError(i18next.t("loadNogos.error.loading-file-too-big")):n.displayUploadError(i18next.t("loadNogos.error.loading-file-unexpected")),n.fire("update",{options:{nogos:[],polygons:[],polylines:[]}}),n._clear()}}),!1},preventRoutePointOnCreate:function(e){this.editTools.on("editable:drawing:start",function(t){this._wasRouteDrawing=e.isDrawing(),e.draw(!1)},this),this.editTools.on("editable:drawing:end",function(t){this._wasRouteDrawing&&setTimeout(function(){e.draw(!0)},0)},this)},getOptions:function(){return{nogos:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Circle}),polygons:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Polygon}),polylines:this.drawnItems.getLayers().filter(function(t){return t instanceof L.Polyline&&!(t instanceof L.Polygon)})}},setOptions:function(t){var e=t.nogos,o=t.polylines,t=t.polygons;this._clear(),this._addNogos(e,o,t)},addNogos:function(t,e,o){this._addNogos(t,e,o),this._fireUpdate()},_addNogos:function(t,e,o){if(t)for(var i=0;i<t.length;i++)t[i].setStyle(this.style),this.drawnItems.addLayer(t[i]);if(e)for(i=0;i<e.length;i++)e[i].setStyle(this.style),this.drawnItems.addLayer(e[i]);if(o)for(i=0;i<o.length;i++)o[i].setStyle(this.style),this.drawnItems.addLayer(o[i])},removeNogos:function(t,e,o){if(t)for(var i=0;i<t.length;i++)this.drawnItems.removeLayer(t[i]);if(e)for(i=0;i<e.length;i++)this.drawnItems.removeLayer(e[i]);if(o)for(i=0;i<o.length;i++)this.drawnItems.removeLayer(o[i]);this._fireUpdate()},_clear:function(){this.drawnItems.clearLayers()},clear:function(){this._clear(),this._fireUpdate()},_fireUpdate:function(){this.fire("update",{options:this.getOptions()})},getFeatureGroup:function(){return this.drawnItems},getEditGroup:function(){return this.editTools.editLayer},getButton:function(){return this.button}}),BR.NogoAreas.include(L.Evented.prototype),BR.Editable=L.Editable.extend({initialize:function(t,e){L.Editable.prototype.initialize.call(this,t,e),this.map.tap||(this.map.addHandler("tap",L.Map.Tap),this.map.tap.disable())},registerForDrawing:function(t){this._tapEnabled=this.map.tap.enabled(),this._tapEnabled||this.map.tap.enable(),L.Editable.prototype.registerForDrawing.call(this,t)},unregisterForDrawing:function(t){this._tapEnabled||this.map.tap.disable(),L.Editable.prototype.unregisterForDrawing.call(this,t)},createVertexIcon:function(t){return new(BR.Browser.touch?L.Editable.TouchVertexIcon:L.Editable.VertexIcon)(t)}}),BR.EditingTooltip=L.Handler.extend({options:{closeTimeout:2e3},initialize:function(t,e,o){this.map=t,this.editTools=e,this.button=o},addHooks:function(){L.DomEvent.addListener(this.button.button,"click",this._addCreate,this),this.editTools.featuresLayer.on("layeradd",this._bind,this),this.editTools.on("editable:drawing:end",this._postCreate,this),this.editTools.on("editable:enable",this._enable,this),this.editTools.on("editable:disable",this._disable,this)},removeHooks:function(){L.DomEvent.removeListener(this.button.button,"click",this._addCreate,this),this.editTools.featuresLayer.off("layeradd",this._bind,this),this.editTools.off("editable:drawing:end",this._postCreate,this),this.editTools.off("editable:enable",this._enable,this),this.editTools.off("editable:disable",this._disable,this)},_bind:function(t){t=t.layer;t.bindTooltip(BR.NogoAreas.MSG_DISABLED,{direction:"bottom",className:"editing-tooltip"}),t.openTooltip=function(t,e){!e&&t instanceof L.Layer&&(e=L.latLng(t.getBounds().getSouth(),.5*(t.getBounds().getWest()+t.getBounds().getEast()))),L.Layer.prototype.openTooltip.call(this,t,e)}},_addCreate:function(t){var e,o,i;this.editTools.drawing()&&(i=this.map.mouseEventToLatLng(t),(e=L.tooltip({sticky:!0,direction:"right",offset:L.point(5,28),className:"editing-tooltip-create"}))._tooltip=e,o=function(t){t="tooltipclose"===t.type?"off":"on";this._map[t]("mousemove",this._moveTooltip,this)},this.map.on("tooltipopen",o,e),this.map.on("tooltipclose",o,e),t=function t(e){this.map.off("tooltipopen",o,e.tooltip),this.map.off("tooltipclose",o,e.tooltip),this.map.off("tooltipclose",t,this),e.tooltip._tooltip=null},this.map.on("tooltipclose",t,this),e.setTooltipContent(BR.NogoAreas.MSG_CREATE),this.map.openTooltip(e,i),i=function(){this.map.closeTooltip(e)},this.editTools.once("editable:editing editable:drawing:cancel",i,this),BR.Browser.touch&&setTimeout(L.bind(i,this),this.options.closeTimeout))},_setCloseTimeout:function(t){var e=setTimeout(function(){t.closeTooltip()},this.options.closeTimeout);t.once("tooltipopen",function(t){clearTimeout(e)})},_postCreate:function(){this.editTools.once("editable:disable",function(t){t.layer.openTooltip(t.layer),this._setCloseTimeout(t.layer)},this)},_enable:function(t){t.layer.setTooltipContent(BR.NogoAreas.MSG_ENABLED),this.editTools.once("editable:editing",function(t){t.layer.closeTooltip()},this)},_disable:function(t){t.layer.setTooltipContent(BR.NogoAreas.MSG_DISABLED),this._setCloseTimeout(t.layer)}}),BR.DeletableCircleEditor=L.Editable.CircleEditor.extend({_computeDeleteLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x-t,e.y-t])},_updateDeleteLatLng:function(){this._deleteLatLng.update(this._computeDeleteLatLng()),this._deleteLatLng.__vertex.update()},_addDeleteMarker:function(){if(this.enabled())return this._deleteLatLng=this._computeDeleteLatLng(),new BR.DeleteMarker(this._deleteLatLng,this)},_delete:function(){this.disable(),this.tools.featuresLayer.removeLayer(this.feature)},delete:function(){this._delete(),this.fireAndForward("editable:deleted")},initialize:function(t,e,o){L.Editable.CircleEditor.prototype.initialize.call(this,t,e,o),this._deleteLatLng=this._computeDeleteLatLng(),this.editLayer=new L.FeatureGroup},addHooks:function(){return L.Editable.CircleEditor.prototype.addHooks.call(this),this.feature&&this._addDeleteMarker(),this},reset:function(){L.Editable.CircleEditor.prototype.reset.call(this),this._addDeleteMarker()},onDrawingMouseDown:function(t){this._deleteLatLng.update(t.latlng),L.Editable.CircleEditor.prototype.onDrawingMouseDown.call(this,t)},onDrawingMouseUp:function(t){0<this.feature.getRadius()?this.commitDrawing(t):(this.cancelDrawing(t),this._delete()),t.originalEvent._simulated=!1,L.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onVertexMarkerDrag:function(t){this._updateDeleteLatLng(),L.Editable.CircleEditor.prototype.onVertexMarkerDrag.call(this,t)}}),BR.DeleteMarker=L.Marker.extend({options:{draggable:!1,icon:L.divIcon({iconSize:BR.Browser.touch?new L.Point(24,24):new L.Point(16,16),className:"leaflet-div-icon fa fa-trash-o nogo-delete-marker"})},initialize:function(t,e,o){this.latlng=t,this.editor=e,L.Marker.prototype.initialize.call(this,t,o),(this.latlng.__vertex=this).editor.editLayer.addLayer(this),this.setZIndexOffset(e.tools._lastZIndex)},onAdd:function(t){L.Marker.prototype.onAdd.call(this,t),this.on("click",this.onClick)},onRemove:function(t){delete this.latlng.__vertex,this.off("click",this.onClick),L.Marker.prototype.onRemove.call(this,t)},onClick:function(){this.editor.delete()}});
BR.PoiMarkers=L.Control.extend({markersLayer:null,circlego:null,options:{shortcut:{draw:{enable:80,disable:27}}},initialize:function(t){this.routing=t,this.circlego=null},onAdd:function(t){var e=this;return this.map=t,this.markersLayer=L.layerGroup([]).addTo(t),this.drawButton=L.easyButton({states:[{stateName:"activate-poi",icon:"fa-hand-o-right",onClick:function(){e.draw(!0)},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-poi-start)",key:"P"})},{stateName:"deactivate-poi",icon:"fa-hand-o-right active",onClick:function(){e.draw(!1)},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-poi-stop)",key:"$t(keyboard.escape)"})}]}).addTo(t),t.on("routing:draw-start",function(){e.draw(!1)}),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),new L.DomUtil.create("div")},draw:function(t){this.drawButton.state(t?"deactivate-poi":"activate-poi"),t?(this.routing.draw(!1),this.circlego&&this.circlego.draw(!1),this.map.on("click",this.onMapClick,this),L.DomUtil.addClass(this.map.getContainer(),"pois-draw-enabled")):(this.map.off("click",this.onMapClick,this),L.DomUtil.removeClass(this.map.getContainer(),"pois-draw-enabled"))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this.draw(!1):t.keyCode===this.options.shortcut.draw.enable&&this.draw(!0))},onMapClick:function(e){var a=this;bootbox.prompt({title:i18next.t("map.enter-poi-name"),required:!BR.Browser.download,callback:function(t){null!==t&&a.addMarker(e.latlng,t)}})},addMarker:function(t,e){var a=L.VectorMarkers.icon({icon:"star",markerColor:BR.conf.markerColors.poi}),o=BR.Util.sanitizeHTMLContent(e),i="<p>"+o+'</p><p><button id="remove-poi-marker" class="btn btn-secondary"><i class="fa fa-trash"></i></button></p>',r=this,n=L.marker(t,{icon:a,draggable:!0,name:e}).bindPopup(i).on("dragend",function(){r.fire("update")}).on("popupopen",function(){this.unbindTooltip(),$("#remove-poi-marker").on("click",function(t){r.markersLayer.removeLayer(n),t.preventDefault(),r.fire("update")})}).on("popupclose",function(){!1===BR.Browser.touch&&this.bindTooltip(o)}).addTo(this.markersLayer);!1===BR.Browser.touch&&n.bindTooltip(o)},clear:function(){this.markersLayer.clearLayers()},setMarkers:function(t){if(this.clear(),t)for(var e=0;e<t.length;e++){var a=t[e];this.addMarker(a.latlng,a.name)}},getMarkers:function(){return this.markersLayer.getLayers().map(function(t){return{latlng:t.getLatLng(),name:t.options.name}})}}),BR.PoiMarkers.include(L.Evented.prototype);
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}BR.routeLoader=function(i,e,s,a){RouteLoader=L.Control.extend({_layerName:"Tracklayer",_trackLayer:void 0,_bounds:void 0,_testLayer:L.layerGroup().addTo(i),_trackPoints:[],_maxTrackPoints:200,_closeCanceled:!0,_currentGeoJSON:{},_options:{format:void 0,showTrackLayer:!0,showPointAsPoi:!0,simplifyTolerance:-1,isTestMode:!1,simplifyLastKnownGood:.001,shortcut:{open:79}},setDialogDraggable:function(t){t.on("mousedown",function(t){var e=$(this),o=t.pageX-e.offset().left,i=t.pageY-e.offset().top;$("body").on("mousemove.draggable",function(t){e.closest(".modal-dialog").offset({left:t.pageX-o,top:t.pageY-i})}),$("body").one("mouseup",function(){$("body").off("mousemove.draggable")}),e.closest(".modal").one("bs.modal.hide",function(){$("body").off("mousemove.draggable")})})},getSimplifiedCoords:function(t){return turf.simplify(this._trackPoints.geometry,{tolerance:t,highQuality:!0}).coordinates},refreshTestLayer:function(){this.onBusyChanged(!0),this._testLayer.clearLayers();var t=L.GeoJSON.coordsToLatLngs(this.getSimplifiedCoords(this._options.simplifyTolerance));if(t.length>this._maxTrackPoints)return this.onBusyChanged(!1),!1;for(var e=0;e<t.length;e++)this._testLayer.addLayer(L.circleMarker(t[e],{radius:6,fill:!1,color:"#FF0000"}));return this.onBusyChanged(!1),!0},cleanup:function(){this._testLayer.clearLayers(),this._trackLayer&&i.hasLayer(this._trackLayer)&&(!this._options.showTrackLayer||this._closeCanceled)&&(i.removeLayer(this._trackLayer),e.removeLayer(this._trackLayer),this._trackLayer=void 0),this._bounds=void 0,this._trackPoints=[],this._currentGeoJSON={},this._options={showTrackLayer:!0,showPointAsPoi:!0,simplifyTolerance:-1,isTestMode:!1,simplifyLastKnownGood:.001,shortcut:{open:79}}},setSliderRange:function(){$slider=$("#simplify_tolerance"),$slider.prop("min",-500);var t=this.guessSimplifyTolerance(this._trackPoints),e=this.getSimplifiedCoords(t).length;e>this._maxTrackPoints&&(this._maxTrackPoints=e,$slider.prop("min",0)),$slider.data("lastknowngood",0),$slider.data("guess",t.toFixed(20)),$slider.val(0),this._options.simplifyTolerance=t,this.refreshTestLayer()},onToleranceSlider:function(t){var e=parseFloat($(t.target).data("guess")),o=parseFloat(t.target.value),i=parseFloat($(t.target).prop("max"));this._options.simplifyTolerance=e<o?e+Math.pow(o,2)*(e/(Math.pow(i,2)/10)):Math.abs(e+Math.pow(o,3)*(e/Math.pow(i,3))),this.refreshTestLayer()?(this._options.simplifyLastKnownGood=this._options.simplifyTolerance,$(t.target).data("lastknowngood",t.target.value)):(o=this.findLowestTolerance(parseInt(t.target.value),parseInt($(t.target).data("lastknowngood")),e,i),$(t.target).prop("min",o),$(t.target).data("lastknowngood",o),t.target.value=$(t.target).data("lastknowngood"),this._options.simplifyTolerance=this._options.simplifyLastKnownGood=Math.abs(e+Math.pow(o,3)*(e/Math.pow(i,3))),this.refreshTestLayer())},findLowestTolerance:function(t,e,o,i){if(Math.abs(e-t)<=2)return e;var s=Math.round((e+t)/2),a=Math.abs(o+Math.pow(s,3)*(o/Math.pow(i,3)));return this.getSimplifiedCoords(a).length>this._maxTrackPoints?this.findLowestTolerance(s,e,o,i):this.findLowestTolerance(t,s,o,i)},onBusyChanged:function(t){void 0===_typeof(t)&&(t=!1),!0===t?$("#loadedittrack #msg_busy").removeClass("invisible"):$("#loadedittrack #msg_busy").addClass("invisible")},onManualCollapse:function(t){$("#loadedittrack").is(":hidden")||(this._options.isTestMode=$(t.target).hasClass("show"),this._options.isTestMode?(this.once("file:loaded",this.setSliderRange,this),this.convertTrackLocal()):this.cleanup())},onAdd:function(){$("#loadedittrack").on("hidden.bs.modal",function(t){this.cleanup()}.bind(this)),$("#loadedittrack").on("show.bs.modal",function(t){$("#manual_collapse").collapse("hide"),this._closeCanceled=!0}.bind(this)),L.DomUtil.get("submitLoadEditTrack").onclick=L.bind(function(t){t.preventDefault(),this._closeCanceled=!1,this.onBusyChanged(!0),0<this._testLayer.getLayers().length?(this._testLayer.clearLayers(),setTimeout(function(){this.addRoutingPoints(),this.onBusyChanged(!1),$("#loadedittrack").modal("hide")}.bind(this),0)):setTimeout(function(){this.convertTrackLocal(),$("#loadedittrack").modal("hide")}.bind(this),0)},this),L.DomUtil.get("simplify_tolerance").oninput=L.bind(this.onToleranceSlider,this),L.DomUtil.get("loadedittrackFile").onchange=L.bind(this.onFileChanged,this),this.onFileChanged({target:L.DomUtil.get("loadedittrackFile")}),this.setDialogDraggable($("#loadedittrack .modal-header")),$("#manual_collapse").collapse("hide"),$("#manual_collapse").on("hidden.bs.collapse shown.bs.collapse",function(t){this.onManualCollapse(t)}.bind(this)),L.DomEvent.addListener(document,"keydown",this.keydownListener,this);var t=L.DomUtil.create("div");return t.hidden=!0,t},onRemove:function(){},onFileChanged:function(t){t.target.files[0]&&($(t.target).next("label").text(t.target.files[0].name),t=this._options.isTestMode,this.cleanup(),this._options.isTestMode=t,this._options.isTestMode&&(this.once("file:loaded",this.setSliderRange,this),this.convertTrackLocal()))},setLayerNameFromGeojson:function(t){if("Feature"==t.type&&t.properties&&t.properties.name)this._layerName=t.properties.name;else if("FeatureCollection"==t.type)for(var e=0;e<t.features.length;e++)if(t.features[e].properties&&t.features[e].properties.name)return void(this._layerName=t.features[e].properties.name)},getOptions:function(){this._options.showTrackLayer=$("#cb_showtracklayer")[0].checked,this._options.showPointAsPoi=$("#cb_showpois")[0].checked,this._options.simplifyTolerance=-1,this._bounds=void 0},convertTrackLocal:function(){var t,e;0!=$("#loadedittrackFile")[0].files.length&&(this.onBusyChanged(!0),this.getOptions(),t=$("#loadedittrackFile")[0].files[0],this._layerName=t.name.replace(/\.[^\.]*$/,""),this._options.format||(this._options.format=t.name.split(".").pop()),(e=new FileReader).onload=L.bind(this.processFile,this),e.readAsText(t))},addTrackOverlay:function(t){this._trackLayer=L.geoJSON(t,BR.Track.getGeoJsonOptions(e)).addTo(i),e.addOverlay(this._trackLayer,BR.Util.sanitizeHTMLContent(this._layerName)),this._bounds=this._trackLayer.getBounds(),this._bounds&&i.fitBounds(this._bounds)},getLineStringsFromGeoJSON:function(t){var o=[],t=turf.flatten(t);turf.featureEach(t,function(t,e){"LineString"==turf.getType(t)&&(t=turf.cleanCoords(t),t=turf.coordAll(t),o=o.concat(t))});t=turf.lineString(o);return t.length=o.length,t},guessSimplifyTolerance:function(t){t=t.length/1e6;return.8<t&&(t=.8),t},addRoutingPoints:function(){this._options.simplifyTolerance<0&&(this._options.simplifyTolerance=this.guessSimplifyTolerance(this._trackPoints));for(var t=[],e=L.GeoJSON.coordsToLatLngs(this.getSimplifiedCoords(this._options.simplifyTolerance)),o=0;o<e.length;o++)t.push(e[o]);0<t.length&&(s.setWaypoints(t,null,function(t){t&&(t=t.error,BR.message.showError(i18next.t("warning.tracks-load-error",{error:t&&t.message?t.message:t})))}),this._bounds||(this._bounds=L.latLngBounds(t))),this._bounds||i.fitBounds(this._bounds),this._options.showPointAsPoi&&BR.Track.addPoiMarkers(a,this._currentGeoJSON)},processFile:function(t){var e=t.target.result,o=null;switch(this._options.format){case"kml":case"gpx":var i=(new DOMParser).parseFromString(e,"text/xml"),o=toGeoJSON[this._options.format](i);break;default:o=JSON.parse(e)}this._currentGeoJSON=o,this.setLayerNameFromGeojson(o),this._trackPoints=this.getLineStringsFromGeoJSON(o);t=turf.length(this._trackPoints,{units:"kilometers"});this._maxTrackPoints=Math.min(t*Math.max(-.14*t+10,1),200),this.fire("file:loaded"),(this._options.showTrackLayer||this._options.isTestMode)&&this.addTrackOverlay(o),this._options.isTestMode||this.addRoutingPoints(),this.onBusyChanged(!1)},keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this._options.shortcut.open&&!0===t.shiftKey&&$("#navbarLoadEditTracks").click()}}),RouteLoader.include(L.Evented.prototype);var t=new RouteLoader;return t.addTo(i),t};
function _createForOfIteratorHelper(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,e=function(){};return{s:e,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _iterableToArrayLimit(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}L.Routing.Draw.prototype._hideTrailer=function(){0!==this._trailer.options.opacity&&this._trailer.setStyle({opacity:0})},BR.Routing=L.Routing.extend({statics:{hasBeeline:function(t){return 0<(null==t?void 0:t.filter(function(t){var e;return null==t||null===(e=t._routing)||void 0===e?void 0:e.beeline}).length)}},options:{position:"topright",icons:{start:L.VectorMarkers.icon({icon:"play",markerColor:BR.conf.markerColors.start}),normal:L.VectorMarkers.icon({icon:"circle",markerColor:BR.conf.markerColors.via}),end:L.VectorMarkers.icon({icon:"stop",markerColor:BR.conf.markerColors.stop}),draw:!1,opacity:1},snapping:null,zIndexOffset:-2e3,distanceMarkers:{iconSize:[6,18],offset:5e3,textFunction:function(t){return t/1e3}},shortcut:{draw:{enable:68,disable:27,beelineMode:66,beelineModifier:16,beelineModifierName:"shiftKey"},reverse:82,deleteLastPoint:90}},initialize:function(t,e){L.Routing.prototype.initialize.call(this,e),this.profile=t},onAdd:function(t){this.options.tooltips.waypoint=i18next.t("map.route-tooltip-waypoint"),this.options.tooltips.segment=i18next.t("map.route-tooltip-segment"),this._segmentsCasing=(new L.FeatureGroup).addTo(t),this._loadingTrailerGroup=(new L.FeatureGroup).addTo(t);var e=L.Routing.prototype.onAdd.call(this,t);this._segments.on("layeradd",this._addSegmentCasing,this),this._segments.on("layerremove",this._removeSegmentCasing,this),this._waypoints.on("layeradd",this._setMarkerOpacity,this),this._routingAll=!1,this.on("routing:rerouteAllSegmentsStart routing:setWaypointsStart",function(t){this._routingAll=!0}),this.on("routing:rerouteAllSegmentsEnd routing:setWaypointsEnd",function(t){this._routingAll=!1}),this.on("routing:routeWaypointStart routing:rerouteAllSegmentsStart routing:rerouteSegmentStart",function(t){this._routingAll&&"routing:rerouteAllSegmentsStart"!==t.type||this._removeDistanceMarkers()}),this.on("routing:routeWaypointEnd routing:setWaypointsEnd routing:rerouteAllSegmentsEnd routing:rerouteSegmentEnd",function(t){this._routingAll&&"routing:rerouteAllSegmentsEnd"!==t.type&&"routing:setWaypointsEnd"!==t.type||this._updateDistanceMarkers(t)}),this.on("waypoint:mouseover",function(t){this._dragging||(this._hideMouseMarker(),this._map.off("mousemove",this._segmentOnMousemove,this),this._suspended=!0)},this._edit),this.on("waypoint:mouseout",function(t){this._segmentOnMouseover(t),this._suspended=!1},this._edit),this._edit._mouseMarker.setIcon(L.divIcon({className:"line-mouse-marker",iconAnchor:[8,8],iconSize:[16,16]})),this._edit._mouseMarker.on("move",L.bind(function(t){var e=t.latlng;e._feature&&(this._mouseMarker._feature=e._feature,e._feature.fire("mousemove",t,!0))},this._edit));function n(t){this._mouseMarker._feature&&(this._mouseMarker._feature.fire("mouseout",t,!0),this._mouseMarker._feature=null)}function i(){this._hidden&&this._parent._waypoints._first&&this._show()}this._edit.on("segment:mouseout",n,this._edit),this._edit._mouseMarker.on("dragstart",n,this._edit),this.on("waypoint:mouseover",n,this._edit),this._draw.on("enabled",function(){L.DomUtil.addClass(t.getContainer(),"routing-draw-enabled"),this._marker._icon.style.pointerEvents="none",this._parent.off("waypoint:mouseout",this._catchWaypointEvent,this),this.on("waypoint:mouseout",function(t){this._parent._edit._suspended||this._catchWaypointEvent(t)},this)}),this._draw.on("disabled",function(){L.DomUtil.removeClass(t.getContainer(),"routing-draw-enabled")});var o=function(){!this._hidden&&this._parent._waypoints._first&&this._hide()}.bind(this._draw);function r(t){o(),L.DomEvent.stopPropagation(t)}return this._draw.on("enabled",function(){this._map.on("mouseout",o,this),this._map.on("mouseover",i,this),this._parent._segments.on("mouseover",L.DomEvent.stopPropagation,this),this._parent._segments.on("mouseout",L.DomEvent.stopPropagation,this),L.DomEvent.on(this._map._controlContainer,"mouseout",i,this),L.DomEvent.on(this._map._controlContainer,"mouseover",r,this)}),this._draw.on("disabled",function(){this._map.off("mouseout",o,this),this._map.off("mouseover",i,this),this._parent._segments.off("mouseover",L.DomEvent.stopPropagation,this),this._parent._segments.off("mouseout",L.DomEvent.stopPropagation,this),L.DomEvent.off(this._map._controlContainer,"mouseout",i,this),L.DomEvent.off(this._map._controlContainer,"mouseover",r,this)}),this.on("waypoint:click",function(){this._hidden&&!this._parent._waypoints._first&&(this._show(),this._hideTrailer())},this._draw),this._map.boxZoom.disable(),this._map.addHandler("boxZoom",BR.ClickTolerantBoxZoom),this._draw.on("enabled",function(){this._map.boxZoom.tolerant=!0}),this._draw.on("disabled",function(){this._map.boxZoom.tolerant=!1}),L.DomEvent.removeListener(this._container,"keydown",this._keydownListener,this),L.DomEvent.removeListener(this._container,"keyup",this._keyupListener,this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this),this.draw(!0),e},_addSegmentCasing:function(t){var e=Object.assign({},t.layer.options,this.options.styles.trackCasing),e=L.polyline(t.layer.getLatLngs(),Object.assign({},e,{interactive:!1}));this._segmentsCasing.addLayer(e),t.layer._casing=e,this._segments.bringToFront()},_removeSegmentCasing:function(t){this._segmentsCasing.removeLayer(t.layer._casing)},setOpacity:function(e){var t=1-Math.sqrt(1-e);this.options.styles.track.opacity=t,this.options.styles.trackCasing.opacity=t,this.options.icons.opacity=e,this._segments.setStyle({opacity:t}),this._segmentsCasing.setStyle({opacity:t}),this._waypoints.eachLayer(function(t){t.setOpacity(e)}),this._distanceMarkers&&this._distanceMarkers.setOpacity(e)},_setMarkerOpacity:function(t){t.layer.setOpacity(this.options.icons.opacity)},_removeMarkerEvents:function(t){t.off("mouseover",this._fireWaypointEvent,this),t.off("mouseout",this._fireWaypointEvent,this),t.off("dragstart",this._fireWaypointEvent,this),t.off("dragend",this._fireWaypointEvent,this),t.off("drag",this._fireWaypointEvent,this),t.off("click",this._fireWaypointEvent,this)},clear:function(){var t=this._draw._enabled,e=this._waypoints._first;if(this.draw(!1),null!==e){for(this._removeMarkerEvents(e);e._routing.nextMarker;){var n=e._routing.nextMarker;this._removeMarkerEvents(n),e=n}this._waypoints._first=null,this._waypoints._last=null,this._waypoints.clearLayers(),this._segments.clearLayers(),this._removeDistanceMarkers(),t&&this.draw(!0)}},setWaypoints:function(e,t,n){function i(t){r=r||t,++s>=e.length&&(a.fire("routing:setWaypointsEnd",{err:r}),n&&n(r))}var o,r,s=0,a=this;for(this.fire("routing:setWaypointsStart"),this._waypoints.remove(),this._waypoints._map=null,this._loadingTrailerGroup.remove(),this._loadingTrailerGroup._map=null,o=0;e&&o<e.length;o++){var l=t&&o<t.length?t[o]:null;this.addWaypoint(e[o],l,this._waypoints._last,null,i)}this._loadingTrailerGroup._map=this._map,this._loadingTrailerGroup.addTo(this._map),this._waypoints._map=this._map,this._waypoints.addTo(this._map)},toPolyline:function(){var i=[];return this._eachSegment(function(t,e,n){n&&n.feature&&(i=i.concat(n.getLatLngs()))}),L.polyline(i)},_routeSegment:function(t,e,n){var i;t&&null!==t._routing.nextLine&&t._routing.nextLine.setStyle({color:"dimgray"}),t&&e&&(i=new L.Polyline([t.getLatLng(),e.getLatLng()],{color:this.options.styles.track.color,opacity:this.options.styles.trailer.opacity,dashArray:[10,10],className:"loading-trailer"}),this._loadingTrailerGroup.addLayer(i)),L.Routing.prototype._routeSegment.call(this,t,e,L.bind(function(t,e){i&&this._loadingTrailerGroup.removeLayer(i),n(t,e)},this))},getSegments:function(){var i=[];return this._eachSegment(function(t,e,n){n&&n.feature&&i.push(n)}),i},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(t.keyCode===this.options.shortcut.draw.disable?this._draw.disable():t.keyCode===this.options.shortcut.draw.enable?this._draw.enable():t.keyCode===this.options.shortcut.reverse?this.reverse():t.keyCode===this.options.shortcut.deleteLastPoint?this.deleteLastPoint():t.keyCode===this.options.shortcut.draw.beelineMode?this.toggleBeelineDrawing():t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!0))},_keyupListener:function(t){t.keyCode===this.options.shortcut.draw.beelineModifier&&this._draw._setTrailerStyle(!1)},isDrawing:function(){return this._draw._enabled},reverse:function(){var t=this.getWaypoints(),e=this.getBeelineFlags();t.reverse(),e.reverse(),this.clear(),this.setWaypoints(t,e)},deleteLastPoint:function(){(lastPoint=this.getLast())&&this.removeWaypoint(lastPoint,function(t,e){})},_removeDistanceMarkers:function(){this._map&&this._distanceMarkers&&this._map.removeLayer(this._distanceMarkers)},_updateDistanceMarkers:function(){var t;this._removeDistanceMarkers(),this._map&&(t=this.options.distanceMarkers||{},this._distanceMarkers=new L.DistanceMarkers(this.toPolyline(),this._map,t),this._map.addLayer(this._distanceMarkers))},_distance:function(t,e){var n=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat([t.lng,t.lat]),2),i=n[0],t=n[1],n=_slicedToArray(btools.util.CheapRuler.toIntegerLngLat([e.lng,e.lat]),2),e=n[0],n=n[1];return btools.util.CheapRuler.calcDistance(i,t,e,n)},_computeKinematic:function(t,e,n){var i=new BR.RoutingContext(this.profile);i.expctxWay=new BR.BExpressionContextWay(void 0,n);n=new BR.StdPath;return n.computeKinematic(i,t,e,!0),n},_getCostFactor:function(t){var e,n;return t&&(t=(n=t.feature.properties)["track-length"],n=n.cost,t&&(e=n/t)),e},_interpolateBeelines:function(t,e,n){var i,o=null==e?void 0:e.getLatLngs()[e.getLatLngs().length-1].alt,r=null!==(i=null==n?void 0:n.getLatLngs()[0].alt)&&void 0!==i?i:o;null!==(i=o)&&void 0!==i||(o=r);var s=0;null!=o&&null!=r&&(s=r-o);var a=t.reduce(function(t,e){return t+e.feature.properties["track-length"]},0),e=this._getCostFactor(e),n=this._getCostFactor(n),l=null!=e&&null!=n?Math.max(e,n):null!=e?e:n,u=_createForOfIteratorHelper(t);try{for(u.s();!(_=u.n()).done;){var h=_.value.feature.properties,c=h["track-length"],d=s*c/a,_=this._computeKinematic(c,d,l);h["total-energy"]=_.getTotalEnergy(),h["total-time"]=_.getTotalTime(),0<d&&(h["filtered ascend"]=Math.trunc(d)),h["plain-ascend"]=Math.trunc(.5+d),h.cost=Math.round(c*(null!==l&&void 0!==l?l:0))}}catch(t){u.e(t)}finally{u.f()}},_updateBeelines:function(){L.Routing.prototype._updateBeelines.call(this);var o=[],r=null;this._eachSegment(function(t,e,n){var i;null!=n&&null!==(i=n._routing)&&void 0!==i&&i.beeline?o.push(n):(0<o.length&&this._interpolateBeelines(o,r,n),r=n,o=[])}),0<o.length&&this._interpolateBeelines(o,r,null)},createBeeline:function(t,e){var n=L.Routing.prototype.createBeeline.call(this,t,e);delete n.getLatLngs()[0].alt,delete n.getLatLngs()[1].alt;var i=this._distance(t,e),o={cost:0,"filtered ascend":0,"plain-ascend":0,"total-energy":0,"total-time":0,"track-length":i,messages:[["Longitude","Latitude","Elevation","Distance","CostPerKm","ElevCost","TurnCost","NodeCost","InitialCost","WayTags","NodeTags","Time","Energy"],[1e6*e.lng,1e6*e.lat,null,i,null,null,null,null,null,"","",null,null]]};n.feature=turf.lineString([[t.lng,t.lat],[e.lng,e.lat]],o);var r=_createForOfIteratorHelper(n.getLatLngs());try{for(r.s();!(a=r.n()).done;){var s=a.value,a=o.messages[1];s.feature=BR.TrackEdges.getFeature(a),s.message=a}}catch(t){r.e(t)}finally{r.f()}return n}});
BR.RoutingPathQuality=L.Control.extend({options:{shortcut:{toggle:67,muteKeyCode:77}},initialize:function(t,e,i){L.setOptions(this,i),t.createPane("routingQualityPane"),t.getPane("routingQualityPane").style.zIndex=450,t.getPane("routingQualityPane").style.pointerEvents="none";t=new L.Hotline.Renderer({pane:"routingQualityPane"});this._routingSegments=L.featureGroup(),this._routingSegments.id="route-quality",e.addOverlay(this._routingSegments,i18next.t("map.layer.route-quality")),this.providers={incline:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-incline)",key:"C"}),icon:"fa-line-chart",provider:new HotLineQualityProvider({hotlineOptions:{min:-8.5,max:8.5,palette:{0:"#0000ff",.25:"#00ffff",.5:"#00ff00",.75:"#ffff00",1:"#ff0000"},outlineColor:"dimgray",renderer:t},valueFunction:function(t,e){var i=t.alt-e.alt,t=e.distanceTo(t);return 0===t?0:180*Math.atan(i/t)/Math.PI}})},altitude:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-altitude)",key:"C"}),icon:"fa-area-chart",provider:new HotLineQualityProvider({hotlineOptions:{outlineColor:"dimgray",renderer:t},valueFunction:function(t){return t.alt}})},cost:{title:i18next.t("map.route-quality-shortcut",{action:"$t(map.route-quality-cost)",key:"C"}),icon:"fa-usd",provider:new HotLineQualityProvider({hotlineOptions:{outlineColor:"dimgray",renderer:t},valueFunction:function(t){var e=t.feature,i=e.cost.perKm,t=e.distance/1e3;return 0<t&&(i+=(e.cost.elev+e.cost.turn+e.cost.node+e.cost.initial)/t),i}})}},this._initialProvider=this.options.initialProvider||"incline",this.selectedProvider=this._initialProvider,this._active=!1,this._muted=!1},onAdd:function(t){(this._map=t).on("overlayadd",function(t){t.layer===this._routingSegments&&this._activate(this.routingPathButton)},this),t.on("overlayremove",function(t){t.layer===this._routingSegments&&this._deactivate(this.routingPathButton)},this);for(var e=[],i=Object.keys(this.providers),n=i.length,o=0;o<n;++o){var a=this.providers[i[o]],r=i[(o+1)%n];e.push({stateName:i[o],icon:a.icon,title:a.title,onClick:L.bind(function(e){return L.bind(function(t){this._active?(t.state(e),this.setProvider(e),e===this._initialProvider?this._deactivate(t):this._getIcon(t).classList.add("active")):this._activate(t)},this)},this)(r)})}return(this.options.shortcut.muteKeyCode||this.options.shortcut.toggle)&&(L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this)),this.routingPathButton=new L.easyButton({states:e}).addTo(t),new L.DomUtil.create("div")},_activate:function(t){this._active=!0,this._getIcon(t).classList.add("active"),this._routingSegments.addTo(this._map)},_deactivate:function(t){this._active=!1,this._getIcon(t).classList.remove("active"),this._map.removeLayer(this._routingSegments)},_getIcon:function(t){return t.button.firstChild.firstChild},update:function(t,e){var i=[];e.eachLayer(function(t){i.push(t)}),this.segments=i,this._update(this.segments)},setProvider:function(t){this.selectedProvider=t,this._update(this.segments)},_update:function(t){this._routingSegments.clearLayers();var e=this.providers[this.selectedProvider].provider.computeLayers(t);if(e)for(var i=0;i<e.length;i++)this._routingSegments.addLayer(e[i])},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&(this._active&&t.keyCode===this.options.shortcut.muteKeyCode&&(this._muted=!0,this._deactivate(this.routingPathButton)),this._muted||t.keyCode!==this.options.shortcut.toggle||this.routingPathButton.button.click())},_keyupListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&this._muted&&t.keyCode===this.options.shortcut.muteKeyCode&&(this._muted=!1,this._activate(this.routingPathButton))}});var HotLineQualityProvider=L.Class.extend({initialize:function(t){this.hotlineOptions=t.hotlineOptions,this.valueFunction=t.valueFunction},computeLayers:function(t){var e=[];if(t){for(var i=[],n=[],o=0;t&&o<t.length;o++){var a,r=t[o];null!==(a=r._routing)&&void 0!==a&&a.beeline||(r=this._computeLatLngVals(r),i.push(r),Array.prototype.push.apply(n,r))}if(0<n.length){var s,u=L.extend({},this.hotlineOptions);u.min||u.max||(s=this._calcMinMaxValues(n),u.min=s.min,u.max=s.max);for(o=0;o<i.length;o++){var h=i[o],h=L.hotline(h,u);e.push(h)}}}return e},_computeLatLngVals:function(t){for(var e=[],i=t.getLatLngs(),n=i.length,o=0;o<n;o++){var a=this.valueFunction.call(this,i[o],i[Math.max(o-1,0)],o,i);e.push(this._convertToArray(i[o],a))}return e},_convertToArray:function(t,e){return[t.lat,t.lng,e]},_calcMinMaxValues:function(t){for(var e=o=t[0][2],i=1;t&&i<t.length;i++)var n=t[i],e=Math.max(e,n[2]),o=Math.min(o,n[2]);return o===e&&(e=o+1),{min:o,max:e}}});
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,a=new Array(e);o<e;o++)a[o]=t[o];return a}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var a=_superPropBase(t,e);if(a){a=Object.getOwnPropertyDescriptor(a,e);return a.get?a.get.call(arguments.length<3?t:o):a.value}}).apply(this,arguments)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(o){var a=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(o);return _possibleConstructorReturn(this,a?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}BR.Search=function(){"use strict";_inherits(o,L.Control.Geocoder);var e=_createSuper(o);function o(t){return _classCallCheck(this,o),t=e.call(this,Object.assign({geocoder:new L.Control.Geocoder.LatLng({next:new L.Control.Geocoder.Nominatim({serviceUrl:"https://nominatim.openstreetmap.org/"}),sizeInMeters:800}),position:"topleft",expand:"click",shortcut:{search:70},placeholder:i18next.t("map.geocoder-placeholder")},t)),L.DomEvent.addListener(document,"keydown",t._keydownListener,_assertThisInitialized(t)),t}return _createClass(o,[{key:"markGeocode",value:function(t){return this._map.fitBounds(t.geocode.bbox,{maxZoom:17}),this.clear(),this._geocodeMarker=new L.CircleMarker(t.geocode.center,{interactive:!1,color:"red",opacity:1,weight:3}).addTo(this._map),this}},{key:"clear",value:function(){this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker)}},{key:"_keydownListener",value:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.search&&($("#map .leaflet-control-geocoder")[0].dispatchEvent(new MouseEvent("click")),t.preventDefault())}},{key:"onAdd",value:function(t){if(!BR.Util.localStorageAvailable())return _get(_getPrototypeOf(o.prototype),"onAdd",this).call(this,t);t=_get(_getPrototypeOf(o.prototype),"onAdd",this).call(this,t);return new SearchFavorites(this,t),t}}]),o}();var SearchFavorites=function(){"use strict";function a(t,e){var o=this;_classCallCheck(this,a),this.searchInput=void 0,this.autocompleteContainer=void 0,this.autocompleteSelect=void 0,this.autocompleteMenu=void 0,this.geocoderForm=void 0,this.geocoder=void 0,this.favElements=void 0,this.isFiltered=!0,this.arFavitems=[],this.arFavitemsLC=[],this.geocoder=t,this.searchInput=$(e).find(".leaflet-control-geocoder-form input[type=text]"),this.searchInput.after('<span class="search-fav-ctrls btn-group btn-group-sm">\n\t\t\t\t<button \tid="search-fav-add"  \n\t\t\t\t\ttitle="'.concat(i18next.t("searchfav.addfavorite"),'" \n\t\t\t\t\tclass="fa fa-star-o  border-0">\n\t\t\t\t</button><button \tdata-toggle="collapse" \n\t\t\t\t\thref="#search-autocomplete-container"  \n\t\t\t\t\tid="search-fav-expand" \n\t\t\t\t\ttitle="').concat(i18next.t("searchfav.openfavorites"),'"  \n\t\t\t\t\tclass="fa fa-angle-double-down  border-0">\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t')),$(e).find(".leaflet-control-geocoder-form .search-fav-ctrls").on("mousedown",function(t){t.stopPropagation(),t.preventDefault()}),$(e).find(".leaflet-control-geocoder-form .search-fav-ctrls").click(function(t){return o.onCtrlsClick(t)}),$(e).find(".leaflet-control-geocoder-form").append('\n\t\t\t<div class="collapse autocomplete-container filtered" id="search-autocomplete-container">\n\t\t\t\t<div class="autocomplete-select-container">\n\t\t\t\t\t<div class="list-group autocomplete-select" id="search-autocomplete-select" ></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="autocomplete-menu  bg-light rounded-bottom">\n\t\t\t\t\t<div id="search-fav-menu-toggle" class="" data-toggle="collapse" href="#autocomplete-btngroup">\n\t\t\t\t\t <span class="bt-more align-top">...</span>\n\t\t\t\t\t</div>\n\t\t\t\t  <div class="btn-group btn-group-sm collapse" id="autocomplete-btngroup">\n\t\t\t\t\t\t<button id="search-fav-deleteall"  \n\t\t\t\t\t\t\ttitle="'.concat(i18next.t("searchfav.removeall"),'"  \n\t\t\t\t\t\t\tclass="fa fa-eraser  border">\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button id="search-fav-export"  \n\t\t\t\t\t\t\ttitle="').concat(i18next.t("searchfav.export"),'"  \n\t\t\t\t\t\t\tclass="fa fa-floppy-o  border">\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button id="search-fav-import"\n\t\t\t\t\t\t\tclass="fa fa-folder-open-o  border"\n\t\t\t\t\t\t\ttitle="').concat(i18next.t("searchfav.import"),'" >\n\t\t\t\t\t\t\t\t<input id="search-fav-file" type="file" class="d-none" accept=".json">\n\t\t\t\t\t\t</button>\n\t\t\t\t  </div>\n\t\t\t\t</div>\t\t\t\t\n\t\t')),this.autocompleteContainer=$(e).find("#search-autocomplete-container"),this.autocompleteSelect=this.autocompleteContainer.find("#search-autocomplete-select"),this.autocompleteMenu=this.autocompleteContainer.find("#autocomplete-btngroup"),this.geocoderForm=$(e).find(".leaflet-control-geocoder-form"),this.autocompleteContainer.on("mousedown",function(t){t.stopPropagation(),t.preventDefault()}),this.autocompleteContainer.find("#search-fav-menu-toggle").on("mousedown touchend",function(t){t.stopPropagation(),t.preventDefault()}),this.autocompleteContainer.find("#search-fav-menu-toggle").on("click touchend",function(t){t.stopPropagation(),t.preventDefault(),o.autocompleteMenu.collapse("toggle")}),this.autocompleteContainer.find(".autocomplete-select-container").on("wheel",function(t){t.stopPropagation()}),this.autocompleteContainer.on("shown.bs.collapse",function(t){return o.geocoderForm.addClass("stayvisible")}),this.autocompleteContainer.on("hidden.bs.collapse",function(t){o.geocoderForm.removeClass("stayvisible"),o.autocompleteMenu.collapse("hide")}),this.autocompleteSelect.click(function(t){return o.onFavItemClicked(t)}),this.autocompleteContainer.find(".autocomplete-menu").click(function(t){return o.onFavMenuClicked(t)}),this.autocompleteContainer.find("#search-fav-file").on("change",function(t){return o.onImportFavFile(t)});e=localStorage.searchFavItems;e&&(this.arFavitems=JSON.parse(e),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()})),this.updateFavList(),this.searchInput.on("keyup",function(t){return o.onInput(t)})}return _createClass(a,[{key:"updateFavList",value:function(){var t;0<this.arFavitems.length?(t=this.arFavitems.join('</button><button class="list-group-item list-group-item-action rounded-0 favitem"><span class="fa fa-trash-o mr-1 del-favitem"></span>'),this.autocompleteSelect.html('<button class="list-group-item list-group-item-action rounded-0 favitem"><span class="fa fa-trash-o mr-1 del-favitem"></span>'.concat(t,"</button>"))):this.autocompleteSelect.empty(),this.favElements=this.autocompleteSelect.find("button")}},{key:"appendFavorite",value:function(t){""!==t&&(this.arFavitems.push(t),this.arFavitems=_toConsumableArray(new Set(this.arFavitems)),this.arFavitems.sort(),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList())}},{key:"deleteFavorite",value:function(t){t=this.arFavitems.indexOf(t);0<=t&&(this.arFavitems.splice(t,1),this.arFavitems=_toConsumableArray(new Set(this.arFavitems)),this.arFavitems.sort(),this.arFavitemsLC=this.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList())}},{key:"onInput",value:function(t){var o,a,r=this;13!=t.keyCode?t.keyCode<=45&&8!=t.keyCode||(!(o=this.searchInput.val().toLowerCase())||o.length<2?this.autocompleteContainer.collapse("hide"):(this.isFiltered||(this.autocompleteContainer.addClass("filtered"),this.isFiltered=!0),a=!1,this.favElements.removeClass("match"),this.arFavitemsLC.forEach(function(t,e){-1!=t.indexOf(o)&&(r.favElements.eq(e).addClass("match"),a=!0)}),a?this.autocompleteContainer.collapse("show"):this.autocompleteContainer.collapse("hide"))):this.autocompleteContainer.collapse("hide")}},{key:"onCtrlsClick",value:function(t){switch(t.stopPropagation(),t.preventDefault(),t.target.id){case"search-fav-add":this.appendFavorite(this.searchInput.val());break;case"search-fav-expand":this.autocompleteContainer.hasClass("show")?this.isFiltered?(this.autocompleteContainer.removeClass("filtered"),this.isFiltered=!1):(this.autocompleteContainer.collapse("hide"),this.autocompleteContainer.addClass("filtered"),this.isFiltered=!0):(this.autocompleteContainer.removeClass("filtered"),this.isFiltered=!1,this.autocompleteContainer.collapse("show"))}}},{key:"onFavItemClicked",value:function(t){t.stopPropagation(),t.preventDefault(),$(t.target).hasClass("favitem")?(this.autocompleteContainer.collapse("hide"),this.geocoder.setQuery(t.target.innerText),this.searchInput.focus(),this.geocoder._keydown({keyCode:13})):$(t.target).hasClass("del-favitem")&&this.deleteFavorite($(t.target).closest("button").text())}},{key:"onFavMenuClicked",value:function(t){switch(t.target.id){case"search-fav-deleteall":confirm(i18next.t("searchfav.ask_removeall"))&&(this.arFavitems=[],this.arFavitemsLC=[],localStorage.searchFavItems=JSON.stringify(this.arFavitems),this.updateFavList());break;case"search-fav-export":var e=JSON.stringify(this.arFavitems,null,2),o=new Blob([e],{type:"application/json;charset=utf-8"}),e=URL.createObjectURL(o),o=document.createElement("a");o.href=e,o.download="SearchFavorites.json",o.click();break;case"search-fav-import":$(t.target).find("input[type=file]").click(),t.preventDefault()}}},{key:"onImportFavFile",value:function(t){var e,o=this;t.target.files[0]&&((e=new FileReader).onload=function(t){t=JSON.parse(t.target.result);o.arFavitems=o.arFavitems.concat(t),o.arFavitems=_toConsumableArray(new Set(o.arFavitems)),o.arFavitems.sort(),o.arFavitemsLC=o.arFavitems.map(function(t){return t.toLowerCase()}),localStorage.searchFavItems=JSON.stringify(o.arFavitems),o.updateFavList()},e.readAsText(t.target.files[0]),t.target.value="")}}]),a}();
BR.Sidebar=L.Control.Sidebar.extend({storageId:"sidebar-control",options:{position:"right",container:"sidebar",tabContainer:"sidebarTabs",autopan:!1,defaultTabId:"",shortcut:{toggleTabs:84},listeningTabs:{}},initialize:function(t,i){L.Control.Sidebar.prototype.initialize.call(this,t,i),this.oldTab=null,L.DomEvent.addListener(document,"keydown",this._keydownListener,this)},addTo:function(t){return L.Control.Sidebar.prototype.addTo.call(this,t),this.on("content",this._notifyOnContent,this),this.on("closing",this._notifyOnClose,this),this.on("toggleExpand",this._notifyOnResize,this),this.on("closing",function(){this._map.getContainer().focus()},this),this.recentTab=this.options.defaultTabId,this.on("content",function(t){this.recentTab=t.id},this),this._rememberTabState(),L.Browser.touch&&BR.Browser.touchScreenDetectable&&!BR.Browser.touchScreen&&(L.DomUtil.removeClass(this._container,"leaflet-touch"),L.DomUtil.removeClass(this._tabContainer,"leaflet-touch")),this},showPanel:function(t){return this._getTab(t).hidden=!1,this},_rememberTabState:function(){var t;BR.Util.localStorageAvailable()&&(this.on("content closing",this._storeActiveTab,this),"true"===(t=localStorage.getItem(this.storageId))?t=this.options.defaultTabId:null===t&&(t=""),""!==t&&this._getTab(t)&&this.open(t))},_notifyShow:function(t){t&&t.show&&t.show()},_notifyHide:function(t){t&&t.hide&&t.hide()},_notifyOnContent:function(t){t=this.options.listeningTabs[t.id];this._notifyHide(this.oldTab),this._notifyShow(t),this.oldTab=t},_notifyOnClose:function(){this._notifyHide(this.oldTab),this.oldTab=null},_notifyOnResize:function(){var t=this.oldTab;t&&t.onResize&&t.onResize()},_storeActiveTab:function(t){localStorage.setItem(this.storageId,t.id||"")},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggleTabs&&($("#sidebarTabs > ul > li[class=active]").length?t.shiftKey||this.close():this.open(this.recentTab),t.shiftKey&&((t=$("#sidebarTabs > ul > li[class=active] ~ li:not([hidden]) > a")).length||(t=$("#sidebarTabs > ul > li:not([hidden]) > a")),this.open(t.attr("href").slice(1))))}}),BR.sidebar=function(t,i){return new BR.Sidebar(t,i)};
BR.tracksLoader=function(t,a,e,n){TracksLoader=L.Control.FileLayerLoad.extend({options:{layer:function(e,o){return BR.Track.addPoiMarkers(n,e),L.geoJSON(e,o)},layerOptions:BR.Track.getGeoJsonOptions(a),addToMap:!1,fileSizeLimit:BR.conf.trackSizeLimit||10240,shortcut:{open:79}},_initContainer:function(){var o,e=this.loader,t=L.DomUtil.get("navbarLoadTracksContainer");L.DomEvent.addListener(document,"keydown",this._keydownListener,this),(o=L.DomUtil.create("input","hidden",t)).type="file",o.multiple="multiple",this.options.formats?o.accept=this.options.formats.join(","):o.accept=".gpx,.kml,.json,.geojson",o.style.display="none",o.addEventListener("change",function(){e.loadMultiple(this.files),this.value=""},!1);t=L.DomUtil.get("navbarLoadTracks");L.DomEvent.disableClickPropagation(t),L.DomEvent.on(t,"click",function(e){o.click(),e.preventDefault()});t=L.DomUtil.create("div");return t.hidden=!0,t},_keydownListener:function(e){BR.Util.keyboardShortcutsAllowed(e)&&e.keyCode===this.options.shortcut.open&&!1===e.shiftKey&&$("#navbarLoadTracks")[0].click()}}),t.createPane("tracks"),t.getPane("tracks").style.zIndex=350;var o=new TracksLoader;return o.addTo(t),o.loader.on("data:loaded",function(e){var o=e.layer;a.addOverlay(o,e.filename),o.addTo(t)}),o.loader.on("data:error",function(e){e=e.error;BR.message.showError(i18next.t("warning.tracks-load-error",{error:e&&e.message?e.message:e})),console.error(e)}),o};
L.DistanceMarkers=L.LayerGroup.extend({initialize:function(e,i,t){var o=(t=t||{}).offset||1e3,r=Math.min(i.getMaxZoom(),t.showAll||12),n=t.cssClass||"dist-marker",a=void 0!==t.iconSize?t.iconSize:[12,12],s=t.textFunction||function(e,t){return t},l={},m=e;"function"==typeof e.getLatLngs&&(m=e.getLatLngs());for(var c=L.GeometryUtil.accumulatedLengths(e),e=0<c.length?c[c.length-1]:0,f=0,h=Math.floor(e/o),v=1;v<=h;++v){for(var y=o*v;f<c.length-1&&c[f]<y;)++f;var u=s.call(this,y,v,o),d=m[f-1],g=m[f],d=L.polyline([d,g]),g=(y-c[f-1])/(c[f]-c[f-1]),d=L.GeometryUtil.interpolateOnLine(i,d,g),g=[a[0]+a[0]*(""+u).length,a[1]],g=L.divIcon({className:n,html:u,iconSize:g}),u=L.marker(d.latLng,{title:u,icon:g,interactive:!1}),g=this._minimumZoomLevelForItem(v,r);void 0===l[g]&&(l[g]=L.layerGroup()),l[g].addLayer(u)}var z=0,p=this,e=function(){var e=z,t=z=i.getZoom();if(e<t)for(var o=e+1;o<=t;++o)void 0!==l[o]&&p.addLayer(l[o]);else if(t<e)for(o=e;t<o;--o)void 0!==l[o]&&p.removeLayer(l[o])};i.on("zoomend",e),this._zoomLayers=l,this._layers={},e()},setOpacity:function(t){for(var e=Object.keys(this._zoomLayers),o=e.length,i=0;i<o;++i)this._zoomLayers[e[i]].eachLayer(function(e){e.setOpacity(t)})},_minimumZoomLevelForItem:function(e,t){for(var o=t,i=e;0<i&&i%2==0;)--o,i=Math.floor(i/2);return o}});
!function(t){var a,n=(a=t.documentMode,"onhashchange"in t&&(void 0===a||7<a));L.Hash=function(t,a){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t,a)},L.Hash.parseHash=function(t){0===t.indexOf("#map=")&&(t=t.substr(5));var a=t.split(/\&(.+)/),n=a[0].split("/");if(4!=n.length)return!1;var e=parseInt(n[0],10),i=parseFloat(n[1]),t=parseFloat(n[2]),n=this.parseLayers(n[3]),a=a[1];return!(isNaN(e)||isNaN(i)||isNaN(t))&&{center:new L.LatLng(i,t),zoom:e,layers:n,additional:a}},L.Hash.formatHash=function(t){var a=t.getCenter(),n=t.getZoom(),e=Math.max(0,Math.ceil(Math.log(n)/Math.LN2)),t=this.formatLayers(),t=[n,a.lat.toFixed(e),a.lng.toFixed(e),t];if(url="#map="+t.join("/"),null!=this.additionalCb){t=this.additionalCb();if(null!=t)return url+t}return url},L.Hash.prototype={options:{layerSeparator:","},map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t,a){this.map=t,L.Util.setOptions(this,a),this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},_parseLayers:function(t,a){return t.split(a).map(L.bind(function(t){var a=null,t=decodeURIComponent(t);return t&&(a=this.options.layersControl.getLayerFromString(t)),a},this))},parseLayers:function(t){function a(t,a){return a&&t++,t}var n=this._parseLayers(t,this.options.layerSeparator),e=n.reduce(a,0);return e<n.length&&(e<(t=this._parseLayers(t,"-")).reduce(a,0)&&(n=t)),n},activateLayers:function(t){var e=this.options.layersControl,i=!1;e.removeActiveLayers(),t.forEach(L.bind(function(t,a,n){t&&(e.activateLayer(t),t.layer instanceof OverpassLayer&&e._update(),t&&!t.overlay&&(i=!0))},this)),i||e.activateDefaultBaseLayer()},formatLayers:function(){return this.options.layersControl.getActiveLayers().filter(function(t){return t.layer instanceof L.GridLayer||t.layer.id}).map(L.bind(function(t){return encodeURIComponent(this.options.layersControl.toLayerString(t))},this)).join(this.options.layerSeparator)},removeFrom:function(){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t,a,n=location.hash;n!==this.lastHash&&((t=this.parseHash(n))||null==this.onInvalidHashChangeCb||null!=(a=this.onInvalidHashChangeCb(n))&&a!=n&&(t=this.parseHash(a)),t?(this.movingMap=!0,this.map.setView(t.center,t.zoom),this.activateLayers(t.layers),null!=this.onHashChangeCb&&this.onHashChangeCb(t.additional),this.movingMap=!1):this.onMapMove(this.map))},changeDefer:100,changeTimeout:null,onHashChange:function(){var t;this.changeTimeout||((t=this).changeTimeout=setTimeout(function(){t.update(),t.changeTimeout=null},this.changeDefer))},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1},_keyByValue:function(t,a){for(var n in t)if(t.hasOwnProperty(n))return t[n]===a?n:null}},L.hash=function(t,a){return new L.Hash(t,a)},L.Map.prototype.addHash=function(){this._hash=L.hash(this,this.options)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window);
BR.stravaSegments=function(a,t){var e=L.control.stravaSegments({runningTitle:i18next.t("map.strava-shortcut",{action:"$t(map.strava-running)",key:"S"}),bikingTitle:i18next.t("map.strava-shortcut",{action:"$t(map.strava-biking)",key:"S"}),loadingTitle:i18next.t("map.loading"),stravaToken:BR.keys.strava}).addTo(a);t.addOverlay(e.stravaLayer,i18next.t("map.layer.strava-segments")),e.onError=function(t){BR.message.showError(i18next.t("warning.strava-error",{error:t&&t.message?t.message:t}))},L.setOptions(this,{shortcut:{toggleLayer:83}});t=function(){var t=e.runningButton.button.parentElement;t.hidden=!t.hidden};return t(),e.stravaLayer.on("add remove",t),L.DomEvent.addListener(document,"keydown",function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.toggleLayer&&(a.hasLayer(e.stravaLayer)?a.removeLayer(e.stravaLayer):a.addLayer(e.stravaLayer))},this),e};
BR.ControlLayers=L.Control.Layers.extend({getActiveLayers:function(){for(var e=[],a=0;a<this._layers.length;a++){var r=this._layers[a];this._map.hasLayer(r.layer)&&(r.overlay?e.push(r):e.unshift(r))}return e},getActiveBaseLayer:function(){for(var e=this.getActiveLayers(),a=0;a<e.length;a++){var r=e[a];if(!r.overlay)return r}return null},removeActiveLayers:function(){for(var e=[],a=0;a<this._layers.length;a++){var r=this._layers[a];this._map.hasLayer(r.layer)&&(this._map.removeLayer(r.layer),e.push(r))}return e},getLayer:function(e){for(var a=0;a<this._layers.length;a++){var r=this._layers[a];if(r.name===e)return r}return null},getBaseLayers:function(){return this._layers.filter(function(e){return!e.overlay})},activateLayer:function(e){this._map.hasLayer(e.layer)||this._map.addLayer(e.layer)},activateFirstLayer:function(){for(var e=0;e<this._layers.length;e++){var a=this._layers[e];if(!a.overlay){this.activateLayer(a);break}}},activateBaseLayerIndex:function(e){e=this.getBaseLayers()[e];this.activateLayer(e)},_addLayer:function(e,a,r){L.Control.Layers.prototype._addLayer.call(this,e,a,r),this.options.autoZIndex&&e.setZIndex&&(r||(this._lastZIndex--,e.setZIndex(0)))}});
function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);i=!0);}catch(t){s=!0,a=t}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){i=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}BR.Export=L.Class.extend({latLngs:[],options:{shortcut:{export:88}},initialize:function(t,e,r){this.router=t,this.pois=e,this.profile=r,this.exportButton=$("#exportButton");e=this.trackname=document.getElementById("trackname");this.tracknameAllowedChars=BR.conf.tracknameAllowedChars,!BR.Browser.download&&this.tracknameAllowedChars&&(this.tracknameMessage=document.getElementById("trackname-message"),r=new RegExp("["+this.tracknameAllowedChars+"]+"),e.pattern=r.toString().slice(1,-1),e.addEventListener("input",L.bind(this._validationMessage,this))),this.exportButton.on("click",L.bind(this._generateTrackname,this)),L.DomUtil.get("submitExport").onclick=L.bind(this._export,this),L.DomUtil.get("serverExport").onclick=L.bind(this._exportServer,this),L.DomEvent.addListener(document,"keydown",this._keydownListener,this),$("#export").on("show.bs.modal",this._warnStraightLine.bind(this)),this.update([])},update:function(t,e){this.latLngs=t,this.segments=e,t.length<2?this.exportButton.addClass("disabled"):this.exportButton.removeClass("disabled")},_warnStraightLine:function(){var t=BR.Routing.hasBeeline(this.segments);document.getElementById("export-beeline-warning").hidden=!t;var e="Download from server (deprecated)";t&&(e="[Warning: straight lines not supported] "+e),document.getElementById("serverExport").title=e},_getMimeType:function(t){return{gpx:"application/gpx+xml",kml:"application/vnd.google-earth.kml+xml",geojson:"application/vnd.geo+json",csv:"text/tab-separated-values"}[t]},_triggerDownload:function(t,e){var r=document.createElement("a");r.href=t,e&&(r.download=e),r.hidden=!0,document.body.appendChild(r),r.click(),r.remove()},_exportServer:function(t){this._export(t,!0)},_export:function(t,e){var r,n,a=this,o=1<arguments.length&&void 0!==e&&e,i=document.forms.export,s=i.format.value||$("#export-format input:radio:checked").val(),l=i.trackname.value,c=encodeURIComponent(l),i=i["include-waypoints"].checked;t.preventDefault(),!o&&BR.Browser.download?(o=this._formatTrack(s,l,i),r=(l||"brouter")+"."+s,l=this._getMimeType(s),l=new Blob([o],{type:l+";charset=utf-8"}),(n=new FileReader).onload=function(t){return a._triggerDownload(n.result,r)},n.readAsDataURL(l)):(i=this.router.getUrl(this.latLngs,null,this.pois.getMarkers(),null,s,c,i),this._triggerDownload(i))},_formatTrack:function(t,e,r){var n=BR.Export._concatTotalTrack(this.segments);switch(e&&(n.features[0].properties.name=e),this._addPois(n),r&&this._addRouteWaypoints(n),t){case"gpx":var a=+this.profile.getProfileVar("turnInstructionMode"),o=this.profile.getTransportMode();return BR.Gpx.format(n,a,o);case"kml":return BR.Kml.format(n);case"geojson":return JSON.stringify(n,null,2);case"csv":return BR.Csv.format(n)}console.error("Export format not implemented: "+t)},_addPois:function(t){var e=_createForOfIteratorHelper(this.pois.getMarkers());try{for(e.s();!(n=e.n()).done;){var r=n.value,n={name:r.name,type:"poi"},n=turf.point([r.latlng.lng,r.latlng.lat],n);t.features.push(n)}}catch(t){e.e(t)}finally{e.f()}},_addRouteWaypoints:function(t){var e=_createForOfIteratorHelper(this.latLngs.entries());try{for(e.s();!(o=e.n()).done;){var r=_slicedToArray(o.value,2),n=r[0],a=r[1],o="via"+n,r="via";0===n?r=o="from":n===this.latLngs.length-1&&(r=o="to");r={name:o,type:r},r=turf.point([a.lng,a.lat],r);t.features.push(r)}}catch(t){e.e(t)}finally{e.f()}},_validationMessage:function(){var t=this.trackname,e=new RegExp("[^"+this.tracknameAllowedChars+"]","g");t.validity.patternMismatch?(t=t.value.replace(e,""),e=this.tracknameAllowedChars.replace(/\\/g,""),this.tracknameMessage.textContent="["+e+"] --\x3e "+t):this.tracknameMessage.textContent=""},_selectTrackname:function(){trackname.setSelectionRange(0,trackname.value.lastIndexOf(BR.Browser.download?" (":" - "))},_generateTrackname:function(){var n=this.trackname;this._getCityAtPosition(this.latLngs[0],L.bind(function(r){this._getCityAtPosition(this.latLngs[this.latLngs.length-1],L.bind(function(t){var e=document.getElementById("distance").innerHTML;!BR.Browser.download&&this.tracknameAllowedChars&&(e=e.replace(",",".")),n.value=r&&t?r===t?i18next.t("export.route-loop",{from:r,distance:e}):i18next.t("export.route-from-to",{from:r,to:t,distance:e}):null,!BR.Browser.download&&this.tracknameAllowedChars&&(n.value=n.value.replace(/[>)]/g,"").replace(/ \(/g," - "),this._validationMessage()),this._selectTrackname()},this))},this))},_getCityAtPosition:function(n,a){var t=L.Util.template("https://nominatim.openstreetmap.org/reverse?lon={lng}&lat={lat}&format=json",n);BR.Util.get(t,L.bind(function(t,e){try{var r=JSON.parse(e).address;a(r.village||r.town||r.hamlet||r.city_district||r.city)}catch(t){return BR.message.showError('Error getting position city "'+n+'": '+t),a(null)}}))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.shortcut.export&&!this.exportButton.hasClass("disabled")&&(this._generateTrackname(),$("#export").modal("show"))}}),BR.export=function(){return new BR.Export},BR.Export._concatTotalTrack=function(t){var e,r=[],n=_createForOfIteratorHelper(t.entries());try{for(n.s();!(o=n.n()).done;){var a=_slicedToArray(o.value,2),o=a[0],a=a[1].feature;if(a){var i=0<r.length?r.length-1:0;if(e){var s=e,l=a.properties;if(!function(t,e){var r=_createForOfIteratorHelper(["cost","filtered ascend","plain-ascend","total-energy","total-time","track-length"]);try{for(r.s();!(n=r.n()).done;){var n=n.value;t[n]=(+t[n]+ +e[n]).toString()}}catch(t){r.e(t)}finally{r.f()}}(s,l),s.messages=s.messages.concat(l.messages.slice(1)),s.times&&l.times){var c=s.times[s.times.length-1],u=_createForOfIteratorHelper(l.times.entries());try{for(u.s();!(h=u.n()).done;){var d=_slicedToArray(h.value,2),h=d[0],d=d[1];0<h&&s.times.push(+(c+d).toFixed(3))}}catch(t){u.e(t)}finally{u.f()}}if(l.voicehints){s.voicehints||(s.voicehints=[]);var p=_createForOfIteratorHelper(l.voicehints);try{for(p.s();!(f=p.n()).done;){var f=f.value.slice();f[0]+=i,s.voicehints.push(f)}}catch(t){p.e(t)}finally{p.f()}}}else(e=Object.assign({},a.properties)).voicehints&&(e.voicehints=e.voicehints.slice()),e.times&&(e.times=e.times.slice());l=a.geometry.coordinates;0<o&&(a=r[r.length-1],o=l[0],a.length<o.length?r.pop():l=l.slice(1)),r=r.concat(l)}}}catch(t){n.e(t)}finally{n.f()}return turf.featureCollection([turf.lineString(r,e)])};
BR.Itinerary=L.Class.extend({initialize:function(){this._content=document.getElementById("itinerary"),this.update()},update:function(t,e){var n,i,r,a="";for(a+='<pre class="flexgrow">',n=0;e&&n<e.length;n++)for(r=e[n].feature.iternity,i=0;r&&i<r.length;i++)a+=r[i]+"\n";a+="</pre>",this._content.innerHTML=a}});
BR.Layers=L.Class.extend({_loadLayers:function(){if(this._customLayers={},BR.Util.localStorageAvailable()){var e=JSON.parse(localStorage.getItem("map/customLayers"));for(a in e)this._addLayer(a,e[a].layer,e[a].isOverlay,e[a].dataSource)}},_loadTable:function(){var e,a=[];for(layer in this._customLayers)"OverpassAPI"===this._customLayers[layer].dataSource?a.push([layer,this._customLayers[layer].layer.options.query,i18next.t("sidebar.layers.table.type_overpass_query")]):(e=this._customLayers[layer].isOverlay,a.push([layer,this._customLayers[layer].layer._url,e?i18next.t("sidebar.layers.table.type_overlay"):i18next.t("sidebar.layers.table.type_layer")]));null!=this._layersTable&&this._layersTable.destroy(),this._layersTable=$("#custom_layers_table").DataTable({data:a,info:!1,searching:!1,bAutoWidth:!1,paging:!1,language:{emptyTable:i18next.t("sidebar.layers.table.empty")},columns:[{title:i18next.t("sidebar.layers.table.name")},{title:i18next.t("sidebar.layers.table.URL")},{title:i18next.t("sidebar.layers.table.type")}]})},init:function(e,a,t,s){for(var r in this._layersControl=a,this._map=e,this._layers={},s)this._layers[r]=[s[r],!0];for(var r in t)this._layers[r]=[t[r],!1];L.DomUtil.get("custom_layers_add_base").onclick=L.bind(this._addBaseLayer,this),L.DomUtil.get("custom_layers_add_overlay").onclick=L.bind(this._addOverlay,this),L.DomUtil.get("custom_layers_add_overpass").onclick=L.bind(this._addOverpassQuery,this),L.DomUtil.get("custom_layers_remove").onclick=L.bind(this._remove,this),this._loadLayers(),this._loadTable();var l=this._layersTable;$("#custom_layers_table tbody").on("click","tr",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):(l.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))}),L.DomUtil.get("custom_layers_button").onclick=function(){$("#custom_layers").modal()}},_remove:function(){var e=this._layersTable.row(".selected").data();null!=e&&(e=e[0],this._layersControl.removeLayer(this._customLayers[e].layer),this._map.removeLayer(this._customLayers[e].layer),delete this._customLayers[e],this._layersTable.row(".selected").remove().draw(!1),this._sync())},_addFromInput:function(e,a){var t=L.DomUtil.get("layer_name").value,s=L.DomUtil.get("layer_url").value;0<t.length&&0<s.length&&this._addLayer(t,s,e,a)},_addBaseLayer:function(){this._addFromInput(!1)},_addOverlay:function(){this._addFromInput(!0)},_addOverpassQuery:function(){this._addFromInput(!0,"OverpassAPI")},_addLayer:function(e,a,t,s){if(!(e in this._layers||e in this._customLayers))try{var r="OverpassAPI"===s?this._layersControl.layersConfig.createOverpassLayer(a):"OpenStreetMapNotesAPI"===s?this._layersControl.layersConfig.createOpenStreetMapNotesLayer():L.tileLayer(a);return this._customLayers[e]={layer:r,isOverlay:t,dataSource:s},t?this._layersControl.addOverlay(r,e):this._layersControl.addBaseLayer(r,e),this._loadTable(),this._sync(),r}catch(e){return void console.warn("Oops:",e)}},_sync:function(){BR.Util.localStorageAvailable()&&localStorage.setItem("map/customLayers",JSON.stringify(this._customLayers,function(e,a){if(void 0!==a)return"OverpassAPI"===a.dataSource?{dataSource:"OverpassAPI",isOverlay:!0,layer:a.layer.options.query}:a._url||a}))}});
function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}BR.LayersTab=BR.ControlLayers.extend({previewLayer:null,previewBounds:null,saveLayers:[],initialize:function(e,t,r,i){L.Control.Layers.prototype.initialize.call(this,t,r,i),this.layersConfig=e},addTo:function(e){return this._map=e,this.onAdd(e),L.DomUtil.get("layers-control-wrapper").appendChild(this._section),this.initOpacitySlider(e),this.initButtons(),this.initJsTree(),this},onAdd:function(e){BR.ControlLayers.prototype.onAdd.call(this,e),e.on("baselayerchange overlayadd overlayremove",this.storeActiveLayers,this),e.on("overlayadd overlayremove",this.updateOpacityLabel,this)},onRemove:function(e){BR.ControlLayers.prototype.onRemove.call(this,e),e.off("baselayerchange overlayadd overlayremove",this.storeActiveLayers,this),e.off("overlayadd overlayremove",this.updateOpacityLabel,this)},initOpacitySlider:function(i){var a=this,e=new BR.OpacitySlider({id:"overlay",reversed:!1,orientation:"horizontal",defaultValue:1,title:i18next.t("layers.opacity-slider"),callback:function(e){for(var t=0;t<a._layers.length;t++){var r=a._layers[t].layer;a._layers[t].overlay&&i.hasLayer(r)&&(r.setOpacity?r.setOpacity(e):r.setStyle&&r.setStyle({opacity:e}))}}});L.DomUtil.get("leaflet-control-layers-overlays-opacity-slider").appendChild(e.getElement())},initButtons:function(){L.DomUtil.get("expand_tree_button").onclick=L.bind(function(){this.jstree.open_all()},this),L.DomUtil.get("collapse_tree_button").onclick=L.bind(function(){this.jstree.close_all()},this),L.DomUtil.get("optional_layers_button").onclick=L.bind(function(){var e=L.DomUtil.get("optional_layers_button"),t=L.DomUtil.get("tree-button-group"),r=L.DomUtil.get("optional-layers");r.hidden=!r.hidden,t.hidden=!t.hidden,e.classList.toggle("active"),r.hidden&&this.deselectNode()},this)},initJsTree:function(){var o=BR.layerIndex,e=this.toJsTree(BR.confLayers.tree),a=null;$("#optional-layers-tree").on("select_node.jstree",L.bind(function(e,t){var r=o[t.node.id],i=t.selected[0];i!==a?(this.showPreview(r),a=i):t.instance.deselect_node(t.node)},this)).on("deselect_node.jstree",L.bind(function(){this.hidePreview(),a=null},this)).on("check_node.jstree",L.bind(function(e,t){var r=o[t.node.id],i=this.createLayer(r),a=r.properties.name;r.properties.overlay?this.addOverlay(i,a):this.addBaseLayer(i,a),this.storeDefaultLayers();var s=document.getElementById(t.node.a_attr.id);s.classList.add("added"),setTimeout(function(){s.classList.remove("added")},1e3)},this)).on("uncheck_node.jstree",L.bind(function(e,t){var r,i=this.getLayerById(t.node.id);i&&(this.removeLayer(i.layer),this._map.hasLayer(i.layer)&&(this._map.removeLayer(i.layer),i.overlay||this.activateFirstLayer()),this.storeDefaultLayers(),(r=document.getElementById(t.node.a_attr.id)).classList.add("removed"),setTimeout(function(){r.classList.remove("removed")},1e3))},this)).on("ready.jstree",function(e,t){t.instance.open_all()}).jstree({plugins:["checkbox"],checkbox:{whole_node:!1,tie_selection:!1},core:{multiple:!1,themes:{icons:!0,dots:!1},data:e}}),this.jstree=$("#optional-layers-tree").jstree(!0)},toJsTree:function(e){var t={children:[]},v=this;return function a(e,s){function t(e){for(var t in e){var r=e[t],i=(i=t,{text:i18next.t("sidebar.layers.category."+i,i),icon:!1,state:{disabled:!0},children:[]});s.children.push(i),a(r,i)}}if(Array.isArray(e))for(var r=0;r<e.length;r++){var i=e[r];"object"===_typeof(i)?t(i):(n=BR.layerIndex[i])?(o=i,l=s,h=d=c=y=void 0,y=n.properties,c=y.url,d=v.layersConfig.getKeyName(c),h=null,(!d||d&&BR.keys[d.name])&&(h={id:o,text:(n=l,c='<span class="tree-text">',(l=(d=y).country_code||d.language_code)&&n.text!==l&&(c+='<span class="tree-code">'+l+"</span>"),(c+=d.name)+"</span>"),icon:v.layersConfig.getOverpassIconUrl(y.icon)||!1,state:{checked:v.layersConfig.isDefaultLayer(o,y.overlay)}}),h&&s.children.push(h)):console.error('Layer "'+i+'" not found')}else t(e);var o,n,l,y,c,d,h}(e,t),t.children},storeDefaultLayers:function(){for(var e=[],t=[],r=0;r<this._layers.length;r++){var i=this._layers[r],a=i.layer.id;a&&-1===this.layersConfig.builtInLayers.indexOf(a)&&(i.overlay?t:e).push(a)}this.layersConfig.storeDefaultLayers(e,t)},createLayer:function(e){var t=this.layersConfig.createLayer(e),e=e.properties.overlay;return t.options.zIndex=e?this._lastZIndex+1:0,t},getLayerById:function(e){for(var t=0;t<this._layers.length;t++){var r=this._layers[t];if(r.layer.id===e)return r}return null},getLayerByLegacyName:function(e){var t=null,e=this.layersConfig.legacyNameToIdMap[e];return e&&(t=this.getLayerById(e)),t},activateDefaultBaseLayer:function(){var e=BR.conf.defaultBaseLayerIndex||0;this.getActiveBaseLayer()||this.activateBaseLayerIndex(e)},saveRemoveActiveLayers:function(){this.saveLayers=this.removeActiveLayers()},restoreActiveLayers:function(e){for(var t=0;t<this.saveLayers.length;t++){var r=this.saveLayers[t];(!e||e&&r.overlay)&&(!!this._getLayer(L.Util.stamp(r.layer))?this.activateLayer(r):r.overlay||this.activateFirstLayer())}this.saveLayers=[]},removePreviewLayer:function(){return!(!this.previewLayer||!this._map.hasLayer(this.previewLayer))&&(this._map.removeLayer(this.previewLayer),!(this.previewLayer=null))},showPreviewBounds:function(e){e.geometry&&(this.previewBounds=L.geoJson(e.geometry,{invert:!0,renderer:L.svg({padding:1}),color:"#333",fillOpacity:.4,weight:2}).addTo(this._map))},removePreviewBounds:function(){this.previewBounds&&this._map.hasLayer(this.previewBounds)&&(this._map.removeLayer(this.previewBounds),this.previewBounds=null)},deselectNode:function(){var e=this.jstree.get_selected();0<e.length&&this.jstree.deselect_node(e[0])},onBaselayerchange:function(){setTimeout(L.Util.bind(function(){this.removePreviewBounds(),this.removePreviewLayer(),this.restoreActiveLayers(!0),this.deselectNode()},this),0)},showPreview:function(e){var t=this.createLayer(e);this._map.addLayer(t),this.removePreviewBounds(),this.removePreviewLayer()||(this.saveRemoveActiveLayers(),this._map.once("baselayerchange",this.onBaselayerchange,this)),this.previewLayer=t,this.showPreviewBounds(e),L.DomUtil.get("preview").hidden=!1},hidePreview:function(){this._map.off("baselayerchange",this.onBaselayerchange,this),this.removePreviewBounds(),this.removePreviewLayer(),this.restoreActiveLayers(),L.DomUtil.get("preview").hidden=!0},toLayerString:function(e){return e.layer.id||e.name},getLayerFromString:function(e){var t=this.getLayerById(e);return t=t||((t=this.getLayer(e))||this.getLayerByLegacyName(e))},storeActiveLayers:function(){var e;BR.Util.localStorageAvailable()&&(e=this.getActiveLayers().map(L.bind(function(e){return this.toLayerString(e)},this)),e=JSON.stringify(e),localStorage.setItem("map/activeLayers",e))},loadActiveLayers:function(){if(BR.Util.localStorageAvailable()){var e=localStorage.getItem("map/activeLayers");if(e)for(var t=JSON.parse(e),r=0;r<t.length;r++){var i=t[r],i=this.getLayerFromString(i);i&&this.activateLayer(i)}}},updateOpacityLabel:function(){var e=$("#leaflet-control-layers-overlays-opacity-slider"),t=this.getActiveLayers().length-1;0==t?e.hide():(e.show(),e.children()[1].innerText=i18next.t("sidebar.layers.overlay-opacity",{count:t}))}}),BR.layersTab=function(e,t,r){return new BR.LayersTab(e,t,r)};
BR.Message=L.Class.extend({options:{alert:!1,onClosed:null},initialize:function(i,n){L.setOptions(this,n),this.id=i},_show:function(i,n){var t,e,a=L.DomUtil.get(this.id);switch(n){case"error":t="fa-times-circle",e="alert-danger";break;case"warning":t="fa-exclamation-triangle",e="alert-warning";break;case"loading":t="fa-spinner fa-pulse",e="alert-secondary";break;default:t="fa-info-circle",e="alert-info"}L.DomEvent.disableClickPropagation(a),a.innerHTML='<div class="alert '+e+' alert-dismissible fade show" role="alert">  <button type="button" class="close" data-dismiss="alert" aria-label="Close">    <span aria-hidden="true">&times;</span>  </button>  <span class="fa '+t+'" aria-hidden="true"/></span>'+i+"</div>",this.options.onClosed&&$("#"+this.id+" .alert").on("closed.bs.alert",this.options.onClosed),this.options.alert&&$("#"+this.id+" .alert").alert()},hide:function(){$("#"+this.id+" .alert").alert("close")},showError:function(i){i&&i.message&&(i=i.message),"target island detected for section 0\n"==i||"no track found at pass=0\n"==i?i=i18next.t("warning.no-route-found"):"to-position not mapped in existing datafile\n"==i?i=i18next.t("warning.invalid-route-to"):"from-position not mapped in existing datafile\n"==i?i=i18next.t("warning.invalid-route-from"):i&&i.startsWith("null description for: ")&&(i=i18next.t("warning.no-route-found")),this._show(i,"error")},showWarning:function(i){this._show(i,"warning")},showInfo:function(i){this._show(i,"info")},showLoading:function(i){this._show(i,"loading")}}),BR.message=new BR.Message("message");
BR.OpacitySlider=L.Class.extend({options:{id:"",reversed:!0,orientation:"vertical",defaultValue:BR.conf.defaultOpacity,title:"",callback:function(){}},initialize:function(t){L.setOptions(this,t);var e=this.input=$('<input id="slider-'+this.options.id+'" type="text"/>'),i=BR.Util.localStorageAvailable()?localStorage["opacitySliderValue"+this.options.id]:null,t=i?parseInt(i):100*this.options.defaultValue,i=100*(BR.conf.minOpacity||0);t<i&&(t=i),e.slider({id:this.options.id,min:0,max:100,step:1,value:t,orientation:this.options.orientation,reversed:this.options.reversed,selection:this.options.reversed?"before":"after",tooltip:"hide"}).on("slide slideStop",{self:this},function(t){t.data.self.options.callback(t.value/100)}).on("slideStop",{self:this},function(t){BR.Util.localStorageAvailable()&&(localStorage["opacitySliderValue"+t.data.self.options.id]=t.value)}),this.getElement().title=this.options.title,this.options.callback(t/100),this.options.muteKeyCode&&(L.DomEvent.addListener(document,"keydown",this._keydownListener,this),L.DomEvent.addListener(document,"keyup",this._keyupListener,this))},_keydownListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.muteKeyCode&&this.options.callback(0)},_keyupListener:function(t){BR.Util.keyboardShortcutsAllowed(t)&&t.keyCode===this.options.muteKeyCode&&this.options.callback(this.input.val()/100)},getElement:function(){return this.input.slider("getElement")}});
BR.OpacitySliderControl=L.Control.extend({options:{position:"topleft"},onAdd:function(){var e=L.DomUtil.create("div","leaflet-bar control-slider");L.DomEvent.disableClickPropagation(e),!BR.Util.localStorageAvailable()||null!==(t=localStorage.getItem("opacitySliderValue"))&&(localStorage.setItem("opacitySliderValue"+this.options.id,t),localStorage.removeItem("opacitySliderValue"));var t=new BR.OpacitySlider(this.options);e.appendChild(t.getElement());function o(e){L.DomEvent.stop(e),i()}var i=function e(){document.removeEventListener("click",o,!0),document.removeEventListener("mousedown",e,!0)};return t.input.on("slideStart",function(e){L.DomUtil.disableTextSelection()}).on("slideStop",{self:this},function(e){L.DomUtil.enableTextSelection(),document.addEventListener("click",o,!0),document.addEventListener("mousedown",i,!0)}),e}});
BR.Profile=L.Evented.extend({cache:{},saveWarningShown:!1,initialize:function(){var e=L.DomUtil.get("profile_upload");this.editor=CodeMirror.fromTextArea(e,{lineNumbers:!0}),$('#profileEditorTabs a[data-toggle="tab"]').on("shown.bs.tab",L.bind(function(e){this._activateSecondaryTab()},this)),L.DomUtil.get("save").onclick=L.bind(this._save,this),L.DomUtil.get("upload").onclick=L.bind(this._upload,this),L.DomUtil.get("clear").onclick=L.bind(this.clear,this),this.pinned=L.DomUtil.get("profile-pinned"),this.message=new BR.Message("profile_message",{alert:!0})},clear:function(e){var t=e.target||e.srcElement;e.preventDefault(),this.editor.markClean(),this._setValue(""),this.fire("clear"),t.blur()},update:function(e,i){var r,a=e.profile,e=!1;a&&BR.conf.profilesUrl&&((this.selectedProfileName=a)in this.cache?this._updateProfile(a,this.cache[a]):(r=BR.conf.profilesUrl+a+".brf",e=!0,BR.Util.get(r,L.bind(function(e,t){return e?console.warn('Error getting profile from "'+r+'": '+e):(this.cache[a]=t,this.profileName&&this.selectedProfileName!==a||this._updateProfile(a,t)),void(i&&i())},this)))),i&&!e&&i()},show:function(){this.editor.refresh()},onResize:function(){this.editor.refresh()},getProfileVar:function(e){var t;if(this._isParamsFormActive()){var i=this._getFormValues();if(i.hasOwnProperty(e))return i[e]}i=this._getSelectedProfileText();if(!i)return t;e=new RegExp("assign\\s*".concat(e,"\\s*=?\\s*([\\w\\.]*)")),e=i.match(e);return e&&(t=e[1]),t},getTransportMode:function(){var e=!!this.getProfileVar("validForCars"),t=!!this.getProfileVar("validForBikes");return e?"car":t?"bike":"foot"},_upload:function(e){var r=e.target||e.srcElement,t=this._getProfileText();this.message.hide(),e.preventDefault(),this.fire("update",{profileText:t,callback:L.bind(function(e,t,i){$(r).blur(),e||(this.profileName=t,this.cache[t]=i,this.saveWarningShown||(this.message.showWarning(i18next.t("warning.temporary-profile")),this.saveWarningShown=!0))},this)})},_buildCustomProfile:function(t){var i=this._getFormValues();return Object.keys(i).forEach(function(e){var a=i[e],e=new RegExp("(assign\\s*"+e+"\\s*=?\\s*)([\\w.]*)(\\s*#\\s*%(.*)%\\s*(\\|\\s*(.*)\\s*\\|\\s*(.*)\\s*)?[\\r\\n])");t=t.replace(e,function(e,t,i,r){return t+a+r})}),t},_getFormValues:function(){var i={};return document.querySelectorAll("#profile_params input, #profile_params select").forEach(function(e){var t=e.name,e="checkbox"==e.type?e.checked:e.value;i[t]=e}),i},_save:function(){var e=this._buildCustomProfile(this._getProfileText()),r=this;this.fire("update",{profileText:e,callback:function(e,t,i){e||(r.profileName=t,r.cache[t]=i)}})},_updateProfile:function(e,t){var i=!this.editor.getValue(),r=this.editor.isClean();i||r?(this.profileName=e,this._setValue(t),this.pinned.hidden||(this.pinned.hidden=!0)):this.pinned.hidden&&(this.pinned.hidden=!1)},_setValue:function(e){e=e||"";var t=this.editor.isClean();this.editor.setValue(e),t&&this.editor.markClean(),this._isParamsFormActive()&&this._buildParamsForm(e)},_buildParamsForm:function(e){var l,s,c;e&&(l={},(e=e.split("---context:").filter(function(e){return e.startsWith("global")}))&&0<e.length&&(e=e[0].split("\n").slice(1),s=/assign\s*(\w*)\s*=?\s*([\w\.]*)\s*#\s*%(.*)%\s*(\|\s*(.*)\s*\|\s*(.*)\s*)?$/,e.forEach(function(e){var t=e.match(s);if(t){var i=t[1],r=t[2],e=t[5],t=t[6],a={};if(t.match(/\[.*\]/)&&(t.slice(1,-1).split(",").forEach(function(e){var t=e.split("="),e=(t[0]||"").replace(/^\s+|\s+$/g,""),t=(t[1]||"").replace(/^\s+|\s+$/g,"");a[e]=t}),t="select"),"boolean"==(t=t||("true"==r||"false"==r?"boolean":"number")))r="true"==r;else if("number"==t&&(r=Number.parseFloat(r),Number.isNaN(r)))return;l[i]={description:e,type:t,value:r,possible_values:a}}})),(c=L.DomUtil.get("profile_params")).innerHTML="",Object.keys(l).length||c.append(i18next.t("sidebar.profile.no_easy_configuration_warning")),Object.keys(l).forEach(function(i){var e=document.createElement("div"),t=document.createElement("label"),r=l[i].type,a=i18next.exists("profileParameters."+i+".name")?i18next.t("profileParameters."+i+".name"):i;if("select"==r){var s=document.createElement("select");s.name=a,s.className="form-control form-control-sm",t.htmlFor=s.id="customize-profile-"+a;var n=l[i].possible_values;Object.keys(n).forEach(function(e){var t=document.createElement("option");(t.value=e)==l[i].value&&(t.selected=!0),t.append(n[e]),s.appendChild(t)}),t.append(a),e.appendChild(t),e.appendChild(s)}else{var o=document.createElement("input");if(o.name=a,t.htmlFor=o.id="customize-profile-"+a,"number"==r)o.type="number",o.value=l[i].value,o.className="form-control form-control-sm",t.append(a),e.appendChild(t),e.appendChild(o),e.className="form-group";else{if("boolean"!=r)return;o.type="checkbox",o.checked=l[i].value,e.appendChild(o),t.append(a),e.appendChild(t)}}a=document.createElement("p"),t=i18next.exists("profileParameters."+i+".description")?i18next.t("profileParameters."+i+".description"):l[i].description.replace(/^\s+|\s+$/g,"");a.innerHTML=t,a.className="help-block",e.appendChild(a),c.appendChild(e)}))},_isParamsFormActive:function(){return L.DomUtil.get("profile_params_container").classList.contains("active")},_activateSecondaryTab:function(){var e=this._getProfileText();this._isParamsFormActive()?this._buildParamsForm(e):this._setValue(this._buildCustomProfile(e))},_getProfileText:function(){return this.editor.getValue()},_getSelectedProfileText:function(){var e;return null!==(e=this.cache[this.selectedProfileName])&&void 0!==e?e:this.editor.getValue()}});
BR.RoutingOptions=L.Evented.extend({options:{shortcut:{switch:71}},initialize:function(){$("#profile-alternative").on("changed.bs.select",this._getChangeHandler());for(var e=this.getRememberedProfile(),t=!1,i=BR.conf.profiles,o=L.DomUtil.get("profile"),l=0;l<i.length;l++){var r=document.createElement("option");r.value=i[l],r.text=i18next.t("navbar.profile."+i[l]),location.hash||null===e||e!==i[l]||(t=r.selected=!0),o.appendChild(r)}o.children[0].value="Custom",t||(o.children[1].selected=!0),L.DomEvent.addListener(document,"keydown",this._keydownListener,this)},refreshUI:function(){$("#profile-alternative").find("option:disabled").each(function(e){$(this).prop("disabled",!1)}),$("#profile-alternative").find("option:selected").each(function(e){$(this).prop("disabled",!0)});var e=L.DomUtil.get("profile").children[0];"Custom"===e.value&&(e.disabled=!0),$(".selectpicker").selectpicker("refresh");e=$("#profile-alternative-form button")[0];e.title=e.title+i18next.t("navbar.profile-tooltip",{key:"G"})},getOptions:function(){var e=$("#profile option:selected"),t=$("#alternative option:selected");return this.refreshUI(),{profile:e.val(),alternative:t.val()}},setOptions:function(e){var t=[e.profile||$("#profile option:selected").val(),e.alternative||$("#alternative option:selected").val()];$(".selectpicker").selectpicker("val",t),this.refreshUI(),e.profile&&L.BRouter.isCustomProfile(e.profile)&&this.setCustomProfile(e.profile,!0)},setCustomProfile:function(e,t){var i=L.DomUtil.get("profile"),o=i.children[0];o.value=e||"Custom",o.disabled=!e,e?$("#profile").find("option:selected").each(function(e){$(this).prop("selected",!1)}):o.selected&&(i.children[1].selected=!0),o.selected=!!e,t||this.fire("update",{options:this.getOptions()})},getCustomProfile:function(){var e=L.DomUtil.get("profile").children[0],t=null;return"Custom"!==e.value&&(t=e.value),t},rememberProfile:function(e){BR.Util.localStorageAvailable()&&(L.BRouter.isCustomProfile(e)||localStorage.setItem("routingprofile",e))},getRememberedProfile:function(){return BR.Util.localStorageAvailable()?localStorage.getItem("routingprofile"):null},_getChangeHandler:function(){return L.bind(function(e){this.rememberProfile(e.target.options[e.target.options.selectedIndex].value),this.fire("update",{options:this.getOptions()})},this)},_keydownListener:function(e){BR.Util.keyboardShortcutsAllowed(e)&&e.keyCode===this.options.shortcut.switch&&($("#profile-alternative-form .dropdown").hasClass("show")||$("#profile-alternative-form button").click())}});
BR.TrackAnalysis=L.Class.extend({options:{overlayStyle:{color:"yellow",opacity:.8,weight:8,pane:"routingQualityPane"}},totalRouteDistance:0,initialize:function(t,a){this.map=t,L.setOptions(this,a)},trackEdges:null,trackPolyline:null,active:!1,show:function(){this.active=!0,this.options.requestUpdate(this)},hide:function(){this.active=!1},update:function(t,a){this.active&&(0!==a.length?(this.trackPolyline=t,this.trackEdges=new BR.TrackEdges(a),a=this.calcStats(t,a),this.render(a),$(".track-analysis-table tr").hover(L.bind(this.handleHover,this),L.bind(this.handleHoverOut,this)),$(".track-analysis-table tbody").on("click","tr",L.bind(this.toggleSelected,this))):$("#track_statistics").html(""))},calcStats:function(t,a){for(var e={highway:{},surface:{},smoothness:{}},s=this.totalRouteDistance=0;a&&s<a.length;s++)for(var i=1;i<a[s].feature.properties.messages.length;i++){this.totalRouteDistance+=parseFloat(a[s].feature.properties.messages[i][3]);for(var n=a[s].feature.properties.messages[i][9].split(" "),n=this.normalizeWayTags(n,"cycling"),r=0;r<n.length;r++){var l=n[r].split("="),o=l[0];switch(o){case"highway":var h=l[1],c="";"track"===h&&(h="Track "+(c=this.getTrackType(n))),void 0===e.highway[h]&&(e.highway[h]={formatted_name:i18next.t("sidebar.analysis.data.highway."+h,h),name:l[1],subtype:c,distance:0}),e.highway[h].distance+=parseFloat(a[s].feature.properties.messages[i][3]);break;case"surface":case"smoothness":void 0===e[o][l[1]]&&(e[o][l[1]]={formatted_name:i18next.t("sidebar.analysis.data."+o+"."+l[1],l[1]),name:l[1],subtype:"",distance:0}),e[o][l[1]].distance+=parseFloat(a[s].feature.properties.messages[i][3])}}}return this.sortAnalysisData(e)},normalizeWayTags:function(t,a){for(var e={},s={},i={},n=0;n<t.length;n++){var r=t[n].split("="),l=r[0],r=r[1];"surface"!==l?-1===l.indexOf(":surface")?"smoothness"!==l?-1===l.indexOf(":smoothness")?e[l]=r:i[l.split(":")[0]]=r:i.default=r:s[l.split(":")[0]]=r:s.default=r}return"cycling"===a?("string"==typeof s.cycleway?e.surface=s.cycleway:"string"==typeof s.default&&(e.surface=s.default),"string"==typeof i.cycleway?e.smoothness=i.cycleway:"string"==typeof i.default&&(e.smoothness=i.default)):("string"==typeof s.default&&(e.surface=s.default),"string"==typeof i.default&&(e.smoothness=i.default)),this.wayTagsToArray(e)},sortAnalysisData:function(t){var a,e={},s={};for(a in t)if(t.hasOwnProperty(a)){for(var i in s[a]={},e[a]=[],t[a])t[a].hasOwnProperty(i)&&e[a].push(t[a][i]);e[a].sort(function(t,a){return a.distance-t.distance});for(var n=0;n<e[a].length;n++)s[a][e[a][n].formatted_name]=e[a][n]}return s},getTrackType:function(t){for(var a=0;a<t.length;a++){var e=t[a].split("=");if("tracktype"===e[0])return e[1]}return"unknown"},render:function(t){var a=$("#track_statistics");a.html(""),a.append($('<h4 class="track-analysis-heading">'+i18next.t("sidebar.analysis.header.highway")+"</h4>")),a.append(this.renderTable("highway",t.highway)),a.append($('<h4 class="track-analysis-heading">'+i18next.t("sidebar.analysis.header.surface")+"</h4>")),a.append(this.renderTable("surface",t.surface)),a.append($('<h4 class="track-analysis-heading">'+i18next.t("sidebar.analysis.header.smoothness")+"</h4>")),a.append(this.renderTable("smoothness",t.smoothness))},renderTable:function(t,a){var e,s=$('<table data-type="'+t+'" class="mini cell-border stripe dataTable track-analysis-table"></table>'),t=$("<thead></thead>");t.append($("<tr>").append('<th class="track-analysis-header-category">'+i18next.t("sidebar.analysis.table.category")+"</th>").append($('<th class="track-analysis-header-distance">'+i18next.t("sidebar.analysis.table.length")+"</th>"))),s.append(t);var i,n=$("<tbody></tbody>"),r=0;for(e in a)a.hasOwnProperty(e)&&((i=$('<tr data-name="'+a[e].name+'" data-subtype="'+a[e].subtype+'" data-distance="'+a[e].distance+'"></tr>')).append('<td class="track-analysis-title">'+a[e].formatted_name+"</td>"),i.append('<td class="track-analysis-distance">'+this.formatDistance(a[e].distance)+" km</td>"),n.append(i),r+=a[e].distance);return r<this.totalRouteDistance&&n.append($('<tr data-name="internal-unknown" data-distance="'+(this.totalRouteDistance-r)+'"></tr>').append($('<td class="track-analysis-title">'+i18next.t("sidebar.analysis.table.unknown")+"</td>")).append($('<td class="track-analysis-distance">'+this.formatDistance(this.totalRouteDistance-r)+" km</td>"))),s.append(n),s.append($("<tfoot></tfoot>").append("<tr></tr>").append($("<td>"+i18next.t("sidebar.analysis.table.total_known")+"</td>")).append($('<td class="track-analysis-distance track-analysis-distance-total">'+this.formatDistance(r)+" km</td>"))),s},formatDistance:function(t){return(t/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})},handleHover:function(t){var a=$(t.currentTarget),e=a.parents("table").first().data("type"),t=a.data("name"),a=a.data("subtype"),a=this.getPolylinesForDataType(e,t,a);this.highlightedSegments=L.layerGroup(a).addTo(this.map)},handleHoverOut:function(){this.map.removeLayer(this.highlightedSegments)},toggleSelected:function(t){var a=t.currentTarget,e=$(a).parents("table").first().data("type"),s=$(a).data("name"),t=$(a).data("subtype");if(a.classList.toggle("selected"))return this.highlightedSegment&&(this.map.removeLayer(this.highlightedSegment),this.selectedTableRow.classList.remove("selected")),this.highlightedSegment=L.layerGroup(this.getPolylinesForDataType(e,s,t)).addTo(this.map),void(this.selectedTableRow=a);this.map.removeLayer(this.highlightedSegment),this.selectedTableRow=null,this.highlightedSegment=null},getPolylinesForDataType:function(t,a,e){for(var s,i,n=[],r=this.trackPolyline.getLatLngs(),l=0;l<this.trackEdges.edges.length;l++)this.wayTagsMatchesData(r[this.trackEdges.edges[l]],t,a,e)&&(s=0<l?this.trackEdges.edges[l-1]:0,i=this.trackEdges.edges[l]+1,n.push(L.polyline(r.slice(s,i),this.options.overlayStyle)));return n},wayTagsMatchesData:function(t,a,e,s){var i=this.wayTagsToObject(t);switch(a){case"highway":return"track"===e?"unknown"===s&&"track"===i.highway&&!i.tracktype||"string"==typeof i.tracktype&&i.tracktype===s:"internal-unknown"===e&&"string"!=typeof i.highway||"string"==typeof i.highway&&i.highway===e;case"surface":return this.singleWayTagMatchesData("surface",i,e);case"smoothness":return this.singleWayTagMatchesData("smoothness",i,e)}return!1},singleWayTagMatchesData:function(t,a,e){var s,i=null;for(s in a)if(-1!==s.indexOf(t)){i=a[s];break}return"internal-unknown"===e&&null===i||i===e},wayTagsToObject:function(t){for(var a={},e=t.feature.wayTags.split(" "),s=0;s<e.length;s++){var i=e[s].split("=");a[i[0]]=i[1]}return a},wayTagsToArray:function(t){var a,e=[];for(a in t)e.push(a+"="+t[a]);return e}});
BR.TrackMessages=L.Class.extend({options:{edgeStyle:{color:"yellow",opacity:.8,weight:8,pane:"routingQualityPane"},syncMap:!0},active:!1,columnOptions:{Longitude:{visible:!1},Latitude:{visible:!1},Elevation:{title:"elev.",className:"dt-body-right"},Distance:{title:"dist.",className:"dt-body-right"},CostPerKm:{title:"$/km",className:"dt-body-right"},ElevCost:{title:"elev$",className:"dt-body-right"},TurnCost:{title:"turn$",className:"dt-body-right"},NodeCost:{title:"node$",className:"dt-body-right"},InitialCost:{title:"initial$",className:"dt-body-right"}},trackEdges:null,trackPolyline:null,initialize:function(t,e){L.setOptions(this,e),this._map=t;t=document.getElementById("datatable");this.tableClassName=t.className,this.tableParent=t.parentElement;t=document.getElementById("data-sync-map");L.DomEvent.on(t,"click",this._toggleSyncMap,this)},update:function(t,e){var s,a,i=[];if(this.active){for(this.trackPolyline=t,this.trackEdges=new BR.TrackEdges(e),s=0;e&&s<e.length;s++)(a=e[s].feature.properties.messages)&&(i=i.concat(a.slice(1)));this._destroyTable(),0!==i.length&&(t=a[0],t=this._getColumns(t,i),this._table=$("#datatable").DataTable({destroy:!0,data:i,columns:t,paging:!1,searching:!1,info:!1,scrollY:50,scrollX:!0,order:[]}),$("#datatable tbody tr").hover(L.bind(this._handleHover,this),L.bind(this._handleHoverOut,this)),$("#datatable tbody").on("click","tr",L.bind(this._toggleSelected,this)))}},show:function(){this.active=!0,this.options.requestUpdate(this)},hide:function(){this.active=!1},_destroyTable:function(){var t;return $.fn.DataTable.isDataTable("#datatable")&&($("#datatable").DataTable().destroy(!0),(t=document.createElement("table")).id="datatable",t.className=this.tableClassName,this.tableParent.appendChild(t)),t||document.getElementById("datatable")},_getColumns:function(t,e){var s,a=[],i=this._getEmptyColumns(e);for(k=0;k<t.length;k++)s={title:t[k],visible:!i[k]},s=L.extend(s,this.columnOptions[t[k]]),a.push(s);return a},_getEmptyColumns:function(t){for(var s=new Array(t[0].length),e=0;e<s.length;e++)s[e]=!0;return t.forEach(function(t){t.forEach(function(t,e){s[e]=s[e]&&!t})}),s},_getRowEdge:function(t){var e=this._table.row($(t)),s=this.trackPolyline.getLatLngs(),t=0<e.index()?this.trackEdges.edges[e.index()-1]:0,e=this.trackEdges.edges[e.index()],e=s.slice(t,e+1);return L.polyline(e,this.options.edgeStyle)},_handleHover:function(t){t=t.currentTarget;this._hoveredEdge=this._getRowEdge(t).addTo(this._map),this.options.syncMap&&!this._selectedEdge&&this._map.panTo(this._hoveredEdge.getCenter())},_handleHoverOut:function(){this._map.removeLayer(this._hoveredEdge),this._hoveredEdge=null},_toggleSelected:function(t){t=t.currentTarget;t.classList.toggle("selected")?(this._selectedEdge&&(this._map.removeLayer(this._selectedEdge),this._selectedRow.classList.remove("selected")),this._selectedEdge=this._getRowEdge(t).addTo(this._map),this._selectedRow=t,this._map.panTo(this._selectedEdge.getCenter())):(this._map.removeLayer(this._selectedEdge),this._selectedEdge=null,this._selectedRow=null)},_toggleSyncMap:function(t){t.currentTarget.classList.toggle("active"),this.options.syncMap=!this.options.syncMap}});
BR.TrackStats=L.Class.extend({update:function(t,e){if(0==e.length)return $("#stats-container").hide(),void $("#stats-info").show();$("#stats-container").show(),$("#stats-info").hide(),document.getElementById("beeline-warning").hidden=!BR.Routing.hasBeeline(e);var a=this.calcStats(t,e),n=L.Util.formatNum(a.trackLength/1e3,1).toLocaleString(),o=L.Util.formatNum(a.trackLength/1e3,3).toLocaleString(void 0,{minimumFractionDigits:3}),i=a.filteredAscend.toLocaleString(),l=a.plainAscend.toLocaleString(),r=a.cost.toLocaleString(),c=a.trackLength?L.Util.formatNum(a.cost/a.trackLength,2).toLocaleString():"0",t=Math.trunc(a.totalTime/3600)+":"+("0"+Math.trunc(a.totalTime%3600/60)).slice(-2),e=L.Util.formatNum(a.totalEnergy/36e5,2).toLocaleString(),a=a.trackLength?L.Util.formatNum(a.totalEnergy/36/a.trackLength,2).toLocaleString():"0";$("#distance").html(n),$("#distance").attr("title",o+" km"),$("#ascend").html(i),$("#plainascend").html(l),$("#cost").html(r),$("#meancostfactor").html(c),$("#totaltime").html(t),$("#totalenergy").html(e),$("#meanenergy").html(a)},calcStats:function(t,e){for(var a,n={trackLength:0,filteredAscend:0,plainAscend:0,totalTime:0,totalEnergy:0,cost:0},o=0;e&&o<e.length;o++)a=e[o].feature.properties,n.trackLength+=+a["track-length"],n.filteredAscend+=+a["filtered ascend"],n.plainAscend+=+a["plain-ascend"],n.totalTime+=+a["total-time"],n.totalEnergy+=+a["total-energy"],n.cost+=+a.cost;return n}});
!function(){var a;i18next.on("languageChanged",function(e){for(i=0;i<i18next.languages.length;i++){var t=i18next.languages[i];if(i18next.hasResourceBundle(t,"translation")){var n=document.documentElement;n.getAttribute("lang")!==t&&n.setAttribute("lang",t);break}}}),i18next.use(window.i18nextXHRBackend).use(window.i18nextBrowserLanguageDetector).init({fallbackLng:"en",backend:{loadPath:"dist/locales/{{lng}}.json"}},function(e,t){var n;jqueryI18next.init(i18next,$,{useOptionsAttr:!0}),$("html").localize(),$("#aboutLinks").localize({privacyPolicyUrl:BR.conf.privacyPolicyUrl||"https://brouter.de/privacypolicy.html"}),a=BR.Map.initMap(),n=a,L.Browser.touch&&BR.Browser.touchScreenDetectable&&!BR.Browser.touchScreen&&L.DomUtil.removeClass(n.map.getContainer(),"leaflet-touch"),function(e){var t,a,o,i,n,r,s,l,c,u,d,p,g,f,m,y=e.map,h=e.layersControl;$(".selectpicker").selectpicker({iconBase:"fa",tickIcon:"fa-check",windowPadding:[0,0,40,0]}),t=new BR.Search,y.addControl(t),$("#map .leaflet-control-geocoder > button")[0].title=i18next.t("keyboard.generic-shortcut",{action:"$t(map.geocoder)",key:"F"}),a=L.bRouter(),g=L.easyButton({states:[{stateName:"deactivate-draw",icon:"fa-pencil active",onClick:function(e){o.draw(!1),e.state("activate-draw")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-route-stop)",key:"$t(keyboard.escape)"})},{stateName:"activate-draw",icon:"fa-pencil",onClick:function(e){o.draw(!0),e.state("deactivate-draw")},title:i18next.t("keyboard.generic-shortcut",{action:"$t(map.draw-route-start)",key:"D"})}]});var b,B='\n            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" \n                id="mdi-vector-line" width="24" height="24" viewBox="0 0 24 24" class="mdi active">\n                <path d="M15,3V7.59L7.59,15H3V21H9V16.42L16.42,9H21V3M17,5H19V7H17M5,17H7V19H5" />\n            </svg>',v=function(e){var t=o.toggleBeelineDrawing();e.state(t?"deactivate-beeline":"activate-beeline")},k=i18next.t("keyboard.generic-shortcut",{action:"$t(map.toggle-beeline)",key:"B"}),w=L.easyButton({states:[{stateName:"activate-beeline",icon:B.replace(" active",""),onClick:v,title:k},{stateName:"deactivate-beeline",icon:B,onClick:v,title:k}]});function R(){bootbox.prompt({size:"small",title:i18next.t("map.clear-route"),inputType:"checkbox",inputOptions:[{text:i18next.t("map.delete-route"),value:"route"},{text:i18next.t("map.delete-nogo-areas"),value:"nogo"},{text:i18next.t("map.delete-pois"),value:"pois"}],value:["route"],onShown:function(){$("button.bootbox-accept",$(this)).focus()},callback:function(e){null!==e&&(-1!==e.indexOf("route")&&o.clear(),-1!==e.indexOf("nogo")&&n.clear(),-1!==e.indexOf("pois")&&f.clear(),M(),b.onMapMove())}})}function x(e){a.setOptions(e.options),a.queue.idle()||a.queue.remove(function(e){return e.callback(L.BRouter.ABORTED_ERROR),!0}),o.rerouteAllSegments(M)}function C(e){var t=o.toPolyline(),n=o.getSegments();e.update(t,n)}function M(e){var t,n,a;e?e!==L.BRouter.ABORTED_ERROR&&BR.message.showError(e):(BR.message.hide(),t=o.toPolyline(),n=o.getSegments(),a=o.getWaypoints(),e=o._segments,l.update(t,e),routingPathQuality.update(t,e),(BR.conf.transit?s:r).update(t,n),d.update(t,n),p.update(t,n),c.update(a,n))}y.on("routing:beeline-start",function(){return w.state("deactivate-beeline")}),y.on("routing:beeline-end",function(){return w.state("activate-beeline")}),e=L.easyButton("fa-random",function(){o.reverse()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.reverse-route)",key:"R"})),B=L.easyButton('<span><i class="fa fa-caret-left"></i><i class="fa fa-map-marker" style="margin-left: 1px; color: gray;"></i></span>',function(){o.deleteLastPoint()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.delete-last-point)",key:"Z"})),v=L.easyButton("fa-trash-o",function(){R()},i18next.t("keyboard.generic-shortcut",{action:"$t(map.clear-route)",key:"$t(keyboard.backspace)"})),L.DomEvent.addListener(document,"keydown",function(e){BR.Util.keyboardShortcutsAllowed(e)&&!$(".modal.show").length&&(8===e.keyCode?R():72===e.keyCode&&$("#about").modal("show"))},this),(i=new BR.RoutingOptions).on("update",function(e){b.movingMap||u.update(e.options,function(){x(e)})}),BR.NogoAreas.MSG_BUTTON=i18next.t("keyboard.generic-shortcut",{action:"$t(map.nogo.draw)",key:"N"}),BR.NogoAreas.MSG_BUTTON_CANCEL=i18next.t("keyboard.generic-shortcut",{action:"$t(map.nogo.cancel)",key:"$t(keyboard.escape)"}),BR.NogoAreas.MSG_CREATE=i18next.t("map.nogo.click-drag"),BR.NogoAreas.MSG_DISABLED=i18next.t("map.nogo.edit"),BR.NogoAreas.MSG_ENABLED=i18next.t("map.nogo.help"),(n=new BR.NogoAreas).on("update",x),BR.conf.transit?s=new BR.Itinerary:r=new BR.TrackStats,l=new BR.Heightgraph,(u=new BR.Profile).on("update",function(n){BR.message.hide();var e=i.getCustomProfile();a.uploadProfile(e,n.profileText,function(e,t){e?(u.message.showError(e),t&&(i.setCustomProfile(t,!0),a.setOptions(i.getOptions()))):(i.setCustomProfile(t,!0),x({options:i.getOptions()})),n.callback&&n.callback(e,t,n.profileText)})}),u.on("clear",function(e){u.message.hide(),i.setCustomProfile(null)}),d=new BR.TrackMessages(y,{requestUpdate:C}),p=new BR.TrackAnalysis(y,{requestUpdate:C}),routingPathQuality=new BR.RoutingPathQuality(y,h),o=new BR.Routing(u,{routing:{router:L.bind(a.getRouteSegment,a)},styles:BR.conf.routingStyles}),f=new BR.PoiMarkers(o),c=new BR.Export(a,f,u),o.on("routing:routeWaypointEnd routing:setWaypointsEnd routing:rerouteSegmentEnd",function(e){t.clear(),M(e&&e.err)}),y.on("routing:draw-start",function(){g.state("deactivate-draw"),w.enable()}),y.on("routing:draw-end",function(){g.state("activate-draw"),w.disable()}),o.addTo(y),l.addBelow(y),k=BR.sidebar({defaultTabId:BR.conf.transit?"tab_itinerary":"tab_profile",listeningTabs:{tab_profile:u,tab_data:d,tab_analysis:p}}).addTo(y),BR.conf.transit&&k.showPanel("tab_itinerary"),n.addTo(y),null!=(m=BR.circleGoArea(o,n,f))&&(f.circlego=m).addTo(y),e=[g,w,e,n.getButton()],m&&e.push(m.getButton()),e.push(B,v),L.easyBar(e).addTo(y),n.preventRoutePointOnCreate(o),BR.keys.strava&&BR.stravaSegments(y,h),BR.tracksLoader(y,h,o,f),BR.routeLoader(y,h,o,f),f.addTo(y),routingPathQuality.addTo(y),y.addControl(new BR.OpacitySliderControl({id:"route",title:i18next.t("map.opacity-slider-shortcut",{action:"$t(map.opacity-slider)",key:"M"}),muteKeyCode:77,callback:L.bind(o.setOpacity,o)})),a.setOptions(n.getOptions()),a.setOptions(i.getOptions()),location.hash||(u.update(i.getOptions()),h.loadActiveLayers()),(b=new L.Hash(null,null)).additionalCb=function(){var e=a.getUrl(o.getWaypoints(),o.getBeelineFlags(),f.getMarkers(),m?m.getCircle():null,null).substr("brouter?".length+1);return 0<(e=e.replace(/\|/g,";")).length?"&"+e:null},b.onHashChangeCb=function(e){var t=a.parseUrlParams(function(e){var t=0<arguments.length&&void 0!==e?e:"",n={},a="&";-1!==(t=t.replace(/;/g,"|")).search("&amp;")&&(a="&amp;");for(var o=t.split(a),i=0;i<o.length;i++){var r=o[i].split("=");2===r.length&&(n[r[0]]=decodeURIComponent(r[1]))}return n}(e));a.setOptions(t),i.setOptions(t),n.setOptions(t);e=Object.assign({},i.getOptions(),t);u.update(e,function(){t.lonlats&&(o.draw(!1),o.clear(),o.setWaypoints(t.lonlats,t.beelineFlags))}),t.pois&&f.setMarkers(t.pois),m&&t.circlego&&m.setOptions(t)},b.onInvalidHashChangeCb=function(e){return e=(e=(e=(e=e.replace("zoom=","map=")).replace("&lat=","/")).replace("&lon=","/")).replace("&layer=","/")},b.init(y,{layersControl:h}),setTimeout(function(){h.activateDefaultBaseLayer()},b.changeDefer),i.on("update",b.onMapMove,b),n.on("update",b.onMapMove,b),f.on("update",b.onMapMove,b),o.on("routing:routeWaypointEnd",b.onMapMove,b),o.on("waypoint:click",function(e){e=e.marker._routing;e.prevMarker||e.nextMarker||b.onMapMove()},b),BR.WhatsNew.init(),$(".modal").on("shown.bs.modal",function(e){$("input:visible:enabled:first",e.target).focus()})}(a)})}();
//# sourceMappingURL=brouter-web.js.map
